<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions</title>
<!--Generated on Mon Aug 11 17:57:54 2025 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<!--Document created on August 11, 2025.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="https://cdn.jsdelivr.net/gh/arXiv/arxiv-browse@master/arxiv/browse/static/css/ar5iv.0.8.2.min.css" rel="stylesheet" type="text/css"/>
<link href="https://cdn.jsdelivr.net/gh/arXiv/arxiv-browse@master/arxiv/browse/static/css/ar5iv-fonts.0.8.2.min.css" rel="stylesheet" type="text/css"/>
<link href="https://cdn.jsdelivr.net/gh/arXiv/arxiv-browse@master/arxiv/browse/static/css/latexml_styles.0.8.2.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<link href="book.css" rel="stylesheet" type="text/css"/><script defer="defer" src="shared-ui.js"></script><script defer="defer" src="book.js"></script></head>
<body id="top">
<nav class="ltx_page_navbar"><a class="ltx_ref" href="book-main.html" rel="start" title=""><span class="ltx_text ltx_ref_title">Learning Deep Representations of Data Distributions</span></a>
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_chapter"><a class="ltx_ref" href="Chx1.html" title="In Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_title">Preface</span></a></li>
<li class="ltx_tocentry ltx_tocentry_chapter"><a class="ltx_ref" href="Ch1.html" title="In Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_chapter"><a class="ltx_ref" href="Ch2.html" title="In Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Learning Linear and Independent Structures</span></a></li>
<li class="ltx_tocentry ltx_tocentry_chapter"><a class="ltx_ref" href="Ch3.html" title="In Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Pursuing Low-Dimensional Distributions via Lossy Compression</span></a></li>
<li class="ltx_tocentry ltx_tocentry_chapter"><a class="ltx_ref" href="Ch4.html" title="In Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Deep Representations from Unrolled Optimization</span></a></li>
<li class="ltx_tocentry ltx_tocentry_chapter"><a class="ltx_ref" href="Ch5.html" title="In Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Consistent and Self-Consistent Representations</span></a></li>
<li class="ltx_tocentry ltx_tocentry_chapter"><a class="ltx_ref" href="Ch6.html" title="In Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Inference with Low-Dimensional Distributions</span></a></li>
<li class="ltx_tocentry ltx_tocentry_chapter"><a class="ltx_ref" href="Ch7.html" title="In Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7 </span>Learning Representations for Real-World Data</span></a></li>
<li class="ltx_tocentry ltx_tocentry_chapter"><a class="ltx_ref" href="Ch8.html" title="In Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">8 </span>Future Study of Intelligence</span></a></li>
<li class="ltx_tocentry ltx_tocentry_part">
<a class="ltx_ref" href="Ptx1.html" title="In Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_title">Appendices</span></a>
<ol class="ltx_toclist ltx_toclist_part">
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="A1.html" title="In Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Optimization Methods</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix ltx_ref_self">
<span class="ltx_ref ltx_ref_self"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Entropy, Diffusion, Denoising, and Lossy Coding</span></span>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="#S1" title="In Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.1 </span>Differential Entropy of Low-Dimensional Distributions</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="#S2" title="In Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.2 </span>Diffusion and Denoising Processes</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="#S2.SS1" title="In B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.2.1 </span>Diffusion Process Increases Entropy Over Time</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="#S2.SS2" title="In B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.2.2 </span>Denoising Process Reduces Entropy Over Time</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="#S2.SS3" title="In B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.2.3 </span>Technical Lemmas and Intermediate Results</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="#S2.SS3.SSSx1" title="In B.2.3 Technical Lemmas and Intermediate Results â€£ B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_title">Finitneness of the Differential Entropy</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="#S2.SS3.SSSx2" title="In B.2.3 Technical Lemmas and Intermediate Results â€£ B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_title">Integration by Parts in De Brujin Identity</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="#S2.SS3.SSSx3" title="In B.2.3 Technical Lemmas and Intermediate Results â€£ B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_title">Local Invertibility of the Denoiser <math alttext="\bar{\bm{x}}" class="ltx_Math" display="inline"><semantics><mover accent="true"><mi>ğ’™</mi><mo>Â¯</mo></mover><annotation encoding="application/x-tex">\bar{\bm{x}}</annotation><annotation encoding="application/x-llamapun">overÂ¯ start_ARG bold_italic_x end_ARG</annotation></semantics></math></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="#S2.SS3.SSSx4" title="In B.2.3 Technical Lemmas and Intermediate Results â€£ B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_title">Controlling the Laplacian <math alttext="\Delta\log p_{t}" class="ltx_Math" display="inline"><semantics><mrow><mi mathvariant="normal">Î”</mi><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mi>log</mi><mo lspace="0.167em">â¡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow></mrow><annotation encoding="application/x-tex">\Delta\log p_{t}</annotation><annotation encoding="application/x-llamapun">roman_Î” roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="#S2.SS3.SSSx5" title="In B.2.3 Technical Lemmas and Intermediate Results â€£ B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_title">Derivative Computations</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="#S2.SS3.SSSx6" title="In B.2.3 Technical Lemmas and Intermediate Results â€£ B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_title">Differentiating Under the Integral Sign</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="#S3" title="In Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.3 </span>Lossy Coding and Sphere Packing</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="#S3.SS1" title="In B.3 Lossy Coding and Sphere Packing â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.3.1 </span>Proof of Relationship Between Rate Distortion and Covering</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="#S3.SS2" title="In B.3 Lossy Coding and Sphere Packing â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.3.2 </span>Deferred Proofs</span></a></li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<header class="ltx_page_header">
</header>
<div class="ltx_page_content">
<section class="ltx_appendix ltx_authors_1line">
<h1 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Entropy, Diffusion, Denoising, and Lossy Coding</h1><div class="mini-toc"><div class="mini-toc-title">In this section</div><ul><li><a href="#S1">Differential Entropy of Low-Dimensional Distributions</a></li><li><a href="#S2">Diffusion and Denoising Processes</a><div class="mini-toc-sub"><a href="#S2.SS1">Diffusion Process Increases Entropy Over Time</a><a href="#S2.SS2">Denoising Process Reduces Entropy Over Time</a><a href="#S2.SS3">Technical Lemmas and Intermediate Results</a></div></li><li><a href="#S3">Lossy Coding and Sphere Packing</a><div class="mini-toc-sub"><a href="#S3.SS1">Proof of Relationship Between Rate Distortion and Covering</a><a href="#S3.SS2">Deferred Proofs</a></div></li></ul></div>
<div class="ltx_para" id="p1">
<blockquote class="ltx_quote">
<p class="ltx_p">â€œ<span class="ltx_text ltx_font_italic">The increase of disorder or entropy with time is one example of what is called an arrow of time, something that distinguishes the past from the future, giving a direction to time.</span>â€</p>
<p class="ltx_p">â€„ â€“ A Brief History of Time, Stephen Hawking</p>
</blockquote>
</div>
<div class="ltx_para" id="p2">
<p class="ltx_p">In this appendix we provide proofs for several facts, mentioned in
<a class="ltx_ref" href="Ch3.html" title="Chapter 3 Pursuing Low-Dimensional Distributions via Lossy Compression â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Chapter</span>Â <span class="ltx_text ltx_ref_tag">3</span></a>, which are related to differential entropy, how
it evolves under diffusion processes, and its connections to lossy coding. We
will make the following mild assumption about the random variable representing
the data source, denoted <math alttext="\bm{x}" class="ltx_Math" display="inline" id="p2.m1"><semantics><mi>ğ’™</mi><annotation encoding="application/x-tex">\bm{x}</annotation><annotation encoding="application/x-llamapun">bold_italic_x</annotation></semantics></math>.</p>
</div>
<div class="ltx_theorem ltx_theorem_assumption" id="Thmassumption1">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold">Assumption B.1</span></span><span class="ltx_text ltx_font_bold">.</span>
</h6>
<div class="ltx_para" id="Thmassumption1.p1">
<p class="ltx_p"><math alttext="\bm{x}" class="ltx_Math" display="inline" id="Thmassumption1.p1.m1"><semantics><mi>ğ’™</mi><annotation encoding="application/x-tex">\bm{x}</annotation><annotation encoding="application/x-llamapun">bold_italic_x</annotation></semantics></math> is supported on a compact set <math alttext="\mathcal{S}\subseteq\mathbb{R}^{D}" class="ltx_Math" display="inline" id="Thmassumption1.p1.m2"><semantics><mrow><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mo>âŠ†</mo><msup><mi>â„</mi><mi>D</mi></msup></mrow><annotation encoding="application/x-tex">\mathcal{S}\subseteq\mathbb{R}^{D}</annotation><annotation encoding="application/x-llamapun">caligraphic_S âŠ† blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT</annotation></semantics></math> of radius at most <math alttext="R" class="ltx_Math" display="inline" id="Thmassumption1.p1.m3"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation><annotation encoding="application/x-llamapun">italic_R</annotation></semantics></math>, i.e., <math alttext="R\doteq\sup_{\bm{\xi}\in\mathcal{S}}\|\bm{\xi}\|_{2}" class="ltx_Math" display="inline" id="Thmassumption1.p1.m4"><semantics><mrow><mi>R</mi><mo rspace="0.1389em">â‰</mo><mrow><msub><mo lspace="0.1389em" rspace="0em">sup</mo><mrow><mi>ğƒ</mi><mo>âˆˆ</mo><mi class="ltx_font_mathcaligraphic">ğ’®</mi></mrow></msub><msub><mrow><mo stretchy="false">â€–</mo><mi>ğƒ</mi><mo stretchy="false">â€–</mo></mrow><mn>2</mn></msub></mrow></mrow><annotation encoding="application/x-tex">R\doteq\sup_{\bm{\xi}\in\mathcal{S}}\|\bm{\xi}\|_{2}</annotation><annotation encoding="application/x-llamapun">italic_R â‰ roman_sup start_POSTSUBSCRIPT bold_italic_Î¾ âˆˆ caligraphic_S end_POSTSUBSCRIPT âˆ¥ bold_italic_Î¾ âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
</div>
<div class="ltx_para" id="p3">
<p class="ltx_p">In particular, since compact sets in Euclidean space are bounded, it holds <math alttext="R&lt;\infty" class="ltx_Math" display="inline" id="p3.m1"><semantics><mrow><mi>R</mi><mo>&lt;</mo><mi mathvariant="normal">âˆ</mi></mrow><annotation encoding="application/x-tex">R&lt;\infty</annotation><annotation encoding="application/x-llamapun">italic_R &lt; âˆ</annotation></semantics></math>. We will consistently use the notation <math alttext="B_{r}(\bm{\xi})\doteq\{\bm{u}\in\mathbb{R}^{D}\colon\|\bm{\xi}-\bm{u}\|_{2}\leq r\}" class="ltx_Math" display="inline" id="p3.m2"><semantics><mrow><mrow><msub><mi>B</mi><mi>r</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>â‰</mo><mrow><mo stretchy="false">{</mo><mrow><mi>ğ’–</mi><mo>âˆˆ</mo><msup><mi>â„</mi><mi>D</mi></msup></mrow><mo lspace="0.278em" rspace="0.278em">:</mo><mrow><msub><mrow><mo stretchy="false">â€–</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’–</mi></mrow><mo stretchy="false">â€–</mo></mrow><mn>2</mn></msub><mo>â‰¤</mo><mi>r</mi></mrow><mo stretchy="false">}</mo></mrow></mrow><annotation encoding="application/x-tex">B_{r}(\bm{\xi})\doteq\{\bm{u}\in\mathbb{R}^{D}\colon\|\bm{\xi}-\bm{u}\|_{2}\leq r\}</annotation><annotation encoding="application/x-llamapun">italic_B start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( bold_italic_Î¾ ) â‰ { bold_italic_u âˆˆ blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT : âˆ¥ bold_italic_Î¾ - bold_italic_u âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT â‰¤ italic_r }</annotation></semantics></math> to denote the Euclidean ball of radius <math alttext="r" class="ltx_Math" display="inline" id="p3.m3"><semantics><mi>r</mi><annotation encoding="application/x-tex">r</annotation><annotation encoding="application/x-llamapun">italic_r</annotation></semantics></math> centered at <math alttext="\bm{\xi}" class="ltx_Math" display="inline" id="p3.m4"><semantics><mi>ğƒ</mi><annotation encoding="application/x-tex">\bm{\xi}</annotation><annotation encoding="application/x-llamapun">bold_italic_Î¾</annotation></semantics></math>. In this sense, <a class="ltx_ref" href="#Thmassumption1" title="Assumption B.1. â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Assumption</span>Â <span class="ltx_text ltx_ref_tag">B.1</span></a> has <math alttext="\mathcal{S}\subseteq B_{R}(\bm{0})" class="ltx_Math" display="inline" id="p3.m5"><semantics><mrow><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mo>âŠ†</mo><mrow><msub><mi>B</mi><mi>R</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mn>ğŸ</mn><mo stretchy="false">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\mathcal{S}\subseteq B_{R}(\bm{0})</annotation><annotation encoding="application/x-llamapun">caligraphic_S âŠ† italic_B start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT ( bold_0 )</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="p4">
<p class="ltx_p">Notice that this assumption holds for (almost) all variables we care about in practice, as it is (often) imposed by a normalization step during data pre-processing.</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">B.1 </span>Differential Entropy of Low-Dimensional Distributions</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p">In this short appendix we provide a proof of the following fact.</p>
</div>
<div class="ltx_theorem ltx_theorem_theorem" id="Thmtheorem1">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold">Theorem B.1</span></span><span class="ltx_text ltx_font_bold">.</span>
</h6>
<div class="ltx_para" id="Thmtheorem1.p1">
<p class="ltx_p"><span class="ltx_text ltx_font_italic">Let <math alttext="\bm{x}" class="ltx_Math" display="inline" id="Thmtheorem1.p1.m1"><semantics><mi>ğ±</mi><annotation encoding="application/x-tex">\bm{x}</annotation><annotation encoding="application/x-llamapun">bold_italic_x</annotation></semantics></math> be any random variable such that <a class="ltx_ref" href="#Thmassumption1" title="Assumption B.1. â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Assumption</span>Â <span class="ltx_text ltx_ref_tag">B.1</span></a> holds, and the support <math alttext="\mathcal{S}" class="ltx_Math" display="inline" id="Thmtheorem1.p1.m2"><semantics><mi class="ltx_font_mathcaligraphic">ğ’®</mi><annotation encoding="application/x-tex">\mathcal{S}</annotation><annotation encoding="application/x-llamapun">caligraphic_S</annotation></semantics></math> of <math alttext="\bm{x}" class="ltx_Math" display="inline" id="Thmtheorem1.p1.m3"><semantics><mi>ğ±</mi><annotation encoding="application/x-tex">\bm{x}</annotation><annotation encoding="application/x-llamapun">bold_italic_x</annotation></semantics></math> has <math alttext="0" class="ltx_Math" display="inline" id="Thmtheorem1.p1.m4"><mn>0</mn></math> volume.<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_upright">1</span></span><span class="ltx_text ltx_font_upright">Formally this means that </span><math alttext="\mathcal{S}" class="ltx_Math" display="inline" id="footnote1.m1"><semantics><mi class="ltx_font_mathcaligraphic">ğ’®</mi><annotation encoding="application/x-tex">\mathcal{S}</annotation><annotation encoding="application/x-llamapun">caligraphic_S</annotation></semantics></math><span class="ltx_text ltx_font_upright"> is Borel measurable with Borel measure </span><math alttext="0" class="ltx_Math" display="inline" id="footnote1.m2"><mn>0</mn></math><span class="ltx_text ltx_font_upright">.</span></span></span></span> Then <math alttext="h(\bm{x})=-\infty" class="ltx_Math" display="inline" id="Thmtheorem1.p1.m5"><semantics><mrow><mrow><mi>h</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğ±</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mo>âˆ’</mo><mi mathvariant="normal">âˆ</mi></mrow></mrow><annotation encoding="application/x-tex">h(\bm{x})=-\infty</annotation><annotation encoding="application/x-llamapun">italic_h ( bold_italic_x ) = - âˆ</annotation></semantics></math>.</span></p>
</div>
</div>
<div class="ltx_proof">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h6>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p">We will show this for the case that <math alttext="\bm{x}" class="ltx_Math" display="inline" id="S1.p2.m1"><semantics><mi>ğ’™</mi><annotation encoding="application/x-tex">\bm{x}</annotation><annotation encoding="application/x-llamapun">bold_italic_x</annotation></semantics></math> is uniform on <math alttext="\mathcal{S}" class="ltx_Math" display="inline" id="S1.p2.m2"><semantics><mi class="ltx_font_mathcaligraphic">ğ’®</mi><annotation encoding="application/x-tex">\mathcal{S}</annotation><annotation encoding="application/x-llamapun">caligraphic_S</annotation></semantics></math>; this setting captures the essential ideas without being too technical. The basic idea is to take an <math alttext="\varepsilon" class="ltx_Math" display="inline" id="S1.p2.m3"><semantics><mi>Îµ</mi><annotation encoding="application/x-tex">\varepsilon</annotation><annotation encoding="application/x-llamapun">italic_Îµ</annotation></semantics></math>-thickening of <math alttext="\mathcal{S}" class="ltx_Math" display="inline" id="S1.p2.m4"><semantics><mi class="ltx_font_mathcaligraphic">ğ’®</mi><annotation encoding="application/x-tex">\mathcal{S}</annotation><annotation encoding="application/x-llamapun">caligraphic_S</annotation></semantics></math>, say <math alttext="\mathcal{S}_{\varepsilon}" class="ltx_Math" display="inline" id="S1.p2.m5"><semantics><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mi>Îµ</mi></msub><annotation encoding="application/x-tex">\mathcal{S}_{\varepsilon}</annotation><annotation encoding="application/x-llamapun">caligraphic_S start_POSTSUBSCRIPT italic_Îµ end_POSTSUBSCRIPT</annotation></semantics></math> defined as</p>
<table class="ltx_equation ltx_eqn_table" id="S1.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="S_{\varepsilon}=\bigcup_{\bm{\xi}\in\mathcal{S}}B_{\varepsilon}(\bm{\xi})" class="ltx_Math" display="block" id="S1.E1.m1"><semantics><mrow><msub><mi>S</mi><mi>Îµ</mi></msub><mo rspace="0.111em">=</mo><mrow><munder><mo movablelimits="false">â‹ƒ</mo><mrow><mi>ğƒ</mi><mo>âˆˆ</mo><mi class="ltx_font_mathcaligraphic">ğ’®</mi></mrow></munder><mrow><msub><mi>B</mi><mi>Îµ</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">S_{\varepsilon}=\bigcup_{\bm{\xi}\in\mathcal{S}}B_{\varepsilon}(\bm{\xi})</annotation><annotation encoding="application/x-llamapun">italic_S start_POSTSUBSCRIPT italic_Îµ end_POSTSUBSCRIPT = â‹ƒ start_POSTSUBSCRIPT bold_italic_Î¾ âˆˆ caligraphic_S end_POSTSUBSCRIPT italic_B start_POSTSUBSCRIPT italic_Îµ end_POSTSUBSCRIPT ( bold_italic_Î¾ )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.1.1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">and visualized in <a class="ltx_ref" href="#F1" title="In B.1 Differential Entropy of Low-Dimensional Distributions â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Figure</span>Â <span class="ltx_text ltx_ref_tag">B.1</span></a>.</p>
</div>
<figure class="ltx_figure" id="F1"><svg class="ltx_picture" height="101.2" id="F1.pic1" overflow="visible" version="1.1" width="239.07"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,101.2) matrix(1 0 0 -1 0 0) translate(8.96,0) translate(0,41.59)"><g color="#FFB3B3" fill="#FFB3B3" fill-opacity="0.5" stroke="#FFB3B3" stroke-opacity="0.5"><path d="M 0 0 M 4.37 6.55 C 0.75 8.96 -4.14 7.99 -6.55 4.37 C -8.96 0.75 -7.99 -4.14 -4.37 -6.55 C -0.75 -8.96 4.14 -7.99 6.55 -4.37 C 8.96 -0.75 7.99 4.14 4.37 6.55 Z M 0 0" style="stroke:none"></path></g><g color="#FFB3B3" fill="#FFB3B3" fill-opacity="0.5" stroke="#FFB3B3" stroke-opacity="0.5"><path d="M 2.01 2.85 M 6.72 9.16 C 3.23 11.76 -1.7 11.04 -4.3 7.56 C -6.9 4.07 -6.19 -0.86 -2.7 -3.46 C 0.79 -6.06 5.72 -5.34 8.32 -1.86 C 10.92 1.63 10.2 6.56 6.72 9.16 Z M 2.01 2.85" style="stroke:none"></path></g><g color="#FFB3B3" fill="#FFB3B3" fill-opacity="0.5" stroke="#FFB3B3" stroke-opacity="0.5"><path d="M 4.17 5.58 M 9.23 11.61 C 5.9 14.41 0.94 13.98 -1.86 10.65 C -4.66 7.32 -4.22 2.35 -0.89 -0.45 C 2.44 -3.25 7.4 -2.81 10.2 0.52 C 13 3.85 12.56 8.81 9.23 11.61 Z M 4.17 5.58" style="stroke:none"></path></g><g color="#FFB3B3" fill="#FFB3B3" fill-opacity="0.5" stroke="#FFB3B3" stroke-opacity="0.5"><path d="M 6.49 8.18 M 11.93 13.88 C 8.78 16.88 3.79 16.76 0.79 13.61 C -2.21 10.46 -2.09 5.48 1.06 2.48 C 4.21 -0.52 9.19 -0.4 12.19 2.74 C 15.19 5.89 15.07 10.88 11.93 13.88 Z M 6.49 8.18" style="stroke:none"></path></g><g color="#FFB3B3" fill="#FFB3B3" fill-opacity="0.5" stroke="#FFB3B3" stroke-opacity="0.5"><path d="M 8.98 10.62 M 14.79 15.94 C 11.85 19.14 6.87 19.36 3.66 16.42 C 0.45 13.49 0.24 8.51 3.17 5.3 C 6.11 2.09 11.09 1.87 14.3 4.81 C 17.5 7.75 17.72 12.73 14.79 15.94 Z M 8.98 10.62" style="stroke:none"></path></g><g color="#FFB3B3" fill="#FFB3B3" fill-opacity="0.5" stroke="#FFB3B3" stroke-opacity="0.5"><path d="M 11.63 12.88 M 17.8 17.77 C 15.11 21.18 10.15 21.75 6.74 19.05 C 3.33 16.35 2.76 11.4 5.46 7.99 C 8.16 4.58 13.11 4.01 16.52 6.71 C 19.93 9.4 20.5 14.36 17.8 17.77 Z M 11.63 12.88" style="stroke:none"></path></g><g color="#FFB3B3" fill="#FFB3B3" fill-opacity="0.5" stroke="#FFB3B3" stroke-opacity="0.5"><path d="M 14.44 14.94 M 20.96 19.35 C 18.53 22.95 13.63 23.9 10.03 21.46 C 6.43 19.02 5.48 14.13 7.92 10.53 C 10.36 6.92 15.25 5.98 18.85 8.42 C 22.46 10.85 23.4 15.75 20.96 19.35 Z M 14.44 14.94" style="stroke:none"></path></g><g color="#FFB3B3" fill="#FFB3B3" fill-opacity="0.5" stroke="#FFB3B3" stroke-opacity="0.5"><path d="M 17.4 16.78 M 24.24 20.68 C 22.09 24.46 17.28 25.77 13.5 23.62 C 9.72 21.46 8.4 16.66 10.56 12.88 C 12.71 9.1 17.52 7.78 21.3 9.94 C 25.08 12.09 26.39 16.9 24.24 20.68 Z M 17.4 16.78" style="stroke:none"></path></g><g color="#FFB3B3" fill="#FFB3B3" fill-opacity="0.5" stroke="#FFB3B3" stroke-opacity="0.5"><path d="M 20.49 18.39 M 27.61 21.75 C 25.75 25.68 21.06 27.36 17.13 25.51 C 13.19 23.65 11.51 18.95 13.37 15.02 C 15.23 11.09 19.92 9.41 23.86 11.27 C 27.79 13.13 29.47 17.82 27.61 21.75 Z M 20.49 18.39" style="stroke:none"></path></g><g color="#FFB3B3" fill="#FFB3B3" fill-opacity="0.5" stroke="#FFB3B3" stroke-opacity="0.5"><path d="M 23.69 19.76 M 31.04 22.58 C 29.48 26.64 24.93 28.67 20.87 27.11 C 16.81 25.55 14.78 20.99 16.34 16.93 C 17.9 12.87 22.46 10.85 26.52 12.41 C 30.58 13.96 32.6 18.52 31.04 22.58 Z M 23.69 19.76" style="stroke:none"></path></g><g color="#FFB3B3" fill="#FFB3B3" fill-opacity="0.5" stroke="#FFB3B3" stroke-opacity="0.5"><path d="M 26.99 20.89 M 34.52 23.18 C 33.25 27.34 28.86 29.69 24.7 28.42 C 20.54 27.15 18.19 22.76 19.45 18.59 C 20.72 14.43 25.12 12.09 29.28 13.35 C 33.44 14.62 35.79 19.02 34.52 23.18 Z M 26.99 20.89" style="stroke:none"></path></g><g color="#FFB3B3" fill="#FFB3B3" fill-opacity="0.5" stroke="#FFB3B3" stroke-opacity="0.5"><path d="M 30.35 21.79 M 38.02 23.57 C 37.04 27.81 32.8 30.44 28.57 29.46 C 24.33 28.47 21.7 24.24 22.68 20 C 23.67 15.77 27.9 13.13 32.14 14.12 C 36.37 15.1 39.01 19.33 38.02 23.57 Z M 30.35 21.79" style="stroke:none"></path></g><g color="#FFB3B3" fill="#FFB3B3" fill-opacity="0.5" stroke="#FFB3B3" stroke-opacity="0.5"><path d="M 33.77 22.47 M 41.53 23.78 C 40.81 28.07 36.75 30.96 32.46 30.23 C 28.17 29.51 25.28 25.45 26 21.16 C 26.73 16.87 30.79 13.98 35.08 14.71 C 39.36 15.43 42.25 19.49 41.53 23.78 Z M 33.77 22.47" style="stroke:none"></path></g><g color="#FFB3B3" fill="#FFB3B3" fill-opacity="0.5" stroke="#FFB3B3" stroke-opacity="0.5"><path d="M 37.22 22.95 M 45.04 23.83 C 44.56 28.15 40.66 31.26 36.34 30.78 C 32.02 30.29 28.91 26.4 29.39 22.07 C 29.87 17.75 33.77 14.64 38.09 15.13 C 42.41 15.61 45.52 19.51 45.04 23.83 Z M 37.22 22.95" style="stroke:none"></path></g><g color="#FFB3B3" fill="#FFB3B3" fill-opacity="0.5" stroke="#FFB3B3" stroke-opacity="0.5"><path d="M 40.69 23.25 M 48.54 23.74 C 48.27 28.08 44.54 31.38 40.2 31.11 C 35.86 30.84 32.56 27.1 32.83 22.76 C 33.1 18.42 36.83 15.12 41.17 15.39 C 45.51 15.66 48.81 19.4 48.54 23.74 Z M 40.69 23.25" style="stroke:none"></path></g><g color="#FFB3B3" fill="#FFB3B3" fill-opacity="0.5" stroke="#FFB3B3" stroke-opacity="0.5"><path d="M 44.17 23.39 M 52.04 23.54 C 51.96 27.88 48.37 31.34 44.02 31.26 C 39.67 31.18 36.21 27.59 36.29 23.25 C 36.37 18.9 39.96 15.44 44.31 15.52 C 48.66 15.6 52.12 19.19 52.04 23.54 Z M 44.17 23.39" style="stroke:none"></path></g><g color="#FFB3B3" fill="#FFB3B3" fill-opacity="0.5" stroke="#FFB3B3" stroke-opacity="0.5"><path d="M 47.65 23.39 M 55.52 23.23 C 55.61 27.58 52.15 31.17 47.8 31.26 C 43.45 31.34 39.86 27.89 39.77 23.54 C 39.69 19.19 43.14 15.6 47.49 15.51 C 51.84 15.43 55.43 18.88 55.52 23.23 Z M 47.65 23.39" style="stroke:none"></path></g><g color="#FFB3B3" fill="#FFB3B3" fill-opacity="0.5" stroke="#FFB3B3" stroke-opacity="0.5"><path d="M 51.13 23.26 M 58.99 22.85 C 59.22 27.19 55.88 30.89 51.54 31.12 C 47.2 31.35 43.49 28.02 43.27 23.67 C 43.04 19.33 46.37 15.62 50.72 15.4 C 55.06 15.17 58.76 18.5 58.99 22.85 Z M 51.13 23.26" style="stroke:none"></path></g><g color="#FFB3B3" fill="#FFB3B3" fill-opacity="0.5" stroke="#FFB3B3" stroke-opacity="0.5"><path d="M 54.6 23.03 M 62.45 22.39 C 62.8 26.73 59.57 30.53 55.24 30.88 C 50.9 31.23 47.1 27.99 46.75 23.66 C 46.41 19.33 49.64 15.53 53.97 15.18 C 58.31 14.83 62.1 18.06 62.45 22.39 Z M 54.6 23.03" style="stroke:none"></path></g><g color="#FFB3B3" fill="#FFB3B3" fill-opacity="0.5" stroke="#FFB3B3" stroke-opacity="0.5"><path d="M 58.07 22.71 M 65.9 21.89 C 66.35 26.21 63.21 30.09 58.89 30.54 C 54.56 30.99 50.69 27.85 50.24 23.52 C 49.79 19.2 52.93 15.32 57.25 14.87 C 61.58 14.42 65.45 17.56 65.9 21.89 Z M 58.07 22.71" style="stroke:none"></path></g><g color="#FFB3B3" fill="#FFB3B3" fill-opacity="0.5" stroke="#FFB3B3" stroke-opacity="0.5"><path d="M 61.53 22.31 M 69.35 21.34 C 69.88 25.66 66.81 29.59 62.5 30.12 C 58.18 30.66 54.25 27.59 53.72 23.28 C 53.18 18.96 56.25 15.03 60.56 14.5 C 64.88 13.96 68.81 17.03 69.35 21.34 Z M 61.53 22.31" style="stroke:none"></path></g><g color="#FFB3B3" fill="#FFB3B3" fill-opacity="0.5" stroke="#FFB3B3" stroke-opacity="0.5"><path d="M 64.98 21.85 M 72.78 20.77 C 73.38 25.07 70.38 29.05 66.07 29.65 C 61.76 30.25 57.78 27.25 57.18 22.94 C 56.58 18.63 59.59 14.66 63.89 14.06 C 68.2 13.45 72.18 16.46 72.78 20.77 Z M 64.98 21.85" style="stroke:none"></path></g><g color="#FFB3B3" fill="#FFB3B3" fill-opacity="0.5" stroke="#FFB3B3" stroke-opacity="0.5"><path d="M 68.43 21.35 M 76.21 20.17 C 76.86 24.47 73.91 28.49 69.61 29.14 C 65.31 29.79 61.29 26.83 60.64 22.53 C 59.99 18.23 62.95 14.22 67.25 13.57 C 71.55 12.92 75.56 15.87 76.21 20.17 Z M 68.43 21.35" style="stroke:none"></path></g><g color="#FFB3B3" fill="#FFB3B3" fill-opacity="0.5" stroke="#FFB3B3" stroke-opacity="0.5"><path d="M 71.87 20.82 M 79.64 19.57 C 80.33 23.87 77.41 27.9 73.11 28.59 C 68.82 29.28 64.78 26.35 64.09 22.06 C 63.41 17.76 66.33 13.73 70.62 13.04 C 74.92 12.35 78.96 15.28 79.64 19.57 Z M 71.87 20.82" style="stroke:none"></path></g><g color="#FFB3B3" fill="#FFB3B3" fill-opacity="0.5" stroke="#FFB3B3" stroke-opacity="0.5"><path d="M 75.3 20.26 M 83.07 18.97 C 83.78 23.26 80.87 27.32 76.58 28.03 C 72.29 28.73 68.24 25.83 67.53 21.54 C 66.83 17.25 69.73 13.2 74.02 12.49 C 78.31 11.78 82.36 14.68 83.07 18.97 Z M 75.3 20.26" style="stroke:none"></path></g><g color="#FFB3B3" fill="#FFB3B3" fill-opacity="0.5" stroke="#FFB3B3" stroke-opacity="0.5"><path d="M 78.73 19.69 M 86.5 18.39 C 87.22 22.68 84.32 26.74 80.03 27.45 C 75.74 28.17 71.68 25.27 70.97 20.98 C 70.25 16.69 73.15 12.63 77.44 11.92 C 81.73 11.2 85.79 14.1 86.5 18.39 Z M 78.73 19.69" style="stroke:none"></path></g><g color="#FFB3B3" fill="#FFB3B3" fill-opacity="0.5" stroke="#FFB3B3" stroke-opacity="0.5"><path d="M 82.17 19.12 M 89.94 17.83 C 90.64 22.12 87.74 26.18 83.45 26.88 C 79.16 27.59 75.11 24.69 74.4 20.4 C 73.69 16.11 76.59 12.05 80.89 11.35 C 85.18 10.64 89.23 13.54 89.94 17.83 Z M 82.17 19.12" style="stroke:none"></path></g><g color="#FFB3B3" fill="#FFB3B3" fill-opacity="0.5" stroke="#FFB3B3" stroke-opacity="0.5"><path d="M 85.6 18.56 M 93.38 17.31 C 94.06 21.61 91.14 25.64 86.85 26.33 C 82.55 27.02 78.51 24.09 77.83 19.8 C 77.14 15.51 80.06 11.47 84.36 10.78 C 88.65 10.09 92.69 13.02 93.38 17.31 Z M 85.6 18.56" style="stroke:none"></path></g><g color="#FFB3B3" fill="#FFB3B3" fill-opacity="0.5" stroke="#FFB3B3" stroke-opacity="0.5"><path d="M 89.04 18.02 M 96.83 16.84 C 97.48 21.14 94.52 25.15 90.22 25.81 C 85.92 26.46 81.91 23.5 81.26 19.2 C 80.6 14.9 83.56 10.89 87.86 10.24 C 92.16 9.58 96.17 12.54 96.83 16.84 Z M 89.04 18.02" style="stroke:none"></path></g><g color="#FFB3B3" fill="#FFB3B3" fill-opacity="0.5" stroke="#FFB3B3" stroke-opacity="0.5"><path d="M 92.49 17.52 M 100.29 16.43 C 100.89 20.74 97.88 24.71 93.58 25.32 C 89.27 25.92 85.29 22.91 84.69 18.61 C 84.09 14.3 87.09 10.32 91.4 9.72 C 95.71 9.12 99.68 12.12 100.29 16.43 Z M 92.49 17.52" style="stroke:none"></path></g><g color="#FFB3B3" fill="#FFB3B3" fill-opacity="0.5" stroke="#FFB3B3" stroke-opacity="0.5"><path d="M 95.94 17.06 M 103.75 16.09 C 104.29 20.41 101.22 24.34 96.91 24.88 C 92.59 25.41 88.66 22.35 88.12 18.03 C 87.59 13.71 90.65 9.78 94.97 9.25 C 99.29 8.71 103.22 11.78 103.75 16.09 Z M 95.94 17.06" style="stroke:none"></path></g><g color="#FFB3B3" fill="#FFB3B3" fill-opacity="0.5" stroke="#FFB3B3" stroke-opacity="0.5"><path d="M 99.4 16.67 M 107.23 15.85 C 107.68 20.17 104.54 24.05 100.22 24.5 C 95.89 24.95 92.02 21.81 91.57 17.48 C 91.12 13.16 94.26 9.29 98.58 8.83 C 102.91 8.38 106.78 11.52 107.23 15.85 Z M 99.4 16.67" style="stroke:none"></path></g><g color="#FFB3B3" fill="#FFB3B3" fill-opacity="0.5" stroke="#FFB3B3" stroke-opacity="0.5"><path d="M 102.87 16.34 M 110.71 15.71 C 111.06 20.05 107.83 23.84 103.5 24.19 C 99.16 24.54 95.37 21.31 95.02 16.98 C 94.67 12.64 97.9 8.84 102.23 8.5 C 106.57 8.15 110.36 11.38 110.71 15.71 Z M 102.87 16.34" style="stroke:none"></path></g><g color="#FFB3B3" fill="#FFB3B3" fill-opacity="0.5" stroke="#FFB3B3" stroke-opacity="0.5"><path d="M 106.34 16.11 M 114.2 15.7 C 114.43 20.04 111.1 23.75 106.75 23.97 C 102.41 24.2 98.71 20.87 98.48 16.52 C 98.25 12.18 101.59 8.48 105.93 8.25 C 110.27 8.02 113.98 11.35 114.2 15.7 Z M 106.34 16.11" style="stroke:none"></path></g><g color="#FFB3B3" fill="#FFB3B3" fill-opacity="0.5" stroke="#FFB3B3" stroke-opacity="0.5"><path d="M 109.82 15.98 M 117.7 15.83 C 117.78 20.18 114.33 23.77 109.98 23.86 C 105.63 23.94 102.04 20.49 101.95 16.14 C 101.86 11.79 105.32 8.2 109.67 8.11 C 114.02 8.03 117.61 11.48 117.7 15.83 Z M 109.82 15.98" style="stroke:none"></path></g><g color="#FFB3B3" fill="#FFB3B3" fill-opacity="0.5" stroke="#FFB3B3" stroke-opacity="0.5"><path d="M 113.3 15.98 M 121.18 16.12 C 121.1 20.47 117.51 23.93 113.16 23.85 C 108.81 23.77 105.35 20.18 105.43 15.84 C 105.51 11.49 109.1 8.03 113.45 8.11 C 117.8 8.19 121.26 11.78 121.18 16.12 Z M 113.3 15.98" style="stroke:none"></path></g><g color="#FFB3B3" fill="#FFB3B3" fill-opacity="0.5" stroke="#FFB3B3" stroke-opacity="0.5"><path d="M 116.78 16.12 M 124.64 16.61 C 124.37 20.95 120.64 24.25 116.3 23.98 C 111.96 23.71 108.66 19.97 108.93 15.63 C 109.2 11.29 112.93 7.99 117.27 8.26 C 121.61 8.53 124.91 12.26 124.64 16.61 Z M 116.78 16.12" style="stroke:none"></path></g><g color="#FFB3B3" fill="#FFB3B3" fill-opacity="0.5" stroke="#FFB3B3" stroke-opacity="0.5"><path d="M 120.25 16.42 M 128.08 17.29 C 127.6 21.61 123.7 24.73 119.38 24.24 C 115.06 23.76 111.95 19.86 112.43 15.54 C 112.91 11.22 116.81 8.11 121.13 8.59 C 125.45 9.08 128.56 12.97 128.08 17.29 Z M 120.25 16.42" style="stroke:none"></path></g><g color="#FFB3B3" fill="#FFB3B3" fill-opacity="0.5" stroke="#FFB3B3" stroke-opacity="0.5"><path d="M 123.7 16.9 M 131.47 18.21 C 130.75 22.5 126.68 25.39 122.4 24.66 C 118.11 23.94 115.22 19.88 115.94 15.59 C 116.66 11.3 120.72 8.41 125.01 9.13 C 129.3 9.86 132.19 13.92 131.47 18.21 Z M 123.7 16.9" style="stroke:none"></path></g><g color="#FFB3B3" fill="#FFB3B3" fill-opacity="0.5" stroke="#FFB3B3" stroke-opacity="0.5"><path d="M 127.12 17.58 M 134.79 19.36 C 133.8 23.6 129.57 26.23 125.34 25.25 C 121.1 24.27 118.46 20.03 119.45 15.8 C 120.43 11.56 124.66 8.93 128.9 9.91 C 133.14 10.9 135.77 15.13 134.79 19.36 Z M 127.12 17.58" style="stroke:none"></path></g><g color="#FFB3B3" fill="#FFB3B3" fill-opacity="0.5" stroke="#FFB3B3" stroke-opacity="0.5"><path d="M 130.48 18.48 M 138.02 20.77 C 136.75 24.93 132.35 27.28 128.19 26.01 C 124.03 24.75 121.69 20.35 122.95 16.19 C 124.21 12.03 128.61 9.68 132.77 10.95 C 136.93 12.21 139.28 16.61 138.02 20.77 Z M 130.48 18.48" style="stroke:none"></path></g><g color="#FFB3B3" fill="#FFB3B3" fill-opacity="0.5" stroke="#FFB3B3" stroke-opacity="0.5"><path d="M 133.78 19.61 M 141.13 22.43 C 139.57 26.49 135.02 28.52 130.96 26.96 C 126.9 25.4 124.87 20.85 126.43 16.79 C 127.99 12.73 132.54 10.7 136.6 12.26 C 140.66 13.82 142.69 18.37 141.13 22.43 Z M 133.78 19.61" style="stroke:none"></path></g><g color="#FFB3B3" fill="#FFB3B3" fill-opacity="0.5" stroke="#FFB3B3" stroke-opacity="0.5"><path d="M 136.98 20.98 M 144.1 24.34 C 142.24 28.27 137.55 29.96 133.62 28.1 C 129.69 26.24 128 21.55 129.86 17.62 C 131.72 13.68 136.41 12 140.34 13.86 C 144.28 15.72 145.96 20.41 144.1 24.34 Z M 136.98 20.98" style="stroke:none"></path></g><g color="#FFB3B3" fill="#FFB3B3" fill-opacity="0.5" stroke="#FFB3B3" stroke-opacity="0.5"><path d="M 140.07 22.59 M 146.91 26.49 C 144.76 30.26 139.95 31.58 136.17 29.43 C 132.4 27.28 131.08 22.47 133.23 18.69 C 135.38 14.91 140.19 13.59 143.97 15.75 C 147.75 17.9 149.07 22.71 146.91 26.49 Z M 140.07 22.59" style="stroke:none"></path></g><g color="#FFB3B3" fill="#FFB3B3" fill-opacity="0.5" stroke="#FFB3B3" stroke-opacity="0.5"><path d="M 143.03 24.43 M 149.55 28.84 C 147.12 32.44 142.22 33.39 138.62 30.95 C 135.02 28.51 134.07 23.62 136.51 20.02 C 138.94 16.41 143.84 15.47 147.44 17.9 C 151.04 20.34 151.99 25.23 149.55 28.84 Z M 143.03 24.43" style="stroke:none"></path></g><g color="#FFB3B3" fill="#FFB3B3" fill-opacity="0.5" stroke="#FFB3B3" stroke-opacity="0.5"><path d="M 145.84 26.48 M 152.01 31.37 C 149.32 34.78 144.36 35.36 140.95 32.66 C 137.54 29.96 136.97 25.01 139.67 21.6 C 142.36 18.19 147.32 17.61 150.73 20.31 C 154.14 23.01 154.71 27.96 152.01 31.37 Z M 145.84 26.48" style="stroke:none"></path></g><g color="#FFB3B3" fill="#FFB3B3" fill-opacity="0.5" stroke="#FFB3B3" stroke-opacity="0.5"><path d="M 148.49 28.74 M 154.3 34.06 C 151.36 37.27 146.38 37.49 143.18 34.55 C 139.97 31.62 139.75 26.64 142.69 23.43 C 145.62 20.22 150.6 20 153.81 22.94 C 157.02 25.87 157.24 30.85 154.3 34.06 Z M 148.49 28.74" style="stroke:none"></path></g><g color="#FFB3B3" fill="#FFB3B3" fill-opacity="0.5" stroke="#FFB3B3" stroke-opacity="0.5"><path d="M 150.98 31.18 M 156.42 36.88 C 153.27 39.88 148.28 39.77 145.28 36.62 C 142.28 33.47 142.4 28.49 145.55 25.49 C 148.69 22.49 153.68 22.6 156.68 25.75 C 159.68 28.9 159.56 33.88 156.42 36.88 Z M 150.98 31.18" style="stroke:none"></path></g><g color="#FFB3B3" fill="#FFB3B3" fill-opacity="0.5" stroke="#FFB3B3" stroke-opacity="0.5"><path d="M 153.3 33.78 M 158.37 39.81 C 155.04 42.61 150.07 42.17 147.27 38.85 C 144.48 35.52 144.91 30.55 148.24 27.75 C 151.57 24.95 156.53 25.38 159.33 28.71 C 162.13 32.04 161.7 37.01 158.37 39.81 Z M 153.3 33.78" style="stroke:none"></path></g><g color="#FFB3B3" fill="#FFB3B3" fill-opacity="0.5" stroke="#FFB3B3" stroke-opacity="0.5"><path d="M 155.46 36.51 M 160.17 42.82 C 156.69 45.42 151.75 44.71 149.15 41.22 C 146.55 37.73 147.27 32.8 150.76 30.2 C 154.24 27.6 159.18 28.32 161.78 31.8 C 164.38 35.29 163.66 40.22 160.17 42.82 Z M 155.46 36.51" style="stroke:none"></path></g><g color="#0000FF" fill="#0000FF" stroke="#0000FF" stroke-width="0.8pt"><path d="M 0 0 C 39.37 59.06 118.11 -19.69 157.48 39.37" style="fill:none"></path><g fill="#0000FF" stroke="#0000FF" transform="matrix(1.0 0.0 0.0 1.0 162.65 34.64)"><foreignobject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="7.69"><math alttext="\mathcal{S}" class="ltx_Math" display="inline" id="F1.pic1.m1"><semantics><mi class="ltx_font_mathcaligraphic">ğ’®</mi><annotation encoding="application/x-tex">\mathcal{S}</annotation><annotation encoding="application/x-llamapun">caligraphic_S</annotation></semantics></math></foreignobject></g></g><g color="#FF8080" fill="#FF8080" fill-opacity="0.7" stroke="#FF8080" stroke-opacity="0.7"><path d="M 78.74 19.69 M 86.61 19.69 C 86.61 24.03 83.09 27.56 78.74 27.56 C 74.39 27.56 70.87 24.03 70.87 19.69 C 70.87 15.34 74.39 11.81 78.74 11.81 C 83.09 11.81 86.61 15.34 86.61 19.69 Z M 78.74 19.69" style="stroke:none"></path></g><g color="#000000" fill="#000000" stroke="#000000"><path d="M 78.74 19.69 M 80.12 19.69 C 80.12 20.45 79.5 21.07 78.74 21.07 C 77.98 21.07 77.36 20.45 77.36 19.69 C 77.36 18.92 77.98 18.3 78.74 18.3 C 79.5 18.3 80.12 18.92 80.12 19.69 Z M 78.74 19.69" style="stroke:none"></path></g><g color="#000000" fill="#000000" stroke="#000000" transform="matrix(1.0 0.0 0.0 1.0 65.94 8.84)"><foreignobject height="5.96" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="7.91"><math alttext="x" class="ltx_Math" display="inline" id="F1.pic1.m2"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation><annotation encoding="application/x-llamapun">italic_x</annotation></semantics></math></foreignobject></g><g color="#FF0000" fill="#FF0000" stroke="#FF0000" transform="matrix(1.0 0.0 0.0 1.0 142.68 -23.14)"><foreignobject height="24.21" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="82.81"><math alttext="\mathcal{S}_{\varepsilon}=\bigcup_{\bm{\xi}\in S}B_{\varepsilon}(\bm{\xi})" class="ltx_Math" display="inline" id="F1.pic1.m3"><semantics><mrow><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mi>Îµ</mi></msub><mo rspace="0.111em">=</mo><mrow><msub><mo>â‹ƒ</mo><mrow><mi>ğƒ</mi><mo>âˆˆ</mo><mi>S</mi></mrow></msub><mrow><msub><mi>B</mi><mi>Îµ</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">\mathcal{S}_{\varepsilon}=\bigcup_{\bm{\xi}\in S}B_{\varepsilon}(\bm{\xi})</annotation><annotation encoding="application/x-llamapun">caligraphic_S start_POSTSUBSCRIPT italic_Îµ end_POSTSUBSCRIPT = â‹ƒ start_POSTSUBSCRIPT bold_italic_Î¾ âˆˆ italic_S end_POSTSUBSCRIPT italic_B start_POSTSUBSCRIPT italic_Îµ end_POSTSUBSCRIPT ( bold_italic_Î¾ )</annotation></semantics></math></foreignobject></g></g></svg>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" style="font-size:90%;">Figure B.1</span>: </span><span class="ltx_text" style="font-size:90%;">Illustration of the <math alttext="\varepsilon" class="ltx_Math" display="inline" id="F1.m4"><semantics><mi>Îµ</mi><annotation encoding="application/x-tex">\varepsilon</annotation><annotation encoding="application/x-llamapun">italic_Îµ</annotation></semantics></math>-thickening <math alttext="\mathcal{S}_{\varepsilon}" class="ltx_Math" display="inline" id="F1.m5"><semantics><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mi>Îµ</mi></msub><annotation encoding="application/x-tex">\mathcal{S}_{\varepsilon}</annotation><annotation encoding="application/x-llamapun">caligraphic_S start_POSTSUBSCRIPT italic_Îµ end_POSTSUBSCRIPT</annotation></semantics></math> of a curve <math alttext="\mathcal{S}\subseteq\mathbb{R}^{2}" class="ltx_Math" display="inline" id="F1.m6"><semantics><mrow><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mo>âŠ†</mo><msup><mi>â„</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\mathcal{S}\subseteq\mathbb{R}^{2}</annotation><annotation encoding="application/x-llamapun">caligraphic_S âŠ† blackboard_R start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math>.</span></figcaption>
</figure>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p">We will work with random variables whose support is <math alttext="\mathcal{S}_{\varepsilon}" class="ltx_Math" display="inline" id="S1.p3.m1"><semantics><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mi>Îµ</mi></msub><annotation encoding="application/x-tex">\mathcal{S}_{\varepsilon}</annotation><annotation encoding="application/x-llamapun">caligraphic_S start_POSTSUBSCRIPT italic_Îµ end_POSTSUBSCRIPT</annotation></semantics></math>, which is fully-dimensional, and take the limit as <math alttext="\varepsilon\to 0" class="ltx_Math" display="inline" id="S1.p3.m2"><semantics><mrow><mi>Îµ</mi><mo stretchy="false">â†’</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\varepsilon\to 0</annotation><annotation encoding="application/x-llamapun">italic_Îµ â†’ 0</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p">Thus let <math alttext="\bm{x}\sim\operatorname{\mathcal{U}}(\mathcal{S})" class="ltx_Math" display="inline" id="S1.p4.m1"><semantics><mrow><mi>ğ’™</mi><mo>âˆ¼</mo><mrow><mi class="ltx_font_mathcaligraphic">ğ’°</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\bm{x}\sim\operatorname{\mathcal{U}}(\mathcal{S})</annotation><annotation encoding="application/x-llamapun">bold_italic_x âˆ¼ caligraphic_U ( caligraphic_S )</annotation></semantics></math> such that it does not have a density<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>w.r.t.Â the Borel measure on <math alttext="\mathbb{R}^{D}" class="ltx_Math" display="inline" id="footnote2.m1"><semantics><msup><mi>â„</mi><mi>D</mi></msup><annotation encoding="application/x-tex">\mathbb{R}^{D}</annotation><annotation encoding="application/x-llamapun">blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT</annotation></semantics></math>.</span></span></span> and <math alttext="\bm{x}_{\varepsilon}\sim\operatorname{\mathcal{U}}(\mathcal{S}_{\varepsilon})" class="ltx_Math" display="inline" id="S1.p4.m2"><semantics><mrow><msub><mi>ğ’™</mi><mi>Îµ</mi></msub><mo>âˆ¼</mo><mrow><mi class="ltx_font_mathcaligraphic">ğ’°</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mi>Îµ</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\bm{x}_{\varepsilon}\sim\operatorname{\mathcal{U}}(\mathcal{S}_{\varepsilon})</annotation><annotation encoding="application/x-llamapun">bold_italic_x start_POSTSUBSCRIPT italic_Îµ end_POSTSUBSCRIPT âˆ¼ caligraphic_U ( caligraphic_S start_POSTSUBSCRIPT italic_Îµ end_POSTSUBSCRIPT )</annotation></semantics></math>. Since <math alttext="\mathcal{S}_{\varepsilon}" class="ltx_Math" display="inline" id="S1.p4.m3"><semantics><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mi>Îµ</mi></msub><annotation encoding="application/x-tex">\mathcal{S}_{\varepsilon}</annotation><annotation encoding="application/x-llamapun">caligraphic_S start_POSTSUBSCRIPT italic_Îµ end_POSTSUBSCRIPT</annotation></semantics></math> has positive volume, <math alttext="\bm{x}_{\varepsilon}" class="ltx_Math" display="inline" id="S1.p4.m4"><semantics><msub><mi>ğ’™</mi><mi>Îµ</mi></msub><annotation encoding="application/x-tex">\bm{x}_{\varepsilon}</annotation><annotation encoding="application/x-llamapun">bold_italic_x start_POSTSUBSCRIPT italic_Îµ end_POSTSUBSCRIPT</annotation></semantics></math> has a density <math alttext="p_{\varepsilon}" class="ltx_Math" display="inline" id="S1.p4.m5"><semantics><msub><mi>p</mi><mi>Îµ</mi></msub><annotation encoding="application/x-tex">p_{\varepsilon}</annotation><annotation encoding="application/x-llamapun">italic_p start_POSTSUBSCRIPT italic_Îµ end_POSTSUBSCRIPT</annotation></semantics></math> equal to</p>
<table class="ltx_equation ltx_eqn_table" id="S1.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="p_{\varepsilon}(\bm{\xi})=\mathbf{1}(\bm{\xi}\in\mathcal{S}_{\varepsilon})\cdot\frac{1}{\operatorname{vol}(\mathcal{S}_{\varepsilon})}." class="ltx_Math" display="block" id="S1.E2.m1"><semantics><mrow><mrow><mrow><msub><mi>p</mi><mi>Îµ</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mn>ğŸ</mn><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆˆ</mo><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mi>Îµ</mi></msub></mrow><mo rspace="0.055em" stretchy="false">)</mo></mrow></mrow><mo rspace="0.222em">â‹…</mo><mfrac><mn>1</mn><mrow><mi>vol</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mi>Îµ</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mfrac></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">p_{\varepsilon}(\bm{\xi})=\mathbf{1}(\bm{\xi}\in\mathcal{S}_{\varepsilon})\cdot\frac{1}{\operatorname{vol}(\mathcal{S}_{\varepsilon})}.</annotation><annotation encoding="application/x-llamapun">italic_p start_POSTSUBSCRIPT italic_Îµ end_POSTSUBSCRIPT ( bold_italic_Î¾ ) = bold_1 ( bold_italic_Î¾ âˆˆ caligraphic_S start_POSTSUBSCRIPT italic_Îµ end_POSTSUBSCRIPT ) â‹… divide start_ARG 1 end_ARG start_ARG roman_vol ( caligraphic_S start_POSTSUBSCRIPT italic_Îµ end_POSTSUBSCRIPT ) end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.1.2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">Since <math alttext="\bm{x}" class="ltx_Math" display="inline" id="S1.p4.m6"><semantics><mi>ğ’™</mi><annotation encoding="application/x-tex">\bm{x}</annotation><annotation encoding="application/x-llamapun">bold_italic_x</annotation></semantics></math> does not have a density, the way to make sense of <math alttext="h(\bm{x})" class="ltx_Math" display="inline" id="S1.p4.m7"><semantics><mrow><mi>h</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğ’™</mi><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">h(\bm{x})</annotation><annotation encoding="application/x-llamapun">italic_h ( bold_italic_x )</annotation></semantics></math> is through the equality</p>
<table class="ltx_equation ltx_eqn_table" id="S1.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="h(\bm{x})=\lim_{\varepsilon\searrow 0}h(\bm{x}_{\varepsilon});" class="ltx_Math" display="block" id="S1.E3.m1"><semantics><mrow><mrow><mrow><mi>h</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğ’™</mi><mo stretchy="false">)</mo></mrow></mrow><mo rspace="0.1389em">=</mo><mrow><munder><mo lspace="0.1389em" movablelimits="false" rspace="0.167em">lim</mo><mrow><mi>Îµ</mi><mo>â†˜</mo><mn>0</mn></mrow></munder><mrow><mi>h</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ’™</mi><mi>Îµ</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow><mo>;</mo></mrow><annotation encoding="application/x-tex">h(\bm{x})=\lim_{\varepsilon\searrow 0}h(\bm{x}_{\varepsilon});</annotation><annotation encoding="application/x-llamapun">italic_h ( bold_italic_x ) = roman_lim start_POSTSUBSCRIPT italic_Îµ â†˜ 0 end_POSTSUBSCRIPT italic_h ( bold_italic_x start_POSTSUBSCRIPT italic_Îµ end_POSTSUBSCRIPT ) ;</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.1.3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">we will show that the latter limit evaluates to <math alttext="-\infty" class="ltx_Math" display="inline" id="S1.p4.m8"><semantics><mrow><mo>âˆ’</mo><mi mathvariant="normal">âˆ</mi></mrow><annotation encoding="application/x-tex">-\infty</annotation><annotation encoding="application/x-llamapun">- âˆ</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p">Indeed, using the convention that <math alttext="0\log 0=0" class="ltx_Math" display="inline" id="S1.p5.m1"><semantics><mrow><mrow><mn>0</mn><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mi>log</mi><mo lspace="0.167em">â¡</mo><mn>0</mn></mrow></mrow><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">0\log 0=0</annotation><annotation encoding="application/x-llamapun">0 roman_log 0 = 0</annotation></semantics></math>, it holds</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S3.EGx126">
<tbody id="S1.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle h(\bm{x}_{\varepsilon})" class="ltx_Math" display="inline" id="S1.E4.m1"><semantics><mrow><mi>h</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ’™</mi><mi>Îµ</mi></msub><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">\displaystyle h(\bm{x}_{\varepsilon})</annotation><annotation encoding="application/x-llamapun">italic_h ( bold_italic_x start_POSTSUBSCRIPT italic_Îµ end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=-\int_{\mathbb{R}^{D}}p_{\varepsilon}(x)\log p_{\varepsilon}(x)~{}\mathrm{d}x" class="ltx_Math" display="inline" id="S1.E4.m2"><semantics><mrow><mi></mi><mo>=</mo><mrow><mo>âˆ’</mo><mrow><mstyle displaystyle="true"><msub><mo>âˆ«</mo><msup><mi>â„</mi><mi>D</mi></msup></msub></mstyle><mrow><msub><mi>p</mi><mi>Îµ</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mi>log</mi><mo lspace="0.167em">â¡</mo><msub><mi>p</mi><mi>Îµ</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><mo lspace="0.330em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><mi>x</mi></mrow></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=-\int_{\mathbb{R}^{D}}p_{\varepsilon}(x)\log p_{\varepsilon}(x)~{}\mathrm{d}x</annotation><annotation encoding="application/x-llamapun">= - âˆ« start_POSTSUBSCRIPT blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT end_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT italic_Îµ end_POSTSUBSCRIPT ( italic_x ) roman_log italic_p start_POSTSUBSCRIPT italic_Îµ end_POSTSUBSCRIPT ( italic_x ) roman_d italic_x</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.1.4)</span></td>
</tr></tbody>
<tbody id="S1.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=-\int_{\mathcal{S}_{\varepsilon}}\frac{1}{\operatorname{vol}(\mathcal{S}_{\varepsilon})}\log\left(\frac{1}{\operatorname{vol}(\mathcal{S}_{\varepsilon})}\right)~{}\mathrm{d}\bm{\xi}" class="ltx_Math" display="inline" id="S1.E5.m1"><semantics><mrow><mi></mi><mo>=</mo><mrow><mo>âˆ’</mo><mrow><mstyle displaystyle="true"><msub><mo>âˆ«</mo><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mi>Îµ</mi></msub></msub></mstyle><mrow><mstyle displaystyle="true"><mfrac><mn>1</mn><mrow><mi>vol</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mi>Îµ</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mfrac></mstyle><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mi>log</mi><mo>â¡</mo><mrow><mo>(</mo><mstyle displaystyle="true"><mfrac><mn>1</mn><mrow><mi>vol</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mi>Îµ</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mfrac></mstyle><mo>)</mo></mrow></mrow><mo lspace="0.330em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><mi>ğƒ</mi></mrow></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=-\int_{\mathcal{S}_{\varepsilon}}\frac{1}{\operatorname{vol}(\mathcal{S}_{\varepsilon})}\log\left(\frac{1}{\operatorname{vol}(\mathcal{S}_{\varepsilon})}\right)~{}\mathrm{d}\bm{\xi}</annotation><annotation encoding="application/x-llamapun">= - âˆ« start_POSTSUBSCRIPT caligraphic_S start_POSTSUBSCRIPT italic_Îµ end_POSTSUBSCRIPT end_POSTSUBSCRIPT divide start_ARG 1 end_ARG start_ARG roman_vol ( caligraphic_S start_POSTSUBSCRIPT italic_Îµ end_POSTSUBSCRIPT ) end_ARG roman_log ( divide start_ARG 1 end_ARG start_ARG roman_vol ( caligraphic_S start_POSTSUBSCRIPT italic_Îµ end_POSTSUBSCRIPT ) end_ARG ) roman_d bold_italic_Î¾</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.1.5)</span></td>
</tr></tbody>
<tbody id="S1.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{\log(\operatorname{vol}(\mathcal{S}_{\varepsilon}))}{\operatorname{vol}(\mathcal{S}_{\varepsilon})}\int_{\mathcal{S}_{\varepsilon}}~{}\mathrm{d}\bm{\xi}" class="ltx_Math" display="inline" id="S1.E6.m1"><semantics><mrow><mi></mi><mo>=</mo><mrow><mstyle displaystyle="true"><mfrac><mrow><mi>log</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><mrow><mi>vol</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mi>Îµ</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mrow><mi>vol</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mi>Îµ</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mstyle displaystyle="true"><msub><mo>âˆ«</mo><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mi>Îµ</mi></msub></msub></mstyle><mrow><mo lspace="0.330em" rspace="0em">d</mo><mi>ğƒ</mi></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=\frac{\log(\operatorname{vol}(\mathcal{S}_{\varepsilon}))}{\operatorname{vol}(\mathcal{S}_{\varepsilon})}\int_{\mathcal{S}_{\varepsilon}}~{}\mathrm{d}\bm{\xi}</annotation><annotation encoding="application/x-llamapun">= divide start_ARG roman_log ( roman_vol ( caligraphic_S start_POSTSUBSCRIPT italic_Îµ end_POSTSUBSCRIPT ) ) end_ARG start_ARG roman_vol ( caligraphic_S start_POSTSUBSCRIPT italic_Îµ end_POSTSUBSCRIPT ) end_ARG âˆ« start_POSTSUBSCRIPT caligraphic_S start_POSTSUBSCRIPT italic_Îµ end_POSTSUBSCRIPT end_POSTSUBSCRIPT roman_d bold_italic_Î¾</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.1.6)</span></td>
</tr></tbody>
<tbody id="S1.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\log(\operatorname{vol}(\mathcal{S}_{\varepsilon}))." class="ltx_Math" display="inline" id="S1.E7.m1"><semantics><mrow><mrow><mi></mi><mo>=</mo><mrow><mi>log</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><mrow><mi>vol</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mi>Îµ</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">\displaystyle=\log(\operatorname{vol}(\mathcal{S}_{\varepsilon})).</annotation><annotation encoding="application/x-llamapun">= roman_log ( roman_vol ( caligraphic_S start_POSTSUBSCRIPT italic_Îµ end_POSTSUBSCRIPT ) ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.1.7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">Since <math alttext="\mathcal{S}" class="ltx_Math" display="inline" id="S1.p5.m2"><semantics><mi class="ltx_font_mathcaligraphic">ğ’®</mi><annotation encoding="application/x-tex">\mathcal{S}</annotation><annotation encoding="application/x-llamapun">caligraphic_S</annotation></semantics></math> is compact <math alttext="\operatorname{vol}(\mathcal{S}_{\varepsilon})" class="ltx_Math" display="inline" id="S1.p5.m3"><semantics><mrow><mi>vol</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mi>Îµ</mi></msub><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">\operatorname{vol}(\mathcal{S}_{\varepsilon})</annotation><annotation encoding="application/x-llamapun">roman_vol ( caligraphic_S start_POSTSUBSCRIPT italic_Îµ end_POSTSUBSCRIPT )</annotation></semantics></math> is finite and tends to <math alttext="0" class="ltx_Math" display="inline" id="S1.p5.m4"><mn>0</mn></math> as <math alttext="\varepsilon\searrow 0" class="ltx_Math" display="inline" id="S1.p5.m5"><semantics><mrow><mi>Îµ</mi><mo>â†˜</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\varepsilon\searrow 0</annotation><annotation encoding="application/x-llamapun">italic_Îµ â†˜ 0</annotation></semantics></math>.<span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>In the case where <math alttext="\mathcal{S}" class="ltx_Math" display="inline" id="footnote3.m1"><semantics><mi class="ltx_font_mathcaligraphic">ğ’®</mi><annotation encoding="application/x-tex">\mathcal{S}</annotation><annotation encoding="application/x-llamapun">caligraphic_S</annotation></semantics></math> is not compact and <math alttext="\bm{x}" class="ltx_Math" display="inline" id="footnote3.m2"><semantics><mi>ğ’™</mi><annotation encoding="application/x-tex">\bm{x}</annotation><annotation encoding="application/x-llamapun">bold_italic_x</annotation></semantics></math> is not uniform on <math alttext="\mathcal{S}" class="ltx_Math" display="inline" id="footnote3.m3"><semantics><mi class="ltx_font_mathcaligraphic">ğ’®</mi><annotation encoding="application/x-tex">\mathcal{S}</annotation><annotation encoding="application/x-llamapun">caligraphic_S</annotation></semantics></math>, we define a more refined version of <math alttext="\bm{x}_{\varepsilon}" class="ltx_Math" display="inline" id="footnote3.m4"><semantics><msub><mi>ğ’™</mi><mi>Îµ</mi></msub><annotation encoding="application/x-tex">\bm{x}_{\varepsilon}</annotation><annotation encoding="application/x-llamapun">bold_italic_x start_POSTSUBSCRIPT italic_Îµ end_POSTSUBSCRIPT</annotation></semantics></math> whose density at <math alttext="\bm{\xi}" class="ltx_Math" display="inline" id="footnote3.m5"><semantics><mi>ğƒ</mi><annotation encoding="application/x-tex">\bm{\xi}</annotation><annotation encoding="application/x-llamapun">bold_italic_Î¾</annotation></semantics></math> changes at different rates in the directions orthogonal to and aligned with <math alttext="\mathcal{S}" class="ltx_Math" display="inline" id="footnote3.m6"><semantics><mi class="ltx_font_mathcaligraphic">ğ’®</mi><annotation encoding="application/x-tex">\mathcal{S}</annotation><annotation encoding="application/x-llamapun">caligraphic_S</annotation></semantics></math> at <math alttext="\bm{\xi}" class="ltx_Math" display="inline" id="footnote3.m7"><semantics><mi>ğƒ</mi><annotation encoding="application/x-tex">\bm{\xi}</annotation><annotation encoding="application/x-llamapun">bold_italic_Î¾</annotation></semantics></math>. This density results in a different calculation which does not involve the volume of <math alttext="\mathcal{S}_{\varepsilon}" class="ltx_Math" display="inline" id="footnote3.m8"><semantics><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mi>Îµ</mi></msub><annotation encoding="application/x-tex">\mathcal{S}_{\varepsilon}</annotation><annotation encoding="application/x-llamapun">caligraphic_S start_POSTSUBSCRIPT italic_Îµ end_POSTSUBSCRIPT</annotation></semantics></math> but rather something like the effective volume taken up by <math alttext="\bm{x}_{\varepsilon}" class="ltx_Math" display="inline" id="footnote3.m9"><semantics><msub><mi>ğ’™</mi><mi>Îµ</mi></msub><annotation encoding="application/x-tex">\bm{x}_{\varepsilon}</annotation><annotation encoding="application/x-llamapun">bold_italic_x start_POSTSUBSCRIPT italic_Îµ end_POSTSUBSCRIPT</annotation></semantics></math>, which is finite and vanishing as <math alttext="\varepsilon\searrow 0" class="ltx_Math" display="inline" id="footnote3.m10"><semantics><mrow><mi>Îµ</mi><mo>â†˜</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\varepsilon\searrow 0</annotation><annotation encoding="application/x-llamapun">italic_Îµ â†˜ 0</annotation></semantics></math>.</span></span></span> Thus</p>
<table class="ltx_equation ltx_eqn_table" id="S1.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="h(\bm{x})=\lim_{\varepsilon\searrow 0}h(\bm{x}_{\varepsilon})=\lim_{\varepsilon\searrow 0}\log(\operatorname{vol}(\mathcal{S}_{\varepsilon}))=-\infty," class="ltx_Math" display="block" id="S1.E8.m1"><semantics><mrow><mrow><mrow><mi>h</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğ’™</mi><mo stretchy="false">)</mo></mrow></mrow><mo rspace="0.1389em">=</mo><mrow><munder><mo lspace="0.1389em" movablelimits="false" rspace="0.167em">lim</mo><mrow><mi>Îµ</mi><mo>â†˜</mo><mn>0</mn></mrow></munder><mrow><mi>h</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ’™</mi><mi>Îµ</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow><mo rspace="0.1389em">=</mo><mrow><munder><mo lspace="0.1389em" movablelimits="false" rspace="0.167em">lim</mo><mrow><mi>Îµ</mi><mo>â†˜</mo><mn>0</mn></mrow></munder><mrow><mi>log</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><mrow><mi>vol</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mi>Îµ</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>=</mo><mrow><mo>âˆ’</mo><mi mathvariant="normal">âˆ</mi></mrow></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">h(\bm{x})=\lim_{\varepsilon\searrow 0}h(\bm{x}_{\varepsilon})=\lim_{\varepsilon\searrow 0}\log(\operatorname{vol}(\mathcal{S}_{\varepsilon}))=-\infty,</annotation><annotation encoding="application/x-llamapun">italic_h ( bold_italic_x ) = roman_lim start_POSTSUBSCRIPT italic_Îµ â†˜ 0 end_POSTSUBSCRIPT italic_h ( bold_italic_x start_POSTSUBSCRIPT italic_Îµ end_POSTSUBSCRIPT ) = roman_lim start_POSTSUBSCRIPT italic_Îµ â†˜ 0 end_POSTSUBSCRIPT roman_log ( roman_vol ( caligraphic_S start_POSTSUBSCRIPT italic_Îµ end_POSTSUBSCRIPT ) ) = - âˆ ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.1.8)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">as desired.
âˆ</p>
</div>
</div>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p">The above theorem is actually a corollary of a much more famous and celebrated set of results about the maximum possible entropy of <math alttext="\bm{x}" class="ltx_Math" display="inline" id="S1.p6.m1"><semantics><mi>ğ’™</mi><annotation encoding="application/x-tex">\bm{x}</annotation><annotation encoding="application/x-llamapun">bold_italic_x</annotation></semantics></math> subject to certain constraints on the distribution of <math alttext="\bm{x}" class="ltx_Math" display="inline" id="S1.p6.m2"><semantics><mi>ğ’™</mi><annotation encoding="application/x-tex">\bm{x}</annotation><annotation encoding="application/x-llamapun">bold_italic_x</annotation></semantics></math>. We would be remiss to not provide the results here, but we do not give the proofs; a suitable reference would be <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="bib.html#bibx212" title="">PW22</a>]</cite>.</p>
</div>
<div class="ltx_theorem ltx_theorem_theorem" id="Thmtheorem2">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold">Theorem B.2</span></span><span class="ltx_text ltx_font_bold">.</span>
</h6>
<div class="ltx_para" id="Thmtheorem2.p1">
<p class="ltx_p"><span class="ltx_text ltx_font_italic">Let <math alttext="\bm{x}" class="ltx_Math" display="inline" id="Thmtheorem2.p1.m1"><semantics><mi>ğ±</mi><annotation encoding="application/x-tex">\bm{x}</annotation><annotation encoding="application/x-llamapun">bold_italic_x</annotation></semantics></math> be a random variable on <math alttext="\mathbb{R}^{D}" class="ltx_Math" display="inline" id="Thmtheorem2.p1.m2"><semantics><msup><mi>â„</mi><mi>D</mi></msup><annotation encoding="application/x-tex">\mathbb{R}^{D}</annotation><annotation encoding="application/x-llamapun">blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT</annotation></semantics></math>.</span></p>
<ol class="ltx_enumerate" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p"><span class="ltx_text ltx_font_italic">If </span><math alttext="\bm{x}" class="ltx_Math" display="inline" id="S1.I1.i1.p1.m1"><semantics><mi>ğ’™</mi><annotation encoding="application/x-tex">\bm{x}</annotation><annotation encoding="application/x-llamapun">bold_italic_x</annotation></semantics></math><span class="ltx_text ltx_font_italic"> is supported on a compact set </span><math alttext="\mathcal{S}\subseteq\mathbb{R}^{D}" class="ltx_Math" display="inline" id="S1.I1.i1.p1.m2"><semantics><mrow><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mo>âŠ†</mo><msup><mi>â„</mi><mi>D</mi></msup></mrow><annotation encoding="application/x-tex">\mathcal{S}\subseteq\mathbb{R}^{D}</annotation><annotation encoding="application/x-llamapun">caligraphic_S âŠ† blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT</annotation></semantics></math><span class="ltx_text ltx_font_italic"> (i.e., </span><a class="ltx_ref ltx_font_italic" href="#Thmassumption1" title="Assumption B.1. â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Assumption</span>Â <span class="ltx_text ltx_ref_tag">B.1</span></a><span class="ltx_text ltx_font_italic">) then</span></p>
<table class="ltx_equation ltx_eqn_table" id="S1.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="h(\bm{x})\leq h(\operatorname{\mathcal{U}}(\mathcal{S}))=\log\operatorname{vol}(\mathcal{S})." class="ltx_Math" display="block" id="S1.E9.m1"><semantics><mrow><mrow><mrow><mi>h</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğ’™</mi><mo stretchy="false">)</mo></mrow></mrow><mo>â‰¤</mo><mrow><mi>h</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mi class="ltx_font_mathcaligraphic">ğ’°</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mi>log</mi><mo lspace="0.167em">â¡</mo><mrow><mi>vol</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">h(\bm{x})\leq h(\operatorname{\mathcal{U}}(\mathcal{S}))=\log\operatorname{vol}(\mathcal{S}).</annotation><annotation encoding="application/x-llamapun">italic_h ( bold_italic_x ) â‰¤ italic_h ( caligraphic_U ( caligraphic_S ) ) = roman_log roman_vol ( caligraphic_S ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.1.9)</span></td>
</tr></tbody>
</table>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p"><span class="ltx_text ltx_font_italic">If </span><math alttext="\bm{x}" class="ltx_Math" display="inline" id="S1.I1.i2.p1.m1"><semantics><mi>ğ’™</mi><annotation encoding="application/x-tex">\bm{x}</annotation><annotation encoding="application/x-llamapun">bold_italic_x</annotation></semantics></math><span class="ltx_text ltx_font_italic"> has finite covariance such that, for a PSD matrix </span><math alttext="\bm{\Sigma}\in\mathsf{PSD}(D)" class="ltx_Math" display="inline" id="S1.I1.i2.p1.m2"><semantics><mrow><mi>ğšº</mi><mo>âˆˆ</mo><mrow><mi>ğ–¯ğ–²ğ–£</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>D</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\bm{\Sigma}\in\mathsf{PSD}(D)</annotation><annotation encoding="application/x-llamapun">bold_Î£ âˆˆ sansserif_PSD ( italic_D )</annotation></semantics></math><span class="ltx_text ltx_font_italic">, it holds </span><math alttext="\operatorname{Cov}(\bm{x})\preceq\bm{\Sigma}" class="ltx_Math" display="inline" id="S1.I1.i2.p1.m3"><semantics><mrow><mrow><mi>Cov</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><mi>ğ’™</mi><mo stretchy="false">)</mo></mrow></mrow><mo>âª¯</mo><mi>ğšº</mi></mrow><annotation encoding="application/x-tex">\operatorname{Cov}(\bm{x})\preceq\bm{\Sigma}</annotation><annotation encoding="application/x-llamapun">roman_Cov ( bold_italic_x ) âª¯ bold_Î£</annotation></semantics></math><span class="ltx_text ltx_font_italic"> (w.r.t.Â the PSD ordering, i.e., </span><math alttext="\bm{\Sigma}-\operatorname{Cov}(\bm{x})" class="ltx_Math" display="inline" id="S1.I1.i2.p1.m4"><semantics><mrow><mi>ğšº</mi><mo>âˆ’</mo><mrow><mi>Cov</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><mi>ğ’™</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\bm{\Sigma}-\operatorname{Cov}(\bm{x})</annotation><annotation encoding="application/x-llamapun">bold_Î£ - roman_Cov ( bold_italic_x )</annotation></semantics></math><span class="ltx_text ltx_font_italic"> is PSD), then</span></p>
<table class="ltx_equation ltx_eqn_table" id="S1.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="h(\bm{x})\leq h(\operatorname{\mathcal{N}}(\bm{0},\bm{\Sigma}))=\frac{1}{2}\log((2\pi e)^{D}\det\bm{\Sigma})." class="ltx_Math" display="block" id="S1.E10.m1"><semantics><mrow><mrow><mrow><mi>h</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğ’™</mi><mo stretchy="false">)</mo></mrow></mrow><mo>â‰¤</mo><mrow><mi>h</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mi class="ltx_font_mathcaligraphic">ğ’©</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><mn>ğŸ</mn><mo>,</mo><mi>ğšº</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mfrac><mn>1</mn><mn>2</mn></mfrac><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mi>log</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><mrow><msup><mrow><mo stretchy="false">(</mo><mrow><mn>2</mn><mo lspace="0em" rspace="0em">â€‹</mo><mi>Ï€</mi><mo lspace="0em" rspace="0em">â€‹</mo><mi>e</mi></mrow><mo stretchy="false">)</mo></mrow><mi>D</mi></msup><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mo movablelimits="false" rspace="0.167em">det</mo><mi>ğšº</mi></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">h(\bm{x})\leq h(\operatorname{\mathcal{N}}(\bm{0},\bm{\Sigma}))=\frac{1}{2}\log((2\pi e)^{D}\det\bm{\Sigma}).</annotation><annotation encoding="application/x-llamapun">italic_h ( bold_italic_x ) â‰¤ italic_h ( caligraphic_N ( bold_0 , bold_Î£ ) ) = divide start_ARG 1 end_ARG start_ARG 2 end_ARG roman_log ( ( 2 italic_Ï€ italic_e ) start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT roman_det bold_Î£ ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.1.10)</span></td>
</tr></tbody>
</table>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p"><span class="ltx_text ltx_font_italic">If </span><math alttext="\bm{x}" class="ltx_Math" display="inline" id="S1.I1.i3.p1.m1"><semantics><mi>ğ’™</mi><annotation encoding="application/x-tex">\bm{x}</annotation><annotation encoding="application/x-llamapun">bold_italic_x</annotation></semantics></math><span class="ltx_text ltx_font_italic"> has finite second moment such that, for a constant </span><math alttext="a\geq 0" class="ltx_Math" display="inline" id="S1.I1.i3.p1.m2"><semantics><mrow><mi>a</mi><mo>â‰¥</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">a\geq 0</annotation><annotation encoding="application/x-llamapun">italic_a â‰¥ 0</annotation></semantics></math><span class="ltx_text ltx_font_italic">, it holds </span><math alttext="\operatorname{\mathbb{E}}\|\bm{x}\|_{2}^{2}\leq a" class="ltx_Math" display="inline" id="S1.I1.i3.p1.m3"><semantics><mrow><mrow><mi>ğ”¼</mi><mo>â¡</mo><msubsup><mrow><mo stretchy="false">â€–</mo><mi>ğ’™</mi><mo stretchy="false">â€–</mo></mrow><mn>2</mn><mn>2</mn></msubsup></mrow><mo>â‰¤</mo><mi>a</mi></mrow><annotation encoding="application/x-tex">\operatorname{\mathbb{E}}\|\bm{x}\|_{2}^{2}\leq a</annotation><annotation encoding="application/x-llamapun">blackboard_E âˆ¥ bold_italic_x âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT â‰¤ italic_a</annotation></semantics></math><span class="ltx_text ltx_font_italic">, then</span></p>
<table class="ltx_equation ltx_eqn_table" id="S1.E11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="h(\bm{x})\leq h\left(\operatorname{\mathcal{N}}\left(\bm{0},\frac{a}{D}\bm{I}\right)\right)=\frac{D}{2}\log\frac{2\pi ea}{D}." class="ltx_Math" display="block" id="S1.E11.m1"><semantics><mrow><mrow><mrow><mi>h</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğ’™</mi><mo stretchy="false">)</mo></mrow></mrow><mo>â‰¤</mo><mrow><mi>h</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo>(</mo><mrow><mi class="ltx_font_mathcaligraphic">ğ’©</mi><mo>â¡</mo><mrow><mo>(</mo><mn>ğŸ</mn><mo>,</mo><mrow><mfrac><mi>a</mi><mi>D</mi></mfrac><mo lspace="0em" rspace="0em">â€‹</mo><mi>ğ‘°</mi></mrow><mo>)</mo></mrow></mrow><mo>)</mo></mrow></mrow><mo>=</mo><mrow><mfrac><mi>D</mi><mn>2</mn></mfrac><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mi>log</mi><mo lspace="0.167em">â¡</mo><mfrac><mrow><mn>2</mn><mo lspace="0em" rspace="0em">â€‹</mo><mi>Ï€</mi><mo lspace="0em" rspace="0em">â€‹</mo><mi>e</mi><mo lspace="0em" rspace="0em">â€‹</mo><mi>a</mi></mrow><mi>D</mi></mfrac></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">h(\bm{x})\leq h\left(\operatorname{\mathcal{N}}\left(\bm{0},\frac{a}{D}\bm{I}\right)\right)=\frac{D}{2}\log\frac{2\pi ea}{D}.</annotation><annotation encoding="application/x-llamapun">italic_h ( bold_italic_x ) â‰¤ italic_h ( caligraphic_N ( bold_0 , divide start_ARG italic_a end_ARG start_ARG italic_D end_ARG bold_italic_I ) ) = divide start_ARG italic_D end_ARG start_ARG 2 end_ARG roman_log divide start_ARG 2 italic_Ï€ italic_e italic_a end_ARG start_ARG italic_D end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.1.11)</span></td>
</tr></tbody>
</table>
</div>
</li>
</ol>
</div>
</div>
<div class="ltx_para" id="S1.p7">
<p class="ltx_p">Clearly <a class="ltx_ref" href="#Thmtheorem1" title="Theorem B.1. â€£ B.1 Differential Entropy of Low-Dimensional Distributions â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Theorem</span>Â <span class="ltx_text ltx_ref_tag">B.1</span></a> is a special case of <a class="ltx_ref" href="#Thmtheorem2" title="Theorem B.2. â€£ B.1 Differential Entropy of Low-Dimensional Distributions â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Theorem</span>Â <span class="ltx_text ltx_ref_tag">B.2</span></a>.1 with <math alttext="\operatorname{vol}(\mathcal{S})=0" class="ltx_Math" display="inline" id="S1.p7.m1"><semantics><mrow><mrow><mi>vol</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\operatorname{vol}(\mathcal{S})=0</annotation><annotation encoding="application/x-llamapun">roman_vol ( caligraphic_S ) = 0</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">B.2 </span>Diffusion and Denoising Processes</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p">In the main body (<a class="ltx_ref" href="Ch3.html" title="Chapter 3 Pursuing Low-Dimensional Distributions via Lossy Compression â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Chapter</span>Â <span class="ltx_text ltx_ref_tag">3</span></a>), we considered a random variable <math alttext="\bm{x}" class="ltx_Math" display="inline" id="S2.p1.m1"><semantics><mi>ğ’™</mi><annotation encoding="application/x-tex">\bm{x}</annotation><annotation encoding="application/x-llamapun">bold_italic_x</annotation></semantics></math>, and a stochastic process defined by (<a class="ltx_ref" href="Ch3.html#S2.E1" title="Equation 3.2.1 â€£ 3.2.1 Diffusion and Denoising Processes â€£ 3.2 Compression via Denoising â€£ Chapter 3 Pursuing Low-Dimensional Distributions via Lossy Compression â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">3.2.1</span></a>), i.e.,</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\bm{x}_{t}=\bm{x}+t\bm{g},\qquad\forall t\in[0,T]" class="ltx_Math" display="block" id="S2.E1.m1"><semantics><mrow><mrow><msub><mi>ğ’™</mi><mi>t</mi></msub><mo>=</mo><mrow><mi>ğ’™</mi><mo>+</mo><mrow><mi>t</mi><mo lspace="0em" rspace="0em">â€‹</mo><mi>ğ’ˆ</mi></mrow></mrow></mrow><mo rspace="2.167em">,</mo><mrow><mrow><mo rspace="0.167em">âˆ€</mo><mi>t</mi></mrow><mo>âˆˆ</mo><mrow><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mi>T</mi><mo stretchy="false">]</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\bm{x}_{t}=\bm{x}+t\bm{g},\qquad\forall t\in[0,T]</annotation><annotation encoding="application/x-llamapun">bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = bold_italic_x + italic_t bold_italic_g , âˆ€ italic_t âˆˆ [ 0 , italic_T ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">where <math alttext="\bm{g}\sim\operatorname{\mathcal{N}}(\bm{0},\bm{I})" class="ltx_Math" display="inline" id="S2.p1.m2"><semantics><mrow><mi>ğ’ˆ</mi><mo>âˆ¼</mo><mrow><mi class="ltx_font_mathcaligraphic">ğ’©</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><mn>ğŸ</mn><mo>,</mo><mi>ğ‘°</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\bm{g}\sim\operatorname{\mathcal{N}}(\bm{0},\bm{I})</annotation><annotation encoding="application/x-llamapun">bold_italic_g âˆ¼ caligraphic_N ( bold_0 , bold_italic_I )</annotation></semantics></math> independently of <math alttext="\bm{x}" class="ltx_Math" display="inline" id="S2.p1.m3"><semantics><mi>ğ’™</mi><annotation encoding="application/x-tex">\bm{x}</annotation><annotation encoding="application/x-llamapun">bold_italic_x</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S2.p2">
<p class="ltx_p">The structure of this section is as follows. In <a class="ltx_ref" href="#S2.SS1" title="B.2.1 Diffusion Process Increases Entropy Over Time â€£ B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Section</span>Â <span class="ltx_text ltx_ref_tag">B.2.1</span></a> we provide a formal theorem and crisp proof which shows that under <a class="ltx_ref" href="#S2.E1" title="In B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Equation</span>Â <span class="ltx_text ltx_ref_tag">B.2.1</span></a> the entropy increases, i.e., <math alttext="\frac{\mathrm{d}}{\mathrm{d}t}h(\bm{x}_{t})&gt;0" class="ltx_Math" display="inline" id="S2.p2.m1"><semantics><mrow><mrow><mfrac><mi mathvariant="normal">d</mi><mrow><mi mathvariant="normal">d</mi><mo lspace="0em" rspace="0em">â€‹</mo><mi>t</mi></mrow></mfrac><mo lspace="0em" rspace="0em">â€‹</mo><mi>h</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ’™</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\frac{\mathrm{d}}{\mathrm{d}t}h(\bm{x}_{t})&gt;0</annotation><annotation encoding="application/x-llamapun">divide start_ARG roman_d end_ARG start_ARG roman_d italic_t end_ARG italic_h ( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) &gt; 0</annotation></semantics></math>. In <a class="ltx_ref" href="#S2.SS2" title="B.2.2 Denoising Process Reduces Entropy Over Time â€£ B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Section</span>Â <span class="ltx_text ltx_ref_tag">B.2.2</span></a> we provide a formal theorem and crisp proof which shows that under <a class="ltx_ref" href="#S2.E1" title="In B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Equation</span>Â <span class="ltx_text ltx_ref_tag">B.2.1</span></a>, the entropy decreases during denoising, i.e., <math alttext="h(\operatorname{\mathbb{E}}[\bm{x}_{s}\mid\bm{x}_{t}])&lt;h(\bm{x}_{t})" class="ltx_Math" display="inline" id="S2.p2.m2"><semantics><mrow><mrow><mi>h</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mi>ğ”¼</mi><mo>â¡</mo><mrow><mo stretchy="false">[</mo><mrow><msub><mi>ğ’™</mi><mi>s</mi></msub><mo>âˆ£</mo><msub><mi>ğ’™</mi><mi>t</mi></msub></mrow><mo stretchy="false">]</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>&lt;</mo><mrow><mi>h</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ’™</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">h(\operatorname{\mathbb{E}}[\bm{x}_{s}\mid\bm{x}_{t}])&lt;h(\bm{x}_{t})</annotation><annotation encoding="application/x-llamapun">italic_h ( blackboard_E [ bold_italic_x start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT âˆ£ bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ] ) &lt; italic_h ( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> for all <math alttext="s&lt;t" class="ltx_Math" display="inline" id="S2.p2.m3"><semantics><mrow><mi>s</mi><mo>&lt;</mo><mi>t</mi></mrow><annotation encoding="application/x-tex">s&lt;t</annotation><annotation encoding="application/x-llamapun">italic_s &lt; italic_t</annotation></semantics></math>. In <a class="ltx_ref" href="#S2.SS3" title="B.2.3 Technical Lemmas and Intermediate Results â€£ B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Section</span>Â <span class="ltx_text ltx_ref_tag">B.2.3</span></a> we provide proofs for technical lemmas that are needed to establish the claims in the previous subsections.</p>
</div>
<div class="ltx_para" id="S2.p3">
<p class="ltx_p">Before we start, we introduce some key notations. First, let <math alttext="\varphi_{t}" class="ltx_Math" display="inline" id="S2.p3.m1"><semantics><msub><mi>Ï†</mi><mi>t</mi></msub><annotation encoding="application/x-tex">\varphi_{t}</annotation><annotation encoding="application/x-llamapun">italic_Ï† start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> be the density of <math alttext="\operatorname{\mathcal{N}}(\bm{0},t^{2}\bm{I})" class="ltx_Math" display="inline" id="S2.p3.m2"><semantics><mrow><mi class="ltx_font_mathcaligraphic">ğ’©</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><mn>ğŸ</mn><mo>,</mo><mrow><msup><mi>t</mi><mn>2</mn></msup><mo lspace="0em" rspace="0em">â€‹</mo><mi>ğ‘°</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">\operatorname{\mathcal{N}}(\bm{0},t^{2}\bm{I})</annotation><annotation encoding="application/x-llamapun">caligraphic_N ( bold_0 , italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT bold_italic_I )</annotation></semantics></math>, i.e.,</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\varphi_{t}(\bm{\xi})\doteq\frac{1}{(2\pi)^{D/2}t^{D}}\exp\left(-\frac{\|\bm{\xi}\|_{2}^{2}}{t^{2}}\right)." class="ltx_Math" display="block" id="S2.E2.m1"><semantics><mrow><mrow><mrow><msub><mi>Ï†</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>â‰</mo><mrow><mfrac><mn>1</mn><mrow><msup><mrow><mo stretchy="false">(</mo><mrow><mn>2</mn><mo lspace="0em" rspace="0em">â€‹</mo><mi>Ï€</mi></mrow><mo stretchy="false">)</mo></mrow><mrow><mi>D</mi><mo>/</mo><mn>2</mn></mrow></msup><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>t</mi><mi>D</mi></msup></mrow></mfrac><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mi>exp</mi><mo>â¡</mo><mrow><mo>(</mo><mrow><mo>âˆ’</mo><mfrac><msubsup><mrow><mo stretchy="false">â€–</mo><mi>ğƒ</mi><mo stretchy="false">â€–</mo></mrow><mn>2</mn><mn>2</mn></msubsup><msup><mi>t</mi><mn>2</mn></msup></mfrac></mrow><mo>)</mo></mrow></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">\varphi_{t}(\bm{\xi})\doteq\frac{1}{(2\pi)^{D/2}t^{D}}\exp\left(-\frac{\|\bm{\xi}\|_{2}^{2}}{t^{2}}\right).</annotation><annotation encoding="application/x-llamapun">italic_Ï† start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) â‰ divide start_ARG 1 end_ARG start_ARG ( 2 italic_Ï€ ) start_POSTSUPERSCRIPT italic_D / 2 end_POSTSUPERSCRIPT italic_t start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT end_ARG roman_exp ( - divide start_ARG âˆ¥ bold_italic_Î¾ âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">Next, <math alttext="\bm{x}_{t}" class="ltx_Math" display="inline" id="S2.p3.m3"><semantics><msub><mi>ğ’™</mi><mi>t</mi></msub><annotation encoding="application/x-tex">\bm{x}_{t}</annotation><annotation encoding="application/x-llamapun">bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is supported on all of <math alttext="\mathbb{R}^{D}" class="ltx_Math" display="inline" id="S2.p3.m4"><semantics><msup><mi>â„</mi><mi>D</mi></msup><annotation encoding="application/x-tex">\mathbb{R}^{D}</annotation><annotation encoding="application/x-llamapun">blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT</annotation></semantics></math>, so it has a <span class="ltx_text ltx_font_italic">density</span>, which we denote <math alttext="p_{t}" class="ltx_Math" display="inline" id="S2.p3.m5"><semantics><msub><mi>p</mi><mi>t</mi></msub><annotation encoding="application/x-tex">p_{t}</annotation><annotation encoding="application/x-llamapun">italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> (as in the main body). A quick calculation shows that</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="p_{t}(\bm{\xi})=\operatorname{\mathbb{E}}[\varphi_{t}(\bm{\xi}-\bm{x})]," class="ltx_Math" display="block" id="S2.E3.m1"><semantics><mrow><mrow><mrow><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mi>ğ”¼</mi><mo>â¡</mo><mrow><mo stretchy="false">[</mo><mrow><msub><mi>Ï†</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’™</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">]</mo></mrow></mrow></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">p_{t}(\bm{\xi})=\operatorname{\mathbb{E}}[\varphi_{t}(\bm{\xi}-\bm{x})],</annotation><annotation encoding="application/x-llamapun">italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) = blackboard_E [ italic_Ï† start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ - bold_italic_x ) ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">and from this representation it is possible to deduce (i.e., from <a class="ltx_ref" href="#Thmproposition4" title="Proposition B.4 ([BB11], Proposition 4.20). â€£ Differentiating Under the Integral Sign â€£ B.2.3 Technical Lemmas and Intermediate Results â€£ B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Proposition</span>Â <span class="ltx_text ltx_ref_tag">B.4</span></a>) that <math alttext="p_{t}" class="ltx_Math" display="inline" id="S2.p3.m6"><semantics><msub><mi>p</mi><mi>t</mi></msub><annotation encoding="application/x-tex">p_{t}</annotation><annotation encoding="application/x-llamapun">italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is smooth (i.e., infinitely differentiable) in <math alttext="\bm{\xi}" class="ltx_Math" display="inline" id="S2.p3.m7"><semantics><mi>ğƒ</mi><annotation encoding="application/x-tex">\bm{\xi}</annotation><annotation encoding="application/x-llamapun">bold_italic_Î¾</annotation></semantics></math>, also smooth in <math alttext="t" class="ltx_Math" display="inline" id="S2.p3.m8"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation><annotation encoding="application/x-llamapun">italic_t</annotation></semantics></math>, and positive everywhere. This fact is somewhat remarkable at first sight: even for a completely irregular random variable <math alttext="\bm{x}" class="ltx_Math" display="inline" id="S2.p3.m9"><semantics><mi>ğ’™</mi><annotation encoding="application/x-tex">\bm{x}</annotation><annotation encoding="application/x-llamapun">bold_italic_x</annotation></semantics></math> (say, a Bernoulli random variable, which does not have a density), its Gaussian smoothing admits a density for every (arbitrarily small) <math alttext="t&gt;0" class="ltx_Math" display="inline" id="S2.p3.m10"><semantics><mrow><mi>t</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">t&gt;0</annotation><annotation encoding="application/x-llamapun">italic_t &gt; 0</annotation></semantics></math>. The proof is left as an exercise for readers well-versed in mathematical analysis.</p>
</div>
<div class="ltx_para" id="S2.p4">
<p class="ltx_p">However, we also need to add an assumption about the <span class="ltx_text ltx_font_italic">smoothness</span> of the distribution of <math alttext="\bm{x}" class="ltx_Math" display="inline" id="S2.p4.m1"><semantics><mi>ğ’™</mi><annotation encoding="application/x-tex">\bm{x}</annotation><annotation encoding="application/x-llamapun">bold_italic_x</annotation></semantics></math>, which will eliminate some technical problems that occur around <math alttext="t=0" class="ltx_Math" display="inline" id="S2.p4.m2"><semantics><mrow><mi>t</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">t=0</annotation><annotation encoding="application/x-llamapun">italic_t = 0</annotation></semantics></math> with low-dimensional distributions.<span class="ltx_note ltx_role_footnote" id="footnote4"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span>As then various quantities become highly irregular and dealing with them would require significant additional analysis.</span></span></span> Despite this, we expect that our results hold under milder assumptions with additional work. For now, let us assume:</p>
</div>
<div class="ltx_theorem ltx_theorem_assumption" id="Thmassumption2">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold">Assumption B.2</span></span><span class="ltx_text ltx_font_bold">.</span>
</h6>
<div class="ltx_para" id="Thmassumption2.p1">
<p class="ltx_p"><math alttext="\bm{x}" class="ltx_Math" display="inline" id="Thmassumption2.p1.m1"><semantics><mi>ğ’™</mi><annotation encoding="application/x-tex">\bm{x}</annotation><annotation encoding="application/x-llamapun">bold_italic_x</annotation></semantics></math> has a twice continuously differentiable density, denoted <math alttext="p" class="ltx_Math" display="inline" id="Thmassumption2.p1.m2"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation><annotation encoding="application/x-llamapun">italic_p</annotation></semantics></math>.</p>
</div>
</div>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.2.1 </span>Diffusion Process Increases Entropy Over Time</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p">In this section appendix we provide a proof of <a class="ltx_ref" href="#Thmtheorem3" title="Theorem B.3 (Diffusion Increases Entropy). â€£ B.2.1 Diffusion Process Increases Entropy Over Time â€£ B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Theorem</span>Â <span class="ltx_text ltx_ref_tag">B.3</span></a>. For convenience, we restate it as follows.</p>
</div>
<div class="ltx_theorem ltx_theorem_theorem" id="Thmtheorem3">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold">Theorem B.3</span></span><span class="ltx_text ltx_font_bold"> </span>(Diffusion Increases Entropy)<span class="ltx_text ltx_font_bold">.</span>
</h6>
<div class="ltx_para" id="Thmtheorem3.p1">
<p class="ltx_p"><span class="ltx_text ltx_font_italic">Let <math alttext="\bm{x}" class="ltx_Math" display="inline" id="Thmtheorem3.p1.m1"><semantics><mi>ğ±</mi><annotation encoding="application/x-tex">\bm{x}</annotation><annotation encoding="application/x-llamapun">bold_italic_x</annotation></semantics></math> be any random variable such that <a class="ltx_ref" href="#Thmassumption1" title="Assumption B.1. â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Assumptions</span>Â <span class="ltx_text ltx_ref_tag">B.1</span></a> andÂ <a class="ltx_ref" href="#Thmassumption2" title="Assumption B.2. â€£ B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">B.2</span></a> hold, and let <math alttext="(\bm{x}_{t})_{t\in[0,T]}" class="ltx_Math" display="inline" id="Thmtheorem3.p1.m2"><semantics><msub><mrow><mo stretchy="false">(</mo><msub><mi>ğ±</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><mrow><mi>t</mi><mo>âˆˆ</mo><mrow><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mi>T</mi><mo stretchy="false">]</mo></mrow></mrow></msub><annotation encoding="application/x-tex">(\bm{x}_{t})_{t\in[0,T]}</annotation><annotation encoding="application/x-llamapun">( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_t âˆˆ [ 0 , italic_T ] end_POSTSUBSCRIPT</annotation></semantics></math> be the stochastic process (<a class="ltx_ref" href="#S2.E1" title="Equation B.2.1 â€£ B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">B.2.1</span></a>). Then</span></p>
<table class="ltx_equation ltx_eqn_table" id="S2.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="h(\bm{x}_{s})&lt;h(\bm{x}_{t}),\qquad\forall s,t\colon 0\leq s&lt;t\leq T." class="ltx_Math" display="block" id="S2.E4.m1"><semantics><mrow><mrow><mrow><mrow><mi>h</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ’™</mi><mi>s</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>&lt;</mo><mrow><mrow><mi>h</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ’™</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo rspace="2.167em">,</mo><mrow><mo rspace="0.167em">âˆ€</mo><mi>s</mi></mrow><mo>,</mo><mi>t</mi></mrow></mrow><mo lspace="0.278em" rspace="0.278em">:</mo><mrow><mn>0</mn><mo>â‰¤</mo><mi>s</mi><mo>&lt;</mo><mi>t</mi><mo>â‰¤</mo><mi>T</mi></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">h(\bm{x}_{s})&lt;h(\bm{x}_{t}),\qquad\forall s,t\colon 0\leq s&lt;t\leq T.</annotation><annotation encoding="application/x-llamapun">italic_h ( bold_italic_x start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ) &lt; italic_h ( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) , âˆ€ italic_s , italic_t : 0 â‰¤ italic_s &lt; italic_t â‰¤ italic_T .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.4)</span></td>
</tr></tbody>
</table>
</div>
</div>
<div class="ltx_proof">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h6>
<div class="ltx_para" id="S2.SS1.p2">
<p class="ltx_p">Before we start, let us address a pedantic question: when does the inequality in (<a class="ltx_ref" href="#S2.E4" title="Equation B.2.4 â€£ Theorem B.3 (Diffusion Increases Entropy). â€£ B.2.1 Diffusion Process Increases Entropy Over Time â€£ B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">B.2.4</span></a>) make sense? We will show in <a class="ltx_ref" href="#Thmlemma1" title="Lemma B.1. â€£ Finitneness of the Differential Entropy â€£ B.2.3 Technical Lemmas and Intermediate Results â€£ B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Lemma</span>Â <span class="ltx_text ltx_ref_tag">B.1</span></a> that under our assumptions, the differential entropy is well-defined, is never <math alttext="+\infty" class="ltx_Math" display="inline" id="S2.SS1.p2.m1"><semantics><mrow><mo>+</mo><mi mathvariant="normal">âˆ</mi></mrow><annotation encoding="application/x-tex">+\infty</annotation><annotation encoding="application/x-llamapun">+ âˆ</annotation></semantics></math>, and for <math alttext="t&gt;0" class="ltx_Math" display="inline" id="S2.SS1.p2.m2"><semantics><mrow><mi>t</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">t&gt;0</annotation><annotation encoding="application/x-llamapun">italic_t &gt; 0</annotation></semantics></math> is finite, so the (strict) inequality in (<a class="ltx_ref" href="#S2.E4" title="Equation B.2.4 â€£ Theorem B.3 (Diffusion Increases Entropy). â€£ B.2.1 Diffusion Process Increases Entropy Over Time â€£ B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">B.2.4</span></a>) makes sense.</p>
</div>
<div class="ltx_para" id="S2.SS1.p3">
<p class="ltx_p">Pedantry aside, the crux of this proof is to show that the density <math alttext="p_{t}" class="ltx_Math" display="inline" id="S2.SS1.p3.m1"><semantics><msub><mi>p</mi><mi>t</mi></msub><annotation encoding="application/x-tex">p_{t}</annotation><annotation encoding="application/x-llamapun">italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> of <math alttext="\bm{x}_{t}" class="ltx_Math" display="inline" id="S2.SS1.p3.m2"><semantics><msub><mi>ğ’™</mi><mi>t</mi></msub><annotation encoding="application/x-tex">\bm{x}_{t}</annotation><annotation encoding="application/x-llamapun">bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> satisfies a particular partial differential equation, which is very similar to the <span class="ltx_text ltx_font_italic">heat equation</span>. The heat equation is a famous PDE which describes the diffusion of heat through space. This intuitively should make sense, and paints a mental picture: as the time <math alttext="t" class="ltx_Math" display="inline" id="S2.SS1.p3.m3"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation><annotation encoding="application/x-llamapun">italic_t</annotation></semantics></math> increases, the probability from the original (perhaps tightly concentrated) <math alttext="\bm{x}" class="ltx_Math" display="inline" id="S2.SS1.p3.m4"><semantics><mi>ğ’™</mi><annotation encoding="application/x-tex">\bm{x}</annotation><annotation encoding="application/x-llamapun">bold_italic_x</annotation></semantics></math> disperses across all of <math alttext="\mathbb{R}^{D}" class="ltx_Math" display="inline" id="S2.SS1.p3.m5"><semantics><msup><mi>â„</mi><mi>D</mi></msup><annotation encoding="application/x-tex">\mathbb{R}^{D}</annotation><annotation encoding="application/x-llamapun">blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT</annotation></semantics></math> like heat radiating from a source in a vacuum.</p>
</div>
<div class="ltx_para" id="S2.SS1.p4">
<p class="ltx_p">Such PDEs for <math alttext="p_{t}" class="ltx_Math" display="inline" id="S2.SS1.p4.m1"><semantics><msub><mi>p</mi><mi>t</mi></msub><annotation encoding="application/x-tex">p_{t}</annotation><annotation encoding="application/x-llamapun">italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, known as <span class="ltx_text ltx_font_italic">Fokker-Planck equations</span> for more general stochastic processes, are very powerful tools, as they allow us to describe the instantaneous temporal derivatives of <math alttext="p_{t}" class="ltx_Math" display="inline" id="S2.SS1.p4.m2"><semantics><msub><mi>p</mi><mi>t</mi></msub><annotation encoding="application/x-tex">p_{t}</annotation><annotation encoding="application/x-llamapun">italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> in terms of the instantaneous spatial derivatives of <math alttext="p_{t}" class="ltx_Math" display="inline" id="S2.SS1.p4.m3"><semantics><msub><mi>p</mi><mi>t</mi></msub><annotation encoding="application/x-tex">p_{t}</annotation><annotation encoding="application/x-llamapun">italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, and vice versa, providing a concise description of the regularity and dynamics of <math alttext="p_{t}" class="ltx_Math" display="inline" id="S2.SS1.p4.m4"><semantics><msub><mi>p</mi><mi>t</mi></msub><annotation encoding="application/x-tex">p_{t}</annotation><annotation encoding="application/x-llamapun">italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>. Once we obtain dynamics for <math alttext="p_{t}" class="ltx_Math" display="inline" id="S2.SS1.p4.m5"><semantics><msub><mi>p</mi><mi>t</mi></msub><annotation encoding="application/x-tex">p_{t}</annotation><annotation encoding="application/x-llamapun">italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, we can then use the system to obtain another one which describes the dynamics of <math alttext="h(\bm{x}_{t})" class="ltx_Math" display="inline" id="S2.SS1.p4.m6"><semantics><mrow><mi>h</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ’™</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">h(\bm{x}_{t})</annotation><annotation encoding="application/x-llamapun">italic_h ( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>, which after all is just a functional of <math alttext="p_{t}" class="ltx_Math" display="inline" id="S2.SS1.p4.m7"><semantics><msub><mi>p</mi><mi>t</mi></msub><annotation encoding="application/x-tex">p_{t}</annotation><annotation encoding="application/x-llamapun">italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S2.SS1.p5">
<p class="ltx_p">The description of the PDE involves a mathematical object called the Laplacian <math alttext="\Delta" class="ltx_Math" display="inline" id="S2.SS1.p5.m1"><semantics><mi mathvariant="normal">Î”</mi><annotation encoding="application/x-tex">\Delta</annotation><annotation encoding="application/x-llamapun">roman_Î”</annotation></semantics></math>. Recall from your multivariable calculus class that the Laplacian operating on a differentiable-in-time and twice-differentiable-in-space function <math alttext="f\colon(0,T)\times\mathbb{R}^{D}\to\mathbb{R}" class="ltx_Math" display="inline" id="S2.SS1.p5.m2"><semantics><mrow><mi>f</mi><mo lspace="0.278em" rspace="0.278em">:</mo><mrow><mrow><mrow><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mi>T</mi><mo rspace="0.055em" stretchy="false">)</mo></mrow><mo rspace="0.222em">Ã—</mo><msup><mi>â„</mi><mi>D</mi></msup></mrow><mo stretchy="false">â†’</mo><mi>â„</mi></mrow></mrow><annotation encoding="application/x-tex">f\colon(0,T)\times\mathbb{R}^{D}\to\mathbb{R}</annotation><annotation encoding="application/x-llamapun">italic_f : ( 0 , italic_T ) Ã— blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT â†’ blackboard_R</annotation></semantics></math> is given by</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\Delta f_{t}(\bm{\xi})=\operatorname{tr}(\nabla^{2}f_{t}(\bm{\xi}))=\sum_{i=1}^{D}\frac{\partial^{2}f_{t}}{\partial\xi_{i}^{2}}(\bm{\xi})." class="ltx_Math" display="block" id="S2.E5.m1"><semantics><mrow><mrow><mrow><mi mathvariant="normal">Î”</mi><mo lspace="0em" rspace="0em">â€‹</mo><msub><mi>f</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mi>tr</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><mrow><mrow><msup><mo rspace="0.167em">âˆ‡</mo><mn>2</mn></msup><msub><mi>f</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mo rspace="0.111em">=</mo><mrow><munderover><mo movablelimits="false">âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>D</mi></munderover><mrow><mfrac><mrow><msup><mo>âˆ‚</mo><mn>2</mn></msup><msub><mi>f</mi><mi>t</mi></msub></mrow><mrow><mo rspace="0em">âˆ‚</mo><msubsup><mi>Î¾</mi><mi>i</mi><mn>2</mn></msubsup></mrow></mfrac><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">\Delta f_{t}(\bm{\xi})=\operatorname{tr}(\nabla^{2}f_{t}(\bm{\xi}))=\sum_{i=1}^{D}\frac{\partial^{2}f_{t}}{\partial\xi_{i}^{2}}(\bm{\xi}).</annotation><annotation encoding="application/x-llamapun">roman_Î” italic_f start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) = roman_tr ( âˆ‡ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_f start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) ) = âˆ‘ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT divide start_ARG âˆ‚ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_f start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG start_ARG âˆ‚ italic_Î¾ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG ( bold_italic_Î¾ ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.5)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S2.SS1.p6">
<p class="ltx_p">Namely, from using the integral representation of <math alttext="p_{t}" class="ltx_Math" display="inline" id="S2.SS1.p6.m1"><semantics><msub><mi>p</mi><mi>t</mi></msub><annotation encoding="application/x-tex">p_{t}</annotation><annotation encoding="application/x-llamapun">italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and differentiating under the integral, we can compute the derivatives of <math alttext="p_{t}" class="ltx_Math" display="inline" id="S2.SS1.p6.m2"><semantics><msub><mi>p</mi><mi>t</mi></msub><annotation encoding="application/x-tex">p_{t}</annotation><annotation encoding="application/x-llamapun">italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> (which we do in <a class="ltx_ref" href="#Thmproposition1" title="Proposition B.1. â€£ Derivative Computations â€£ B.2.3 Technical Lemmas and Intermediate Results â€£ B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Proposition</span>Â <span class="ltx_text ltx_ref_tag">B.1</span></a>) and observe that <math alttext="p_{t}" class="ltx_Math" display="inline" id="S2.SS1.p6.m3"><semantics><msub><mi>p</mi><mi>t</mi></msub><annotation encoding="application/x-tex">p_{t}</annotation><annotation encoding="application/x-llamapun">italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> satisfies the heat-like PDE</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\frac{\partial p_{t}}{\partial t}(\bm{\xi})=t\Delta p_{t}(\bm{\xi})." class="ltx_Math" display="block" id="S2.E6.m1"><semantics><mrow><mrow><mrow><mfrac><mrow><mo rspace="0em">âˆ‚</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mrow><mo rspace="0em">âˆ‚</mo><mi>t</mi></mrow></mfrac><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mi>t</mi><mo lspace="0em" rspace="0em">â€‹</mo><mi mathvariant="normal">Î”</mi><mo lspace="0em" rspace="0em">â€‹</mo><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">\frac{\partial p_{t}}{\partial t}(\bm{\xi})=t\Delta p_{t}(\bm{\xi}).</annotation><annotation encoding="application/x-llamapun">divide start_ARG âˆ‚ italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG start_ARG âˆ‚ italic_t end_ARG ( bold_italic_Î¾ ) = italic_t roman_Î” italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">Then for finding the dynamics of <math alttext="h(\bm{x}_{t})" class="ltx_Math" display="inline" id="S2.SS1.p6.m4"><semantics><mrow><mi>h</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ’™</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">h(\bm{x}_{t})</annotation><annotation encoding="application/x-llamapun">italic_h ( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>, we can use <a class="ltx_ref" href="#Thmproposition3" title="Proposition B.3 ([Jon82], Section 11.12). â€£ Differentiating Under the Integral Sign â€£ B.2.3 Technical Lemmas and Intermediate Results â€£ B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Proposition</span>Â <span class="ltx_text ltx_ref_tag">B.3</span></a> again as well as the heat-like PDE to get</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S3.EGx127">
<tbody id="S2.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\frac{\mathrm{d}}{\mathrm{d}t}h(\bm{x}_{t})" class="ltx_Math" display="inline" id="S2.E7.m1"><semantics><mrow><mstyle displaystyle="true"><mfrac><mi mathvariant="normal">d</mi><mrow><mi mathvariant="normal">d</mi><mo lspace="0em" rspace="0em">â€‹</mo><mi>t</mi></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em">â€‹</mo><mi>h</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ’™</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">\displaystyle\frac{\mathrm{d}}{\mathrm{d}t}h(\bm{x}_{t})</annotation><annotation encoding="application/x-llamapun">divide start_ARG roman_d end_ARG start_ARG roman_d italic_t end_ARG italic_h ( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=-\frac{\mathrm{d}}{\mathrm{d}t}\int_{\mathbb{R}^{D}}p_{t}(\bm{\xi})\log p_{t}(\bm{\xi})~{}\mathrm{d}\bm{\xi}" class="ltx_Math" display="inline" id="S2.E7.m2"><semantics><mrow><mi></mi><mo>=</mo><mrow><mo>âˆ’</mo><mrow><mstyle displaystyle="true"><mfrac><mi mathvariant="normal">d</mi><mrow><mi mathvariant="normal">d</mi><mo lspace="0em" rspace="0em">â€‹</mo><mi>t</mi></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mstyle displaystyle="true"><msub><mo>âˆ«</mo><msup><mi>â„</mi><mi>D</mi></msup></msub></mstyle><mrow><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mi>log</mi><mo lspace="0.167em">â¡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mo lspace="0.330em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><mi>ğƒ</mi></mrow></mrow></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=-\frac{\mathrm{d}}{\mathrm{d}t}\int_{\mathbb{R}^{D}}p_{t}(\bm{\xi})\log p_{t}(\bm{\xi})~{}\mathrm{d}\bm{\xi}</annotation><annotation encoding="application/x-llamapun">= - divide start_ARG roman_d end_ARG start_ARG roman_d italic_t end_ARG âˆ« start_POSTSUBSCRIPT blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT end_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) roman_d bold_italic_Î¾</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.7)</span></td>
</tr></tbody>
<tbody id="S2.E8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=-\int_{\mathbb{R}^{D}}\frac{\partial}{\partial t}\left[p_{t}(\bm{\xi})\log p_{t}(\bm{\xi})\right]~{}\mathrm{d}\bm{\xi}" class="ltx_Math" display="inline" id="S2.E8.m1"><semantics><mrow><mi></mi><mo>=</mo><mrow><mo>âˆ’</mo><mrow><mstyle displaystyle="true"><msub><mo>âˆ«</mo><msup><mi>â„</mi><mi>D</mi></msup></msub></mstyle><mrow><mstyle displaystyle="true"><mfrac><mo>âˆ‚</mo><mrow><mo rspace="0em">âˆ‚</mo><mi>t</mi></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo>[</mo><mrow><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mi>log</mi><mo lspace="0.167em">â¡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>]</mo></mrow><mo lspace="0.330em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><mi>ğƒ</mi></mrow></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=-\int_{\mathbb{R}^{D}}\frac{\partial}{\partial t}\left[p_{t}(\bm{\xi})\log p_{t}(\bm{\xi})\right]~{}\mathrm{d}\bm{\xi}</annotation><annotation encoding="application/x-llamapun">= - âˆ« start_POSTSUBSCRIPT blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT end_POSTSUBSCRIPT divide start_ARG âˆ‚ end_ARG start_ARG âˆ‚ italic_t end_ARG [ italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) ] roman_d bold_italic_Î¾</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.8)</span></td>
</tr></tbody>
<tbody id="S2.E9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=-\int_{\mathbb{R}^{D}}\frac{\partial p_{t}}{\partial t}(\bm{\xi})[1+\log p_{t}(\bm{\xi})]~{}\mathrm{d}\bm{\xi}" class="ltx_Math" display="inline" id="S2.E9.m1"><semantics><mrow><mi></mi><mo>=</mo><mrow><mo>âˆ’</mo><mrow><mstyle displaystyle="true"><msub><mo>âˆ«</mo><msup><mi>â„</mi><mi>D</mi></msup></msub></mstyle><mrow><mstyle displaystyle="true"><mfrac><mrow><mo rspace="0em">âˆ‚</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mrow><mo rspace="0em">âˆ‚</mo><mi>t</mi></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">[</mo><mrow><mn>1</mn><mo>+</mo><mrow><mrow><mi>log</mi><mo lspace="0.167em">â¡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mo stretchy="false">]</mo></mrow><mo lspace="0.330em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><mi>ğƒ</mi></mrow></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=-\int_{\mathbb{R}^{D}}\frac{\partial p_{t}}{\partial t}(\bm{\xi})[1+\log p_{t}(\bm{\xi})]~{}\mathrm{d}\bm{\xi}</annotation><annotation encoding="application/x-llamapun">= - âˆ« start_POSTSUBSCRIPT blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT end_POSTSUBSCRIPT divide start_ARG âˆ‚ italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG start_ARG âˆ‚ italic_t end_ARG ( bold_italic_Î¾ ) [ 1 + roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) ] roman_d bold_italic_Î¾</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.9)</span></td>
</tr></tbody>
<tbody id="S2.E10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=-t\int_{\mathbb{R}^{D}}\Delta p_{t}(\bm{\xi})[1+\log p_{t}(\bm{\xi})]~{}\mathrm{d}\bm{\xi}." class="ltx_Math" display="inline" id="S2.E10.m1"><semantics><mrow><mrow><mi></mi><mo>=</mo><mrow><mo>âˆ’</mo><mrow><mi>t</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mstyle displaystyle="true"><msub><mo>âˆ«</mo><msup><mi>â„</mi><mi>D</mi></msup></msub></mstyle><mrow><mi mathvariant="normal">Î”</mi><mo lspace="0em" rspace="0em">â€‹</mo><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">[</mo><mrow><mn>1</mn><mo>+</mo><mrow><mrow><mi>log</mi><mo lspace="0.167em">â¡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mo stretchy="false">]</mo></mrow><mo lspace="0.330em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><mi>ğƒ</mi></mrow></mrow></mrow></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">\displaystyle=-t\int_{\mathbb{R}^{D}}\Delta p_{t}(\bm{\xi})[1+\log p_{t}(\bm{\xi})]~{}\mathrm{d}\bm{\xi}.</annotation><annotation encoding="application/x-llamapun">= - italic_t âˆ« start_POSTSUBSCRIPT blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT end_POSTSUBSCRIPT roman_Î” italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) [ 1 + roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) ] roman_d bold_italic_Î¾ .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.10)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">By using a slightly involved integration by parts argument (<a class="ltx_ref" href="#Thmlemma2" title="Lemma B.2. â€£ Integration by Parts in De Brujin Identity â€£ B.2.3 Technical Lemmas and Intermediate Results â€£ B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Lemma</span>Â <span class="ltx_text ltx_ref_tag">B.2</span></a>), we obtain</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S3.EGx128">
<tbody id="S2.E11"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\frac{\mathrm{d}}{\mathrm{d}t}h(\bm{x}_{t})" class="ltx_Math" display="inline" id="S2.E11.m1"><semantics><mrow><mstyle displaystyle="true"><mfrac><mi mathvariant="normal">d</mi><mrow><mi mathvariant="normal">d</mi><mo lspace="0em" rspace="0em">â€‹</mo><mi>t</mi></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em">â€‹</mo><mi>h</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ’™</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">\displaystyle\frac{\mathrm{d}}{\mathrm{d}t}h(\bm{x}_{t})</annotation><annotation encoding="application/x-llamapun">divide start_ARG roman_d end_ARG start_ARG roman_d italic_t end_ARG italic_h ( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=t\int_{\mathbb{R}^{D}}\langle\nabla\log p_{t}(\bm{\xi}),\nabla p_{t}(\bm{\xi})\rangle~{}\mathrm{d}\bm{\xi}" class="ltx_Math" display="inline" id="S2.E11.m2"><semantics><mrow><mi></mi><mo>=</mo><mrow><mi>t</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mstyle displaystyle="true"><msub><mo>âˆ«</mo><msup><mi>â„</mi><mi>D</mi></msup></msub></mstyle><mrow><mrow><mo stretchy="false">âŸ¨</mo><mrow><mrow><mrow><mo rspace="0.167em">âˆ‡</mo><mi>log</mi></mrow><mo lspace="0.167em">â¡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>,</mo><mrow><mrow><mo rspace="0.167em">âˆ‡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">âŸ©</mo></mrow><mo lspace="0.330em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><mi>ğƒ</mi></mrow></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=t\int_{\mathbb{R}^{D}}\langle\nabla\log p_{t}(\bm{\xi}),\nabla p_{t}(\bm{\xi})\rangle~{}\mathrm{d}\bm{\xi}</annotation><annotation encoding="application/x-llamapun">= italic_t âˆ« start_POSTSUBSCRIPT blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT end_POSTSUBSCRIPT âŸ¨ âˆ‡ roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) , âˆ‡ italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) âŸ© roman_d bold_italic_Î¾</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.11)</span></td>
</tr></tbody>
<tbody id="S2.E12"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=t\int_{\mathbb{R}^{D}}\frac{\|\nabla p_{t}(\bm{\xi})\|_{2}^{2}}{p_{t}(\bm{\xi})}~{}\mathrm{d}\bm{\xi}" class="ltx_Math" display="inline" id="S2.E12.m1"><semantics><mrow><mi></mi><mo>=</mo><mrow><mi>t</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mstyle displaystyle="true"><msub><mo>âˆ«</mo><msup><mi>â„</mi><mi>D</mi></msup></msub></mstyle><mrow><mstyle displaystyle="true"><mfrac><msubsup><mrow><mo stretchy="false">â€–</mo><mrow><mrow><mo rspace="0.167em">âˆ‡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">â€–</mo></mrow><mn>2</mn><mn>2</mn></msubsup><mrow><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow></mfrac></mstyle><mo lspace="0.330em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><mi>ğƒ</mi></mrow></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=t\int_{\mathbb{R}^{D}}\frac{\|\nabla p_{t}(\bm{\xi})\|_{2}^{2}}{p_{t}(\bm{\xi})}~{}\mathrm{d}\bm{\xi}</annotation><annotation encoding="application/x-llamapun">= italic_t âˆ« start_POSTSUBSCRIPT blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT end_POSTSUBSCRIPT divide start_ARG âˆ¥ âˆ‡ italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) end_ARG roman_d bold_italic_Î¾</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.12)</span></td>
</tr></tbody>
<tbody id="S2.E13"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle&gt;0" class="ltx_Math" display="inline" id="S2.E13.m1"><semantics><mrow><mi></mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\displaystyle&gt;0</annotation><annotation encoding="application/x-llamapun">&gt; 0</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.13)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">where strict inequality holds in the last line because, for it to not hold, <math alttext="\nabla p_{t}(\bm{\xi})" class="ltx_Math" display="inline" id="S2.SS1.p6.m5"><semantics><mrow><mrow><mo rspace="0.167em">âˆ‡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">\nabla p_{t}(\bm{\xi})</annotation><annotation encoding="application/x-llamapun">âˆ‡ italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ )</annotation></semantics></math> would need to vanish almost everywhere (i.e., everywhere except possibly on a set of zero volume), but this would imply that <math alttext="p_{t}" class="ltx_Math" display="inline" id="S2.SS1.p6.m6"><semantics><msub><mi>p</mi><mi>t</mi></msub><annotation encoding="application/x-tex">p_{t}</annotation><annotation encoding="application/x-llamapun">italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> would be constant almost everywhere, a contradiction with a fact that <math alttext="p_{t}" class="ltx_Math" display="inline" id="S2.SS1.p6.m7"><semantics><msub><mi>p</mi><mi>t</mi></msub><annotation encoding="application/x-tex">p_{t}</annotation><annotation encoding="application/x-llamapun">italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is a density.</p>
</div>
<div class="ltx_para" id="S2.SS1.p7">
<p class="ltx_p">To complete the proof we just use the fundamental theorem of calculus</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E14">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="h(\bm{x}_{t})=h(\bm{x}_{s})+\int_{s}^{t}\frac{\mathrm{d}}{\mathrm{d}u}h(\bm{x}_{u})~{}\mathrm{d}u&gt;h(\bm{x}_{s})," class="ltx_Math" display="block" id="S2.E14.m1"><semantics><mrow><mrow><mrow><mi>h</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ’™</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mi>h</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ’™</mi><mi>s</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo rspace="0.055em">+</mo><mrow><msubsup><mo>âˆ«</mo><mi>s</mi><mi>t</mi></msubsup><mrow><mfrac><mi mathvariant="normal">d</mi><mrow><mi mathvariant="normal">d</mi><mo lspace="0em" rspace="0em">â€‹</mo><mi>u</mi></mrow></mfrac><mo lspace="0em" rspace="0em">â€‹</mo><mi>h</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ’™</mi><mi>u</mi></msub><mo stretchy="false">)</mo></mrow><mo lspace="0.330em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><mi>u</mi></mrow></mrow></mrow></mrow><mo>&gt;</mo><mrow><mi>h</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ’™</mi><mi>s</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">h(\bm{x}_{t})=h(\bm{x}_{s})+\int_{s}^{t}\frac{\mathrm{d}}{\mathrm{d}u}h(\bm{x}_{u})~{}\mathrm{d}u&gt;h(\bm{x}_{s}),</annotation><annotation encoding="application/x-llamapun">italic_h ( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) = italic_h ( bold_italic_x start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ) + âˆ« start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT divide start_ARG roman_d end_ARG start_ARG roman_d italic_u end_ARG italic_h ( bold_italic_x start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT ) roman_d italic_u &gt; italic_h ( bold_italic_x start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.14)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">which proves the claim. (Note that this does not make sense when <math alttext="h(\bm{x}_{s})=-\infty" class="ltx_Math" display="inline" id="S2.SS1.p7.m1"><semantics><mrow><mrow><mi>h</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ’™</mi><mi>s</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mo>âˆ’</mo><mi mathvariant="normal">âˆ</mi></mrow></mrow><annotation encoding="application/x-tex">h(\bm{x}_{s})=-\infty</annotation><annotation encoding="application/x-llamapun">italic_h ( bold_italic_x start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ) = - âˆ</annotation></semantics></math>, which can only happen when <math alttext="s=0" class="ltx_Math" display="inline" id="S2.SS1.p7.m2"><semantics><mrow><mi>s</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">s=0</annotation><annotation encoding="application/x-llamapun">italic_s = 0</annotation></semantics></math> and <math alttext="h(\bm{x})=-\infty" class="ltx_Math" display="inline" id="S2.SS1.p7.m3"><semantics><mrow><mrow><mi>h</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğ’™</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mo>âˆ’</mo><mi mathvariant="normal">âˆ</mi></mrow></mrow><annotation encoding="application/x-tex">h(\bm{x})=-\infty</annotation><annotation encoding="application/x-llamapun">italic_h ( bold_italic_x ) = - âˆ</annotation></semantics></math>, but in this case <math alttext="h(\bm{x}_{t})&gt;-\infty" class="ltx_Math" display="inline" id="S2.SS1.p7.m4"><semantics><mrow><mrow><mi>h</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ’™</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>&gt;</mo><mrow><mo>âˆ’</mo><mi mathvariant="normal">âˆ</mi></mrow></mrow><annotation encoding="application/x-tex">h(\bm{x}_{t})&gt;-\infty</annotation><annotation encoding="application/x-llamapun">italic_h ( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) &gt; - âˆ</annotation></semantics></math> so the claim is vacuously true anyways.)
âˆ</p>
</div>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.2.2 </span>Denoising Process Reduces Entropy Over Time</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p">Recall that in <a class="ltx_ref" href="Ch3.html#S2.SS1" title="3.2.1 Diffusion and Denoising Processes â€£ 3.2 Compression via Denoising â€£ Chapter 3 Pursuing Low-Dimensional Distributions via Lossy Compression â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Section</span>Â <span class="ltx_text ltx_ref_tag">3.2.1</span></a> we start with the random variable <math alttext="\bm{x}_{T}" class="ltx_Math" display="inline" id="S2.SS2.p1.m1"><semantics><msub><mi>ğ’™</mi><mi>T</mi></msub><annotation encoding="application/x-tex">\bm{x}_{T}</annotation><annotation encoding="application/x-llamapun">bold_italic_x start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT</annotation></semantics></math> and iteratively denoise it using iterations of the form</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E15">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{\bm{x}}_{s}\doteq\operatorname{\mathbb{E}}[\bm{x}_{s}\mid\bm{x}_{t}=\hat{\bm{x}}_{t}]=\frac{s}{t}\hat{\bm{x}}_{t}+\left(1-\frac{s}{t}\right)\bar{\bm{x}}^{\ast}(t,\hat{\bm{x}}_{t})." class="ltx_Math" display="block" id="S2.E15.m1"><semantics><mrow><mrow><msub><mover accent="true"><mi>ğ’™</mi><mo>^</mo></mover><mi>s</mi></msub><mo>â‰</mo><mrow><mi>ğ”¼</mi><mo>â¡</mo><mrow><mo stretchy="false">[</mo><mrow><mrow><msub><mi>ğ’™</mi><mi>s</mi></msub><mo>âˆ£</mo><msub><mi>ğ’™</mi><mi>t</mi></msub></mrow><mo>=</mo><msub><mover accent="true"><mi>ğ’™</mi><mo>^</mo></mover><mi>t</mi></msub></mrow><mo stretchy="false">]</mo></mrow></mrow><mo>=</mo><mrow><mrow><mfrac><mi>s</mi><mi>t</mi></mfrac><mo lspace="0em" rspace="0em">â€‹</mo><msub><mover accent="true"><mi>ğ’™</mi><mo>^</mo></mover><mi>t</mi></msub></mrow><mo>+</mo><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>âˆ’</mo><mfrac><mi>s</mi><mi>t</mi></mfrac></mrow><mo>)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><msup><mover accent="true"><mi>ğ’™</mi><mo>Â¯</mo></mover><mo>âˆ—</mo></msup><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>t</mi><mo>,</mo><msub><mover accent="true"><mi>ğ’™</mi><mo>^</mo></mover><mi>t</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">\hat{\bm{x}}_{s}\doteq\operatorname{\mathbb{E}}[\bm{x}_{s}\mid\bm{x}_{t}=\hat{\bm{x}}_{t}]=\frac{s}{t}\hat{\bm{x}}_{t}+\left(1-\frac{s}{t}\right)\bar{\bm{x}}^{\ast}(t,\hat{\bm{x}}_{t}).</annotation><annotation encoding="application/x-llamapun">over^ start_ARG bold_italic_x end_ARG start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT â‰ blackboard_E [ bold_italic_x start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT âˆ£ bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = over^ start_ARG bold_italic_x end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ] = divide start_ARG italic_s end_ARG start_ARG italic_t end_ARG over^ start_ARG bold_italic_x end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT + ( 1 - divide start_ARG italic_s end_ARG start_ARG italic_t end_ARG ) overÂ¯ start_ARG bold_italic_x end_ARG start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ( italic_t , over^ start_ARG bold_italic_x end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.15)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">for <math alttext="s,t\in\{t_{0},t_{1},\dots,t_{L}\}" class="ltx_Math" display="inline" id="S2.SS2.p1.m2"><semantics><mrow><mrow><mi>s</mi><mo>,</mo><mi>t</mi></mrow><mo>âˆˆ</mo><mrow><mo stretchy="false">{</mo><msub><mi>t</mi><mn>0</mn></msub><mo>,</mo><msub><mi>t</mi><mn>1</mn></msub><mo>,</mo><mi mathvariant="normal">â€¦</mi><mo>,</mo><msub><mi>t</mi><mi>L</mi></msub><mo stretchy="false">}</mo></mrow></mrow><annotation encoding="application/x-tex">s,t\in\{t_{0},t_{1},\dots,t_{L}\}</annotation><annotation encoding="application/x-llamapun">italic_s , italic_t âˆˆ { italic_t start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_t start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , â€¦ , italic_t start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT }</annotation></semantics></math> with <math alttext="s&lt;t" class="ltx_Math" display="inline" id="S2.SS2.p1.m3"><semantics><mrow><mi>s</mi><mo>&lt;</mo><mi>t</mi></mrow><annotation encoding="application/x-tex">s&lt;t</annotation><annotation encoding="application/x-llamapun">italic_s &lt; italic_t</annotation></semantics></math> and <math alttext="\bm{x}_{T}=\hat{\bm{x}}_{T}" class="ltx_Math" display="inline" id="S2.SS2.p1.m4"><semantics><mrow><msub><mi>ğ’™</mi><mi>T</mi></msub><mo>=</mo><msub><mover accent="true"><mi>ğ’™</mi><mo>^</mo></mover><mi>T</mi></msub></mrow><annotation encoding="application/x-tex">\bm{x}_{T}=\hat{\bm{x}}_{T}</annotation><annotation encoding="application/x-llamapun">bold_italic_x start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT = over^ start_ARG bold_italic_x end_ARG start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT</annotation></semantics></math>. We wish to prove that <math alttext="h(\hat{\bm{x}}_{s})&lt;h(\hat{\bm{x}}_{t})" class="ltx_Math" display="inline" id="S2.SS2.p1.m5"><semantics><mrow><mrow><mi>h</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msub><mover accent="true"><mi>ğ’™</mi><mo>^</mo></mover><mi>s</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>&lt;</mo><mrow><mi>h</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msub><mover accent="true"><mi>ğ’™</mi><mo>^</mo></mover><mi>t</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">h(\hat{\bm{x}}_{s})&lt;h(\hat{\bm{x}}_{t})</annotation><annotation encoding="application/x-llamapun">italic_h ( over^ start_ARG bold_italic_x end_ARG start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ) &lt; italic_h ( over^ start_ARG bold_italic_x end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>, showing that the denoising process actually reduces the entropy.</p>
</div>
<div class="ltx_para" id="S2.SS2.p2">
<p class="ltx_p">Before we go about doing this, we make several remarks about the problem statement. First, Tweedieâ€™s formula (<a class="ltx_ref" href="Ch3.html#S2.E20" title="Equation 3.2.20 â€£ Theorem 3.3 (Tweedieâ€™s Formula). â€£ 3.2.1 Diffusion and Denoising Processes â€£ 3.2 Compression via Denoising â€£ Chapter 3 Pursuing Low-Dimensional Distributions via Lossy Compression â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">3.2.20</span></a>) says that</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E16">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\bar{\bm{x}}^{\ast}(t,\bm{x}_{t})=\bm{x}_{t}+t^{2}\nabla p_{t}(\bm{x}_{t})," class="ltx_Math" display="block" id="S2.E16.m1"><semantics><mrow><mrow><mrow><msup><mover accent="true"><mi>ğ’™</mi><mo>Â¯</mo></mover><mo>âˆ—</mo></msup><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>t</mi><mo>,</mo><msub><mi>ğ’™</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><msub><mi>ğ’™</mi><mi>t</mi></msub><mo>+</mo><mrow><msup><mi>t</mi><mn>2</mn></msup><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mo rspace="0.167em">âˆ‡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ’™</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">\bar{\bm{x}}^{\ast}(t,\bm{x}_{t})=\bm{x}_{t}+t^{2}\nabla p_{t}(\bm{x}_{t}),</annotation><annotation encoding="application/x-llamapun">overÂ¯ start_ARG bold_italic_x end_ARG start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ( italic_t , bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) = bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT + italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT âˆ‡ italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.16)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">which likens a full denoising step from time <math alttext="t" class="ltx_Math" display="inline" id="S2.SS2.p2.m1"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation><annotation encoding="application/x-llamapun">italic_t</annotation></semantics></math> to time <math alttext="0" class="ltx_Math" display="inline" id="S2.SS2.p2.m2"><mn>0</mn></math> to a gradient step on the log-density of <math alttext="\bm{x}_{t}" class="ltx_Math" display="inline" id="S2.SS2.p2.m3"><semantics><msub><mi>ğ’™</mi><mi>t</mi></msub><annotation encoding="application/x-tex">\bm{x}_{t}</annotation><annotation encoding="application/x-llamapun">bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>. Can we get a similar result for the full denoising step from time <math alttext="t" class="ltx_Math" display="inline" id="S2.SS2.p2.m4"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation><annotation encoding="application/x-llamapun">italic_t</annotation></semantics></math> to time <math alttext="s" class="ltx_Math" display="inline" id="S2.SS2.p2.m5"><semantics><mi>s</mi><annotation encoding="application/x-tex">s</annotation><annotation encoding="application/x-llamapun">italic_s</annotation></semantics></math> in (<a class="ltx_ref" href="#S2.E15" title="Equation B.2.15 â€£ B.2.2 Denoising Process Reduces Entropy Over Time â€£ B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">B.2.15</span></a>)? It turns out that indeed we can, and it is pretty simple. By using (<a class="ltx_ref" href="#S2.E15" title="Equation B.2.15 â€£ B.2.2 Denoising Process Reduces Entropy Over Time â€£ B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">B.2.15</span></a>) and Tweedieâ€™s formula (<a class="ltx_ref" href="Ch3.html#S2.E20" title="Equation 3.2.20 â€£ Theorem 3.3 (Tweedieâ€™s Formula). â€£ 3.2.1 Diffusion and Denoising Processes â€£ 3.2 Compression via Denoising â€£ Chapter 3 Pursuing Low-Dimensional Distributions via Lossy Compression â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">3.2.20</span></a>), we obtain</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E17">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\operatorname{\mathbb{E}}[\bm{x}_{s}\mid\bm{x}_{t}]=\frac{s}{t}\bm{x}_{t}+\left(1-\frac{s}{t}\right)\left(\bm{x}_{t}+t^{2}\nabla_{\bm{x}_{t}}\log p_{t}(\bm{x}_{t})\right)=\bm{x}_{t}+\left(1-\frac{s}{t}\right)t^{2}\nabla_{\bm{x}_{t}}\log p_{t}(\bm{x}_{t})." class="ltx_Math" display="block" id="S2.E17.m1"><semantics><mrow><mrow><mrow><mi>ğ”¼</mi><mo>â¡</mo><mrow><mo stretchy="false">[</mo><mrow><msub><mi>ğ’™</mi><mi>s</mi></msub><mo>âˆ£</mo><msub><mi>ğ’™</mi><mi>t</mi></msub></mrow><mo stretchy="false">]</mo></mrow></mrow><mo>=</mo><mrow><mrow><mfrac><mi>s</mi><mi>t</mi></mfrac><mo lspace="0em" rspace="0em">â€‹</mo><msub><mi>ğ’™</mi><mi>t</mi></msub></mrow><mo>+</mo><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>âˆ’</mo><mfrac><mi>s</mi><mi>t</mi></mfrac></mrow><mo>)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo>(</mo><mrow><msub><mi>ğ’™</mi><mi>t</mi></msub><mo>+</mo><mrow><msup><mi>t</mi><mn>2</mn></msup><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mrow><msub><mo rspace="0.167em">âˆ‡</mo><msub><mi>ğ’™</mi><mi>t</mi></msub></msub><mi>log</mi></mrow><mo lspace="0.167em">â¡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ’™</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>)</mo></mrow></mrow></mrow><mo>=</mo><mrow><msub><mi>ğ’™</mi><mi>t</mi></msub><mo>+</mo><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>âˆ’</mo><mfrac><mi>s</mi><mi>t</mi></mfrac></mrow><mo>)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>t</mi><mn>2</mn></msup><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mrow><msub><mo rspace="0.167em">âˆ‡</mo><msub><mi>ğ’™</mi><mi>t</mi></msub></msub><mi>log</mi></mrow><mo lspace="0.167em">â¡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ’™</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">\operatorname{\mathbb{E}}[\bm{x}_{s}\mid\bm{x}_{t}]=\frac{s}{t}\bm{x}_{t}+\left(1-\frac{s}{t}\right)\left(\bm{x}_{t}+t^{2}\nabla_{\bm{x}_{t}}\log p_{t}(\bm{x}_{t})\right)=\bm{x}_{t}+\left(1-\frac{s}{t}\right)t^{2}\nabla_{\bm{x}_{t}}\log p_{t}(\bm{x}_{t}).</annotation><annotation encoding="application/x-llamapun">blackboard_E [ bold_italic_x start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT âˆ£ bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ] = divide start_ARG italic_s end_ARG start_ARG italic_t end_ARG bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT + ( 1 - divide start_ARG italic_s end_ARG start_ARG italic_t end_ARG ) ( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT + italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT âˆ‡ start_POSTSUBSCRIPT bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ) = bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT + ( 1 - divide start_ARG italic_s end_ARG start_ARG italic_t end_ARG ) italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT âˆ‡ start_POSTSUBSCRIPT bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.17)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">So this iterative denoising step is again a gradient step on the perturbed log-density <math alttext="\log p_{t}" class="ltx_Math" display="inline" id="S2.SS2.p2.m6"><semantics><mrow><mi>log</mi><mo lspace="0.167em">â¡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\log p_{t}</annotation><annotation encoding="application/x-llamapun">roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> with a shrunken step size. In particular, this step can be seen as a perturbation of the distribution of the random variable <math alttext="\bm{x}_{t}" class="ltx_Math" display="inline" id="S2.SS2.p2.m7"><semantics><msub><mi>ğ’™</mi><mi>t</mi></msub><annotation encoding="application/x-tex">\bm{x}_{t}</annotation><annotation encoding="application/x-llamapun">bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> by the <span class="ltx_text ltx_font_italic">score function vector field</span>, suggesting a connection to stochastic differential equations (SDEs) and the theory of diffusion models <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="bib.html#bibx249" title="">SSK+21</a>]</cite>. Indeed, a proof of the following result <a class="ltx_ref" href="#Thmtheorem4" title="Theorem B.4. â€£ B.2.2 Denoising Process Reduces Entropy Over Time â€£ B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Theorem</span>Â <span class="ltx_text ltx_ref_tag">B.4</span></a> can be developed using this powerful machinery and a limiting argument (e.g., following the technical approach in the exposition of <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="bib.html#bibx47" title="">CCL+23</a>]</cite>). We will give a simpler proof here, which will use only elementary tools and thereby illuminate some of the key quantities behind the process of entropy reduction via denoising. On the other hand, we will need to deal with some slightly technical calculations due to the fact that the denoising process in <a class="ltx_ref" href="#Thmtheorem4" title="Theorem B.4. â€£ B.2.2 Denoising Process Reduces Entropy Over Time â€£ B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Theorem</span>Â <span class="ltx_text ltx_ref_tag">B.4</span></a> does <span class="ltx_text ltx_font_italic">not</span> correspond exactly to the <span class="ltx_text ltx_font_italic">reverse</span> process associated to the noise addition process that generates the observation <math alttext="\bm{x}_{t}" class="ltx_Math" display="inline" id="S2.SS2.p2.m8"><semantics><msub><mi>ğ’™</mi><mi>t</mi></msub><annotation encoding="application/x-tex">\bm{x}_{t}</annotation><annotation encoding="application/x-llamapun">bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>.<span class="ltx_note ltx_role_footnote" id="footnote5"><sup class="ltx_note_mark">5</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">5</sup><span class="ltx_tag ltx_tag_note">5</span>For those familiar with diffusion models, we refer here to the time-reversed forward process not coinciding with the sequence of iterates generated by the process defined by <a class="ltx_ref" href="#Thmtheorem4" title="Theorem B.4. â€£ B.2.2 Denoising Process Reduces Entropy Over Time â€£ B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Theorem</span>Â <span class="ltx_text ltx_ref_tag">B.4</span></a>. These processes coincide in a certain limit where infinitely many steps of <a class="ltx_ref" href="#Thmtheorem4" title="Theorem B.4. â€£ B.2.2 Denoising Process Reduces Entropy Over Time â€£ B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Theorem</span>Â <span class="ltx_text ltx_ref_tag">B.4</span></a> are taken with infinitely small levels of noise added at each step; for general, finite steps, we must introduce some approximations regardless of the level of sophistication of our tools.</span></span></span></p>
</div>
<div class="ltx_para" id="S2.SS2.p3">
<p class="ltx_p">We want to prove that <math alttext="h(\operatorname{\mathbb{E}}[\bm{x}_{s}\mid\bm{x}_{t}])&lt;h(\bm{x}_{t})" class="ltx_Math" display="inline" id="S2.SS2.p3.m1"><semantics><mrow><mrow><mi>h</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mi>ğ”¼</mi><mo>â¡</mo><mrow><mo stretchy="false">[</mo><mrow><msub><mi>ğ’™</mi><mi>s</mi></msub><mo>âˆ£</mo><msub><mi>ğ’™</mi><mi>t</mi></msub></mrow><mo stretchy="false">]</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>&lt;</mo><mrow><mi>h</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ’™</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">h(\operatorname{\mathbb{E}}[\bm{x}_{s}\mid\bm{x}_{t}])&lt;h(\bm{x}_{t})</annotation><annotation encoding="application/x-llamapun">italic_h ( blackboard_E [ bold_italic_x start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT âˆ£ bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ] ) &lt; italic_h ( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>, i.e., formally:</p>
</div>
<div class="ltx_theorem ltx_theorem_theorem" id="Thmtheorem4">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold">Theorem B.4</span></span><span class="ltx_text ltx_font_bold">.</span>
</h6>
<div class="ltx_para" id="Thmtheorem4.p1">
<p class="ltx_p"><span class="ltx_text ltx_font_italic">Let <math alttext="\bm{x}" class="ltx_Math" display="inline" id="Thmtheorem4.p1.m1"><semantics><mi>ğ±</mi><annotation encoding="application/x-tex">\bm{x}</annotation><annotation encoding="application/x-llamapun">bold_italic_x</annotation></semantics></math> be any random variable such that <a class="ltx_ref" href="#Thmassumption1" title="Assumption B.1. â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Assumptions</span>Â <span class="ltx_text ltx_ref_tag">B.1</span></a> andÂ <a class="ltx_ref" href="#Thmassumption2" title="Assumption B.2. â€£ B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">B.2</span></a> hold, and let <math alttext="(\bm{x}_{t})_{t\in[0,T]}" class="ltx_Math" display="inline" id="Thmtheorem4.p1.m2"><semantics><msub><mrow><mo stretchy="false">(</mo><msub><mi>ğ±</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><mrow><mi>t</mi><mo>âˆˆ</mo><mrow><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mi>T</mi><mo stretchy="false">]</mo></mrow></mrow></msub><annotation encoding="application/x-tex">(\bm{x}_{t})_{t\in[0,T]}</annotation><annotation encoding="application/x-llamapun">( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_t âˆˆ [ 0 , italic_T ] end_POSTSUBSCRIPT</annotation></semantics></math> be the stochastic process (<a class="ltx_ref" href="#S2.E1" title="Equation B.2.1 â€£ B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">B.2.1</span></a>). Then</span></p>
<table class="ltx_equation ltx_eqn_table" id="S2.E18">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="h(\operatorname{\mathbb{E}}[\bm{x}_{s}\mid\bm{x}_{t}])&lt;h(\bm{x}_{t}),\qquad\forall s,t\in[0,T]\colon\quad 0&lt;t\leq\frac{R}{\sqrt{2D}},\quad 0\leq s&lt;t\cdot\min\left\{1,\frac{R^{2}/D-2t^{2}}{R^{2}/D-t^{2}}\right\}." class="ltx_math_unparsed" display="block" id="S2.E18.m1"><semantics><mrow><mi>h</mi><mrow><mo stretchy="false">(</mo><mi>ğ”¼</mi><mrow><mo stretchy="false">[</mo><msub><mi>ğ’™</mi><mi>s</mi></msub><mo lspace="0em" rspace="0.167em">âˆ£</mo><msub><mi>ğ’™</mi><mi>t</mi></msub><mo stretchy="false">]</mo></mrow><mo stretchy="false">)</mo></mrow><mo>&lt;</mo><mi>h</mi><mrow><mo stretchy="false">(</mo><msub><mi>ğ’™</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><mo rspace="2.167em">,</mo><mo rspace="0.167em">âˆ€</mo><mi>s</mi><mo>,</mo><mi>t</mi><mo>âˆˆ</mo><mrow><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mi>T</mi><mo rspace="0.278em" stretchy="false">]</mo></mrow><mo>:</mo><mspace width="1.278em"></mspace><mn>0</mn><mo>&lt;</mo><mi>t</mi><mo>â‰¤</mo><mfrac><mi>R</mi><msqrt><mrow><mn>2</mn><mo lspace="0em" rspace="0em">â€‹</mo><mi>D</mi></mrow></msqrt></mfrac><mo rspace="1.167em">,</mo><mn>0</mn><mo>â‰¤</mo><mi>s</mi><mo>&lt;</mo><mi>t</mi><mo lspace="0.222em" rspace="0.222em">â‹…</mo><mi>min</mi><mrow><mo>{</mo><mn>1</mn><mo>,</mo><mfrac><mrow><mrow><msup><mi>R</mi><mn>2</mn></msup><mo>/</mo><mi>D</mi></mrow><mo>âˆ’</mo><mrow><mn>2</mn><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>t</mi><mn>2</mn></msup></mrow></mrow><mrow><mrow><msup><mi>R</mi><mn>2</mn></msup><mo>/</mo><mi>D</mi></mrow><mo>âˆ’</mo><msup><mi>t</mi><mn>2</mn></msup></mrow></mfrac><mo>}</mo></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">h(\operatorname{\mathbb{E}}[\bm{x}_{s}\mid\bm{x}_{t}])&lt;h(\bm{x}_{t}),\qquad\forall s,t\in[0,T]\colon\quad 0&lt;t\leq\frac{R}{\sqrt{2D}},\quad 0\leq s&lt;t\cdot\min\left\{1,\frac{R^{2}/D-2t^{2}}{R^{2}/D-t^{2}}\right\}.</annotation><annotation encoding="application/x-llamapun">italic_h ( blackboard_E [ bold_italic_x start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT âˆ£ bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ] ) &lt; italic_h ( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) , âˆ€ italic_s , italic_t âˆˆ [ 0 , italic_T ] : 0 &lt; italic_t â‰¤ divide start_ARG italic_R end_ARG start_ARG square-root start_ARG 2 italic_D end_ARG end_ARG , 0 â‰¤ italic_s &lt; italic_t â‹… roman_min { 1 , divide start_ARG italic_R start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT / italic_D - 2 italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG italic_R start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT / italic_D - italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG } .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.18)</span></td>
</tr></tbody>
</table>
</div>
</div>
<div class="ltx_proof">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h6>
<div class="ltx_para" id="S2.SS2.p4">
<p class="ltx_p">This proof uses two main ideas:</p>
<ol class="ltx_enumerate" id="S2.I1">
<li class="ltx_item" id="S2.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S2.I1.i1.p1">
<p class="ltx_p">First, write down a density for <math alttext="\operatorname{\mathbb{E}}[\bm{x}_{s}\mid\bm{x}_{t}]" class="ltx_Math" display="inline" id="S2.I1.i1.p1.m1"><semantics><mrow><mi>ğ”¼</mi><mo>â¡</mo><mrow><mo stretchy="false">[</mo><mrow><msub><mi>ğ’™</mi><mi>s</mi></msub><mo>âˆ£</mo><msub><mi>ğ’™</mi><mi>t</mi></msub></mrow><mo stretchy="false">]</mo></mrow></mrow><annotation encoding="application/x-tex">\operatorname{\mathbb{E}}[\bm{x}_{s}\mid\bm{x}_{t}]</annotation><annotation encoding="application/x-llamapun">blackboard_E [ bold_italic_x start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT âˆ£ bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ]</annotation></semantics></math> using a change-of-variables formula.</p>
</div>
</li>
<li class="ltx_item" id="S2.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S2.I1.i2.p1">
<p class="ltx_p">Second, bound this density to control the entropy.</p>
</div>
</li>
</ol>
<p class="ltx_p">The change of variables is justified by <a class="ltx_ref" href="#Thmcorollary1" title="Corollary B.1 (Generalization of [Gri11] Corollary A.2, Part 2). â€£ Local Invertibility of the Denoiser ğ’™Ì„ â€£ B.2.3 Technical Lemmas and Intermediate Results â€£ B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Corollary</span>Â <span class="ltx_text ltx_ref_tag">B.1</span></a>, which was originally derived in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="bib.html#bibx96" title="">Gri11</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S2.SS2.p5">
<p class="ltx_p">We execute these ideas now. From <a class="ltx_ref" href="#Thmcorollary1" title="Corollary B.1 (Generalization of [Gri11] Corollary A.2, Part 2). â€£ Local Invertibility of the Denoiser ğ’™Ì„ â€£ B.2.3 Technical Lemmas and Intermediate Results â€£ B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Corollary</span>Â <span class="ltx_text ltx_ref_tag">B.1</span></a>, we obtain that the function <math alttext="\bar{\bm{x}}" class="ltx_Math" display="inline" id="S2.SS2.p5.m1"><semantics><mover accent="true"><mi>ğ’™</mi><mo>Â¯</mo></mover><annotation encoding="application/x-tex">\bar{\bm{x}}</annotation><annotation encoding="application/x-llamapun">overÂ¯ start_ARG bold_italic_x end_ARG</annotation></semantics></math> defined as <math alttext="\bar{\bm{x}}(\bm{\xi})\doteq\operatorname{\mathbb{E}}[\bm{x}_{s}\mid\bm{x}_{t}=\bm{\xi}]" class="ltx_Math" display="inline" id="S2.SS2.p5.m2"><semantics><mrow><mrow><mover accent="true"><mi>ğ’™</mi><mo>Â¯</mo></mover><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>â‰</mo><mrow><mi>ğ”¼</mi><mo>â¡</mo><mrow><mo stretchy="false">[</mo><mrow><mrow><msub><mi>ğ’™</mi><mi>s</mi></msub><mo>âˆ£</mo><msub><mi>ğ’™</mi><mi>t</mi></msub></mrow><mo>=</mo><mi>ğƒ</mi></mrow><mo stretchy="false">]</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\bar{\bm{x}}(\bm{\xi})\doteq\operatorname{\mathbb{E}}[\bm{x}_{s}\mid\bm{x}_{t}=\bm{\xi}]</annotation><annotation encoding="application/x-llamapun">overÂ¯ start_ARG bold_italic_x end_ARG ( bold_italic_Î¾ ) â‰ blackboard_E [ bold_italic_x start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT âˆ£ bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = bold_italic_Î¾ ]</annotation></semantics></math> is differentiable, injective, and thus invertible on its range, which we henceforth denote <math alttext="\mathcal{X}\subseteq\mathbb{R}^{D}" class="ltx_Math" display="inline" id="S2.SS2.p5.m3"><semantics><mrow><mi class="ltx_font_mathcaligraphic">ğ’³</mi><mo>âŠ†</mo><msup><mi>â„</mi><mi>D</mi></msup></mrow><annotation encoding="application/x-tex">\mathcal{X}\subseteq\mathbb{R}^{D}</annotation><annotation encoding="application/x-llamapun">caligraphic_X âŠ† blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT</annotation></semantics></math>. We denote its inverse as <math alttext="\bar{\bm{x}}^{-1}" class="ltx_Math" display="inline" id="S2.SS2.p5.m4"><semantics><msup><mover accent="true"><mi>ğ’™</mi><mo>Â¯</mo></mover><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><annotation encoding="application/x-tex">\bar{\bm{x}}^{-1}</annotation><annotation encoding="application/x-llamapun">overÂ¯ start_ARG bold_italic_x end_ARG start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT</annotation></semantics></math>. Using a change-of-variables formula, the density <math alttext="\bar{p}" class="ltx_Math" display="inline" id="S2.SS2.p5.m5"><semantics><mover accent="true"><mi>p</mi><mo>Â¯</mo></mover><annotation encoding="application/x-tex">\bar{p}</annotation><annotation encoding="application/x-llamapun">overÂ¯ start_ARG italic_p end_ARG</annotation></semantics></math> of <math alttext="\bar{\bm{x}}(\bm{x}_{t})" class="ltx_Math" display="inline" id="S2.SS2.p5.m6"><semantics><mrow><mover accent="true"><mi>ğ’™</mi><mo>Â¯</mo></mover><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ’™</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">\bar{\bm{x}}(\bm{x}_{t})</annotation><annotation encoding="application/x-llamapun">overÂ¯ start_ARG bold_italic_x end_ARG ( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> is given by</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E19">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\bar{p}(\bm{\xi})\doteq\frac{(p_{t}\circ\bar{\bm{x}}^{-1})(\bm{\xi})}{\det(\bar{\bm{x}}^{\prime}(\bar{\bm{x}}^{-1}(\bm{\xi})))}," class="ltx_Math" display="block" id="S2.E19.m1"><semantics><mrow><mrow><mrow><mover accent="true"><mi>p</mi><mo>Â¯</mo></mover><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>â‰</mo><mfrac><mrow><mrow><mo stretchy="false">(</mo><mrow><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0.222em" rspace="0.222em">âˆ˜</mo><msup><mover accent="true"><mi>ğ’™</mi><mo>Â¯</mo></mover><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup></mrow><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mrow><mo rspace="0em">det</mo><mrow><mo stretchy="false">(</mo><mrow><msup><mover accent="true"><mi>ğ’™</mi><mo>Â¯</mo></mover><mo>â€²</mo></msup><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><msup><mover accent="true"><mi>ğ’™</mi><mo>Â¯</mo></mover><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mfrac></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">\bar{p}(\bm{\xi})\doteq\frac{(p_{t}\circ\bar{\bm{x}}^{-1})(\bm{\xi})}{\det(\bar{\bm{x}}^{\prime}(\bar{\bm{x}}^{-1}(\bm{\xi})))},</annotation><annotation encoding="application/x-llamapun">overÂ¯ start_ARG italic_p end_ARG ( bold_italic_Î¾ ) â‰ divide start_ARG ( italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT âˆ˜ overÂ¯ start_ARG bold_italic_x end_ARG start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) ( bold_italic_Î¾ ) end_ARG start_ARG roman_det ( overÂ¯ start_ARG bold_italic_x end_ARG start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT ( overÂ¯ start_ARG bold_italic_x end_ARG start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ( bold_italic_Î¾ ) ) ) end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.19)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">where (recall, from <a class="ltx_ref" href="A1.html" title="Appendix A Optimization Methods â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Appendix</span>Â <span class="ltx_text ltx_ref_tag">A</span></a>) <math alttext="\bar{\bm{x}}^{\prime}" class="ltx_Math" display="inline" id="S2.SS2.p5.m7"><semantics><msup><mover accent="true"><mi>ğ’™</mi><mo>Â¯</mo></mover><mo>â€²</mo></msup><annotation encoding="application/x-tex">\bar{\bm{x}}^{\prime}</annotation><annotation encoding="application/x-llamapun">overÂ¯ start_ARG bold_italic_x end_ARG start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT</annotation></semantics></math> is the Jacobian of <math alttext="\bar{\bm{x}}" class="ltx_Math" display="inline" id="S2.SS2.p5.m8"><semantics><mover accent="true"><mi>ğ’™</mi><mo>Â¯</mo></mover><annotation encoding="application/x-tex">\bar{\bm{x}}</annotation><annotation encoding="application/x-llamapun">overÂ¯ start_ARG bold_italic_x end_ARG</annotation></semantics></math>. Since from <a class="ltx_ref" href="#Thmlemma3" title="Lemma B.3 (Generalization of [Gri11], Lemma A.1). â€£ Local Invertibility of the Denoiser ğ’™Ì„ â€£ B.2.3 Technical Lemmas and Intermediate Results â€£ B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Lemma</span>Â <span class="ltx_text ltx_ref_tag">B.3</span></a> we know <math alttext="\bar{\bm{x}}^{\prime}" class="ltx_Math" display="inline" id="S2.SS2.p5.m9"><semantics><msup><mover accent="true"><mi>ğ’™</mi><mo>Â¯</mo></mover><mo>â€²</mo></msup><annotation encoding="application/x-tex">\bar{\bm{x}}^{\prime}</annotation><annotation encoding="application/x-llamapun">overÂ¯ start_ARG bold_italic_x end_ARG start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT</annotation></semantics></math> is a positive definite matrix, the determinant is positive and so the whole density is positive. Then it follows that</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S3.EGx129">
<tbody id="S2.E20"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle h(\bar{\bm{x}}(\bm{x}_{t}))" class="ltx_Math" display="inline" id="S2.E20.m1"><semantics><mrow><mi>h</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mover accent="true"><mi>ğ’™</mi><mo>Â¯</mo></mover><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ’™</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">\displaystyle h(\bar{\bm{x}}(\bm{x}_{t}))</annotation><annotation encoding="application/x-llamapun">italic_h ( overÂ¯ start_ARG bold_italic_x end_ARG ( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=-\int_{\mathcal{X}}\frac{(p_{t}\circ\bar{\bm{x}}^{-1})(\bm{\xi})}{\det(\bar{\bm{x}}^{\prime}(\bar{\bm{x}}^{-1}(\bm{\xi})))}\log\frac{(p_{t}\circ\bar{\bm{x}}^{-1})(\bm{\xi})}{\det(\bar{\bm{x}}^{\prime}(\bar{\bm{x}}^{-1}(\bm{\xi})))}~{}\mathrm{d}\bm{\xi}" class="ltx_Math" display="inline" id="S2.E20.m2"><semantics><mrow><mi></mi><mo>=</mo><mrow><mo>âˆ’</mo><mrow><mstyle displaystyle="true"><msub><mo>âˆ«</mo><mi class="ltx_font_mathcaligraphic">ğ’³</mi></msub></mstyle><mrow><mstyle displaystyle="true"><mfrac><mrow><mrow><mo stretchy="false">(</mo><mrow><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0.222em" rspace="0.222em">âˆ˜</mo><msup><mover accent="true"><mi>ğ’™</mi><mo>Â¯</mo></mover><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup></mrow><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mrow><mo rspace="0em">det</mo><mrow><mo stretchy="false">(</mo><mrow><msup><mover accent="true"><mi>ğ’™</mi><mo>Â¯</mo></mover><mo>â€²</mo></msup><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><msup><mover accent="true"><mi>ğ’™</mi><mo>Â¯</mo></mover><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mfrac></mstyle><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mi>log</mi><mo lspace="0.167em">â¡</mo><mrow><mstyle displaystyle="true"><mfrac><mrow><mrow><mo stretchy="false">(</mo><mrow><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0.222em" rspace="0.222em">âˆ˜</mo><msup><mover accent="true"><mi>ğ’™</mi><mo>Â¯</mo></mover><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup></mrow><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mrow><mo rspace="0em">det</mo><mrow><mo stretchy="false">(</mo><mrow><msup><mover accent="true"><mi>ğ’™</mi><mo>Â¯</mo></mover><mo>â€²</mo></msup><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><msup><mover accent="true"><mi>ğ’™</mi><mo>Â¯</mo></mover><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mfrac></mstyle><mo lspace="0.330em" rspace="0em">â€‹</mo><mi mathvariant="normal">d</mi><mo lspace="0em" rspace="0em">â€‹</mo><mi>ğƒ</mi></mrow></mrow></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=-\int_{\mathcal{X}}\frac{(p_{t}\circ\bar{\bm{x}}^{-1})(\bm{\xi})}{\det(\bar{\bm{x}}^{\prime}(\bar{\bm{x}}^{-1}(\bm{\xi})))}\log\frac{(p_{t}\circ\bar{\bm{x}}^{-1})(\bm{\xi})}{\det(\bar{\bm{x}}^{\prime}(\bar{\bm{x}}^{-1}(\bm{\xi})))}~{}\mathrm{d}\bm{\xi}</annotation><annotation encoding="application/x-llamapun">= - âˆ« start_POSTSUBSCRIPT caligraphic_X end_POSTSUBSCRIPT divide start_ARG ( italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT âˆ˜ overÂ¯ start_ARG bold_italic_x end_ARG start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) ( bold_italic_Î¾ ) end_ARG start_ARG roman_det ( overÂ¯ start_ARG bold_italic_x end_ARG start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT ( overÂ¯ start_ARG bold_italic_x end_ARG start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ( bold_italic_Î¾ ) ) ) end_ARG roman_log divide start_ARG ( italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT âˆ˜ overÂ¯ start_ARG bold_italic_x end_ARG start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) ( bold_italic_Î¾ ) end_ARG start_ARG roman_det ( overÂ¯ start_ARG bold_italic_x end_ARG start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT ( overÂ¯ start_ARG bold_italic_x end_ARG start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ( bold_italic_Î¾ ) ) ) end_ARG roman_d bold_italic_Î¾</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.20)</span></td>
</tr></tbody>
<tbody id="S2.E21"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=-\int_{\mathcal{X}}\frac{(p_{t}\circ\bar{\bm{x}}^{-1})(\bm{\xi})}{\det(\bar{\bm{x}}^{\prime}(\bar{\bm{x}}^{-1}(\bm{\xi})))}\log((p_{t}\circ\bar{\bm{x}}^{-1})(\bm{\xi}))~{}\mathrm{d}\bm{\xi}" class="ltx_Math" display="inline" id="S2.E21.m1"><semantics><mrow><mi></mi><mo>=</mo><mrow><mo>âˆ’</mo><mrow><mstyle displaystyle="true"><msub><mo>âˆ«</mo><mi class="ltx_font_mathcaligraphic">ğ’³</mi></msub></mstyle><mrow><mstyle displaystyle="true"><mfrac><mrow><mrow><mo stretchy="false">(</mo><mrow><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0.222em" rspace="0.222em">âˆ˜</mo><msup><mover accent="true"><mi>ğ’™</mi><mo>Â¯</mo></mover><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup></mrow><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mrow><mo rspace="0em">det</mo><mrow><mo stretchy="false">(</mo><mrow><msup><mover accent="true"><mi>ğ’™</mi><mo>Â¯</mo></mover><mo>â€²</mo></msup><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><msup><mover accent="true"><mi>ğ’™</mi><mo>Â¯</mo></mover><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mfrac></mstyle><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mi>log</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><mrow><mrow><mo stretchy="false">(</mo><mrow><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0.222em" rspace="0.222em">âˆ˜</mo><msup><mover accent="true"><mi>ğ’™</mi><mo>Â¯</mo></mover><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup></mrow><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mo lspace="0.330em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><mi>ğƒ</mi></mrow></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=-\int_{\mathcal{X}}\frac{(p_{t}\circ\bar{\bm{x}}^{-1})(\bm{\xi})}{\det(\bar{\bm{x}}^{\prime}(\bar{\bm{x}}^{-1}(\bm{\xi})))}\log((p_{t}\circ\bar{\bm{x}}^{-1})(\bm{\xi}))~{}\mathrm{d}\bm{\xi}</annotation><annotation encoding="application/x-llamapun">= - âˆ« start_POSTSUBSCRIPT caligraphic_X end_POSTSUBSCRIPT divide start_ARG ( italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT âˆ˜ overÂ¯ start_ARG bold_italic_x end_ARG start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) ( bold_italic_Î¾ ) end_ARG start_ARG roman_det ( overÂ¯ start_ARG bold_italic_x end_ARG start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT ( overÂ¯ start_ARG bold_italic_x end_ARG start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ( bold_italic_Î¾ ) ) ) end_ARG roman_log ( ( italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT âˆ˜ overÂ¯ start_ARG bold_italic_x end_ARG start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) ( bold_italic_Î¾ ) ) roman_d bold_italic_Î¾</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.21)</span></td>
</tr></tbody>
<tbody id="S2.E22"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\qquad+\int_{\mathcal{X}}\frac{(p_{t}\circ\bar{\bm{x}}^{-1})(\bm{\xi})}{\det(\bar{\bm{x}}^{\prime}(\bar{\bm{x}}^{-1}(\bm{\xi})))}\log\det\left(\bar{\bm{x}}^{\prime}(\bar{\bm{x}}^{-1}(\bm{\xi}))\right)~{}\mathrm{d}\bm{\xi}" class="ltx_Math" display="inline" id="S2.E22.m1"><semantics><mrow><mo>+</mo><mrow><mstyle displaystyle="true"><msub><mo>âˆ«</mo><mi class="ltx_font_mathcaligraphic">ğ’³</mi></msub></mstyle><mrow><mstyle displaystyle="true"><mfrac><mrow><mrow><mo stretchy="false">(</mo><mrow><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0.222em" rspace="0.222em">âˆ˜</mo><msup><mover accent="true"><mi>ğ’™</mi><mo>Â¯</mo></mover><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup></mrow><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mrow><mo rspace="0em">det</mo><mrow><mo stretchy="false">(</mo><mrow><msup><mover accent="true"><mi>ğ’™</mi><mo>Â¯</mo></mover><mo>â€²</mo></msup><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><msup><mover accent="true"><mi>ğ’™</mi><mo>Â¯</mo></mover><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mfrac></mstyle><mo lspace="0.167em" rspace="0em">â€‹</mo><mi>log</mi><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mo movablelimits="false" rspace="0em">det</mo><mrow><mrow><mo>(</mo><mrow><msup><mover accent="true"><mi>ğ’™</mi><mo>Â¯</mo></mover><mo>â€²</mo></msup><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><msup><mover accent="true"><mi>ğ’™</mi><mo>Â¯</mo></mover><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>)</mo></mrow><mo lspace="0.330em" rspace="0em">â€‹</mo><mi mathvariant="normal">d</mi><mo lspace="0em" rspace="0em">â€‹</mo><mi>ğƒ</mi></mrow></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle\qquad+\int_{\mathcal{X}}\frac{(p_{t}\circ\bar{\bm{x}}^{-1})(\bm{\xi})}{\det(\bar{\bm{x}}^{\prime}(\bar{\bm{x}}^{-1}(\bm{\xi})))}\log\det\left(\bar{\bm{x}}^{\prime}(\bar{\bm{x}}^{-1}(\bm{\xi}))\right)~{}\mathrm{d}\bm{\xi}</annotation><annotation encoding="application/x-llamapun">+ âˆ« start_POSTSUBSCRIPT caligraphic_X end_POSTSUBSCRIPT divide start_ARG ( italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT âˆ˜ overÂ¯ start_ARG bold_italic_x end_ARG start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) ( bold_italic_Î¾ ) end_ARG start_ARG roman_det ( overÂ¯ start_ARG bold_italic_x end_ARG start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT ( overÂ¯ start_ARG bold_italic_x end_ARG start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ( bold_italic_Î¾ ) ) ) end_ARG roman_log roman_det ( overÂ¯ start_ARG bold_italic_x end_ARG start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT ( overÂ¯ start_ARG bold_italic_x end_ARG start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ( bold_italic_Î¾ ) ) ) roman_d bold_italic_Î¾</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.22)</span></td>
</tr></tbody>
<tbody id="S2.E23"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=-\int_{\mathbb{R}^{D}}p_{t}(\bm{\xi})\log p_{t}(\bm{\xi})~{}\mathrm{d}\bm{\xi}+\int_{\mathcal{X}}\frac{(p_{t}\circ\bar{\bm{x}}^{-1})(\bm{\xi})}{\det(\bar{\bm{x}}^{\prime}(\bar{\bm{x}}^{-1}(\bm{\xi})))}\log\det\left(\bar{\bm{x}}^{\prime}(\bar{\bm{x}}^{-1}(\bm{\xi}))\right)~{}\mathrm{d}\bm{\xi}" class="ltx_Math" display="inline" id="S2.E23.m1"><semantics><mrow><mi></mi><mo>=</mo><mrow><mrow><mo>âˆ’</mo><mrow><mstyle displaystyle="true"><msub><mo>âˆ«</mo><msup><mi>â„</mi><mi>D</mi></msup></msub></mstyle><mrow><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mi>log</mi><mo lspace="0.167em">â¡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mo lspace="0.330em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><mi>ğƒ</mi></mrow></mrow></mrow></mrow><mo>+</mo><mrow><mstyle displaystyle="true"><msub><mo>âˆ«</mo><mi class="ltx_font_mathcaligraphic">ğ’³</mi></msub></mstyle><mrow><mstyle displaystyle="true"><mfrac><mrow><mrow><mo stretchy="false">(</mo><mrow><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0.222em" rspace="0.222em">âˆ˜</mo><msup><mover accent="true"><mi>ğ’™</mi><mo>Â¯</mo></mover><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup></mrow><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mrow><mo rspace="0em">det</mo><mrow><mo stretchy="false">(</mo><mrow><msup><mover accent="true"><mi>ğ’™</mi><mo>Â¯</mo></mover><mo>â€²</mo></msup><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><msup><mover accent="true"><mi>ğ’™</mi><mo>Â¯</mo></mover><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mfrac></mstyle><mo lspace="0.167em" rspace="0em">â€‹</mo><mi>log</mi><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mo movablelimits="false" rspace="0em">det</mo><mrow><mrow><mo>(</mo><mrow><msup><mover accent="true"><mi>ğ’™</mi><mo>Â¯</mo></mover><mo>â€²</mo></msup><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><msup><mover accent="true"><mi>ğ’™</mi><mo>Â¯</mo></mover><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>)</mo></mrow><mo lspace="0.330em" rspace="0em">â€‹</mo><mi mathvariant="normal">d</mi><mo lspace="0em" rspace="0em">â€‹</mo><mi>ğƒ</mi></mrow></mrow></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=-\int_{\mathbb{R}^{D}}p_{t}(\bm{\xi})\log p_{t}(\bm{\xi})~{}\mathrm{d}\bm{\xi}+\int_{\mathcal{X}}\frac{(p_{t}\circ\bar{\bm{x}}^{-1})(\bm{\xi})}{\det(\bar{\bm{x}}^{\prime}(\bar{\bm{x}}^{-1}(\bm{\xi})))}\log\det\left(\bar{\bm{x}}^{\prime}(\bar{\bm{x}}^{-1}(\bm{\xi}))\right)~{}\mathrm{d}\bm{\xi}</annotation><annotation encoding="application/x-llamapun">= - âˆ« start_POSTSUBSCRIPT blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT end_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) roman_d bold_italic_Î¾ + âˆ« start_POSTSUBSCRIPT caligraphic_X end_POSTSUBSCRIPT divide start_ARG ( italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT âˆ˜ overÂ¯ start_ARG bold_italic_x end_ARG start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) ( bold_italic_Î¾ ) end_ARG start_ARG roman_det ( overÂ¯ start_ARG bold_italic_x end_ARG start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT ( overÂ¯ start_ARG bold_italic_x end_ARG start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ( bold_italic_Î¾ ) ) ) end_ARG roman_log roman_det ( overÂ¯ start_ARG bold_italic_x end_ARG start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT ( overÂ¯ start_ARG bold_italic_x end_ARG start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ( bold_italic_Î¾ ) ) ) roman_d bold_italic_Î¾</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.23)</span></td>
</tr></tbody>
<tbody id="S2.E24"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=h(\bm{x}_{t})-\int_{\mathcal{X}}\frac{(p_{t}\circ\bar{\bm{x}}^{-1})(\bm{\xi})}{\det(\bar{\bm{x}}^{\prime}(\bar{\bm{x}}^{-1}(\bm{\xi})))}\log\left(\frac{1}{\det(\bar{\bm{x}}^{\prime}(\bar{\bm{x}}^{-1}(\bm{\xi})))}\right)~{}\mathrm{d}\bm{\xi}." class="ltx_Math" display="inline" id="S2.E24.m1"><semantics><mrow><mrow><mi></mi><mo>=</mo><mrow><mrow><mi>h</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ’™</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>âˆ’</mo><mrow><mstyle displaystyle="true"><msub><mo>âˆ«</mo><mi class="ltx_font_mathcaligraphic">ğ’³</mi></msub></mstyle><mrow><mstyle displaystyle="true"><mfrac><mrow><mrow><mo stretchy="false">(</mo><mrow><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0.222em" rspace="0.222em">âˆ˜</mo><msup><mover accent="true"><mi>ğ’™</mi><mo>Â¯</mo></mover><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup></mrow><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mrow><mo rspace="0em">det</mo><mrow><mo stretchy="false">(</mo><mrow><msup><mover accent="true"><mi>ğ’™</mi><mo>Â¯</mo></mover><mo>â€²</mo></msup><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><msup><mover accent="true"><mi>ğ’™</mi><mo>Â¯</mo></mover><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mfrac></mstyle><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mi>log</mi><mo>â¡</mo><mrow><mo>(</mo><mstyle displaystyle="true"><mfrac><mn>1</mn><mrow><mo rspace="0em">det</mo><mrow><mo stretchy="false">(</mo><mrow><msup><mover accent="true"><mi>ğ’™</mi><mo>Â¯</mo></mover><mo>â€²</mo></msup><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><msup><mover accent="true"><mi>ğ’™</mi><mo>Â¯</mo></mover><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mfrac></mstyle><mo>)</mo></mrow></mrow><mo lspace="0.330em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><mi>ğƒ</mi></mrow></mrow></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">\displaystyle=h(\bm{x}_{t})-\int_{\mathcal{X}}\frac{(p_{t}\circ\bar{\bm{x}}^{-1})(\bm{\xi})}{\det(\bar{\bm{x}}^{\prime}(\bar{\bm{x}}^{-1}(\bm{\xi})))}\log\left(\frac{1}{\det(\bar{\bm{x}}^{\prime}(\bar{\bm{x}}^{-1}(\bm{\xi})))}\right)~{}\mathrm{d}\bm{\xi}.</annotation><annotation encoding="application/x-llamapun">= italic_h ( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) - âˆ« start_POSTSUBSCRIPT caligraphic_X end_POSTSUBSCRIPT divide start_ARG ( italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT âˆ˜ overÂ¯ start_ARG bold_italic_x end_ARG start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) ( bold_italic_Î¾ ) end_ARG start_ARG roman_det ( overÂ¯ start_ARG bold_italic_x end_ARG start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT ( overÂ¯ start_ARG bold_italic_x end_ARG start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ( bold_italic_Î¾ ) ) ) end_ARG roman_log ( divide start_ARG 1 end_ARG start_ARG roman_det ( overÂ¯ start_ARG bold_italic_x end_ARG start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT ( overÂ¯ start_ARG bold_italic_x end_ARG start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ( bold_italic_Î¾ ) ) ) end_ARG ) roman_d bold_italic_Î¾ .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.24)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">We will study the last term (including the <math alttext="-" class="ltx_Math" display="inline" id="S2.SS2.p5.m10"><semantics><mo>âˆ’</mo><annotation encoding="application/x-tex">-</annotation><annotation encoding="application/x-llamapun">-</annotation></semantics></math>), and show that it is negative.</p>
</div>
<div class="ltx_para" id="S2.SS2.p6">
<p class="ltx_p">By concavity, one has <math alttext="-x\log x\leq 1-x" class="ltx_Math" display="inline" id="S2.SS2.p6.m1"><semantics><mrow><mrow><mo>âˆ’</mo><mrow><mi>x</mi><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mi>log</mi><mo lspace="0.167em">â¡</mo><mi>x</mi></mrow></mrow></mrow><mo>â‰¤</mo><mrow><mn>1</mn><mo>âˆ’</mo><mi>x</mi></mrow></mrow><annotation encoding="application/x-tex">-x\log x\leq 1-x</annotation><annotation encoding="application/x-llamapun">- italic_x roman_log italic_x â‰¤ 1 - italic_x</annotation></semantics></math> for every <math alttext="x\geq 0" class="ltx_Math" display="inline" id="S2.SS2.p6.m2"><semantics><mrow><mi>x</mi><mo>â‰¥</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">x\geq 0</annotation><annotation encoding="application/x-llamapun">italic_x â‰¥ 0</annotation></semantics></math>. Hence</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S3.EGx130">
<tbody id="S2.E25"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle h(\bar{\bm{x}}(\bm{x}_{t}))-h(\bm{x}_{t})" class="ltx_Math" display="inline" id="S2.E25.m1"><semantics><mrow><mrow><mi>h</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mover accent="true"><mi>ğ’™</mi><mo>Â¯</mo></mover><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ’™</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>âˆ’</mo><mrow><mi>h</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ’™</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle h(\bar{\bm{x}}(\bm{x}_{t}))-h(\bm{x}_{t})</annotation><annotation encoding="application/x-llamapun">italic_h ( overÂ¯ start_ARG bold_italic_x end_ARG ( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ) - italic_h ( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=-\int_{\mathcal{X}}\frac{(p_{t}\circ\bar{\bm{x}}^{-1})(\bm{\xi})}{\det(\bar{\bm{x}}^{\prime}(\bar{\bm{x}}^{-1}(\bm{\xi})))}\log\left(\frac{1}{\det(\bar{\bm{x}}^{\prime}(\bar{\bm{x}}^{-1}(\bm{\xi})))}\right)~{}\mathrm{d}\bm{\xi}" class="ltx_Math" display="inline" id="S2.E25.m2"><semantics><mrow><mi></mi><mo>=</mo><mrow><mo>âˆ’</mo><mrow><mstyle displaystyle="true"><msub><mo>âˆ«</mo><mi class="ltx_font_mathcaligraphic">ğ’³</mi></msub></mstyle><mrow><mstyle displaystyle="true"><mfrac><mrow><mrow><mo stretchy="false">(</mo><mrow><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0.222em" rspace="0.222em">âˆ˜</mo><msup><mover accent="true"><mi>ğ’™</mi><mo>Â¯</mo></mover><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup></mrow><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mrow><mo rspace="0em">det</mo><mrow><mo stretchy="false">(</mo><mrow><msup><mover accent="true"><mi>ğ’™</mi><mo>Â¯</mo></mover><mo>â€²</mo></msup><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><msup><mover accent="true"><mi>ğ’™</mi><mo>Â¯</mo></mover><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mfrac></mstyle><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mi>log</mi><mo>â¡</mo><mrow><mo>(</mo><mstyle displaystyle="true"><mfrac><mn>1</mn><mrow><mo rspace="0em">det</mo><mrow><mo stretchy="false">(</mo><mrow><msup><mover accent="true"><mi>ğ’™</mi><mo>Â¯</mo></mover><mo>â€²</mo></msup><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><msup><mover accent="true"><mi>ğ’™</mi><mo>Â¯</mo></mover><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mfrac></mstyle><mo>)</mo></mrow></mrow><mo lspace="0.330em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><mi>ğƒ</mi></mrow></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=-\int_{\mathcal{X}}\frac{(p_{t}\circ\bar{\bm{x}}^{-1})(\bm{\xi})}{\det(\bar{\bm{x}}^{\prime}(\bar{\bm{x}}^{-1}(\bm{\xi})))}\log\left(\frac{1}{\det(\bar{\bm{x}}^{\prime}(\bar{\bm{x}}^{-1}(\bm{\xi})))}\right)~{}\mathrm{d}\bm{\xi}</annotation><annotation encoding="application/x-llamapun">= - âˆ« start_POSTSUBSCRIPT caligraphic_X end_POSTSUBSCRIPT divide start_ARG ( italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT âˆ˜ overÂ¯ start_ARG bold_italic_x end_ARG start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) ( bold_italic_Î¾ ) end_ARG start_ARG roman_det ( overÂ¯ start_ARG bold_italic_x end_ARG start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT ( overÂ¯ start_ARG bold_italic_x end_ARG start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ( bold_italic_Î¾ ) ) ) end_ARG roman_log ( divide start_ARG 1 end_ARG start_ARG roman_det ( overÂ¯ start_ARG bold_italic_x end_ARG start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT ( overÂ¯ start_ARG bold_italic_x end_ARG start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ( bold_italic_Î¾ ) ) ) end_ARG ) roman_d bold_italic_Î¾</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.25)</span></td>
</tr></tbody>
<tbody id="S2.E26"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\leq\int_{\mathcal{X}}(p_{t}\circ\bar{\bm{x}}^{-1})(\bm{\xi})\cdot\left(1-\frac{1}{\det(\bar{\bm{x}}^{\prime}(\bar{\bm{x}}^{-1}(\bm{\xi})))}\right)~{}\mathrm{d}\bm{\xi}" class="ltx_Math" display="inline" id="S2.E26.m1"><semantics><mrow><mi></mi><mo>â‰¤</mo><mrow><mstyle displaystyle="true"><msub><mo>âˆ«</mo><mi class="ltx_font_mathcaligraphic">ğ’³</mi></msub></mstyle><mrow><mrow><mrow><mrow><mo stretchy="false">(</mo><mrow><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0.222em" rspace="0.222em">âˆ˜</mo><msup><mover accent="true"><mi>ğ’™</mi><mo>Â¯</mo></mover><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup></mrow><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo rspace="0.055em" stretchy="false">)</mo></mrow></mrow><mo rspace="0.222em">â‹…</mo><mrow><mo>(</mo><mrow><mn>1</mn><mo>âˆ’</mo><mstyle displaystyle="true"><mfrac><mn>1</mn><mrow><mo rspace="0em">det</mo><mrow><mo stretchy="false">(</mo><mrow><msup><mover accent="true"><mi>ğ’™</mi><mo>Â¯</mo></mover><mo>â€²</mo></msup><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><msup><mover accent="true"><mi>ğ’™</mi><mo>Â¯</mo></mover><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mfrac></mstyle></mrow><mo>)</mo></mrow></mrow><mo lspace="0.330em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><mi>ğƒ</mi></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle\leq\int_{\mathcal{X}}(p_{t}\circ\bar{\bm{x}}^{-1})(\bm{\xi})\cdot\left(1-\frac{1}{\det(\bar{\bm{x}}^{\prime}(\bar{\bm{x}}^{-1}(\bm{\xi})))}\right)~{}\mathrm{d}\bm{\xi}</annotation><annotation encoding="application/x-llamapun">â‰¤ âˆ« start_POSTSUBSCRIPT caligraphic_X end_POSTSUBSCRIPT ( italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT âˆ˜ overÂ¯ start_ARG bold_italic_x end_ARG start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) ( bold_italic_Î¾ ) â‹… ( 1 - divide start_ARG 1 end_ARG start_ARG roman_det ( overÂ¯ start_ARG bold_italic_x end_ARG start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT ( overÂ¯ start_ARG bold_italic_x end_ARG start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ( bold_italic_Î¾ ) ) ) end_ARG ) roman_d bold_italic_Î¾</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.26)</span></td>
</tr></tbody>
<tbody id="S2.E27"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\int_{\mathcal{X}}(p_{t}\circ\bar{\bm{x}}^{-1})(\bm{\xi})~{}\mathrm{d}\bm{\xi}-\int_{\mathcal{X}}\frac{(p_{t}\circ\bar{\bm{x}}^{-1})(\bm{\xi})}{\det(\bar{\bm{x}}^{\prime}(\bar{\bm{x}}^{-1}(\bm{\xi})))}~{}\mathrm{d}\bm{\xi}" class="ltx_Math" display="inline" id="S2.E27.m1"><semantics><mrow><mi></mi><mo>=</mo><mrow><mrow><mstyle displaystyle="true"><msub><mo>âˆ«</mo><mi class="ltx_font_mathcaligraphic">ğ’³</mi></msub></mstyle><mrow><mrow><mo stretchy="false">(</mo><mrow><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0.222em" rspace="0.222em">âˆ˜</mo><msup><mover accent="true"><mi>ğ’™</mi><mo>Â¯</mo></mover><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup></mrow><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mo lspace="0.330em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><mi>ğƒ</mi></mrow></mrow></mrow><mo>âˆ’</mo><mrow><mstyle displaystyle="true"><msub><mo>âˆ«</mo><mi class="ltx_font_mathcaligraphic">ğ’³</mi></msub></mstyle><mrow><mstyle displaystyle="true"><mfrac><mrow><mrow><mo stretchy="false">(</mo><mrow><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0.222em" rspace="0.222em">âˆ˜</mo><msup><mover accent="true"><mi>ğ’™</mi><mo>Â¯</mo></mover><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup></mrow><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mrow><mo rspace="0em">det</mo><mrow><mo stretchy="false">(</mo><mrow><msup><mover accent="true"><mi>ğ’™</mi><mo>Â¯</mo></mover><mo>â€²</mo></msup><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><msup><mover accent="true"><mi>ğ’™</mi><mo>Â¯</mo></mover><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mfrac></mstyle><mo lspace="0.330em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><mi>ğƒ</mi></mrow></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=\int_{\mathcal{X}}(p_{t}\circ\bar{\bm{x}}^{-1})(\bm{\xi})~{}\mathrm{d}\bm{\xi}-\int_{\mathcal{X}}\frac{(p_{t}\circ\bar{\bm{x}}^{-1})(\bm{\xi})}{\det(\bar{\bm{x}}^{\prime}(\bar{\bm{x}}^{-1}(\bm{\xi})))}~{}\mathrm{d}\bm{\xi}</annotation><annotation encoding="application/x-llamapun">= âˆ« start_POSTSUBSCRIPT caligraphic_X end_POSTSUBSCRIPT ( italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT âˆ˜ overÂ¯ start_ARG bold_italic_x end_ARG start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) ( bold_italic_Î¾ ) roman_d bold_italic_Î¾ - âˆ« start_POSTSUBSCRIPT caligraphic_X end_POSTSUBSCRIPT divide start_ARG ( italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT âˆ˜ overÂ¯ start_ARG bold_italic_x end_ARG start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ) ( bold_italic_Î¾ ) end_ARG start_ARG roman_det ( overÂ¯ start_ARG bold_italic_x end_ARG start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT ( overÂ¯ start_ARG bold_italic_x end_ARG start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ( bold_italic_Î¾ ) ) ) end_ARG roman_d bold_italic_Î¾</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.27)</span></td>
</tr></tbody>
<tbody id="S2.E28"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\int_{\mathbb{R}^{D}}p_{t}(\bm{\xi})\det\left(\bar{\bm{x}}^{\prime}(\bar{\bm{x}}^{-1}(\bm{\xi}))\right)~{}\mathrm{d}\bm{\xi}-\int_{\mathcal{X}}\bar{p}(\bm{\xi})~{}\mathrm{d}\bm{\xi}" class="ltx_Math" display="inline" id="S2.E28.m1"><semantics><mrow><mi></mi><mo>=</mo><mrow><mrow><mstyle displaystyle="true"><msub><mo>âˆ«</mo><msup><mi>â„</mi><mi>D</mi></msup></msub></mstyle><mrow><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mo movablelimits="false" rspace="0em">det</mo><mrow><mrow><mo>(</mo><mrow><msup><mover accent="true"><mi>ğ’™</mi><mo>Â¯</mo></mover><mo>â€²</mo></msup><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><msup><mover accent="true"><mi>ğ’™</mi><mo>Â¯</mo></mover><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>)</mo></mrow><mo lspace="0.330em" rspace="0em">â€‹</mo><mi mathvariant="normal">d</mi><mo lspace="0em" rspace="0em">â€‹</mo><mi>ğƒ</mi></mrow></mrow></mrow></mrow><mo>âˆ’</mo><mrow><mstyle displaystyle="true"><msub><mo>âˆ«</mo><mi class="ltx_font_mathcaligraphic">ğ’³</mi></msub></mstyle><mrow><mover accent="true"><mi>p</mi><mo>Â¯</mo></mover><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mo lspace="0.330em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><mi>ğƒ</mi></mrow></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=\int_{\mathbb{R}^{D}}p_{t}(\bm{\xi})\det\left(\bar{\bm{x}}^{\prime}(\bar{\bm{x}}^{-1}(\bm{\xi}))\right)~{}\mathrm{d}\bm{\xi}-\int_{\mathcal{X}}\bar{p}(\bm{\xi})~{}\mathrm{d}\bm{\xi}</annotation><annotation encoding="application/x-llamapun">= âˆ« start_POSTSUBSCRIPT blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT end_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) roman_det ( overÂ¯ start_ARG bold_italic_x end_ARG start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT ( overÂ¯ start_ARG bold_italic_x end_ARG start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ( bold_italic_Î¾ ) ) ) roman_d bold_italic_Î¾ - âˆ« start_POSTSUBSCRIPT caligraphic_X end_POSTSUBSCRIPT overÂ¯ start_ARG italic_p end_ARG ( bold_italic_Î¾ ) roman_d bold_italic_Î¾</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.28)</span></td>
</tr></tbody>
<tbody id="S2.E29"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\int_{\mathbb{R}^{D}}p_{t}(\bm{\xi})\det\left(\bm{I}+\left(1-\frac{s}{t}\right)t^{2}\nabla^{2}\log p_{t}(\bm{\xi})\right)~{}\mathrm{d}\bm{\xi}-1." class="ltx_Math" display="inline" id="S2.E29.m1"><semantics><mrow><mrow><mi></mi><mo>=</mo><mrow><mrow><mstyle displaystyle="true"><msub><mo>âˆ«</mo><msup><mi>â„</mi><mi>D</mi></msup></msub></mstyle><mrow><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mo movablelimits="false" rspace="0em">det</mo><mrow><mrow><mo>(</mo><mrow><mi>ğ‘°</mi><mo>+</mo><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>âˆ’</mo><mstyle displaystyle="true"><mfrac><mi>s</mi><mi>t</mi></mfrac></mstyle></mrow><mo>)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>t</mi><mn>2</mn></msup><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mrow><msup><mo rspace="0.167em">âˆ‡</mo><mn>2</mn></msup><mi>log</mi></mrow><mo lspace="0.167em">â¡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>)</mo></mrow><mo lspace="0.330em" rspace="0em">â€‹</mo><mi mathvariant="normal">d</mi><mo lspace="0em" rspace="0em">â€‹</mo><mi>ğƒ</mi></mrow></mrow></mrow></mrow><mo>âˆ’</mo><mn>1</mn></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">\displaystyle=\int_{\mathbb{R}^{D}}p_{t}(\bm{\xi})\det\left(\bm{I}+\left(1-\frac{s}{t}\right)t^{2}\nabla^{2}\log p_{t}(\bm{\xi})\right)~{}\mathrm{d}\bm{\xi}-1.</annotation><annotation encoding="application/x-llamapun">= âˆ« start_POSTSUBSCRIPT blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT end_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) roman_det ( bold_italic_I + ( 1 - divide start_ARG italic_s end_ARG start_ARG italic_t end_ARG ) italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT âˆ‡ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) ) roman_d bold_italic_Î¾ - 1 .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.29)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">Now, by the AM-GM inequality on eigenvalues, we have for any symmetric positive definite matrix <math alttext="\bm{M}\in\mathsf{PSD}(D)" class="ltx_Math" display="inline" id="S2.SS2.p6.m3"><semantics><mrow><mi>ğ‘´</mi><mo>âˆˆ</mo><mrow><mi>ğ–¯ğ–²ğ–£</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>D</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\bm{M}\in\mathsf{PSD}(D)</annotation><annotation encoding="application/x-llamapun">bold_italic_M âˆˆ sansserif_PSD ( italic_D )</annotation></semantics></math> the bound</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E30">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\det(\bm{M})^{1/D}=\prod_{i=1}^{D}\lambda_{i}(\bm{M})^{1/D}\leq\frac{\sum_{i=1}^{D}\lambda_{i}(\bm{M})}{D}=\frac{\operatorname{tr}(\bm{M})}{D}," class="ltx_Math" display="block" id="S2.E30.m1"><semantics><mrow><mrow><mrow><mo movablelimits="false" rspace="0em">det</mo><msup><mrow><mo stretchy="false">(</mo><mi>ğ‘´</mi><mo stretchy="false">)</mo></mrow><mrow><mn>1</mn><mo>/</mo><mi>D</mi></mrow></msup></mrow><mo rspace="0.111em">=</mo><mrow><munderover><mo movablelimits="false">âˆ</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>D</mi></munderover><mrow><msub><mi>Î»</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><msup><mrow><mo stretchy="false">(</mo><mi>ğ‘´</mi><mo stretchy="false">)</mo></mrow><mrow><mn>1</mn><mo>/</mo><mi>D</mi></mrow></msup></mrow></mrow><mo>â‰¤</mo><mfrac><mrow><msubsup><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>D</mi></msubsup><mrow><msub><mi>Î»</mi><mi>i</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğ‘´</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mi>D</mi></mfrac><mo>=</mo><mfrac><mrow><mi>tr</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><mi>ğ‘´</mi><mo stretchy="false">)</mo></mrow></mrow><mi>D</mi></mfrac></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">\det(\bm{M})^{1/D}=\prod_{i=1}^{D}\lambda_{i}(\bm{M})^{1/D}\leq\frac{\sum_{i=1}^{D}\lambda_{i}(\bm{M})}{D}=\frac{\operatorname{tr}(\bm{M})}{D},</annotation><annotation encoding="application/x-llamapun">roman_det ( bold_italic_M ) start_POSTSUPERSCRIPT 1 / italic_D end_POSTSUPERSCRIPT = âˆ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT italic_Î» start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( bold_italic_M ) start_POSTSUPERSCRIPT 1 / italic_D end_POSTSUPERSCRIPT â‰¤ divide start_ARG âˆ‘ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT italic_Î» start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( bold_italic_M ) end_ARG start_ARG italic_D end_ARG = divide start_ARG roman_tr ( bold_italic_M ) end_ARG start_ARG italic_D end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.30)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">which we can apply to the above expression and obtain</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S3.EGx131">
<tbody id="S2.E31"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\int_{\mathbb{R}^{D}}p_{t}(\bm{\xi})\det\left(\bm{I}+\left(1-\frac{s}{t}\right)t^{2}\nabla^{2}\log p_{t}(\bm{\xi})\right)~{}\mathrm{d}\bm{\xi}" class="ltx_Math" display="inline" id="S2.E31.m1"><semantics><mrow><mstyle displaystyle="true"><msub><mo>âˆ«</mo><msup><mi>â„</mi><mi>D</mi></msup></msub></mstyle><mrow><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mo movablelimits="false" rspace="0em">det</mo><mrow><mrow><mo>(</mo><mrow><mi>ğ‘°</mi><mo>+</mo><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>âˆ’</mo><mstyle displaystyle="true"><mfrac><mi>s</mi><mi>t</mi></mfrac></mstyle></mrow><mo>)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>t</mi><mn>2</mn></msup><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mrow><msup><mo rspace="0.167em">âˆ‡</mo><mn>2</mn></msup><mi>log</mi></mrow><mo lspace="0.167em">â¡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>)</mo></mrow><mo lspace="0.330em" rspace="0em">â€‹</mo><mi mathvariant="normal">d</mi><mo lspace="0em" rspace="0em">â€‹</mo><mi>ğƒ</mi></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle\int_{\mathbb{R}^{D}}p_{t}(\bm{\xi})\det\left(\bm{I}+\left(1-\frac{s}{t}\right)t^{2}\nabla^{2}\log p_{t}(\bm{\xi})\right)~{}\mathrm{d}\bm{\xi}</annotation><annotation encoding="application/x-llamapun">âˆ« start_POSTSUBSCRIPT blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT end_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) roman_det ( bold_italic_I + ( 1 - divide start_ARG italic_s end_ARG start_ARG italic_t end_ARG ) italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT âˆ‡ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) ) roman_d bold_italic_Î¾</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.31)</span></td>
</tr></tbody>
<tbody id="S2.E32"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\leq\int_{\mathbb{R}^{D}}p_{t}(\bm{\xi})\operatorname{tr}\left(\frac{1}{D}\left[\bm{I}+\left(1-\frac{s}{t}\right)t^{2}\nabla^{2}\log p_{t}(\bm{\xi})\right]\right)^{D}~{}\mathrm{d}\bm{\xi}" class="ltx_math_unparsed" display="inline" id="S2.E32.m1"><semantics><mrow><mo>â‰¤</mo><mstyle displaystyle="true"><msub><mo>âˆ«</mo><msup><mi>â„</mi><mi>D</mi></msup></msub></mstyle><msub><mi>p</mi><mi>t</mi></msub><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo rspace="0.167em" stretchy="false">)</mo></mrow><mi>tr</mi><msup><mrow><mo>(</mo><mstyle displaystyle="true"><mfrac><mn>1</mn><mi>D</mi></mfrac></mstyle><mrow><mo>[</mo><mi>ğ‘°</mi><mo>+</mo><mrow><mo>(</mo><mn>1</mn><mo>âˆ’</mo><mstyle displaystyle="true"><mfrac><mi>s</mi><mi>t</mi></mfrac></mstyle><mo>)</mo></mrow><msup><mi>t</mi><mn>2</mn></msup><msup><mo lspace="0.167em" rspace="0.167em">âˆ‡</mo><mn>2</mn></msup><mi>log</mi><msub><mi>p</mi><mi>t</mi></msub><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mo>]</mo></mrow><mo>)</mo></mrow><mi>D</mi></msup><mi mathvariant="normal">d</mi><mi>ğƒ</mi></mrow><annotation encoding="application/x-tex">\displaystyle\leq\int_{\mathbb{R}^{D}}p_{t}(\bm{\xi})\operatorname{tr}\left(\frac{1}{D}\left[\bm{I}+\left(1-\frac{s}{t}\right)t^{2}\nabla^{2}\log p_{t}(\bm{\xi})\right]\right)^{D}~{}\mathrm{d}\bm{\xi}</annotation><annotation encoding="application/x-llamapun">â‰¤ âˆ« start_POSTSUBSCRIPT blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT end_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) roman_tr ( divide start_ARG 1 end_ARG start_ARG italic_D end_ARG [ bold_italic_I + ( 1 - divide start_ARG italic_s end_ARG start_ARG italic_t end_ARG ) italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT âˆ‡ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) ] ) start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT roman_d bold_italic_Î¾</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.32)</span></td>
</tr></tbody>
<tbody id="S2.E33"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\int_{\mathbb{R}^{D}}p_{t}(\bm{\xi})\left(1+\frac{\left(1-\frac{s}{t}\right)t^{2}}{D}\operatorname{tr}(\nabla^{2}\log p_{t}(\bm{\xi}))\right)^{D}~{}\mathrm{d}\bm{\xi}" class="ltx_Math" display="inline" id="S2.E33.m1"><semantics><mrow><mi></mi><mo>=</mo><mrow><mstyle displaystyle="true"><msub><mo>âˆ«</mo><msup><mi>â„</mi><mi>D</mi></msup></msub></mstyle><mrow><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><msup><mrow><mo>(</mo><mrow><mn>1</mn><mo>+</mo><mrow><mstyle displaystyle="true"><mfrac><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>âˆ’</mo><mfrac><mi>s</mi><mi>t</mi></mfrac></mrow><mo>)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>t</mi><mn>2</mn></msup></mrow><mi>D</mi></mfrac></mstyle><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mi>tr</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><mrow><mrow><mrow><msup><mo rspace="0.167em">âˆ‡</mo><mn>2</mn></msup><mi>log</mi></mrow><mo lspace="0.167em">â¡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow><mo>)</mo></mrow><mi>D</mi></msup><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><mi>ğƒ</mi></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=\int_{\mathbb{R}^{D}}p_{t}(\bm{\xi})\left(1+\frac{\left(1-\frac{s}{t}\right)t^{2}}{D}\operatorname{tr}(\nabla^{2}\log p_{t}(\bm{\xi}))\right)^{D}~{}\mathrm{d}\bm{\xi}</annotation><annotation encoding="application/x-llamapun">= âˆ« start_POSTSUBSCRIPT blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT end_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) ( 1 + divide start_ARG ( 1 - divide start_ARG italic_s end_ARG start_ARG italic_t end_ARG ) italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG italic_D end_ARG roman_tr ( âˆ‡ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) ) ) start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT roman_d bold_italic_Î¾</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.33)</span></td>
</tr></tbody>
<tbody id="S2.E34"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\int_{\mathbb{R}^{D}}p_{t}(\bm{\xi})\left(1+\frac{\left(1-\frac{s}{t}\right)t^{2}}{D}\Delta\log p_{t}(\bm{\xi})\right)^{D}~{}\mathrm{d}\bm{\xi}." class="ltx_Math" display="inline" id="S2.E34.m1"><semantics><mrow><mrow><mi></mi><mo>=</mo><mrow><mstyle displaystyle="true"><msub><mo>âˆ«</mo><msup><mi>â„</mi><mi>D</mi></msup></msub></mstyle><mrow><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><msup><mrow><mo>(</mo><mrow><mn>1</mn><mo>+</mo><mrow><mstyle displaystyle="true"><mfrac><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>âˆ’</mo><mfrac><mi>s</mi><mi>t</mi></mfrac></mrow><mo>)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>t</mi><mn>2</mn></msup></mrow><mi>D</mi></mfrac></mstyle><mo lspace="0em" rspace="0em">â€‹</mo><mi mathvariant="normal">Î”</mi><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mi>log</mi><mo lspace="0.167em">â¡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>)</mo></mrow><mi>D</mi></msup><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><mi>ğƒ</mi></mrow></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">\displaystyle=\int_{\mathbb{R}^{D}}p_{t}(\bm{\xi})\left(1+\frac{\left(1-\frac{s}{t}\right)t^{2}}{D}\Delta\log p_{t}(\bm{\xi})\right)^{D}~{}\mathrm{d}\bm{\xi}.</annotation><annotation encoding="application/x-llamapun">= âˆ« start_POSTSUBSCRIPT blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT end_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) ( 1 + divide start_ARG ( 1 - divide start_ARG italic_s end_ARG start_ARG italic_t end_ARG ) italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG italic_D end_ARG roman_Î” roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) ) start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT roman_d bold_italic_Î¾ .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.34)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">From <a class="ltx_ref" href="#Thmlemma5" title="Lemma B.5. â€£ Controlling the Laplacian Î”â¢log{ğ‘_ğ‘¡} â€£ B.2.3 Technical Lemmas and Intermediate Results â€£ B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Lemma</span>Â <span class="ltx_text ltx_ref_tag">B.5</span></a>, it holds (where, recall, <math alttext="R" class="ltx_Math" display="inline" id="S2.SS2.p6.m4"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation><annotation encoding="application/x-llamapun">italic_R</annotation></semantics></math> is the radius of the support of <math alttext="\bm{x}" class="ltx_Math" display="inline" id="S2.SS2.p6.m5"><semantics><mi>ğ’™</mi><annotation encoding="application/x-tex">\bm{x}</annotation><annotation encoding="application/x-llamapun">bold_italic_x</annotation></semantics></math> as in <a class="ltx_ref" href="#Thmassumption1" title="Assumption B.1. â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Assumption</span>Â <span class="ltx_text ltx_ref_tag">B.1</span></a>)</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E35">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\lvert\Delta\log p_{t}(\bm{\xi})\rvert\leq\max\left(\frac{D}{t^{2}},\left\lvert\frac{R^{2}}{t^{4}}-\frac{D}{t^{2}}\right\rvert\right)=:U_{t}." class="ltx_math_unparsed" display="block" id="S2.E35.m1"><semantics><mrow><mrow><mo stretchy="false">|</mo><mi mathvariant="normal">Î”</mi><mi>log</mi><msub><mi>p</mi><mi>t</mi></msub><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mo stretchy="false">|</mo></mrow><mo>â‰¤</mo><mi>max</mi><mrow><mo>(</mo><mfrac><mi>D</mi><msup><mi>t</mi><mn>2</mn></msup></mfrac><mo>,</mo><mrow><mo>|</mo><mfrac><msup><mi>R</mi><mn>2</mn></msup><msup><mi>t</mi><mn>4</mn></msup></mfrac><mo>âˆ’</mo><mfrac><mi>D</mi><msup><mi>t</mi><mn>2</mn></msup></mfrac><mo>|</mo></mrow><mo>)</mo></mrow><mo rspace="0em">=</mo><mo rspace="0.278em">:</mo><msub><mi>U</mi><mi>t</mi></msub><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">\lvert\Delta\log p_{t}(\bm{\xi})\rvert\leq\max\left(\frac{D}{t^{2}},\left\lvert\frac{R^{2}}{t^{4}}-\frac{D}{t^{2}}\right\rvert\right)=:U_{t}.</annotation><annotation encoding="application/x-llamapun">| roman_Î” roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) | â‰¤ roman_max ( divide start_ARG italic_D end_ARG start_ARG italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG , | divide start_ARG italic_R start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG italic_t start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT end_ARG - divide start_ARG italic_D end_ARG start_ARG italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG | ) = : italic_U start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.35)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">Then it holds</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E36">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="-\frac{\left(1-\frac{s}{t}\right)t^{2}}{D}U_{t}\leq\frac{\left(1-\frac{s}{t}\right)t^{2}}{D}\Delta\log p_{t}(\bm{\xi})\leq\frac{\left(1-\frac{s}{t}\right)t^{2}}{D}U_{t}." class="ltx_Math" display="block" id="S2.E36.m1"><semantics><mrow><mrow><mrow><mo>âˆ’</mo><mrow><mfrac><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>âˆ’</mo><mfrac><mi>s</mi><mi>t</mi></mfrac></mrow><mo>)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>t</mi><mn>2</mn></msup></mrow><mi>D</mi></mfrac><mo lspace="0em" rspace="0em">â€‹</mo><msub><mi>U</mi><mi>t</mi></msub></mrow></mrow><mo>â‰¤</mo><mrow><mfrac><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>âˆ’</mo><mfrac><mi>s</mi><mi>t</mi></mfrac></mrow><mo>)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>t</mi><mn>2</mn></msup></mrow><mi>D</mi></mfrac><mo lspace="0em" rspace="0em">â€‹</mo><mi mathvariant="normal">Î”</mi><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mi>log</mi><mo lspace="0.167em">â¡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>â‰¤</mo><mrow><mfrac><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>âˆ’</mo><mfrac><mi>s</mi><mi>t</mi></mfrac></mrow><mo>)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>t</mi><mn>2</mn></msup></mrow><mi>D</mi></mfrac><mo lspace="0em" rspace="0em">â€‹</mo><msub><mi>U</mi><mi>t</mi></msub></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">-\frac{\left(1-\frac{s}{t}\right)t^{2}}{D}U_{t}\leq\frac{\left(1-\frac{s}{t}\right)t^{2}}{D}\Delta\log p_{t}(\bm{\xi})\leq\frac{\left(1-\frac{s}{t}\right)t^{2}}{D}U_{t}.</annotation><annotation encoding="application/x-llamapun">- divide start_ARG ( 1 - divide start_ARG italic_s end_ARG start_ARG italic_t end_ARG ) italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG italic_D end_ARG italic_U start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT â‰¤ divide start_ARG ( 1 - divide start_ARG italic_s end_ARG start_ARG italic_t end_ARG ) italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG italic_D end_ARG roman_Î” roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) â‰¤ divide start_ARG ( 1 - divide start_ARG italic_s end_ARG start_ARG italic_t end_ARG ) italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG italic_D end_ARG italic_U start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.36)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">Meanwhile, the function <math alttext="x\mapsto(1+x)^{D}" class="ltx_Math" display="inline" id="S2.SS2.p6.m6"><semantics><mrow><mi>x</mi><mo stretchy="false">â†¦</mo><msup><mrow><mo stretchy="false">(</mo><mrow><mn>1</mn><mo>+</mo><mi>x</mi></mrow><mo stretchy="false">)</mo></mrow><mi>D</mi></msup></mrow><annotation encoding="application/x-tex">x\mapsto(1+x)^{D}</annotation><annotation encoding="application/x-llamapun">italic_x â†¦ ( 1 + italic_x ) start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT</annotation></semantics></math> is convex on <math alttext="[-1,\infty)" class="ltx_Math" display="inline" id="S2.SS2.p6.m7"><semantics><mrow><mo stretchy="false">[</mo><mrow><mo>âˆ’</mo><mn>1</mn></mrow><mo>,</mo><mi mathvariant="normal">âˆ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">[-1,\infty)</annotation><annotation encoding="application/x-llamapun">[ - 1 , âˆ )</annotation></semantics></math>, so for
<math alttext="-(1-s/t)t^{2}U_{t}/D\leq x\leq(1-s/t)t^{2}U_{t}/D" class="ltx_Math" display="inline" id="S2.SS2.p6.m8"><semantics><mrow><mrow><mo>âˆ’</mo><mrow><mrow><mrow><mo stretchy="false">(</mo><mrow><mn>1</mn><mo>âˆ’</mo><mrow><mi>s</mi><mo>/</mo><mi>t</mi></mrow></mrow><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>t</mi><mn>2</mn></msup><mo lspace="0em" rspace="0em">â€‹</mo><msub><mi>U</mi><mi>t</mi></msub></mrow><mo>/</mo><mi>D</mi></mrow></mrow><mo>â‰¤</mo><mi>x</mi><mo>â‰¤</mo><mrow><mrow><mrow><mo stretchy="false">(</mo><mrow><mn>1</mn><mo>âˆ’</mo><mrow><mi>s</mi><mo>/</mo><mi>t</mi></mrow></mrow><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>t</mi><mn>2</mn></msup><mo lspace="0em" rspace="0em">â€‹</mo><msub><mi>U</mi><mi>t</mi></msub></mrow><mo>/</mo><mi>D</mi></mrow></mrow><annotation encoding="application/x-tex">-(1-s/t)t^{2}U_{t}/D\leq x\leq(1-s/t)t^{2}U_{t}/D</annotation><annotation encoding="application/x-llamapun">- ( 1 - italic_s / italic_t ) italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_U start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT / italic_D â‰¤ italic_x â‰¤ ( 1 - italic_s / italic_t ) italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_U start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT / italic_D</annotation></semantics></math> we have</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S3.EGx132">
<tbody id="S2.E37"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle(1+x)^{d}" class="ltx_Math" display="inline" id="S2.E37.m1"><semantics><msup><mrow><mo stretchy="false">(</mo><mrow><mn>1</mn><mo>+</mo><mi>x</mi></mrow><mo stretchy="false">)</mo></mrow><mi>d</mi></msup><annotation encoding="application/x-tex">\displaystyle(1+x)^{d}</annotation><annotation encoding="application/x-llamapun">( 1 + italic_x ) start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\leq\left(1-\frac{\left(1-\frac{s}{t}\right)t^{2}U_{t}}{D}\right)^{D}+\underbrace{\left[\left(1+\frac{\left(1-\frac{s}{t}\right)t^{2}U_{t}}{D}\right)^{D}-\left(1-\frac{\left(1-\frac{s}{t}\right)t^{2}U_{t}}{D}\right)^{D}\right]}_{M(s,t,D)}x" class="ltx_Math" display="inline" id="S2.E37.m2"><semantics><mrow><mi></mi><mo>â‰¤</mo><mrow><msup><mrow><mo>(</mo><mrow><mn>1</mn><mo>âˆ’</mo><mstyle displaystyle="true"><mfrac><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>âˆ’</mo><mfrac><mi>s</mi><mi>t</mi></mfrac></mrow><mo>)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>t</mi><mn>2</mn></msup><mo lspace="0em" rspace="0em">â€‹</mo><msub><mi>U</mi><mi>t</mi></msub></mrow><mi>D</mi></mfrac></mstyle></mrow><mo>)</mo></mrow><mi>D</mi></msup><mo>+</mo><mrow><munder><munder accentunder="true"><mrow><mo>[</mo><mrow><msup><mrow><mo>(</mo><mrow><mn>1</mn><mo>+</mo><mstyle displaystyle="true"><mfrac><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>âˆ’</mo><mfrac><mi>s</mi><mi>t</mi></mfrac></mrow><mo>)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>t</mi><mn>2</mn></msup><mo lspace="0em" rspace="0em">â€‹</mo><msub><mi>U</mi><mi>t</mi></msub></mrow><mi>D</mi></mfrac></mstyle></mrow><mo>)</mo></mrow><mi>D</mi></msup><mo>âˆ’</mo><msup><mrow><mo>(</mo><mrow><mn>1</mn><mo>âˆ’</mo><mstyle displaystyle="true"><mfrac><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>âˆ’</mo><mfrac><mi>s</mi><mi>t</mi></mfrac></mrow><mo>)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>t</mi><mn>2</mn></msup><mo lspace="0em" rspace="0em">â€‹</mo><msub><mi>U</mi><mi>t</mi></msub></mrow><mi>D</mi></mfrac></mstyle></mrow><mo>)</mo></mrow><mi>D</mi></msup></mrow><mo>]</mo></mrow><mo>âŸ</mo></munder><mrow><mi>M</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>D</mi><mo stretchy="false">)</mo></mrow></mrow></munder><mo lspace="0em" rspace="0em">â€‹</mo><mi>x</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle\leq\left(1-\frac{\left(1-\frac{s}{t}\right)t^{2}U_{t}}{D}\right)^{D}+\underbrace{\left[\left(1+\frac{\left(1-\frac{s}{t}\right)t^{2}U_{t}}{D}\right)^{D}-\left(1-\frac{\left(1-\frac{s}{t}\right)t^{2}U_{t}}{D}\right)^{D}\right]}_{M(s,t,D)}x</annotation><annotation encoding="application/x-llamapun">â‰¤ ( 1 - divide start_ARG ( 1 - divide start_ARG italic_s end_ARG start_ARG italic_t end_ARG ) italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_U start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG start_ARG italic_D end_ARG ) start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT + underâŸ start_ARG [ ( 1 + divide start_ARG ( 1 - divide start_ARG italic_s end_ARG start_ARG italic_t end_ARG ) italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_U start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG start_ARG italic_D end_ARG ) start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT - ( 1 - divide start_ARG ( 1 - divide start_ARG italic_s end_ARG start_ARG italic_t end_ARG ) italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_U start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG start_ARG italic_D end_ARG ) start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT ] end_ARG start_POSTSUBSCRIPT italic_M ( italic_s , italic_t , italic_D ) end_POSTSUBSCRIPT italic_x</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.37)</span></td>
</tr></tbody>
<tbody id="S2.E38"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\leq 1+M(s,t,D)x." class="ltx_Math" display="inline" id="S2.E38.m1"><semantics><mrow><mrow><mi></mi><mo>â‰¤</mo><mrow><mn>1</mn><mo>+</mo><mrow><mi>M</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>D</mi><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mi>x</mi></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">\displaystyle\leq 1+M(s,t,D)x.</annotation><annotation encoding="application/x-llamapun">â‰¤ 1 + italic_M ( italic_s , italic_t , italic_D ) italic_x .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.38)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">Here <math alttext="M(s,t,D)&gt;0" class="ltx_Math" display="inline" id="S2.SS2.p6.m9"><semantics><mrow><mrow><mi>M</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>D</mi><mo stretchy="false">)</mo></mrow></mrow><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">M(s,t,D)&gt;0</annotation><annotation encoding="application/x-llamapun">italic_M ( italic_s , italic_t , italic_D ) &gt; 0</annotation></semantics></math> since <math alttext="U_{t}&gt;0" class="ltx_Math" display="inline" id="S2.SS2.p6.m10"><semantics><mrow><msub><mi>U</mi><mi>t</mi></msub><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">U_{t}&gt;0</annotation><annotation encoding="application/x-llamapun">italic_U start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT &gt; 0</annotation></semantics></math>. In the above bound, we need to verify that the lower bound for <math alttext="x" class="ltx_Math" display="inline" id="S2.SS2.p6.m11"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation><annotation encoding="application/x-llamapun">italic_x</annotation></semantics></math> is <math alttext="\geq-1" class="ltx_Math" display="inline" id="S2.SS2.p6.m12"><semantics><mrow><mi></mi><mo>â‰¥</mo><mrow><mo>âˆ’</mo><mn>1</mn></mrow></mrow><annotation encoding="application/x-tex">\geq-1</annotation><annotation encoding="application/x-llamapun">â‰¥ - 1</annotation></semantics></math>. Indeed,</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S3.EGx133">
<tbody id="S2.E39"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle-\frac{\left(1-\frac{s}{t}\right)t^{2}}{D}U_{t}" class="ltx_Math" display="inline" id="S2.E39.m1"><semantics><mrow><mo>âˆ’</mo><mrow><mstyle displaystyle="true"><mfrac><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>âˆ’</mo><mfrac><mi>s</mi><mi>t</mi></mfrac></mrow><mo>)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>t</mi><mn>2</mn></msup></mrow><mi>D</mi></mfrac></mstyle><mo lspace="0em" rspace="0em">â€‹</mo><msub><mi>U</mi><mi>t</mi></msub></mrow></mrow><annotation encoding="application/x-tex">\displaystyle-\frac{\left(1-\frac{s}{t}\right)t^{2}}{D}U_{t}</annotation><annotation encoding="application/x-llamapun">- divide start_ARG ( 1 - divide start_ARG italic_s end_ARG start_ARG italic_t end_ARG ) italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG italic_D end_ARG italic_U start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=-\frac{\left(1-\frac{s}{t}\right)t^{2}}{D}\max\left(\frac{D}{t^{2}},\left\lvert\frac{R^{2}}{t^{4}}-\frac{D}{t^{2}}\right\rvert\right)" class="ltx_Math" display="inline" id="S2.E39.m2"><semantics><mrow><mi></mi><mo>=</mo><mrow><mo>âˆ’</mo><mrow><mstyle displaystyle="true"><mfrac><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>âˆ’</mo><mfrac><mi>s</mi><mi>t</mi></mfrac></mrow><mo>)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>t</mi><mn>2</mn></msup></mrow><mi>D</mi></mfrac></mstyle><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mi>max</mi><mo>â¡</mo><mrow><mo>(</mo><mstyle displaystyle="true"><mfrac><mi>D</mi><msup><mi>t</mi><mn>2</mn></msup></mfrac></mstyle><mo>,</mo><mrow><mo>|</mo><mrow><mstyle displaystyle="true"><mfrac><msup><mi>R</mi><mn>2</mn></msup><msup><mi>t</mi><mn>4</mn></msup></mfrac></mstyle><mo>âˆ’</mo><mstyle displaystyle="true"><mfrac><mi>D</mi><msup><mi>t</mi><mn>2</mn></msup></mfrac></mstyle></mrow><mo>|</mo></mrow><mo>)</mo></mrow></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=-\frac{\left(1-\frac{s}{t}\right)t^{2}}{D}\max\left(\frac{D}{t^{2}},\left\lvert\frac{R^{2}}{t^{4}}-\frac{D}{t^{2}}\right\rvert\right)</annotation><annotation encoding="application/x-llamapun">= - divide start_ARG ( 1 - divide start_ARG italic_s end_ARG start_ARG italic_t end_ARG ) italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG italic_D end_ARG roman_max ( divide start_ARG italic_D end_ARG start_ARG italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG , | divide start_ARG italic_R start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG italic_t start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT end_ARG - divide start_ARG italic_D end_ARG start_ARG italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG | )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.39)</span></td>
</tr></tbody>
<tbody id="S2.E40"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=-\left(1-\frac{s}{t}\right)\max\left(1,\left\lvert\frac{R^{2}}{Dt^{2}}-1\right\rvert\right)" class="ltx_Math" display="inline" id="S2.E40.m1"><semantics><mrow><mi></mi><mo>=</mo><mrow><mo>âˆ’</mo><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>âˆ’</mo><mstyle displaystyle="true"><mfrac><mi>s</mi><mi>t</mi></mfrac></mstyle></mrow><mo>)</mo></mrow><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mi>max</mi><mo>â¡</mo><mrow><mo>(</mo><mn>1</mn><mo>,</mo><mrow><mo>|</mo><mrow><mstyle displaystyle="true"><mfrac><msup><mi>R</mi><mn>2</mn></msup><mrow><mi>D</mi><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>t</mi><mn>2</mn></msup></mrow></mfrac></mstyle><mo>âˆ’</mo><mn>1</mn></mrow><mo>|</mo></mrow><mo>)</mo></mrow></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=-\left(1-\frac{s}{t}\right)\max\left(1,\left\lvert\frac{R^{2}}{Dt^{2}}-1\right\rvert\right)</annotation><annotation encoding="application/x-llamapun">= - ( 1 - divide start_ARG italic_s end_ARG start_ARG italic_t end_ARG ) roman_max ( 1 , | divide start_ARG italic_R start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG italic_D italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG - 1 | )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.40)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">Notice that this is <math alttext="\geq-1" class="ltx_Math" display="inline" id="S2.SS2.p6.m13"><semantics><mrow><mi></mi><mo>â‰¥</mo><mrow><mo>âˆ’</mo><mn>1</mn></mrow></mrow><annotation encoding="application/x-tex">\geq-1</annotation><annotation encoding="application/x-llamapun">â‰¥ - 1</annotation></semantics></math> if and only if <math alttext="\left(1-\frac{s}{t}\right)\cdot\left(\frac{R^{2}}{Dt^{2}}-1\right)\geq 1" class="ltx_Math" display="inline" id="S2.SS2.p6.m14"><semantics><mrow><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>âˆ’</mo><mfrac><mi>s</mi><mi>t</mi></mfrac></mrow><mo rspace="0.055em">)</mo></mrow><mo rspace="0.222em">â‹…</mo><mrow><mo>(</mo><mrow><mfrac><msup><mi>R</mi><mn>2</mn></msup><mrow><mi>D</mi><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>t</mi><mn>2</mn></msup></mrow></mfrac><mo>âˆ’</mo><mn>1</mn></mrow><mo>)</mo></mrow></mrow><mo>â‰¥</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\left(1-\frac{s}{t}\right)\cdot\left(\frac{R^{2}}{Dt^{2}}-1\right)\geq 1</annotation><annotation encoding="application/x-llamapun">( 1 - divide start_ARG italic_s end_ARG start_ARG italic_t end_ARG ) â‹… ( divide start_ARG italic_R start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG italic_D italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG - 1 ) â‰¥ 1</annotation></semantics></math>, i.e., <math alttext="0&lt;t&lt;R/\sqrt{2D}" class="ltx_Math" display="inline" id="S2.SS2.p6.m15"><semantics><mrow><mn>0</mn><mo>&lt;</mo><mi>t</mi><mo>&lt;</mo><mrow><mi>R</mi><mo>/</mo><msqrt><mrow><mn>2</mn><mo lspace="0em" rspace="0em">â€‹</mo><mi>D</mi></mrow></msqrt></mrow></mrow><annotation encoding="application/x-tex">0&lt;t&lt;R/\sqrt{2D}</annotation><annotation encoding="application/x-llamapun">0 &lt; italic_t &lt; italic_R / square-root start_ARG 2 italic_D end_ARG</annotation></semantics></math> and <math alttext="0\leq s\leq t\cdot\frac{R^{2}/D-2t^{2}}{R^{2}/D-t^{2}}" class="ltx_Math" display="inline" id="S2.SS2.p6.m16"><semantics><mrow><mn>0</mn><mo>â‰¤</mo><mi>s</mi><mo>â‰¤</mo><mrow><mi>t</mi><mo lspace="0.222em" rspace="0.222em">â‹…</mo><mfrac><mrow><mrow><msup><mi>R</mi><mn>2</mn></msup><mo>/</mo><mi>D</mi></mrow><mo>âˆ’</mo><mrow><mn>2</mn><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>t</mi><mn>2</mn></msup></mrow></mrow><mrow><mrow><msup><mi>R</mi><mn>2</mn></msup><mo>/</mo><mi>D</mi></mrow><mo>âˆ’</mo><msup><mi>t</mi><mn>2</mn></msup></mrow></mfrac></mrow></mrow><annotation encoding="application/x-tex">0\leq s\leq t\cdot\frac{R^{2}/D-2t^{2}}{R^{2}/D-t^{2}}</annotation><annotation encoding="application/x-llamapun">0 â‰¤ italic_s â‰¤ italic_t â‹… divide start_ARG italic_R start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT / italic_D - 2 italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG italic_R start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT / italic_D - italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math>, as granted by the assumptions.</p>
</div>
<div class="ltx_para" id="S2.SS2.p7">
<p class="ltx_p">Applying this bound, we obtain</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S3.EGx134">
<tbody id="S2.E41"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\int_{\mathbb{R}^{D}}p_{t}(\bm{\xi})\left(1+\frac{\left(1-\frac{s}{t}\right)t^{2}}{D}\Delta\log p_{t}(\bm{\xi})\right)^{D}~{}\mathrm{d}\bm{\xi}" class="ltx_Math" display="inline" id="S2.E41.m1"><semantics><mrow><mstyle displaystyle="true"><msub><mo>âˆ«</mo><msup><mi>â„</mi><mi>D</mi></msup></msub></mstyle><mrow><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><msup><mrow><mo>(</mo><mrow><mn>1</mn><mo>+</mo><mrow><mstyle displaystyle="true"><mfrac><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>âˆ’</mo><mfrac><mi>s</mi><mi>t</mi></mfrac></mrow><mo>)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>t</mi><mn>2</mn></msup></mrow><mi>D</mi></mfrac></mstyle><mo lspace="0em" rspace="0em">â€‹</mo><mi mathvariant="normal">Î”</mi><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mi>log</mi><mo lspace="0.167em">â¡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>)</mo></mrow><mi>D</mi></msup><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><mi>ğƒ</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle\int_{\mathbb{R}^{D}}p_{t}(\bm{\xi})\left(1+\frac{\left(1-\frac{s}{t}\right)t^{2}}{D}\Delta\log p_{t}(\bm{\xi})\right)^{D}~{}\mathrm{d}\bm{\xi}</annotation><annotation encoding="application/x-llamapun">âˆ« start_POSTSUBSCRIPT blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT end_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) ( 1 + divide start_ARG ( 1 - divide start_ARG italic_s end_ARG start_ARG italic_t end_ARG ) italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG italic_D end_ARG roman_Î” roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) ) start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT roman_d bold_italic_Î¾</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.41)</span></td>
</tr></tbody>
<tbody id="S2.E42"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\leq\int_{\mathbb{R}^{D}}p_{t}(\bm{\xi})\left(1+M(s,t,D)\Delta\log p_{t}(\bm{\xi})\right)~{}\mathrm{d}\bm{\xi}" class="ltx_Math" display="inline" id="S2.E42.m1"><semantics><mrow><mi></mi><mo>â‰¤</mo><mrow><mstyle displaystyle="true"><msub><mo>âˆ«</mo><msup><mi>â„</mi><mi>D</mi></msup></msub></mstyle><mrow><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo>(</mo><mrow><mn>1</mn><mo>+</mo><mrow><mi>M</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>D</mi><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mi mathvariant="normal">Î”</mi><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mi>log</mi><mo lspace="0.167em">â¡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>)</mo></mrow><mo lspace="0.330em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><mi>ğƒ</mi></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle\leq\int_{\mathbb{R}^{D}}p_{t}(\bm{\xi})\left(1+M(s,t,D)\Delta\log p_{t}(\bm{\xi})\right)~{}\mathrm{d}\bm{\xi}</annotation><annotation encoding="application/x-llamapun">â‰¤ âˆ« start_POSTSUBSCRIPT blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT end_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) ( 1 + italic_M ( italic_s , italic_t , italic_D ) roman_Î” roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) ) roman_d bold_italic_Î¾</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.42)</span></td>
</tr></tbody>
<tbody id="S2.E43"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=1+M(s,t,D)\int_{\mathbb{R}^{D}}p_{t}(\bm{\xi})\Delta\log p_{t}(\bm{\xi})~{}\mathrm{d}\bm{\xi}" class="ltx_Math" display="inline" id="S2.E43.m1"><semantics><mrow><mi></mi><mo>=</mo><mrow><mn>1</mn><mo>+</mo><mrow><mi>M</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>D</mi><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mstyle displaystyle="true"><msub><mo>âˆ«</mo><msup><mi>â„</mi><mi>D</mi></msup></msub></mstyle><mrow><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mi mathvariant="normal">Î”</mi><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mi>log</mi><mo lspace="0.167em">â¡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mo lspace="0.330em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><mi>ğƒ</mi></mrow></mrow></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=1+M(s,t,D)\int_{\mathbb{R}^{D}}p_{t}(\bm{\xi})\Delta\log p_{t}(\bm{\xi})~{}\mathrm{d}\bm{\xi}</annotation><annotation encoding="application/x-llamapun">= 1 + italic_M ( italic_s , italic_t , italic_D ) âˆ« start_POSTSUBSCRIPT blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT end_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) roman_Î” roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) roman_d bold_italic_Î¾</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.43)</span></td>
</tr></tbody>
<tbody id="S2.E44"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=1-M(s,t,D)\int_{\mathbb{R}^{D}}\langle\nabla p_{t}(\bm{\xi}),\nabla\log p_{t}(\bm{\xi})\rangle~{}\mathrm{d}\bm{\xi}" class="ltx_Math" display="inline" id="S2.E44.m1"><semantics><mrow><mi></mi><mo>=</mo><mrow><mn>1</mn><mo>âˆ’</mo><mrow><mi>M</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>D</mi><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mstyle displaystyle="true"><msub><mo>âˆ«</mo><msup><mi>â„</mi><mi>D</mi></msup></msub></mstyle><mrow><mrow><mo stretchy="false">âŸ¨</mo><mrow><mrow><mo rspace="0.167em">âˆ‡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>,</mo><mrow><mrow><mrow><mo rspace="0.167em">âˆ‡</mo><mi>log</mi></mrow><mo lspace="0.167em">â¡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">âŸ©</mo></mrow><mo lspace="0.330em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><mi>ğƒ</mi></mrow></mrow></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=1-M(s,t,D)\int_{\mathbb{R}^{D}}\langle\nabla p_{t}(\bm{\xi}),\nabla\log p_{t}(\bm{\xi})\rangle~{}\mathrm{d}\bm{\xi}</annotation><annotation encoding="application/x-llamapun">= 1 - italic_M ( italic_s , italic_t , italic_D ) âˆ« start_POSTSUBSCRIPT blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT end_POSTSUBSCRIPT âŸ¨ âˆ‡ italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) , âˆ‡ roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) âŸ© roman_d bold_italic_Î¾</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.44)</span></td>
</tr></tbody>
<tbody id="S2.E45"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=1-M(s,t,D)\int_{\mathbb{R}^{D}}\frac{\|\nabla p_{t}(\bm{\xi})\|_{2}^{2}}{p_{t}(\bm{\xi})}~{}\mathrm{d}\bm{\xi}," class="ltx_Math" display="inline" id="S2.E45.m1"><semantics><mrow><mrow><mi></mi><mo>=</mo><mrow><mn>1</mn><mo>âˆ’</mo><mrow><mi>M</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>D</mi><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mstyle displaystyle="true"><msub><mo>âˆ«</mo><msup><mi>â„</mi><mi>D</mi></msup></msub></mstyle><mrow><mstyle displaystyle="true"><mfrac><msubsup><mrow><mo stretchy="false">â€–</mo><mrow><mrow><mo rspace="0.167em">âˆ‡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">â€–</mo></mrow><mn>2</mn><mn>2</mn></msubsup><mrow><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow></mfrac></mstyle><mo lspace="0.330em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><mi>ğƒ</mi></mrow></mrow></mrow></mrow></mrow></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">\displaystyle=1-M(s,t,D)\int_{\mathbb{R}^{D}}\frac{\|\nabla p_{t}(\bm{\xi})\|_{2}^{2}}{p_{t}(\bm{\xi})}~{}\mathrm{d}\bm{\xi},</annotation><annotation encoding="application/x-llamapun">= 1 - italic_M ( italic_s , italic_t , italic_D ) âˆ« start_POSTSUBSCRIPT blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT end_POSTSUBSCRIPT divide start_ARG âˆ¥ âˆ‡ italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) end_ARG roman_d bold_italic_Î¾ ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.45)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">where the last few lines are the same as in the proof of <a class="ltx_ref" href="#Thmtheorem3" title="Theorem B.3 (Diffusion Increases Entropy). â€£ B.2.1 Diffusion Process Increases Entropy Over Time â€£ B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Theorem</span>Â <span class="ltx_text ltx_ref_tag">B.3</span></a>. Combining this result with our previous estimate,</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E46">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="h(\bar{\bm{x}}(\bm{x}_{t}))-h(\bm{x}_{t})\leq-M(s,t,D)\int_{\mathbb{R}^{D}}\frac{\|\nabla p_{t}(\bm{\xi})\|_{2}^{2}}{p_{t}(\bm{\xi})}~{}\mathrm{d}\bm{\xi}&lt;0" class="ltx_Math" display="block" id="S2.E46.m1"><semantics><mrow><mrow><mrow><mi>h</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mover accent="true"><mi>ğ’™</mi><mo>Â¯</mo></mover><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ’™</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>âˆ’</mo><mrow><mi>h</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ’™</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>â‰¤</mo><mrow><mo>âˆ’</mo><mrow><mi>M</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>D</mi><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><msub><mo>âˆ«</mo><msup><mi>â„</mi><mi>D</mi></msup></msub><mrow><mfrac><msubsup><mrow><mo stretchy="false">â€–</mo><mrow><mrow><mo rspace="0.167em">âˆ‡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">â€–</mo></mrow><mn>2</mn><mn>2</mn></msubsup><mrow><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow></mfrac><mo lspace="0.330em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><mi>ğƒ</mi></mrow></mrow></mrow></mrow></mrow><mo>&lt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">h(\bar{\bm{x}}(\bm{x}_{t}))-h(\bm{x}_{t})\leq-M(s,t,D)\int_{\mathbb{R}^{D}}\frac{\|\nabla p_{t}(\bm{\xi})\|_{2}^{2}}{p_{t}(\bm{\xi})}~{}\mathrm{d}\bm{\xi}&lt;0</annotation><annotation encoding="application/x-llamapun">italic_h ( overÂ¯ start_ARG bold_italic_x end_ARG ( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ) - italic_h ( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) â‰¤ - italic_M ( italic_s , italic_t , italic_D ) âˆ« start_POSTSUBSCRIPT blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT end_POSTSUBSCRIPT divide start_ARG âˆ¥ âˆ‡ italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) end_ARG roman_d bold_italic_Î¾ &lt; 0</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.46)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">where the inequality is strict by the same argument as in <a class="ltx_ref" href="#Thmtheorem3" title="Theorem B.3 (Diffusion Increases Entropy). â€£ B.2.1 Diffusion Process Increases Entropy Over Time â€£ B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Theorem</span>Â <span class="ltx_text ltx_ref_tag">B.3</span></a>.
âˆ</p>
</div>
</div>
<div class="ltx_para" id="S2.SS2.p8">
<p class="ltx_p">Notice that the bounds for <math alttext="s" class="ltx_Math" display="inline" id="S2.SS2.p8.m1"><semantics><mi>s</mi><annotation encoding="application/x-tex">s</annotation><annotation encoding="application/x-llamapun">italic_s</annotation></semantics></math> and <math alttext="t" class="ltx_Math" display="inline" id="S2.SS2.p8.m2"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation><annotation encoding="application/x-llamapun">italic_t</annotation></semantics></math> depend on the radius <math alttext="R" class="ltx_Math" display="inline" id="S2.SS2.p8.m3"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation><annotation encoding="application/x-llamapun">italic_R</annotation></semantics></math> of the data distribution, and are not so general as the bounds in <a class="ltx_ref" href="#Thmtheorem3" title="Theorem B.3 (Diffusion Increases Entropy). â€£ B.2.1 Diffusion Process Increases Entropy Over Time â€£ B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Theorem</span>Â <span class="ltx_text ltx_ref_tag">B.3</span></a>. The result is actually â€œas general as neededâ€ in the following sense. Note that if <math alttext="\bm{x}" class="ltx_Math" display="inline" id="S2.SS2.p8.m4"><semantics><mi>ğ’™</mi><annotation encoding="application/x-tex">\bm{x}</annotation><annotation encoding="application/x-llamapun">bold_italic_x</annotation></semantics></math> has a twice continuously differentiable density supported on the ball of radius <math alttext="R" class="ltx_Math" display="inline" id="S2.SS2.p8.m5"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation><annotation encoding="application/x-llamapun">italic_R</annotation></semantics></math> centered at <math alttext="\bm{0}" class="ltx_Math" display="inline" id="S2.SS2.p8.m6"><semantics><mn>ğŸ</mn><annotation encoding="application/x-tex">\bm{0}</annotation><annotation encoding="application/x-llamapun">bold_0</annotation></semantics></math>, then it does for <math alttext="2R" class="ltx_Math" display="inline" id="S2.SS2.p8.m7"><semantics><mrow><mn>2</mn><mo lspace="0em" rspace="0em">â€‹</mo><mi>R</mi></mrow><annotation encoding="application/x-tex">2R</annotation><annotation encoding="application/x-llamapun">2 italic_R</annotation></semantics></math>, and <math alttext="3R" class="ltx_Math" display="inline" id="S2.SS2.p8.m8"><semantics><mrow><mn>3</mn><mo lspace="0em" rspace="0em">â€‹</mo><mi>R</mi></mrow><annotation encoding="application/x-tex">3R</annotation><annotation encoding="application/x-llamapun">3 italic_R</annotation></semantics></math>, and so on, i.e., for any ball of radius <math alttext="R^{\prime}&gt;R" class="ltx_Math" display="inline" id="S2.SS2.p8.m9"><semantics><mrow><msup><mi>R</mi><mo>â€²</mo></msup><mo>&gt;</mo><mi>R</mi></mrow><annotation encoding="application/x-tex">R^{\prime}&gt;R</annotation><annotation encoding="application/x-llamapun">italic_R start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT &gt; italic_R</annotation></semantics></math>. Thus one strategy to get the appropriate denoising guarantee is: fix a data dimension <math alttext="D" class="ltx_Math" display="inline" id="S2.SS2.p8.m10"><semantics><mi>D</mi><annotation encoding="application/x-tex">D</annotation><annotation encoding="application/x-llamapun">italic_D</annotation></semantics></math> and discretization schedule, and then set (in the analysis) the data radius <math alttext="R" class="ltx_Math" display="inline" id="S2.SS2.p8.m11"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation><annotation encoding="application/x-llamapun">italic_R</annotation></semantics></math> to be very large such that each denoising step satisfies the requirements for entropy decrease given in <a class="ltx_ref" href="#Thmtheorem4" title="Theorem B.4. â€£ B.2.2 Denoising Process Reduces Entropy Over Time â€£ B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Theorem</span>Â <span class="ltx_text ltx_ref_tag">B.4</span></a>. Then each step of the denoising process will indeed reduce the entropy, as desired.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.2.3 </span>Technical Lemmas and Intermediate Results</h3>
<div class="ltx_para" id="S2.SS3.p1">
<p class="ltx_p">In this subsection we present technical results which power our main two conceptual theorems. Our presentation will be more or less standard for mathematics; we will start with the higher-level results first, and gradually move back to the more incremental results. The higher-level results will use the incremental results, and in this way we have an easy-to-read dependency ordering of the results: no result depends on those before it. Results which do not depend on each other are generally ordered by the place they appear in the above pair of proofs.</p>
</div>
<section class="ltx_subsubsection" id="S2.SS3.SSSx1">
<h4 class="ltx_title ltx_title_subsubsection">Finitneness of the Differential Entropy</h4>
<div class="ltx_para" id="S2.SS3.SSSx1.p1">
<p class="ltx_p">We first show that the entropy exists along the stochastic process and is finite.</p>
</div>
<div class="ltx_theorem ltx_theorem_lemma" id="Thmlemma1">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold">Lemma B.1</span></span><span class="ltx_text ltx_font_bold">.</span>
</h6>
<div class="ltx_para" id="Thmlemma1.p1">
<p class="ltx_p"><span class="ltx_text ltx_font_italic">Let <math alttext="\bm{x}" class="ltx_Math" display="inline" id="Thmlemma1.p1.m1"><semantics><mi>ğ±</mi><annotation encoding="application/x-tex">\bm{x}</annotation><annotation encoding="application/x-llamapun">bold_italic_x</annotation></semantics></math> be any random variable, and let <math alttext="(\bm{x}_{t})_{t\in[0,T]}" class="ltx_Math" display="inline" id="Thmlemma1.p1.m2"><semantics><msub><mrow><mo stretchy="false">(</mo><msub><mi>ğ±</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><mrow><mi>t</mi><mo>âˆˆ</mo><mrow><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mi>T</mi><mo stretchy="false">]</mo></mrow></mrow></msub><annotation encoding="application/x-tex">(\bm{x}_{t})_{t\in[0,T]}</annotation><annotation encoding="application/x-llamapun">( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_t âˆˆ [ 0 , italic_T ] end_POSTSUBSCRIPT</annotation></semantics></math> be the stochastic process (<a class="ltx_ref" href="#S2.E1" title="Equation B.2.1 â€£ B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">B.2.1</span></a>).</span></p>
<ol class="ltx_enumerate" id="S2.I2">
<li class="ltx_item" id="S2.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S2.I2.i1.p1">
<p class="ltx_p"><span class="ltx_text ltx_font_italic">For </span><math alttext="t&gt;0" class="ltx_Math" display="inline" id="S2.I2.i1.p1.m1"><semantics><mrow><mi>t</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">t&gt;0</annotation><annotation encoding="application/x-llamapun">italic_t &gt; 0</annotation></semantics></math><span class="ltx_text ltx_font_italic">, the differential entropy </span><math alttext="h(\bm{x}_{t})" class="ltx_Math" display="inline" id="S2.I2.i1.p1.m2"><semantics><mrow><mi>h</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ’™</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">h(\bm{x}_{t})</annotation><annotation encoding="application/x-llamapun">italic_h ( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math><span class="ltx_text ltx_font_italic"> exists and is </span><math alttext="&gt;-\infty" class="ltx_Math" display="inline" id="S2.I2.i1.p1.m3"><semantics><mrow><mi></mi><mo>&gt;</mo><mrow><mo>âˆ’</mo><mi mathvariant="normal">âˆ</mi></mrow></mrow><annotation encoding="application/x-tex">&gt;-\infty</annotation><annotation encoding="application/x-llamapun">&gt; - âˆ</annotation></semantics></math><span class="ltx_text ltx_font_italic">.</span></p>
</div>
</li>
<li class="ltx_item" id="S2.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S2.I2.i2.p1">
<p class="ltx_p"><span class="ltx_text ltx_font_italic">If in addition </span><a class="ltx_ref ltx_font_italic" href="#Thmassumption1" title="Assumption B.1. â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Assumption</span>Â <span class="ltx_text ltx_ref_tag">B.1</span></a><span class="ltx_text ltx_font_italic"> holds for </span><math alttext="\bm{x}" class="ltx_Math" display="inline" id="S2.I2.i2.p1.m1"><semantics><mi>ğ’™</mi><annotation encoding="application/x-tex">\bm{x}</annotation><annotation encoding="application/x-llamapun">bold_italic_x</annotation></semantics></math><span class="ltx_text ltx_font_italic">, then </span><math alttext="h(\bm{x})&lt;\infty" class="ltx_Math" display="inline" id="S2.I2.i2.p1.m2"><semantics><mrow><mrow><mi>h</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğ’™</mi><mo stretchy="false">)</mo></mrow></mrow><mo>&lt;</mo><mi mathvariant="normal">âˆ</mi></mrow><annotation encoding="application/x-tex">h(\bm{x})&lt;\infty</annotation><annotation encoding="application/x-llamapun">italic_h ( bold_italic_x ) &lt; âˆ</annotation></semantics></math><span class="ltx_text ltx_font_italic"> and </span><math alttext="h(\bm{x}_{t})\ &lt;\infty" class="ltx_Math" display="inline" id="S2.I2.i2.p1.m3"><semantics><mrow><mrow><mi>h</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ’™</mi><mi>t</mi></msub><mo rspace="0.500em" stretchy="false">)</mo></mrow></mrow><mo>&lt;</mo><mi mathvariant="normal">âˆ</mi></mrow><annotation encoding="application/x-tex">h(\bm{x}_{t})\ &lt;\infty</annotation><annotation encoding="application/x-llamapun">italic_h ( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) &lt; âˆ</annotation></semantics></math><span class="ltx_text ltx_font_italic">.</span></p>
</div>
</li>
</ol>
</div>
</div>
<div class="ltx_proof">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h6>
<div class="ltx_para" id="S2.SS3.SSSx1.p2">
<p class="ltx_p">To prove <a class="ltx_ref" href="#Thmlemma1" title="Lemma B.1. â€£ Finitneness of the Differential Entropy â€£ B.2.3 Technical Lemmas and Intermediate Results â€£ B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Lemma</span>Â <span class="ltx_text ltx_ref_tag">B.1</span></a>.1, we use a classic yet tedious analysis argument. Since <math alttext="\bm{x}_{t}" class="ltx_Math" display="inline" id="S2.SS3.SSSx1.p2.m1"><semantics><msub><mi>ğ’™</mi><mi>t</mi></msub><annotation encoding="application/x-tex">\bm{x}_{t}</annotation><annotation encoding="application/x-llamapun">bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> has a density, we can write</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E47">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="h(\bm{x}_{t})=-\int_{\mathbb{R}^{D}}p_{t}(\bm{\xi})\log p_{t}(\bm{\xi})~{}\mathrm{d}\bm{\xi}." class="ltx_Math" display="block" id="S2.E47.m1"><semantics><mrow><mrow><mrow><mi>h</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ’™</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mo>âˆ’</mo><mrow><msub><mo>âˆ«</mo><msup><mi>â„</mi><mi>D</mi></msup></msub><mrow><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mi>log</mi><mo lspace="0.167em">â¡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mo lspace="0.330em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><mi>ğƒ</mi></mrow></mrow></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">h(\bm{x}_{t})=-\int_{\mathbb{R}^{D}}p_{t}(\bm{\xi})\log p_{t}(\bm{\xi})~{}\mathrm{d}\bm{\xi}.</annotation><annotation encoding="application/x-llamapun">italic_h ( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) = - âˆ« start_POSTSUBSCRIPT blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT end_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) roman_d bold_italic_Î¾ .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.47)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">Accordingly, let <math alttext="g\colon\mathbb{R}^{D}\to\mathbb{R}" class="ltx_Math" display="inline" id="S2.SS3.SSSx1.p2.m2"><semantics><mrow><mi>g</mi><mo lspace="0.278em" rspace="0.278em">:</mo><mrow><msup><mi>â„</mi><mi>D</mi></msup><mo stretchy="false">â†’</mo><mi>â„</mi></mrow></mrow><annotation encoding="application/x-tex">g\colon\mathbb{R}^{D}\to\mathbb{R}</annotation><annotation encoding="application/x-llamapun">italic_g : blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT â†’ blackboard_R</annotation></semantics></math> be defined as</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E48">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="g(\bm{\xi})\doteq-p_{t}(\bm{\xi})\log p_{t}(\bm{\xi})\implies h(\bm{x}_{t})=\int_{\mathbb{R}^{D}}g(\bm{\xi})~{}\mathrm{d}\bm{\xi}." class="ltx_Math" display="block" id="S2.E48.m1"><semantics><mrow><mrow><mrow><mi>g</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>â‰</mo><mrow><mo>âˆ’</mo><mrow><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mi>log</mi><mo lspace="0.167em">â¡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mo stretchy="false">âŸ¹</mo><mrow><mi>h</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ’™</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo rspace="0.111em">=</mo><mrow><msub><mo>âˆ«</mo><msup><mi>â„</mi><mi>D</mi></msup></msub><mrow><mi>g</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mo lspace="0.330em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><mi>ğƒ</mi></mrow></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">g(\bm{\xi})\doteq-p_{t}(\bm{\xi})\log p_{t}(\bm{\xi})\implies h(\bm{x}_{t})=\int_{\mathbb{R}^{D}}g(\bm{\xi})~{}\mathrm{d}\bm{\xi}.</annotation><annotation encoding="application/x-llamapun">italic_g ( bold_italic_Î¾ ) â‰ - italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) âŸ¹ italic_h ( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) = âˆ« start_POSTSUBSCRIPT blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT end_POSTSUBSCRIPT italic_g ( bold_italic_Î¾ ) roman_d bold_italic_Î¾ .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.48)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">As usual to bound the value of an integral in analysis, define</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E49">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="g_{+}(\bm{\xi})\doteq\max(g(\bm{\xi}),0),\quad g_{-}(\bm{\xi})\doteq\max(-g(\bm{\xi}),0)\quad\implies\quad g=g_{+}-g_{-}\quad\text{and}\quad g_{+},g_{-}\geq 0." class="ltx_Math" display="block" id="S2.E49.m1"><semantics><mrow><mrow><mrow><mrow><msub><mi>g</mi><mo>+</mo></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>â‰</mo><mrow><mi>max</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><mrow><mi>g</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></mrow></mrow><mo rspace="1.167em">,</mo><mrow><mrow><mrow><msub><mi>g</mi><mo>âˆ’</mo></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>â‰</mo><mrow><mrow><mi>max</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><mrow><mo>âˆ’</mo><mrow><mi>g</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></mrow><mspace width="1em"></mspace><mo stretchy="false">âŸ¹</mo></mrow></mrow><mspace width="1em"></mspace><mrow><mrow><mi>g</mi><mo>=</mo><mrow><mrow><msub><mi>g</mi><mo>+</mo></msub><mo>âˆ’</mo><msub><mi>g</mi><mo>âˆ’</mo></msub></mrow><mspace width="1em"></mspace><mtext>and</mtext><mspace width="1em"></mspace><msub><mi>g</mi><mo>+</mo></msub></mrow></mrow><mo>,</mo><mrow><msub><mi>g</mi><mo>âˆ’</mo></msub><mo>â‰¥</mo><mn>0</mn></mrow></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">g_{+}(\bm{\xi})\doteq\max(g(\bm{\xi}),0),\quad g_{-}(\bm{\xi})\doteq\max(-g(\bm{\xi}),0)\quad\implies\quad g=g_{+}-g_{-}\quad\text{and}\quad g_{+},g_{-}\geq 0.</annotation><annotation encoding="application/x-llamapun">italic_g start_POSTSUBSCRIPT + end_POSTSUBSCRIPT ( bold_italic_Î¾ ) â‰ roman_max ( italic_g ( bold_italic_Î¾ ) , 0 ) , italic_g start_POSTSUBSCRIPT - end_POSTSUBSCRIPT ( bold_italic_Î¾ ) â‰ roman_max ( - italic_g ( bold_italic_Î¾ ) , 0 ) âŸ¹ italic_g = italic_g start_POSTSUBSCRIPT + end_POSTSUBSCRIPT - italic_g start_POSTSUBSCRIPT - end_POSTSUBSCRIPT and italic_g start_POSTSUBSCRIPT + end_POSTSUBSCRIPT , italic_g start_POSTSUBSCRIPT - end_POSTSUBSCRIPT â‰¥ 0 .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.49)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">Then</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E50">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="h(\bm{x}_{t})=\int_{\mathbb{R}^{D}}g_{+}(\bm{\xi})~{}\mathrm{d}\bm{\xi}-\int_{\mathbb{R}^{D}}g_{-}(\bm{\xi})~{}\mathrm{d}\bm{\xi}," class="ltx_Math" display="block" id="S2.E50.m1"><semantics><mrow><mrow><mrow><mi>h</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ’™</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo rspace="0.111em">=</mo><mrow><mrow><msub><mo>âˆ«</mo><msup><mi>â„</mi><mi>D</mi></msup></msub><mrow><msub><mi>g</mi><mo>+</mo></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mo lspace="0.330em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><mi>ğƒ</mi></mrow></mrow></mrow><mo rspace="0.055em">âˆ’</mo><mrow><msub><mo>âˆ«</mo><msup><mi>â„</mi><mi>D</mi></msup></msub><mrow><msub><mi>g</mi><mo>âˆ’</mo></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mo lspace="0.330em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><mi>ğƒ</mi></mrow></mrow></mrow></mrow></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">h(\bm{x}_{t})=\int_{\mathbb{R}^{D}}g_{+}(\bm{\xi})~{}\mathrm{d}\bm{\xi}-\int_{\mathbb{R}^{D}}g_{-}(\bm{\xi})~{}\mathrm{d}\bm{\xi},</annotation><annotation encoding="application/x-llamapun">italic_h ( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) = âˆ« start_POSTSUBSCRIPT blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT end_POSTSUBSCRIPT italic_g start_POSTSUBSCRIPT + end_POSTSUBSCRIPT ( bold_italic_Î¾ ) roman_d bold_italic_Î¾ - âˆ« start_POSTSUBSCRIPT blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT end_POSTSUBSCRIPT italic_g start_POSTSUBSCRIPT - end_POSTSUBSCRIPT ( bold_italic_Î¾ ) roman_d bold_italic_Î¾ ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.50)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">and both integrals are guaranteed to be non-negative since their integrands are.</p>
</div>
<div class="ltx_para" id="S2.SS3.SSSx1.p3">
<p class="ltx_p">In order to show that <math alttext="h(\bm{x}_{t})" class="ltx_Math" display="inline" id="S2.SS3.SSSx1.p3.m1"><semantics><mrow><mi>h</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ’™</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">h(\bm{x}_{t})</annotation><annotation encoding="application/x-llamapun">italic_h ( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> is well-defined, we need to show that <math alttext="\int_{\mathbb{R}^{D}}g_{+}(\bm{\xi})~{}\mathrm{d}\bm{\xi}&lt;\infty" class="ltx_Math" display="inline" id="S2.SS3.SSSx1.p3.m2"><semantics><mrow><mrow><msub><mo>âˆ«</mo><msup><mi>â„</mi><mi>D</mi></msup></msub><mrow><msub><mi>g</mi><mo>+</mo></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mo lspace="0.330em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><mi>ğƒ</mi></mrow></mrow></mrow><mo>&lt;</mo><mi mathvariant="normal">âˆ</mi></mrow><annotation encoding="application/x-tex">\int_{\mathbb{R}^{D}}g_{+}(\bm{\xi})~{}\mathrm{d}\bm{\xi}&lt;\infty</annotation><annotation encoding="application/x-llamapun">âˆ« start_POSTSUBSCRIPT blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT end_POSTSUBSCRIPT italic_g start_POSTSUBSCRIPT + end_POSTSUBSCRIPT ( bold_italic_Î¾ ) roman_d bold_italic_Î¾ &lt; âˆ</annotation></semantics></math> or <math alttext="\int_{\mathbb{R}^{D}}g_{-}(\bm{\xi})~{}\mathrm{d}\bm{\xi}&lt;\infty" class="ltx_Math" display="inline" id="S2.SS3.SSSx1.p3.m3"><semantics><mrow><mrow><msub><mo>âˆ«</mo><msup><mi>â„</mi><mi>D</mi></msup></msub><mrow><msub><mi>g</mi><mo>âˆ’</mo></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mo lspace="0.330em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><mi>ğƒ</mi></mrow></mrow></mrow><mo>&lt;</mo><mi mathvariant="normal">âˆ</mi></mrow><annotation encoding="application/x-tex">\int_{\mathbb{R}^{D}}g_{-}(\bm{\xi})~{}\mathrm{d}\bm{\xi}&lt;\infty</annotation><annotation encoding="application/x-llamapun">âˆ« start_POSTSUBSCRIPT blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT end_POSTSUBSCRIPT italic_g start_POSTSUBSCRIPT - end_POSTSUBSCRIPT ( bold_italic_Î¾ ) roman_d bold_italic_Î¾ &lt; âˆ</annotation></semantics></math>. To show that <math alttext="h(\bm{x}_{t})&gt;-\infty" class="ltx_Math" display="inline" id="S2.SS3.SSSx1.p3.m4"><semantics><mrow><mrow><mi>h</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ’™</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>&gt;</mo><mrow><mo>âˆ’</mo><mi mathvariant="normal">âˆ</mi></mrow></mrow><annotation encoding="application/x-tex">h(\bm{x}_{t})&gt;-\infty</annotation><annotation encoding="application/x-llamapun">italic_h ( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) &gt; - âˆ</annotation></semantics></math>, it merely suffices to show that <math alttext="\int_{\mathbb{R}^{D}}g_{-}(\bm{\xi})~{}\mathrm{d}\bm{\xi}&lt;\infty" class="ltx_Math" display="inline" id="S2.SS3.SSSx1.p3.m5"><semantics><mrow><mrow><msub><mo>âˆ«</mo><msup><mi>â„</mi><mi>D</mi></msup></msub><mrow><msub><mi>g</mi><mo>âˆ’</mo></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mo lspace="0.330em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><mi>ğƒ</mi></mrow></mrow></mrow><mo>&lt;</mo><mi mathvariant="normal">âˆ</mi></mrow><annotation encoding="application/x-tex">\int_{\mathbb{R}^{D}}g_{-}(\bm{\xi})~{}\mathrm{d}\bm{\xi}&lt;\infty</annotation><annotation encoding="application/x-llamapun">âˆ« start_POSTSUBSCRIPT blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT end_POSTSUBSCRIPT italic_g start_POSTSUBSCRIPT - end_POSTSUBSCRIPT ( bold_italic_Î¾ ) roman_d bold_italic_Î¾ &lt; âˆ</annotation></semantics></math>. To bound the integral of <math alttext="g_{-}" class="ltx_Math" display="inline" id="S2.SS3.SSSx1.p3.m6"><semantics><msub><mi>g</mi><mo>âˆ’</mo></msub><annotation encoding="application/x-tex">g_{-}</annotation><annotation encoding="application/x-llamapun">italic_g start_POSTSUBSCRIPT - end_POSTSUBSCRIPT</annotation></semantics></math> we need to understand the quantity <math alttext="g_{-}" class="ltx_Math" display="inline" id="S2.SS3.SSSx1.p3.m7"><semantics><msub><mi>g</mi><mo>âˆ’</mo></msub><annotation encoding="application/x-tex">g_{-}</annotation><annotation encoding="application/x-llamapun">italic_g start_POSTSUBSCRIPT - end_POSTSUBSCRIPT</annotation></semantics></math>, namely, we want to characterize when <math alttext="g" class="ltx_Math" display="inline" id="S2.SS3.SSSx1.p3.m8"><semantics><mi>g</mi><annotation encoding="application/x-tex">g</annotation><annotation encoding="application/x-llamapun">italic_g</annotation></semantics></math> is negative.</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E51">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="g(\bm{\xi})\leq 0\iff p_{t}(\bm{\xi})\log p_{t}(\bm{\xi})\geq 0\iff\log p_{t}(\bm{\xi})\geq 0\iff p_{t}(\bm{\xi})\geq 1." class="ltx_Math" display="block" id="S2.E51.m1"><semantics><mrow><mrow><mrow><mrow><mi>g</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>â‰¤</mo><mn>0</mn></mrow><mo stretchy="false">â‡”</mo><mrow><mrow><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mi>log</mi><mo lspace="0.167em">â¡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>â‰¥</mo><mn>0</mn></mrow><mo stretchy="false">â‡”</mo><mrow><mrow><mrow><mi>log</mi><mo lspace="0.167em">â¡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>â‰¥</mo><mn>0</mn></mrow><mo stretchy="false">â‡”</mo><mrow><mrow><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>â‰¥</mo><mn>1</mn></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">g(\bm{\xi})\leq 0\iff p_{t}(\bm{\xi})\log p_{t}(\bm{\xi})\geq 0\iff\log p_{t}(\bm{\xi})\geq 0\iff p_{t}(\bm{\xi})\geq 1.</annotation><annotation encoding="application/x-llamapun">italic_g ( bold_italic_Î¾ ) â‰¤ 0 â‡” italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) â‰¥ 0 â‡” roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) â‰¥ 0 â‡” italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) â‰¥ 1 .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.51)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">Thus, it holds that</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E52">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="g_{-}(\bm{\xi})=\mathbf{1}(p_{t}(\bm{\xi})\geq 1)\cdot(-g(\bm{\xi}))=\mathbf{1}(p_{t}(\bm{\xi})\geq 1)p_{t}(\bm{\xi})\log p_{t}(\bm{\xi})." class="ltx_Math" display="block" id="S2.E52.m1"><semantics><mrow><mrow><mrow><msub><mi>g</mi><mo>âˆ’</mo></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mn>ğŸ</mn><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mrow><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>â‰¥</mo><mn>1</mn></mrow><mo rspace="0.055em" stretchy="false">)</mo></mrow></mrow><mo rspace="0.222em">â‹…</mo><mrow><mo stretchy="false">(</mo><mrow><mo>âˆ’</mo><mrow><mi>g</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mn>ğŸ</mn><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mrow><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>â‰¥</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mi>log</mi><mo lspace="0.167em">â¡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">g_{-}(\bm{\xi})=\mathbf{1}(p_{t}(\bm{\xi})\geq 1)\cdot(-g(\bm{\xi}))=\mathbf{1}(p_{t}(\bm{\xi})\geq 1)p_{t}(\bm{\xi})\log p_{t}(\bm{\xi}).</annotation><annotation encoding="application/x-llamapun">italic_g start_POSTSUBSCRIPT - end_POSTSUBSCRIPT ( bold_italic_Î¾ ) = bold_1 ( italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) â‰¥ 1 ) â‹… ( - italic_g ( bold_italic_Î¾ ) ) = bold_1 ( italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) â‰¥ 1 ) italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.52)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">In order to bound the integral of <math alttext="g_{-}(\bm{\xi})" class="ltx_Math" display="inline" id="S2.SS3.SSSx1.p3.m9"><semantics><mrow><msub><mi>g</mi><mo>âˆ’</mo></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">g_{-}(\bm{\xi})</annotation><annotation encoding="application/x-llamapun">italic_g start_POSTSUBSCRIPT - end_POSTSUBSCRIPT ( bold_italic_Î¾ )</annotation></semantics></math>, we need to show that <math alttext="p_{t}" class="ltx_Math" display="inline" id="S2.SS3.SSSx1.p3.m10"><semantics><msub><mi>p</mi><mi>t</mi></msub><annotation encoding="application/x-tex">p_{t}</annotation><annotation encoding="application/x-llamapun">italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is â€œnot too concentrated,â€ namely that <math alttext="p_{t}" class="ltx_Math" display="inline" id="S2.SS3.SSSx1.p3.m11"><semantics><msub><mi>p</mi><mi>t</mi></msub><annotation encoding="application/x-tex">p_{t}</annotation><annotation encoding="application/x-llamapun">italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is not too large. To prove this, in this case we are lucky enough to be able to bound the function <math alttext="g_{-}(\bm{\xi})" class="ltx_Math" display="inline" id="S2.SS3.SSSx1.p3.m12"><semantics><mrow><msub><mi>g</mi><mo>âˆ’</mo></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">g_{-}(\bm{\xi})</annotation><annotation encoding="application/x-llamapun">italic_g start_POSTSUBSCRIPT - end_POSTSUBSCRIPT ( bold_italic_Î¾ )</annotation></semantics></math> itself. Namely, notice that</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E53">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\max_{\bm{\xi}\in\mathbb{R}^{D}}\varphi_{t}(\bm{\xi}-\bm{x})=\varphi_{t}(\bm{0})=\frac{1}{(2\pi)^{D/2}t^{D}}=:C_{t}." class="ltx_math_unparsed" display="block" id="S2.E53.m1"><semantics><mrow><munder><mi>max</mi><mrow><mi>ğƒ</mi><mo>âˆˆ</mo><msup><mi>â„</mi><mi>D</mi></msup></mrow></munder><msub><mi>Ï†</mi><mi>t</mi></msub><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’™</mi><mo stretchy="false">)</mo></mrow><mo>=</mo><msub><mi>Ï†</mi><mi>t</mi></msub><mrow><mo stretchy="false">(</mo><mn>ğŸ</mn><mo stretchy="false">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mrow><msup><mrow><mo stretchy="false">(</mo><mrow><mn>2</mn><mo lspace="0em" rspace="0em">â€‹</mo><mi>Ï€</mi></mrow><mo stretchy="false">)</mo></mrow><mrow><mi>D</mi><mo>/</mo><mn>2</mn></mrow></msup><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>t</mi><mi>D</mi></msup></mrow></mfrac><mo rspace="0em">=</mo><mo rspace="0.278em">:</mo><msub><mi>C</mi><mi>t</mi></msub><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">\max_{\bm{\xi}\in\mathbb{R}^{D}}\varphi_{t}(\bm{\xi}-\bm{x})=\varphi_{t}(\bm{0})=\frac{1}{(2\pi)^{D/2}t^{D}}=:C_{t}.</annotation><annotation encoding="application/x-llamapun">roman_max start_POSTSUBSCRIPT bold_italic_Î¾ âˆˆ blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT end_POSTSUBSCRIPT italic_Ï† start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ - bold_italic_x ) = italic_Ï† start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_0 ) = divide start_ARG 1 end_ARG start_ARG ( 2 italic_Ï€ ) start_POSTSUPERSCRIPT italic_D / 2 end_POSTSUPERSCRIPT italic_t start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT end_ARG = : italic_C start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.53)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">which blows up as <math alttext="t\to 0" class="ltx_Math" display="inline" id="S2.SS3.SSSx1.p3.m13"><semantics><mrow><mi>t</mi><mo stretchy="false">â†’</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">t\to 0</annotation><annotation encoding="application/x-llamapun">italic_t â†’ 0</annotation></semantics></math> but is finite for all finite <math alttext="t" class="ltx_Math" display="inline" id="S2.SS3.SSSx1.p3.m14"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation><annotation encoding="application/x-llamapun">italic_t</annotation></semantics></math>. Therefore</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E54">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="p_{t}(\bm{\xi})=\operatorname{\mathbb{E}}\varphi_{t}(\bm{\xi}-\bm{x})\leq\operatorname{\mathbb{E}}C_{t}=C_{t}." class="ltx_Math" display="block" id="S2.E54.m1"><semantics><mrow><mrow><mrow><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mi>ğ”¼</mi><mo lspace="0.167em">â¡</mo><msub><mi>Ï†</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’™</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>â‰¤</mo><mrow><mi>ğ”¼</mi><mo lspace="0.167em">â¡</mo><msub><mi>C</mi><mi>t</mi></msub></mrow><mo>=</mo><msub><mi>C</mi><mi>t</mi></msub></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">p_{t}(\bm{\xi})=\operatorname{\mathbb{E}}\varphi_{t}(\bm{\xi}-\bm{x})\leq\operatorname{\mathbb{E}}C_{t}=C_{t}.</annotation><annotation encoding="application/x-llamapun">italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) = blackboard_E italic_Ï† start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ - bold_italic_x ) â‰¤ blackboard_E italic_C start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = italic_C start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.54)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">Now there are two cases.</p>
<ul class="ltx_itemize" id="S2.I3">
<li class="ltx_item" id="S2.I3.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span>
<div class="ltx_para" id="S2.I3.i1.p1">
<p class="ltx_p">If <math alttext="C_{t}&lt;1" class="ltx_Math" display="inline" id="S2.I3.i1.p1.m1"><semantics><mrow><msub><mi>C</mi><mi>t</mi></msub><mo>&lt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">C_{t}&lt;1</annotation><annotation encoding="application/x-llamapun">italic_C start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT &lt; 1</annotation></semantics></math>, then <math alttext="p_{t}(\bm{\xi})&lt;1" class="ltx_Math" display="inline" id="S2.I3.i1.p1.m2"><semantics><mrow><mrow><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>&lt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">p_{t}(\bm{\xi})&lt;1</annotation><annotation encoding="application/x-llamapun">italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) &lt; 1</annotation></semantics></math>, so the indicator is never <math alttext="1" class="ltx_Math" display="inline" id="S2.I3.i1.p1.m3"><semantics><mn>1</mn><annotation encoding="application/x-tex">1</annotation><annotation encoding="application/x-llamapun">1</annotation></semantics></math>, hence <math alttext="g_{-}=0" class="ltx_Math" display="inline" id="S2.I3.i1.p1.m4"><semantics><mrow><msub><mi>g</mi><mo>âˆ’</mo></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">g_{-}=0</annotation><annotation encoding="application/x-llamapun">italic_g start_POSTSUBSCRIPT - end_POSTSUBSCRIPT = 0</annotation></semantics></math> identically and its integral is also <math alttext="0" class="ltx_Math" display="inline" id="S2.I3.i1.p1.m5"><mn>0</mn></math>.</p>
</div>
</li>
<li class="ltx_item" id="S2.I3.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span>
<div class="ltx_para" id="S2.I3.i2.p1">
<p class="ltx_p">If <math alttext="C_{t}\geq 1" class="ltx_Math" display="inline" id="S2.I3.i2.p1.m1"><semantics><mrow><msub><mi>C</mi><mi>t</mi></msub><mo>â‰¥</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">C_{t}\geq 1</annotation><annotation encoding="application/x-llamapun">italic_C start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT â‰¥ 1</annotation></semantics></math>, then <math alttext="\log C_{t}\geq 0" class="ltx_Math" display="inline" id="S2.I3.i2.p1.m2"><semantics><mrow><mrow><mi>log</mi><mo lspace="0.167em">â¡</mo><msub><mi>C</mi><mi>t</mi></msub></mrow><mo>â‰¥</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\log C_{t}\geq 0</annotation><annotation encoding="application/x-llamapun">roman_log italic_C start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT â‰¥ 0</annotation></semantics></math>, so since the logarithm is monotonically increasing,</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S3.EGx135">
<tbody id="S2.E55"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\int_{\mathbb{R}^{D}}g_{-}(\bm{\xi})~{}\mathrm{d}\bm{\xi}" class="ltx_Math" display="inline" id="S2.E55.m1"><semantics><mrow><mstyle displaystyle="true"><msub><mo>âˆ«</mo><msup><mi>â„</mi><mi>D</mi></msup></msub></mstyle><mrow><msub><mi>g</mi><mo>âˆ’</mo></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mo lspace="0.330em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><mi>ğƒ</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle\int_{\mathbb{R}^{D}}g_{-}(\bm{\xi})~{}\mathrm{d}\bm{\xi}</annotation><annotation encoding="application/x-llamapun">âˆ« start_POSTSUBSCRIPT blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT end_POSTSUBSCRIPT italic_g start_POSTSUBSCRIPT - end_POSTSUBSCRIPT ( bold_italic_Î¾ ) roman_d bold_italic_Î¾</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\int_{\mathbb{R}^{D}}\mathbf{1}(p_{t}(\bm{\xi})\geq 1)p_{t}(\bm{\xi})\log p_{t}(\bm{\xi})~{}\mathrm{d}\bm{\xi}" class="ltx_Math" display="inline" id="S2.E55.m2"><semantics><mrow><mi></mi><mo>=</mo><mrow><mstyle displaystyle="true"><msub><mo>âˆ«</mo><msup><mi>â„</mi><mi>D</mi></msup></msub></mstyle><mrow><mn>ğŸ</mn><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mrow><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>â‰¥</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mi>log</mi><mo lspace="0.167em">â¡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mo lspace="0.330em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><mi>ğƒ</mi></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=\int_{\mathbb{R}^{D}}\mathbf{1}(p_{t}(\bm{\xi})\geq 1)p_{t}(\bm{\xi})\log p_{t}(\bm{\xi})~{}\mathrm{d}\bm{\xi}</annotation><annotation encoding="application/x-llamapun">= âˆ« start_POSTSUBSCRIPT blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT end_POSTSUBSCRIPT bold_1 ( italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) â‰¥ 1 ) italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) roman_d bold_italic_Î¾</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.55)</span></td>
</tr></tbody>
<tbody id="S2.E56"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\operatorname{\mathbb{E}}[\mathbf{1}(p_{t}(\bm{x}_{t})\geq 1)\log p_{t}(\bm{x}_{t})]" class="ltx_Math" display="inline" id="S2.E56.m1"><semantics><mrow><mi></mi><mo>=</mo><mrow><mi>ğ”¼</mi><mo>â¡</mo><mrow><mo stretchy="false">[</mo><mrow><mn>ğŸ</mn><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mrow><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ’™</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>â‰¥</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mi>log</mi><mo lspace="0.167em">â¡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ’™</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">]</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=\operatorname{\mathbb{E}}[\mathbf{1}(p_{t}(\bm{x}_{t})\geq 1)\log p_{t}(\bm{x}_{t})]</annotation><annotation encoding="application/x-llamapun">= blackboard_E [ bold_1 ( italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) â‰¥ 1 ) roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.56)</span></td>
</tr></tbody>
<tbody id="S2.E57"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\leq\operatorname{\mathbb{E}}[\mathbf{1}(p_{t}(\bm{x}_{t})\geq 1)\log C_{t}]" class="ltx_Math" display="inline" id="S2.E57.m1"><semantics><mrow><mi></mi><mo>â‰¤</mo><mrow><mi>ğ”¼</mi><mo>â¡</mo><mrow><mo stretchy="false">[</mo><mrow><mn>ğŸ</mn><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mrow><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ’™</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>â‰¥</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mi>log</mi><mo lspace="0.167em">â¡</mo><msub><mi>C</mi><mi>t</mi></msub></mrow></mrow><mo stretchy="false">]</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle\leq\operatorname{\mathbb{E}}[\mathbf{1}(p_{t}(\bm{x}_{t})\geq 1)\log C_{t}]</annotation><annotation encoding="application/x-llamapun">â‰¤ blackboard_E [ bold_1 ( italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) â‰¥ 1 ) roman_log italic_C start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.57)</span></td>
</tr></tbody>
<tbody id="S2.E58"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\operatorname{\mathbb{P}}[p_{t}(\bm{x}_{t})\geq 1]\log C_{t}." class="ltx_Math" display="inline" id="S2.E58.m1"><semantics><mrow><mrow><mi></mi><mo>=</mo><mrow><mrow><mi>â„™</mi><mo>â¡</mo><mrow><mo stretchy="false">[</mo><mrow><mrow><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ’™</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>â‰¥</mo><mn>1</mn></mrow><mo stretchy="false">]</mo></mrow></mrow><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mi>log</mi><mo lspace="0.167em">â¡</mo><msub><mi>C</mi><mi>t</mi></msub></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">\displaystyle=\operatorname{\mathbb{P}}[p_{t}(\bm{x}_{t})\geq 1]\log C_{t}.</annotation><annotation encoding="application/x-llamapun">= blackboard_P [ italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) â‰¥ 1 ] roman_log italic_C start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.58)</span></td>
</tr></tbody>
</table>
</div>
</li>
</ul>
<p class="ltx_p">Hence we have <math alttext="\int_{\mathbb{R}^{D}}g_{-}(\bm{\xi})~{}\mathrm{d}\bm{\xi}&lt;\infty" class="ltx_Math" display="inline" id="S2.SS3.SSSx1.p3.m15"><semantics><mrow><mrow><msub><mo>âˆ«</mo><msup><mi>â„</mi><mi>D</mi></msup></msub><mrow><msub><mi>g</mi><mo>âˆ’</mo></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mo lspace="0.330em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><mi>ğƒ</mi></mrow></mrow></mrow><mo>&lt;</mo><mi mathvariant="normal">âˆ</mi></mrow><annotation encoding="application/x-tex">\int_{\mathbb{R}^{D}}g_{-}(\bm{\xi})~{}\mathrm{d}\bm{\xi}&lt;\infty</annotation><annotation encoding="application/x-llamapun">âˆ« start_POSTSUBSCRIPT blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT end_POSTSUBSCRIPT italic_g start_POSTSUBSCRIPT - end_POSTSUBSCRIPT ( bold_italic_Î¾ ) roman_d bold_italic_Î¾ &lt; âˆ</annotation></semantics></math>, so the differential entropy <math alttext="h(\bm{x}_{t})" class="ltx_Math" display="inline" id="S2.SS3.SSSx1.p3.m16"><semantics><mrow><mi>h</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ’™</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">h(\bm{x}_{t})</annotation><annotation encoding="application/x-llamapun">italic_h ( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> exists and is <math alttext="&gt;-\infty" class="ltx_Math" display="inline" id="S2.SS3.SSSx1.p3.m17"><semantics><mrow><mi></mi><mo>&gt;</mo><mrow><mo>âˆ’</mo><mi mathvariant="normal">âˆ</mi></mrow></mrow><annotation encoding="application/x-tex">&gt;-\infty</annotation><annotation encoding="application/x-llamapun">&gt; - âˆ</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S2.SS3.SSSx1.p4">
<p class="ltx_p">To prove <a class="ltx_ref" href="#Thmlemma1" title="Lemma B.1. â€£ Finitneness of the Differential Entropy â€£ B.2.3 Technical Lemmas and Intermediate Results â€£ B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Lemma</span>Â <span class="ltx_text ltx_ref_tag">B.1</span></a>.2, suppose that <a class="ltx_ref" href="#Thmassumption1" title="Assumption B.1. â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Assumption</span>Â <span class="ltx_text ltx_ref_tag">B.1</span></a> holds. We want to show that <math alttext="h(\bm{x})&lt;\infty" class="ltx_Math" display="inline" id="S2.SS3.SSSx1.p4.m1"><semantics><mrow><mrow><mi>h</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğ’™</mi><mo stretchy="false">)</mo></mrow></mrow><mo>&lt;</mo><mi mathvariant="normal">âˆ</mi></mrow><annotation encoding="application/x-tex">h(\bm{x})&lt;\infty</annotation><annotation encoding="application/x-llamapun">italic_h ( bold_italic_x ) &lt; âˆ</annotation></semantics></math> and <math alttext="h(\bm{x}_{t})&lt;\infty" class="ltx_Math" display="inline" id="S2.SS3.SSSx1.p4.m2"><semantics><mrow><mrow><mi>h</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ’™</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>&lt;</mo><mi mathvariant="normal">âˆ</mi></mrow><annotation encoding="application/x-tex">h(\bm{x}_{t})&lt;\infty</annotation><annotation encoding="application/x-llamapun">italic_h ( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) &lt; âˆ</annotation></semantics></math>. The mechanism for doing this is the same, and involves the maximum entropy result <a class="ltx_ref" href="#Thmtheorem2" title="Theorem B.2. â€£ B.1 Differential Entropy of Low-Dimensional Distributions â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Theorem</span>Â <span class="ltx_text ltx_ref_tag">B.2</span></a>. Namely, since <math alttext="\bm{x}" class="ltx_Math" display="inline" id="S2.SS3.SSSx1.p4.m3"><semantics><mi>ğ’™</mi><annotation encoding="application/x-tex">\bm{x}</annotation><annotation encoding="application/x-llamapun">bold_italic_x</annotation></semantics></math> is absolutely bounded, it has a finite covariance which we will denote <math alttext="\bm{\Sigma}" class="ltx_Math" display="inline" id="S2.SS3.SSSx1.p4.m4"><semantics><mi>ğšº</mi><annotation encoding="application/x-tex">\bm{\Sigma}</annotation><annotation encoding="application/x-llamapun">bold_Î£</annotation></semantics></math>. Then the covariance of <math alttext="\bm{x}_{t}" class="ltx_Math" display="inline" id="S2.SS3.SSSx1.p4.m5"><semantics><msub><mi>ğ’™</mi><mi>t</mi></msub><annotation encoding="application/x-tex">\bm{x}_{t}</annotation><annotation encoding="application/x-llamapun">bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is <math alttext="\bm{\Sigma}+t^{2}\bm{I}" class="ltx_Math" display="inline" id="S2.SS3.SSSx1.p4.m6"><semantics><mrow><mi>ğšº</mi><mo>+</mo><mrow><msup><mi>t</mi><mn>2</mn></msup><mo lspace="0em" rspace="0em">â€‹</mo><mi>ğ‘°</mi></mrow></mrow><annotation encoding="application/x-tex">\bm{\Sigma}+t^{2}\bm{I}</annotation><annotation encoding="application/x-llamapun">bold_Î£ + italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT bold_italic_I</annotation></semantics></math>. Thus the entropy of <math alttext="\bm{x}" class="ltx_Math" display="inline" id="S2.SS3.SSSx1.p4.m7"><semantics><mi>ğ’™</mi><annotation encoding="application/x-tex">\bm{x}</annotation><annotation encoding="application/x-llamapun">bold_italic_x</annotation></semantics></math> and <math alttext="\bm{x}_{t}" class="ltx_Math" display="inline" id="S2.SS3.SSSx1.p4.m8"><semantics><msub><mi>ğ’™</mi><mi>t</mi></msub><annotation encoding="application/x-tex">\bm{x}_{t}</annotation><annotation encoding="application/x-llamapun">bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> can be upper bounded by the entropy of normal distributions with the respective covariances, i.e., <math alttext="\log[(2\pi e)^{D}\det(\bm{\Sigma})]" class="ltx_Math" display="inline" id="S2.SS3.SSSx1.p4.m9"><semantics><mrow><mi>log</mi><mo>â¡</mo><mrow><mo stretchy="false">[</mo><mrow><msup><mrow><mo stretchy="false">(</mo><mrow><mn>2</mn><mo lspace="0em" rspace="0em">â€‹</mo><mi>Ï€</mi><mo lspace="0em" rspace="0em">â€‹</mo><mi>e</mi></mrow><mo stretchy="false">)</mo></mrow><mi>D</mi></msup><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">det</mo><mrow><mo stretchy="false">(</mo><mi>ğšº</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mo stretchy="false">]</mo></mrow></mrow><annotation encoding="application/x-tex">\log[(2\pi e)^{D}\det(\bm{\Sigma})]</annotation><annotation encoding="application/x-llamapun">roman_log [ ( 2 italic_Ï€ italic_e ) start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT roman_det ( bold_Î£ ) ]</annotation></semantics></math> or <math alttext="\log[(2\pi e)^{D}\det(\bm{\Sigma}+t^{2}\bm{I})]" class="ltx_Math" display="inline" id="S2.SS3.SSSx1.p4.m10"><semantics><mrow><mi>log</mi><mo>â¡</mo><mrow><mo stretchy="false">[</mo><mrow><msup><mrow><mo stretchy="false">(</mo><mrow><mn>2</mn><mo lspace="0em" rspace="0em">â€‹</mo><mi>Ï€</mi><mo lspace="0em" rspace="0em">â€‹</mo><mi>e</mi></mrow><mo stretchy="false">)</mo></mrow><mi>D</mi></msup><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">det</mo><mrow><mo stretchy="false">(</mo><mrow><mi>ğšº</mi><mo>+</mo><mrow><msup><mi>t</mi><mn>2</mn></msup><mo lspace="0em" rspace="0em">â€‹</mo><mi>ğ‘°</mi></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow><mo stretchy="false">]</mo></mrow></mrow><annotation encoding="application/x-tex">\log[(2\pi e)^{D}\det(\bm{\Sigma}+t^{2}\bm{I})]</annotation><annotation encoding="application/x-llamapun">roman_log [ ( 2 italic_Ï€ italic_e ) start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT roman_det ( bold_Î£ + italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT bold_italic_I ) ]</annotation></semantics></math>, and both are <math alttext="&lt;\infty" class="ltx_Math" display="inline" id="S2.SS3.SSSx1.p4.m11"><semantics><mrow><mi></mi><mo>&lt;</mo><mi mathvariant="normal">âˆ</mi></mrow><annotation encoding="application/x-tex">&lt;\infty</annotation><annotation encoding="application/x-llamapun">&lt; âˆ</annotation></semantics></math>.
âˆ</p>
</div>
</div>
</section>
<section class="ltx_subsubsection" id="S2.SS3.SSSx2">
<h4 class="ltx_title ltx_title_subsubsection">Integration by Parts in De Brujin Identity</h4>
<div class="ltx_para" id="S2.SS3.SSSx2.p1">
<p class="ltx_p">Finally, we fill in the integration-by-parts argument alluded to in the proofs of <a class="ltx_ref" href="#Thmtheorem3" title="Theorem B.3 (Diffusion Increases Entropy). â€£ B.2.1 Diffusion Process Increases Entropy Over Time â€£ B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Theorems</span>Â <span class="ltx_text ltx_ref_tag">B.3</span></a> andÂ <a class="ltx_ref" href="#Thmtheorem4" title="Theorem B.4. â€£ B.2.2 Denoising Process Reduces Entropy Over Time â€£ B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">B.4</span></a>. The argument is conceptually pretty simple but requires some technical estimates to show that the boundary term in the integration-by-parts vanishes.</p>
</div>
<div class="ltx_theorem ltx_theorem_lemma" id="Thmlemma2">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold">Lemma B.2</span></span><span class="ltx_text ltx_font_bold">.</span>
</h6>
<div class="ltx_para" id="Thmlemma2.p1">
<p class="ltx_p"><span class="ltx_text ltx_font_italic">Let <math alttext="\bm{x}" class="ltx_Math" display="inline" id="Thmlemma2.p1.m1"><semantics><mi>ğ±</mi><annotation encoding="application/x-tex">\bm{x}</annotation><annotation encoding="application/x-llamapun">bold_italic_x</annotation></semantics></math> be any random variable such that <a class="ltx_ref" href="#Thmassumption1" title="Assumption B.1. â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Assumptions</span>Â <span class="ltx_text ltx_ref_tag">B.1</span></a> andÂ <a class="ltx_ref" href="#Thmassumption2" title="Assumption B.2. â€£ B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">B.2</span></a> hold, and let <math alttext="(\bm{x}_{t})_{t\in[0,T]}" class="ltx_Math" display="inline" id="Thmlemma2.p1.m2"><semantics><msub><mrow><mo stretchy="false">(</mo><msub><mi>ğ±</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><mrow><mi>t</mi><mo>âˆˆ</mo><mrow><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mi>T</mi><mo stretchy="false">]</mo></mrow></mrow></msub><annotation encoding="application/x-tex">(\bm{x}_{t})_{t\in[0,T]}</annotation><annotation encoding="application/x-llamapun">( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_t âˆˆ [ 0 , italic_T ] end_POSTSUBSCRIPT</annotation></semantics></math> be the stochastic process (<a class="ltx_ref" href="#S2.E1" title="Equation B.2.1 â€£ B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">B.2.1</span></a>). For <math alttext="t\geq 0" class="ltx_Math" display="inline" id="Thmlemma2.p1.m3"><semantics><mrow><mi>t</mi><mo>â‰¥</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">t\geq 0</annotation><annotation encoding="application/x-llamapun">italic_t â‰¥ 0</annotation></semantics></math>, let <math alttext="p_{t}" class="ltx_Math" display="inline" id="Thmlemma2.p1.m4"><semantics><msub><mi>p</mi><mi>t</mi></msub><annotation encoding="application/x-tex">p_{t}</annotation><annotation encoding="application/x-llamapun">italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> be the density of <math alttext="\bm{x}_{t}" class="ltx_Math" display="inline" id="Thmlemma2.p1.m5"><semantics><msub><mi>ğ±</mi><mi>t</mi></msub><annotation encoding="application/x-tex">\bm{x}_{t}</annotation><annotation encoding="application/x-llamapun">bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>. Then for a constant <math alttext="c\in\mathbb{R}" class="ltx_Math" display="inline" id="Thmlemma2.p1.m6"><semantics><mrow><mi>c</mi><mo>âˆˆ</mo><mi>â„</mi></mrow><annotation encoding="application/x-tex">c\in\mathbb{R}</annotation><annotation encoding="application/x-llamapun">italic_c âˆˆ blackboard_R</annotation></semantics></math> it holds</span></p>
<table class="ltx_equation ltx_eqn_table" id="S2.E59">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\int_{\mathbb{R}^{D}}\Delta p_{t}(\bm{\xi})[c+\log p_{t}(\bm{\xi})]~{}\mathrm{d}\bm{\xi}=-\int_{\mathbb{R}^{D}}\langle\nabla\log p_{t}(\bm{\xi}),\nabla p_{t}(\bm{\xi})\rangle~{}\mathrm{d}\bm{\xi}." class="ltx_Math" display="block" id="S2.E59.m1"><semantics><mrow><mrow><mrow><msub><mo>âˆ«</mo><msup><mi>â„</mi><mi>D</mi></msup></msub><mrow><mi mathvariant="normal">Î”</mi><mo lspace="0em" rspace="0em">â€‹</mo><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">[</mo><mrow><mi>c</mi><mo>+</mo><mrow><mrow><mi>log</mi><mo lspace="0.167em">â¡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mo stretchy="false">]</mo></mrow><mo lspace="0.330em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><mi>ğƒ</mi></mrow></mrow></mrow><mo>=</mo><mrow><mo>âˆ’</mo><mrow><msub><mo rspace="0em">âˆ«</mo><msup><mi>â„</mi><mi>D</mi></msup></msub><mrow><mrow><mo stretchy="false">âŸ¨</mo><mrow><mrow><mrow><mo rspace="0.167em">âˆ‡</mo><mi>log</mi></mrow><mo lspace="0.167em">â¡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>,</mo><mrow><mrow><mo rspace="0.167em">âˆ‡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">âŸ©</mo></mrow><mo lspace="0.330em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><mi>ğƒ</mi></mrow></mrow></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">\int_{\mathbb{R}^{D}}\Delta p_{t}(\bm{\xi})[c+\log p_{t}(\bm{\xi})]~{}\mathrm{d}\bm{\xi}=-\int_{\mathbb{R}^{D}}\langle\nabla\log p_{t}(\bm{\xi}),\nabla p_{t}(\bm{\xi})\rangle~{}\mathrm{d}\bm{\xi}.</annotation><annotation encoding="application/x-llamapun">âˆ« start_POSTSUBSCRIPT blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT end_POSTSUBSCRIPT roman_Î” italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) [ italic_c + roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) ] roman_d bold_italic_Î¾ = - âˆ« start_POSTSUBSCRIPT blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT end_POSTSUBSCRIPT âŸ¨ âˆ‡ roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) , âˆ‡ italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) âŸ© roman_d bold_italic_Î¾ .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.59)</span></td>
</tr></tbody>
</table>
</div>
</div>
<div class="ltx_proof">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h6>
<div class="ltx_para" id="S2.SS3.SSSx2.p2">
<p class="ltx_p">The basic idea of this proof is in two steps:</p>
<ul class="ltx_itemize" id="S2.I4">
<li class="ltx_item" id="S2.I4.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span>
<div class="ltx_para" id="S2.I4.i1.p1">
<p class="ltx_p">First, apply Greenâ€™s theorem to do integration by parts over a compact set;</p>
</div>
</li>
<li class="ltx_item" id="S2.I4.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span>
<div class="ltx_para" id="S2.I4.i2.p1">
<p class="ltx_p">Second, send the radius of this compact set to <math alttext="+\infty" class="ltx_Math" display="inline" id="S2.I4.i2.p1.m1"><semantics><mrow><mo>+</mo><mi mathvariant="normal">âˆ</mi></mrow><annotation encoding="application/x-tex">+\infty</annotation><annotation encoding="application/x-llamapun">+ âˆ</annotation></semantics></math>, to get integrals over all of <math alttext="\mathbb{R}^{D}" class="ltx_Math" display="inline" id="S2.I4.i2.p1.m2"><semantics><msup><mi>â„</mi><mi>D</mi></msup><annotation encoding="application/x-tex">\mathbb{R}^{D}</annotation><annotation encoding="application/x-llamapun">blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
</li>
</ul>
<p class="ltx_p">Greenâ€™s theorem says that for any compact set <math alttext="\mathcal{K}\subseteq\mathbb{R}^{D}" class="ltx_Math" display="inline" id="S2.SS3.SSSx2.p2.m1"><semantics><mrow><mi class="ltx_font_mathcaligraphic">ğ’¦</mi><mo>âŠ†</mo><msup><mi>â„</mi><mi>D</mi></msup></mrow><annotation encoding="application/x-tex">\mathcal{K}\subseteq\mathbb{R}^{D}</annotation><annotation encoding="application/x-llamapun">caligraphic_K âŠ† blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT</annotation></semantics></math>, twice continuously differentiable <math alttext="\phi\colon\mathbb{R}^{D}\to\mathbb{R}" class="ltx_Math" display="inline" id="S2.SS3.SSSx2.p2.m2"><semantics><mrow><mi>Ï•</mi><mo lspace="0.278em" rspace="0.278em">:</mo><mrow><msup><mi>â„</mi><mi>D</mi></msup><mo stretchy="false">â†’</mo><mi>â„</mi></mrow></mrow><annotation encoding="application/x-tex">\phi\colon\mathbb{R}^{D}\to\mathbb{R}</annotation><annotation encoding="application/x-llamapun">italic_Ï• : blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT â†’ blackboard_R</annotation></semantics></math>, and continuously differentiable <math alttext="\psi\colon\mathbb{R}^{D}\to\mathbb{R}" class="ltx_Math" display="inline" id="S2.SS3.SSSx2.p2.m3"><semantics><mrow><mi>Ïˆ</mi><mo lspace="0.278em" rspace="0.278em">:</mo><mrow><msup><mi>â„</mi><mi>D</mi></msup><mo stretchy="false">â†’</mo><mi>â„</mi></mrow></mrow><annotation encoding="application/x-tex">\psi\colon\mathbb{R}^{D}\to\mathbb{R}</annotation><annotation encoding="application/x-llamapun">italic_Ïˆ : blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT â†’ blackboard_R</annotation></semantics></math>,</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E60">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\int_{\mathcal{K}}\left\{\psi(\bm{\xi})\Delta\phi(\bm{\xi})+\langle\nabla\psi(\bm{\xi}),\nabla\phi(\bm{\xi})\rangle\right\}~{}\mathrm{d}\bm{\xi}=\int_{\partial\mathcal{K}}\psi(\bm{\xi})\langle\nabla\phi(\bm{\xi}),\bm{n}(\bm{\xi})\rangle~{}\mathrm{d}\sigma(\bm{\xi})" class="ltx_Math" display="block" id="S2.E60.m1"><semantics><mrow><mrow><msub><mo>âˆ«</mo><mi class="ltx_font_mathcaligraphic">ğ’¦</mi></msub><mrow><mrow><mo lspace="0em">{</mo><mrow><mrow><mi>Ïˆ</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mi mathvariant="normal">Î”</mi><mo lspace="0em" rspace="0em">â€‹</mo><mi>Ï•</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>+</mo><mrow><mo stretchy="false">âŸ¨</mo><mrow><mrow><mo rspace="0.167em">âˆ‡</mo><mi>Ïˆ</mi></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>,</mo><mrow><mrow><mo rspace="0.167em">âˆ‡</mo><mi>Ï•</mi></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">âŸ©</mo></mrow></mrow><mo>}</mo></mrow><mo lspace="0.330em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><mi>ğƒ</mi></mrow></mrow></mrow><mo rspace="0.111em">=</mo><mrow><msub><mo>âˆ«</mo><mrow><mo rspace="0em">âˆ‚</mo><mi class="ltx_font_mathcaligraphic">ğ’¦</mi></mrow></msub><mrow><mi>Ïˆ</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">âŸ¨</mo><mrow><mrow><mo rspace="0.167em">âˆ‡</mo><mi>Ï•</mi></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>,</mo><mrow><mi>ğ’</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">âŸ©</mo></mrow><mo lspace="0.330em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><mi>Ïƒ</mi></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">\int_{\mathcal{K}}\left\{\psi(\bm{\xi})\Delta\phi(\bm{\xi})+\langle\nabla\psi(\bm{\xi}),\nabla\phi(\bm{\xi})\rangle\right\}~{}\mathrm{d}\bm{\xi}=\int_{\partial\mathcal{K}}\psi(\bm{\xi})\langle\nabla\phi(\bm{\xi}),\bm{n}(\bm{\xi})\rangle~{}\mathrm{d}\sigma(\bm{\xi})</annotation><annotation encoding="application/x-llamapun">âˆ« start_POSTSUBSCRIPT caligraphic_K end_POSTSUBSCRIPT { italic_Ïˆ ( bold_italic_Î¾ ) roman_Î” italic_Ï• ( bold_italic_Î¾ ) + âŸ¨ âˆ‡ italic_Ïˆ ( bold_italic_Î¾ ) , âˆ‡ italic_Ï• ( bold_italic_Î¾ ) âŸ© } roman_d bold_italic_Î¾ = âˆ« start_POSTSUBSCRIPT âˆ‚ caligraphic_K end_POSTSUBSCRIPT italic_Ïˆ ( bold_italic_Î¾ ) âŸ¨ âˆ‡ italic_Ï• ( bold_italic_Î¾ ) , bold_italic_n ( bold_italic_Î¾ ) âŸ© roman_d italic_Ïƒ ( bold_italic_Î¾ )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.60)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">where <math alttext="~{}\mathrm{d}\sigma(\bm{\xi})" class="ltx_Math" display="inline" id="S2.SS3.SSSx2.p2.m4"><semantics><mrow><mi mathvariant="normal">d</mi><mo lspace="0em" rspace="0em">â€‹</mo><mi>Ïƒ</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">~{}\mathrm{d}\sigma(\bm{\xi})</annotation><annotation encoding="application/x-llamapun">roman_d italic_Ïƒ ( bold_italic_Î¾ )</annotation></semantics></math> denotes an integral over the â€œsurface measureâ€, i.e., the inherited measure on <math alttext="\partial\mathcal{K}" class="ltx_Math" display="inline" id="S2.SS3.SSSx2.p2.m5"><semantics><mrow><mo rspace="0em">âˆ‚</mo><mi class="ltx_font_mathcaligraphic">ğ’¦</mi></mrow><annotation encoding="application/x-tex">\partial\mathcal{K}</annotation><annotation encoding="application/x-llamapun">âˆ‚ caligraphic_K</annotation></semantics></math>, namely the boundary of <math alttext="\mathcal{K}" class="ltx_Math" display="inline" id="S2.SS3.SSSx2.p2.m6"><semantics><mi class="ltx_font_mathcaligraphic">ğ’¦</mi><annotation encoding="application/x-tex">\mathcal{K}</annotation><annotation encoding="application/x-llamapun">caligraphic_K</annotation></semantics></math>, and accordingly <math alttext="\bm{\xi}" class="ltx_Math" display="inline" id="S2.SS3.SSSx2.p2.m7"><semantics><mi>ğƒ</mi><annotation encoding="application/x-tex">\bm{\xi}</annotation><annotation encoding="application/x-llamapun">bold_italic_Î¾</annotation></semantics></math> takes values on this surface and <math alttext="\bm{n}(\bm{\xi})" class="ltx_Math" display="inline" id="S2.SS3.SSSx2.p2.m8"><semantics><mrow><mi>ğ’</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">\bm{n}(\bm{\xi})</annotation><annotation encoding="application/x-llamapun">bold_italic_n ( bold_italic_Î¾ )</annotation></semantics></math> is the unit normal vector to <math alttext="\mathcal{K}" class="ltx_Math" display="inline" id="S2.SS3.SSSx2.p2.m9"><semantics><mi class="ltx_font_mathcaligraphic">ğ’¦</mi><annotation encoding="application/x-tex">\mathcal{K}</annotation><annotation encoding="application/x-llamapun">caligraphic_K</annotation></semantics></math> at the surface point <math alttext="\bm{\xi}" class="ltx_Math" display="inline" id="S2.SS3.SSSx2.p2.m10"><semantics><mi>ğƒ</mi><annotation encoding="application/x-tex">\bm{\xi}</annotation><annotation encoding="application/x-llamapun">bold_italic_Î¾</annotation></semantics></math>. Now, taking <math alttext="\phi(\bm{\xi})\doteq p_{t}(\bm{\xi})" class="ltx_Math" display="inline" id="S2.SS3.SSSx2.p2.m11"><semantics><mrow><mrow><mi>Ï•</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>â‰</mo><mrow><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\phi(\bm{\xi})\doteq p_{t}(\bm{\xi})</annotation><annotation encoding="application/x-llamapun">italic_Ï• ( bold_italic_Î¾ ) â‰ italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ )</annotation></semantics></math> and <math alttext="\psi(\bm{\xi})\doteq c+\log p_{t}(\bm{\xi})" class="ltx_Math" display="inline" id="S2.SS3.SSSx2.p2.m12"><semantics><mrow><mrow><mi>Ïˆ</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>â‰</mo><mrow><mi>c</mi><mo>+</mo><mrow><mrow><mi>log</mi><mo lspace="0.167em">â¡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">\psi(\bm{\xi})\doteq c+\log p_{t}(\bm{\xi})</annotation><annotation encoding="application/x-llamapun">italic_Ïˆ ( bold_italic_Î¾ ) â‰ italic_c + roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ )</annotation></semantics></math>, over a ball <math alttext="B_{r}(\bm{0})" class="ltx_Math" display="inline" id="S2.SS3.SSSx2.p2.m13"><semantics><mrow><msub><mi>B</mi><mi>r</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mn>ğŸ</mn><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">B_{r}(\bm{0})</annotation><annotation encoding="application/x-llamapun">italic_B start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( bold_0 )</annotation></semantics></math> of radius <math alttext="r&gt;0" class="ltx_Math" display="inline" id="S2.SS3.SSSx2.p2.m14"><semantics><mrow><mi>r</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">r&gt;0</annotation><annotation encoding="application/x-llamapun">italic_r &gt; 0</annotation></semantics></math> centered at <math alttext="\bm{0}" class="ltx_Math" display="inline" id="S2.SS3.SSSx2.p2.m15"><semantics><mn>ğŸ</mn><annotation encoding="application/x-tex">\bm{0}</annotation><annotation encoding="application/x-llamapun">bold_0</annotation></semantics></math> (so that <math alttext="\partial B_{r}(\bm{0})" class="ltx_Math" display="inline" id="S2.SS3.SSSx2.p2.m16"><semantics><mrow><mo rspace="0em">âˆ‚</mo><mrow><msub><mi>B</mi><mi>r</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mn>ğŸ</mn><mo stretchy="false">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\partial B_{r}(\bm{0})</annotation><annotation encoding="application/x-llamapun">âˆ‚ italic_B start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( bold_0 )</annotation></semantics></math> is the sphere of radius <math alttext="r" class="ltx_Math" display="inline" id="S2.SS3.SSSx2.p2.m17"><semantics><mi>r</mi><annotation encoding="application/x-tex">r</annotation><annotation encoding="application/x-llamapun">italic_r</annotation></semantics></math> centered at <math alttext="\bm{0}" class="ltx_Math" display="inline" id="S2.SS3.SSSx2.p2.m18"><semantics><mn>ğŸ</mn><annotation encoding="application/x-tex">\bm{0}</annotation><annotation encoding="application/x-llamapun">bold_0</annotation></semantics></math> and <math alttext="\bm{n}(\bm{\xi})=\bm{\xi}/\|\bm{\xi}\|_{2}=\bm{\xi}/r" class="ltx_Math" display="inline" id="S2.SS3.SSSx2.p2.m19"><semantics><mrow><mrow><mi>ğ’</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mi>ğƒ</mi><mo>/</mo><msub><mrow><mo stretchy="false">â€–</mo><mi>ğƒ</mi><mo stretchy="false">â€–</mo></mrow><mn>2</mn></msub></mrow><mo>=</mo><mrow><mi>ğƒ</mi><mo>/</mo><mi>r</mi></mrow></mrow><annotation encoding="application/x-tex">\bm{n}(\bm{\xi})=\bm{\xi}/\|\bm{\xi}\|_{2}=\bm{\xi}/r</annotation><annotation encoding="application/x-llamapun">bold_italic_n ( bold_italic_Î¾ ) = bold_italic_Î¾ / âˆ¥ bold_italic_Î¾ âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = bold_italic_Î¾ / italic_r</annotation></semantics></math>):</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S3.EGx136">
<tbody id="S2.E61"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\int_{B_{r}(\bm{0})}\left\{\Delta p_{t}(\bm{\xi})[c+\log p_{t}(\bm{\xi})]+\langle\nabla\log p_{t}(\bm{\xi}),\nabla p_{t}(\bm{\xi})\rangle\right\}~{}\mathrm{d}\bm{\xi}" class="ltx_Math" display="inline" id="S2.E61.m1"><semantics><mrow><mstyle displaystyle="true"><msub><mo>âˆ«</mo><mrow><msub><mi>B</mi><mi>r</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mn>ğŸ</mn><mo stretchy="false">)</mo></mrow></mrow></msub></mstyle><mrow><mrow><mo>{</mo><mrow><mrow><mi mathvariant="normal">Î”</mi><mo lspace="0em" rspace="0em">â€‹</mo><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">[</mo><mrow><mi>c</mi><mo>+</mo><mrow><mrow><mi>log</mi><mo lspace="0.167em">â¡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mo stretchy="false">]</mo></mrow></mrow><mo>+</mo><mrow><mo stretchy="false">âŸ¨</mo><mrow><mrow><mrow><mo rspace="0.167em">âˆ‡</mo><mi>log</mi></mrow><mo lspace="0.167em">â¡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>,</mo><mrow><mrow><mo rspace="0.167em">âˆ‡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">âŸ©</mo></mrow></mrow><mo>}</mo></mrow><mo lspace="0.330em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><mi>ğƒ</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle\int_{B_{r}(\bm{0})}\left\{\Delta p_{t}(\bm{\xi})[c+\log p_{t}(\bm{\xi})]+\langle\nabla\log p_{t}(\bm{\xi}),\nabla p_{t}(\bm{\xi})\rangle\right\}~{}\mathrm{d}\bm{\xi}</annotation><annotation encoding="application/x-llamapun">âˆ« start_POSTSUBSCRIPT italic_B start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( bold_0 ) end_POSTSUBSCRIPT { roman_Î” italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) [ italic_c + roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) ] + âŸ¨ âˆ‡ roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) , âˆ‡ italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) âŸ© } roman_d bold_italic_Î¾</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.61)</span></td>
</tr></tbody>
<tbody id="S2.E62"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\int_{\partial B_{r}(\bm{0})}[c+\log p_{t}(\bm{\xi})]\left\langle\nabla p_{t}(\bm{\xi}),\frac{\bm{\xi}}{r}\right\rangle~{}\mathrm{d}\sigma(\bm{\xi})" class="ltx_Math" display="inline" id="S2.E62.m1"><semantics><mrow><mi></mi><mo>=</mo><mrow><mstyle displaystyle="true"><msub><mo>âˆ«</mo><mrow><mo rspace="0em">âˆ‚</mo><mrow><msub><mi>B</mi><mi>r</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mn>ğŸ</mn><mo stretchy="false">)</mo></mrow></mrow></mrow></msub></mstyle><mrow><mrow><mo stretchy="false">[</mo><mrow><mi>c</mi><mo>+</mo><mrow><mrow><mi>log</mi><mo lspace="0.167em">â¡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mo stretchy="false">]</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo>âŸ¨</mo><mrow><mrow><mo rspace="0.167em">âˆ‡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>,</mo><mstyle displaystyle="true"><mfrac><mi>ğƒ</mi><mi>r</mi></mfrac></mstyle><mo>âŸ©</mo></mrow><mo lspace="0.330em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><mi>Ïƒ</mi></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=\int_{\partial B_{r}(\bm{0})}[c+\log p_{t}(\bm{\xi})]\left\langle\nabla p_{t}(\bm{\xi}),\frac{\bm{\xi}}{r}\right\rangle~{}\mathrm{d}\sigma(\bm{\xi})</annotation><annotation encoding="application/x-llamapun">= âˆ« start_POSTSUBSCRIPT âˆ‚ italic_B start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( bold_0 ) end_POSTSUBSCRIPT [ italic_c + roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) ] âŸ¨ âˆ‡ italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) , divide start_ARG bold_italic_Î¾ end_ARG start_ARG italic_r end_ARG âŸ© roman_d italic_Ïƒ ( bold_italic_Î¾ )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.62)</span></td>
</tr></tbody>
<tbody id="S2.E63"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{1}{r}\int_{\partial B_{r}(\bm{0})}[c+\log p_{t}(\bm{\xi})]\left\langle\nabla p_{t}(\bm{\xi}),\bm{\xi}\right\rangle~{}\mathrm{d}\sigma(\bm{\xi})." class="ltx_Math" display="inline" id="S2.E63.m1"><semantics><mrow><mrow><mi></mi><mo>=</mo><mrow><mstyle displaystyle="true"><mfrac><mn>1</mn><mi>r</mi></mfrac></mstyle><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mstyle displaystyle="true"><msub><mo>âˆ«</mo><mrow><mo rspace="0em">âˆ‚</mo><mrow><msub><mi>B</mi><mi>r</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mn>ğŸ</mn><mo stretchy="false">)</mo></mrow></mrow></mrow></msub></mstyle><mrow><mrow><mo stretchy="false">[</mo><mrow><mi>c</mi><mo>+</mo><mrow><mrow><mi>log</mi><mo lspace="0.167em">â¡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mo stretchy="false">]</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo>âŸ¨</mo><mrow><mrow><mo rspace="0.167em">âˆ‡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>,</mo><mi>ğƒ</mi><mo>âŸ©</mo></mrow><mo lspace="0.330em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><mi>Ïƒ</mi></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">\displaystyle=\frac{1}{r}\int_{\partial B_{r}(\bm{0})}[c+\log p_{t}(\bm{\xi})]\left\langle\nabla p_{t}(\bm{\xi}),\bm{\xi}\right\rangle~{}\mathrm{d}\sigma(\bm{\xi}).</annotation><annotation encoding="application/x-llamapun">= divide start_ARG 1 end_ARG start_ARG italic_r end_ARG âˆ« start_POSTSUBSCRIPT âˆ‚ italic_B start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( bold_0 ) end_POSTSUBSCRIPT [ italic_c + roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) ] âŸ¨ âˆ‡ italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) , bold_italic_Î¾ âŸ© roman_d italic_Ïƒ ( bold_italic_Î¾ ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.63)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">Sending <math alttext="r\to\infty" class="ltx_Math" display="inline" id="S2.SS3.SSSx2.p2.m20"><semantics><mrow><mi>r</mi><mo stretchy="false">â†’</mo><mi mathvariant="normal">âˆ</mi></mrow><annotation encoding="application/x-tex">r\to\infty</annotation><annotation encoding="application/x-llamapun">italic_r â†’ âˆ</annotation></semantics></math>, it holds that</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S3.EGx137">
<tbody id="S2.E64"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\int_{\mathbb{R}^{D}}\left\{\Delta p_{t}(\bm{\xi})[c+\log p_{t}(\bm{\xi})]+\langle\nabla\log p_{t}(\bm{\xi}),\nabla p_{t}(\bm{\xi})\rangle\right\}~{}\mathrm{d}\bm{\xi}" class="ltx_Math" display="inline" id="S2.E64.m1"><semantics><mrow><mstyle displaystyle="true"><msub><mo>âˆ«</mo><msup><mi>â„</mi><mi>D</mi></msup></msub></mstyle><mrow><mrow><mo>{</mo><mrow><mrow><mi mathvariant="normal">Î”</mi><mo lspace="0em" rspace="0em">â€‹</mo><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">[</mo><mrow><mi>c</mi><mo>+</mo><mrow><mrow><mi>log</mi><mo lspace="0.167em">â¡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mo stretchy="false">]</mo></mrow></mrow><mo>+</mo><mrow><mo stretchy="false">âŸ¨</mo><mrow><mrow><mrow><mo rspace="0.167em">âˆ‡</mo><mi>log</mi></mrow><mo lspace="0.167em">â¡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>,</mo><mrow><mrow><mo rspace="0.167em">âˆ‡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">âŸ©</mo></mrow></mrow><mo>}</mo></mrow><mo lspace="0.330em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><mi>ğƒ</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle\int_{\mathbb{R}^{D}}\left\{\Delta p_{t}(\bm{\xi})[c+\log p_{t}(\bm{\xi})]+\langle\nabla\log p_{t}(\bm{\xi}),\nabla p_{t}(\bm{\xi})\rangle\right\}~{}\mathrm{d}\bm{\xi}</annotation><annotation encoding="application/x-llamapun">âˆ« start_POSTSUBSCRIPT blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT end_POSTSUBSCRIPT { roman_Î” italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) [ italic_c + roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) ] + âŸ¨ âˆ‡ roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) , âˆ‡ italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) âŸ© } roman_d bold_italic_Î¾</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.64)</span></td>
</tr></tbody>
<tbody id="S2.E65"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\lim_{r\to\infty}\int_{B_{r}(\bm{0})}\left\{\Delta p_{t}(\bm{\xi})[c+\log p_{t}(\bm{\xi})]+\langle\nabla\log p_{t}(\bm{\xi}),\nabla p_{t}(\bm{\xi})\rangle\right\}~{}\mathrm{d}\bm{\xi}" class="ltx_Math" display="inline" id="S2.E65.m1"><semantics><mrow><mi></mi><mo rspace="0.1389em">=</mo><mrow><munder><mo lspace="0.1389em" movablelimits="false" rspace="0.167em">lim</mo><mrow><mi>r</mi><mo stretchy="false">â†’</mo><mi mathvariant="normal">âˆ</mi></mrow></munder><mrow><mstyle displaystyle="true"><msub><mo>âˆ«</mo><mrow><msub><mi>B</mi><mi>r</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mn>ğŸ</mn><mo stretchy="false">)</mo></mrow></mrow></msub></mstyle><mrow><mrow><mo>{</mo><mrow><mrow><mi mathvariant="normal">Î”</mi><mo lspace="0em" rspace="0em">â€‹</mo><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">[</mo><mrow><mi>c</mi><mo>+</mo><mrow><mrow><mi>log</mi><mo lspace="0.167em">â¡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mo stretchy="false">]</mo></mrow></mrow><mo>+</mo><mrow><mo stretchy="false">âŸ¨</mo><mrow><mrow><mrow><mo rspace="0.167em">âˆ‡</mo><mi>log</mi></mrow><mo lspace="0.167em">â¡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>,</mo><mrow><mrow><mo rspace="0.167em">âˆ‡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">âŸ©</mo></mrow></mrow><mo>}</mo></mrow><mo lspace="0.330em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><mi>ğƒ</mi></mrow></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=\lim_{r\to\infty}\int_{B_{r}(\bm{0})}\left\{\Delta p_{t}(\bm{\xi})[c+\log p_{t}(\bm{\xi})]+\langle\nabla\log p_{t}(\bm{\xi}),\nabla p_{t}(\bm{\xi})\rangle\right\}~{}\mathrm{d}\bm{\xi}</annotation><annotation encoding="application/x-llamapun">= roman_lim start_POSTSUBSCRIPT italic_r â†’ âˆ end_POSTSUBSCRIPT âˆ« start_POSTSUBSCRIPT italic_B start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( bold_0 ) end_POSTSUBSCRIPT { roman_Î” italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) [ italic_c + roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) ] + âŸ¨ âˆ‡ roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) , âˆ‡ italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) âŸ© } roman_d bold_italic_Î¾</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.65)</span></td>
</tr></tbody>
<tbody id="S2.E66"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\lim_{r\to\infty}\int_{\partial B_{r}(\bm{0})}\left\{\Delta p_{t}(\bm{\xi})[c+\log p_{t}(\bm{\xi})]+\langle\nabla\log p_{t}(\bm{\xi}),\nabla p_{t}(\bm{\xi})\rangle\right\}~{}\mathrm{d}\bm{\xi}" class="ltx_Math" display="inline" id="S2.E66.m1"><semantics><mrow><mi></mi><mo rspace="0.1389em">=</mo><mrow><munder><mo lspace="0.1389em" movablelimits="false" rspace="0.167em">lim</mo><mrow><mi>r</mi><mo stretchy="false">â†’</mo><mi mathvariant="normal">âˆ</mi></mrow></munder><mrow><mstyle displaystyle="true"><msub><mo>âˆ«</mo><mrow><mo rspace="0em">âˆ‚</mo><mrow><msub><mi>B</mi><mi>r</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mn>ğŸ</mn><mo stretchy="false">)</mo></mrow></mrow></mrow></msub></mstyle><mrow><mrow><mo>{</mo><mrow><mrow><mi mathvariant="normal">Î”</mi><mo lspace="0em" rspace="0em">â€‹</mo><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">[</mo><mrow><mi>c</mi><mo>+</mo><mrow><mrow><mi>log</mi><mo lspace="0.167em">â¡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mo stretchy="false">]</mo></mrow></mrow><mo>+</mo><mrow><mo stretchy="false">âŸ¨</mo><mrow><mrow><mrow><mo rspace="0.167em">âˆ‡</mo><mi>log</mi></mrow><mo lspace="0.167em">â¡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>,</mo><mrow><mrow><mo rspace="0.167em">âˆ‡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">âŸ©</mo></mrow></mrow><mo>}</mo></mrow><mo lspace="0.330em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><mi>ğƒ</mi></mrow></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=\lim_{r\to\infty}\int_{\partial B_{r}(\bm{0})}\left\{\Delta p_{t}(\bm{\xi})[c+\log p_{t}(\bm{\xi})]+\langle\nabla\log p_{t}(\bm{\xi}),\nabla p_{t}(\bm{\xi})\rangle\right\}~{}\mathrm{d}\bm{\xi}</annotation><annotation encoding="application/x-llamapun">= roman_lim start_POSTSUBSCRIPT italic_r â†’ âˆ end_POSTSUBSCRIPT âˆ« start_POSTSUBSCRIPT âˆ‚ italic_B start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( bold_0 ) end_POSTSUBSCRIPT { roman_Î” italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) [ italic_c + roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) ] + âŸ¨ âˆ‡ roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) , âˆ‡ italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) âŸ© } roman_d bold_italic_Î¾</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.66)</span></td>
</tr></tbody>
<tbody id="S2.E67"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\lim_{r\to\infty}\frac{1}{r}\int_{\partial B_{r}(\bm{0})}[c+\log p_{t}(\bm{\xi})]\left\langle\nabla p_{t}(\bm{\xi}),\bm{\xi}\right\rangle~{}\mathrm{d}\sigma(\bm{\xi})," class="ltx_Math" display="inline" id="S2.E67.m1"><semantics><mrow><mrow><mi></mi><mo rspace="0.1389em">=</mo><mrow><munder><mo lspace="0.1389em" movablelimits="false" rspace="0.167em">lim</mo><mrow><mi>r</mi><mo stretchy="false">â†’</mo><mi mathvariant="normal">âˆ</mi></mrow></munder><mrow><mstyle displaystyle="true"><mfrac><mn>1</mn><mi>r</mi></mfrac></mstyle><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mstyle displaystyle="true"><msub><mo>âˆ«</mo><mrow><mo rspace="0em">âˆ‚</mo><mrow><msub><mi>B</mi><mi>r</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mn>ğŸ</mn><mo stretchy="false">)</mo></mrow></mrow></mrow></msub></mstyle><mrow><mrow><mo stretchy="false">[</mo><mrow><mi>c</mi><mo>+</mo><mrow><mrow><mi>log</mi><mo lspace="0.167em">â¡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mo stretchy="false">]</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo>âŸ¨</mo><mrow><mrow><mo rspace="0.167em">âˆ‡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>,</mo><mi>ğƒ</mi><mo>âŸ©</mo></mrow><mo lspace="0.330em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><mi>Ïƒ</mi></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">\displaystyle=\lim_{r\to\infty}\frac{1}{r}\int_{\partial B_{r}(\bm{0})}[c+\log p_{t}(\bm{\xi})]\left\langle\nabla p_{t}(\bm{\xi}),\bm{\xi}\right\rangle~{}\mathrm{d}\sigma(\bm{\xi}),</annotation><annotation encoding="application/x-llamapun">= roman_lim start_POSTSUBSCRIPT italic_r â†’ âˆ end_POSTSUBSCRIPT divide start_ARG 1 end_ARG start_ARG italic_r end_ARG âˆ« start_POSTSUBSCRIPT âˆ‚ italic_B start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( bold_0 ) end_POSTSUBSCRIPT [ italic_c + roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) ] âŸ¨ âˆ‡ italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) , bold_italic_Î¾ âŸ© roman_d italic_Ïƒ ( bold_italic_Î¾ ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.67)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">where the first inequality follows by dominated convergence on the integrand. It remains to compute the last limit. For this, we take asymptotic expansions of each term. The main device is as follows: for <math alttext="\bm{\xi}\in\partial B_{r}(\bm{0})" class="ltx_Math" display="inline" id="S2.SS3.SSSx2.p2.m21"><semantics><mrow><mi>ğƒ</mi><mo rspace="0.1389em">âˆˆ</mo><mrow><mo lspace="0.1389em" rspace="0em">âˆ‚</mo><mrow><msub><mi>B</mi><mi>r</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mn>ğŸ</mn><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">\bm{\xi}\in\partial B_{r}(\bm{0})</annotation><annotation encoding="application/x-llamapun">bold_italic_Î¾ âˆˆ âˆ‚ italic_B start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( bold_0 )</annotation></semantics></math>, we have <math alttext="\|\bm{\xi}\|_{2}=r" class="ltx_Math" display="inline" id="S2.SS3.SSSx2.p2.m22"><semantics><mrow><msub><mrow><mo stretchy="false">â€–</mo><mi>ğƒ</mi><mo stretchy="false">â€–</mo></mrow><mn>2</mn></msub><mo>=</mo><mi>r</mi></mrow><annotation encoding="application/x-tex">\|\bm{\xi}\|_{2}=r</annotation><annotation encoding="application/x-llamapun">âˆ¥ bold_italic_Î¾ âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = italic_r</annotation></semantics></math>, so</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S3.EGx138">
<tbody id="S2.E68"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle p_{t}(\bm{\xi})" class="ltx_Math" display="inline" id="S2.E68.m1"><semantics><mrow><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">\displaystyle p_{t}(\bm{\xi})</annotation><annotation encoding="application/x-llamapun">italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\operatorname{\mathbb{E}}[\varphi_{t}(\bm{\xi}-\bm{x})]" class="ltx_Math" display="inline" id="S2.E68.m2"><semantics><mrow><mi></mi><mo>=</mo><mrow><mi>ğ”¼</mi><mo>â¡</mo><mrow><mo stretchy="false">[</mo><mrow><msub><mi>Ï†</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’™</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">]</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=\operatorname{\mathbb{E}}[\varphi_{t}(\bm{\xi}-\bm{x})]</annotation><annotation encoding="application/x-llamapun">= blackboard_E [ italic_Ï† start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ - bold_italic_x ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.68)</span></td>
</tr></tbody>
<tbody id="S2.E69"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\operatorname{\mathbb{E}}\left[\underbrace{\frac{1}{(2\pi)^{D/2}t^{D}}}_{\doteq C_{t}}e^{-\|\bm{\xi}-\bm{x}\|_{2}^{2}/(2t^{2})}\right]" class="ltx_Math" display="inline" id="S2.E69.m1"><semantics><mrow><mi></mi><mo>=</mo><mrow><mi>ğ”¼</mi><mo>â¡</mo><mrow><mo>[</mo><mrow><munder><munder accentunder="true"><mstyle displaystyle="true"><mfrac><mn>1</mn><mrow><msup><mrow><mo stretchy="false">(</mo><mrow><mn>2</mn><mo lspace="0em" rspace="0em">â€‹</mo><mi>Ï€</mi></mrow><mo stretchy="false">)</mo></mrow><mrow><mi>D</mi><mo>/</mo><mn>2</mn></mrow></msup><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>t</mi><mi>D</mi></msup></mrow></mfrac></mstyle><mo>âŸ</mo></munder><mrow><mi></mi><mo>â‰</mo><msub><mi>C</mi><mi>t</mi></msub></mrow></munder><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>e</mi><mrow><mo>âˆ’</mo><mrow><msubsup><mrow><mo stretchy="false">â€–</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’™</mi></mrow><mo stretchy="false">â€–</mo></mrow><mn>2</mn><mn>2</mn></msubsup><mo>/</mo><mrow><mo stretchy="false">(</mo><mrow><mn>2</mn><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>t</mi><mn>2</mn></msup></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></msup></mrow><mo>]</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=\operatorname{\mathbb{E}}\left[\underbrace{\frac{1}{(2\pi)^{D/2}t^{D}}}_{\doteq C_{t}}e^{-\|\bm{\xi}-\bm{x}\|_{2}^{2}/(2t^{2})}\right]</annotation><annotation encoding="application/x-llamapun">= blackboard_E [ underâŸ start_ARG divide start_ARG 1 end_ARG start_ARG ( 2 italic_Ï€ ) start_POSTSUPERSCRIPT italic_D / 2 end_POSTSUPERSCRIPT italic_t start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT end_ARG end_ARG start_POSTSUBSCRIPT â‰ italic_C start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_e start_POSTSUPERSCRIPT - âˆ¥ bold_italic_Î¾ - bold_italic_x âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT / ( 2 italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) end_POSTSUPERSCRIPT ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.69)</span></td>
</tr></tbody>
<tbody id="S2.E70"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=C_{t}\operatorname{\mathbb{E}}\left[e^{-(\|\bm{\xi}\|_{2}^{2}-2\langle\bm{\xi},\bm{x}\rangle+\|\bm{x}\|_{2}^{2})/(2t^{2})}\right]" class="ltx_Math" display="inline" id="S2.E70.m1"><semantics><mrow><mi></mi><mo>=</mo><mrow><msub><mi>C</mi><mi>t</mi></msub><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mi>ğ”¼</mi><mo>â¡</mo><mrow><mo>[</mo><msup><mi>e</mi><mrow><mo>âˆ’</mo><mrow><mrow><mo stretchy="false">(</mo><mrow><mrow><msubsup><mrow><mo stretchy="false">â€–</mo><mi>ğƒ</mi><mo stretchy="false">â€–</mo></mrow><mn>2</mn><mn>2</mn></msubsup><mo>âˆ’</mo><mrow><mn>2</mn><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">âŸ¨</mo><mi>ğƒ</mi><mo>,</mo><mi>ğ’™</mi><mo stretchy="false">âŸ©</mo></mrow></mrow></mrow><mo>+</mo><msubsup><mrow><mo stretchy="false">â€–</mo><mi>ğ’™</mi><mo stretchy="false">â€–</mo></mrow><mn>2</mn><mn>2</mn></msubsup></mrow><mo stretchy="false">)</mo></mrow><mo>/</mo><mrow><mo stretchy="false">(</mo><mrow><mn>2</mn><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>t</mi><mn>2</mn></msup></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></msup><mo>]</mo></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=C_{t}\operatorname{\mathbb{E}}\left[e^{-(\|\bm{\xi}\|_{2}^{2}-2\langle\bm{\xi},\bm{x}\rangle+\|\bm{x}\|_{2}^{2})/(2t^{2})}\right]</annotation><annotation encoding="application/x-llamapun">= italic_C start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT blackboard_E [ italic_e start_POSTSUPERSCRIPT - ( âˆ¥ bold_italic_Î¾ âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT - 2 âŸ¨ bold_italic_Î¾ , bold_italic_x âŸ© + âˆ¥ bold_italic_x âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) / ( 2 italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) end_POSTSUPERSCRIPT ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.70)</span></td>
</tr></tbody>
<tbody id="S2.E71"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=C_{t}\operatorname{\mathbb{E}}\left[e^{-(r^{2}-2\langle\bm{\xi},\bm{x}\rangle+\|\bm{x}\|_{2}^{2})/(2t^{2})}\right]" class="ltx_Math" display="inline" id="S2.E71.m1"><semantics><mrow><mi></mi><mo>=</mo><mrow><msub><mi>C</mi><mi>t</mi></msub><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mi>ğ”¼</mi><mo>â¡</mo><mrow><mo>[</mo><msup><mi>e</mi><mrow><mo>âˆ’</mo><mrow><mrow><mo stretchy="false">(</mo><mrow><mrow><msup><mi>r</mi><mn>2</mn></msup><mo>âˆ’</mo><mrow><mn>2</mn><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">âŸ¨</mo><mi>ğƒ</mi><mo>,</mo><mi>ğ’™</mi><mo stretchy="false">âŸ©</mo></mrow></mrow></mrow><mo>+</mo><msubsup><mrow><mo stretchy="false">â€–</mo><mi>ğ’™</mi><mo stretchy="false">â€–</mo></mrow><mn>2</mn><mn>2</mn></msubsup></mrow><mo stretchy="false">)</mo></mrow><mo>/</mo><mrow><mo stretchy="false">(</mo><mrow><mn>2</mn><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>t</mi><mn>2</mn></msup></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></msup><mo>]</mo></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=C_{t}\operatorname{\mathbb{E}}\left[e^{-(r^{2}-2\langle\bm{\xi},\bm{x}\rangle+\|\bm{x}\|_{2}^{2})/(2t^{2})}\right]</annotation><annotation encoding="application/x-llamapun">= italic_C start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT blackboard_E [ italic_e start_POSTSUPERSCRIPT - ( italic_r start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT - 2 âŸ¨ bold_italic_Î¾ , bold_italic_x âŸ© + âˆ¥ bold_italic_x âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) / ( 2 italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) end_POSTSUPERSCRIPT ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.71)</span></td>
</tr></tbody>
<tbody id="S2.E72"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=C_{t}e^{-r^{2}/(2t^{2})}\operatorname{\mathbb{E}}[e^{(2\langle\bm{\xi},\bm{x}\rangle-\|\bm{x}\|_{2}^{2})/(2t^{2})}]." class="ltx_Math" display="inline" id="S2.E72.m1"><semantics><mrow><mrow><mi></mi><mo>=</mo><mrow><msub><mi>C</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>e</mi><mrow><mo>âˆ’</mo><mrow><msup><mi>r</mi><mn>2</mn></msup><mo>/</mo><mrow><mo stretchy="false">(</mo><mrow><mn>2</mn><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>t</mi><mn>2</mn></msup></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></msup><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mi>ğ”¼</mi><mo>â¡</mo><mrow><mo stretchy="false">[</mo><msup><mi>e</mi><mrow><mrow><mo stretchy="false">(</mo><mrow><mrow><mn>2</mn><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">âŸ¨</mo><mi>ğƒ</mi><mo>,</mo><mi>ğ’™</mi><mo stretchy="false">âŸ©</mo></mrow></mrow><mo>âˆ’</mo><msubsup><mrow><mo stretchy="false">â€–</mo><mi>ğ’™</mi><mo stretchy="false">â€–</mo></mrow><mn>2</mn><mn>2</mn></msubsup></mrow><mo stretchy="false">)</mo></mrow><mo>/</mo><mrow><mo stretchy="false">(</mo><mrow><mn>2</mn><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>t</mi><mn>2</mn></msup></mrow><mo stretchy="false">)</mo></mrow></mrow></msup><mo stretchy="false">]</mo></mrow></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">\displaystyle=C_{t}e^{-r^{2}/(2t^{2})}\operatorname{\mathbb{E}}[e^{(2\langle\bm{\xi},\bm{x}\rangle-\|\bm{x}\|_{2}^{2})/(2t^{2})}].</annotation><annotation encoding="application/x-llamapun">= italic_C start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT italic_e start_POSTSUPERSCRIPT - italic_r start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT / ( 2 italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) end_POSTSUPERSCRIPT blackboard_E [ italic_e start_POSTSUPERSCRIPT ( 2 âŸ¨ bold_italic_Î¾ , bold_italic_x âŸ© - âˆ¥ bold_italic_x âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) / ( 2 italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) end_POSTSUPERSCRIPT ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.72)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">Note that because <math alttext="\|\bm{\xi}\|_{2}=r" class="ltx_Math" display="inline" id="S2.SS3.SSSx2.p2.m23"><semantics><mrow><msub><mrow><mo stretchy="false">â€–</mo><mi>ğƒ</mi><mo stretchy="false">â€–</mo></mrow><mn>2</mn></msub><mo>=</mo><mi>r</mi></mrow><annotation encoding="application/x-tex">\|\bm{\xi}\|_{2}=r</annotation><annotation encoding="application/x-llamapun">âˆ¥ bold_italic_Î¾ âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = italic_r</annotation></semantics></math>, we have by Cauchy-Schwarz that</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E73">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="-2r\|\bm{x}\|_{2}-\|\bm{x}\|_{2}^{2}\leq 2\langle\bm{\xi},\bm{x}\rangle-\|\bm{x}\|_{2}^{2}\leq 2r\|\bm{x}\|_{2}-\|\bm{x}\|_{2}^{2}." class="ltx_Math" display="block" id="S2.E73.m1"><semantics><mrow><mrow><mrow><mrow><mo>âˆ’</mo><mrow><mn>2</mn><mo lspace="0em" rspace="0em">â€‹</mo><mi>r</mi><mo lspace="0em" rspace="0em">â€‹</mo><msub><mrow><mo stretchy="false">â€–</mo><mi>ğ’™</mi><mo stretchy="false">â€–</mo></mrow><mn>2</mn></msub></mrow></mrow><mo>âˆ’</mo><msubsup><mrow><mo stretchy="false">â€–</mo><mi>ğ’™</mi><mo stretchy="false">â€–</mo></mrow><mn>2</mn><mn>2</mn></msubsup></mrow><mo>â‰¤</mo><mrow><mrow><mn>2</mn><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">âŸ¨</mo><mi>ğƒ</mi><mo>,</mo><mi>ğ’™</mi><mo stretchy="false">âŸ©</mo></mrow></mrow><mo>âˆ’</mo><msubsup><mrow><mo stretchy="false">â€–</mo><mi>ğ’™</mi><mo stretchy="false">â€–</mo></mrow><mn>2</mn><mn>2</mn></msubsup></mrow><mo>â‰¤</mo><mrow><mrow><mn>2</mn><mo lspace="0em" rspace="0em">â€‹</mo><mi>r</mi><mo lspace="0em" rspace="0em">â€‹</mo><msub><mrow><mo stretchy="false">â€–</mo><mi>ğ’™</mi><mo stretchy="false">â€–</mo></mrow><mn>2</mn></msub></mrow><mo>âˆ’</mo><msubsup><mrow><mo stretchy="false">â€–</mo><mi>ğ’™</mi><mo stretchy="false">â€–</mo></mrow><mn>2</mn><mn>2</mn></msubsup></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">-2r\|\bm{x}\|_{2}-\|\bm{x}\|_{2}^{2}\leq 2\langle\bm{\xi},\bm{x}\rangle-\|\bm{x}\|_{2}^{2}\leq 2r\|\bm{x}\|_{2}-\|\bm{x}\|_{2}^{2}.</annotation><annotation encoding="application/x-llamapun">- 2 italic_r âˆ¥ bold_italic_x âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT - âˆ¥ bold_italic_x âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT â‰¤ 2 âŸ¨ bold_italic_Î¾ , bold_italic_x âŸ© - âˆ¥ bold_italic_x âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT â‰¤ 2 italic_r âˆ¥ bold_italic_x âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT - âˆ¥ bold_italic_x âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.73)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">Recall that by <a class="ltx_ref" href="#Thmassumption1" title="Assumption B.1. â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Assumption</span>Â <span class="ltx_text ltx_ref_tag">B.1</span></a>, <math alttext="\bm{x}" class="ltx_Math" display="inline" id="S2.SS3.SSSx2.p2.m24"><semantics><mi>ğ’™</mi><annotation encoding="application/x-tex">\bm{x}</annotation><annotation encoding="application/x-llamapun">bold_italic_x</annotation></semantics></math> is supported on a compact set <math alttext="\mathcal{S}" class="ltx_Math" display="inline" id="S2.SS3.SSSx2.p2.m25"><semantics><mi class="ltx_font_mathcaligraphic">ğ’®</mi><annotation encoding="application/x-tex">\mathcal{S}</annotation><annotation encoding="application/x-llamapun">caligraphic_S</annotation></semantics></math> of radius <math alttext="R" class="ltx_Math" display="inline" id="S2.SS3.SSSx2.p2.m26"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation><annotation encoding="application/x-llamapun">italic_R</annotation></semantics></math>. Thus</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E74">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="-2R(r+R)\leq 2\langle\bm{\xi},\bm{x}\rangle-\|\bm{x}\|_{2}^{2}\leq 2Rr." class="ltx_Math" display="block" id="S2.E74.m1"><semantics><mrow><mrow><mrow><mo>âˆ’</mo><mrow><mn>2</mn><mo lspace="0em" rspace="0em">â€‹</mo><mi>R</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mi>r</mi><mo>+</mo><mi>R</mi></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>â‰¤</mo><mrow><mrow><mn>2</mn><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">âŸ¨</mo><mi>ğƒ</mi><mo>,</mo><mi>ğ’™</mi><mo stretchy="false">âŸ©</mo></mrow></mrow><mo>âˆ’</mo><msubsup><mrow><mo stretchy="false">â€–</mo><mi>ğ’™</mi><mo stretchy="false">â€–</mo></mrow><mn>2</mn><mn>2</mn></msubsup></mrow><mo>â‰¤</mo><mrow><mn>2</mn><mo lspace="0em" rspace="0em">â€‹</mo><mi>R</mi><mo lspace="0em" rspace="0em">â€‹</mo><mi>r</mi></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">-2R(r+R)\leq 2\langle\bm{\xi},\bm{x}\rangle-\|\bm{x}\|_{2}^{2}\leq 2Rr.</annotation><annotation encoding="application/x-llamapun">- 2 italic_R ( italic_r + italic_R ) â‰¤ 2 âŸ¨ bold_italic_Î¾ , bold_italic_x âŸ© - âˆ¥ bold_italic_x âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT â‰¤ 2 italic_R italic_r .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.74)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">In other words, it holds</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E75">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="C_{t}e^{-[r^{2}+2R(r+R)]/(2t^{2})}\leq p_{t}(\bm{\xi})\leq C_{t}e^{[-r^{2}+2Rr]/(2t^{2})}." class="ltx_Math" display="block" id="S2.E75.m1"><semantics><mrow><mrow><mrow><msub><mi>C</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>e</mi><mrow><mo>âˆ’</mo><mrow><mrow><mo stretchy="false">[</mo><mrow><msup><mi>r</mi><mn>2</mn></msup><mo>+</mo><mrow><mn>2</mn><mo lspace="0em" rspace="0em">â€‹</mo><mi>R</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mi>r</mi><mo>+</mo><mi>R</mi></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow><mo stretchy="false">]</mo></mrow><mo>/</mo><mrow><mo stretchy="false">(</mo><mrow><mn>2</mn><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>t</mi><mn>2</mn></msup></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></msup></mrow><mo>â‰¤</mo><mrow><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>â‰¤</mo><mrow><msub><mi>C</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>e</mi><mrow><mrow><mo stretchy="false">[</mo><mrow><mrow><mo>âˆ’</mo><msup><mi>r</mi><mn>2</mn></msup></mrow><mo>+</mo><mrow><mn>2</mn><mo lspace="0em" rspace="0em">â€‹</mo><mi>R</mi><mo lspace="0em" rspace="0em">â€‹</mo><mi>r</mi></mrow></mrow><mo stretchy="false">]</mo></mrow><mo>/</mo><mrow><mo stretchy="false">(</mo><mrow><mn>2</mn><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>t</mi><mn>2</mn></msup></mrow><mo stretchy="false">)</mo></mrow></mrow></msup></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">C_{t}e^{-[r^{2}+2R(r+R)]/(2t^{2})}\leq p_{t}(\bm{\xi})\leq C_{t}e^{[-r^{2}+2Rr]/(2t^{2})}.</annotation><annotation encoding="application/x-llamapun">italic_C start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT italic_e start_POSTSUPERSCRIPT - [ italic_r start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + 2 italic_R ( italic_r + italic_R ) ] / ( 2 italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) end_POSTSUPERSCRIPT â‰¤ italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) â‰¤ italic_C start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT italic_e start_POSTSUPERSCRIPT [ - italic_r start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + 2 italic_R italic_r ] / ( 2 italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.75)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">Now to compute the gradient, we can use <a class="ltx_ref" href="#Thmproposition1" title="Proposition B.1. â€£ Derivative Computations â€£ B.2.3 Technical Lemmas and Intermediate Results â€£ B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Proposition</span>Â <span class="ltx_text ltx_ref_tag">B.1</span></a> and linearity of expectation to compute</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S3.EGx139">
<tbody id="S2.E76"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\langle\nabla p_{t}(\bm{\xi}),\bm{\xi}\rangle" class="ltx_Math" display="inline" id="S2.E76.m1"><semantics><mrow><mo stretchy="false">âŸ¨</mo><mrow><mrow><mo rspace="0.167em">âˆ‡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>,</mo><mi>ğƒ</mi><mo stretchy="false">âŸ©</mo></mrow><annotation encoding="application/x-tex">\displaystyle\langle\nabla p_{t}(\bm{\xi}),\bm{\xi}\rangle</annotation><annotation encoding="application/x-llamapun">âŸ¨ âˆ‡ italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) , bold_italic_Î¾ âŸ©</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\left\langle-\frac{1}{t^{2}}\operatorname{\mathbb{E}}\left[\left(\bm{\xi}-\bm{x}\right)\varphi_{t}(\bm{\xi}-\bm{x})\right],\bm{\xi}\right\rangle" class="ltx_Math" display="inline" id="S2.E76.m2"><semantics><mrow><mi></mi><mo>=</mo><mrow><mo>âŸ¨</mo><mrow><mo>âˆ’</mo><mrow><mstyle displaystyle="true"><mfrac><mn>1</mn><msup><mi>t</mi><mn>2</mn></msup></mfrac></mstyle><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mi>ğ”¼</mi><mo>â¡</mo><mrow><mo>[</mo><mrow><mrow><mo>(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’™</mi></mrow><mo>)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><msub><mi>Ï†</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’™</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>]</mo></mrow></mrow></mrow></mrow><mo>,</mo><mi>ğƒ</mi><mo>âŸ©</mo></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=\left\langle-\frac{1}{t^{2}}\operatorname{\mathbb{E}}\left[\left(\bm{\xi}-\bm{x}\right)\varphi_{t}(\bm{\xi}-\bm{x})\right],\bm{\xi}\right\rangle</annotation><annotation encoding="application/x-llamapun">= âŸ¨ - divide start_ARG 1 end_ARG start_ARG italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG blackboard_E [ ( bold_italic_Î¾ - bold_italic_x ) italic_Ï† start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ - bold_italic_x ) ] , bold_italic_Î¾ âŸ©</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.76)</span></td>
</tr></tbody>
<tbody id="S2.E77"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=-\frac{1}{t^{2}}\operatorname{\mathbb{E}}\left[\langle\bm{\xi}-\bm{x},\bm{\xi}\rangle\varphi_{t}(\bm{\xi}-\bm{x})\right]" class="ltx_Math" display="inline" id="S2.E77.m1"><semantics><mrow><mi></mi><mo>=</mo><mrow><mo>âˆ’</mo><mrow><mstyle displaystyle="true"><mfrac><mn>1</mn><msup><mi>t</mi><mn>2</mn></msup></mfrac></mstyle><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mi>ğ”¼</mi><mo>â¡</mo><mrow><mo>[</mo><mrow><mrow><mo stretchy="false">âŸ¨</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’™</mi></mrow><mo>,</mo><mi>ğƒ</mi><mo stretchy="false">âŸ©</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><msub><mi>Ï†</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’™</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>]</mo></mrow></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=-\frac{1}{t^{2}}\operatorname{\mathbb{E}}\left[\langle\bm{\xi}-\bm{x},\bm{\xi}\rangle\varphi_{t}(\bm{\xi}-\bm{x})\right]</annotation><annotation encoding="application/x-llamapun">= - divide start_ARG 1 end_ARG start_ARG italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG blackboard_E [ âŸ¨ bold_italic_Î¾ - bold_italic_x , bold_italic_Î¾ âŸ© italic_Ï† start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ - bold_italic_x ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.77)</span></td>
</tr></tbody>
<tbody id="S2.E78"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=-\frac{1}{t^{2}}\operatorname{\mathbb{E}}\left[\left(\|\bm{\xi}\|_{2}^{2}-\langle\bm{\xi},\bm{x}\rangle\right)\varphi_{t}(\bm{\xi}-\bm{x})\right]" class="ltx_Math" display="inline" id="S2.E78.m1"><semantics><mrow><mi></mi><mo>=</mo><mrow><mo>âˆ’</mo><mrow><mstyle displaystyle="true"><mfrac><mn>1</mn><msup><mi>t</mi><mn>2</mn></msup></mfrac></mstyle><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mi>ğ”¼</mi><mo>â¡</mo><mrow><mo>[</mo><mrow><mrow><mo>(</mo><mrow><msubsup><mrow><mo stretchy="false">â€–</mo><mi>ğƒ</mi><mo stretchy="false">â€–</mo></mrow><mn>2</mn><mn>2</mn></msubsup><mo>âˆ’</mo><mrow><mo stretchy="false">âŸ¨</mo><mi>ğƒ</mi><mo>,</mo><mi>ğ’™</mi><mo stretchy="false">âŸ©</mo></mrow></mrow><mo>)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><msub><mi>Ï†</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’™</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>]</mo></mrow></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=-\frac{1}{t^{2}}\operatorname{\mathbb{E}}\left[\left(\|\bm{\xi}\|_{2}^{2}-\langle\bm{\xi},\bm{x}\rangle\right)\varphi_{t}(\bm{\xi}-\bm{x})\right]</annotation><annotation encoding="application/x-llamapun">= - divide start_ARG 1 end_ARG start_ARG italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG blackboard_E [ ( âˆ¥ bold_italic_Î¾ âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT - âŸ¨ bold_italic_Î¾ , bold_italic_x âŸ© ) italic_Ï† start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ - bold_italic_x ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.78)</span></td>
</tr></tbody>
<tbody id="S2.E79"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=-\frac{1}{t^{2}}\operatorname{\mathbb{E}}\left[\left(r^{2}-\langle\bm{\xi},\bm{x}\rangle\right)\varphi_{t}(\bm{\xi}-\bm{x})\right]" class="ltx_Math" display="inline" id="S2.E79.m1"><semantics><mrow><mi></mi><mo>=</mo><mrow><mo>âˆ’</mo><mrow><mstyle displaystyle="true"><mfrac><mn>1</mn><msup><mi>t</mi><mn>2</mn></msup></mfrac></mstyle><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mi>ğ”¼</mi><mo>â¡</mo><mrow><mo>[</mo><mrow><mrow><mo>(</mo><mrow><msup><mi>r</mi><mn>2</mn></msup><mo>âˆ’</mo><mrow><mo stretchy="false">âŸ¨</mo><mi>ğƒ</mi><mo>,</mo><mi>ğ’™</mi><mo stretchy="false">âŸ©</mo></mrow></mrow><mo>)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><msub><mi>Ï†</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’™</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>]</mo></mrow></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=-\frac{1}{t^{2}}\operatorname{\mathbb{E}}\left[\left(r^{2}-\langle\bm{\xi},\bm{x}\rangle\right)\varphi_{t}(\bm{\xi}-\bm{x})\right]</annotation><annotation encoding="application/x-llamapun">= - divide start_ARG 1 end_ARG start_ARG italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG blackboard_E [ ( italic_r start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT - âŸ¨ bold_italic_Î¾ , bold_italic_x âŸ© ) italic_Ï† start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ - bold_italic_x ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.79)</span></td>
</tr></tbody>
<tbody id="S2.E80"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{1}{t^{2}}\operatorname{\mathbb{E}}\left[\left(\langle\bm{\xi},\bm{x}\rangle-r^{2}\right)\varphi_{t}(\bm{\xi}-\bm{x})\right]." class="ltx_Math" display="inline" id="S2.E80.m1"><semantics><mrow><mrow><mi></mi><mo>=</mo><mrow><mstyle displaystyle="true"><mfrac><mn>1</mn><msup><mi>t</mi><mn>2</mn></msup></mfrac></mstyle><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mi>ğ”¼</mi><mo>â¡</mo><mrow><mo>[</mo><mrow><mrow><mo>(</mo><mrow><mrow><mo stretchy="false">âŸ¨</mo><mi>ğƒ</mi><mo>,</mo><mi>ğ’™</mi><mo stretchy="false">âŸ©</mo></mrow><mo>âˆ’</mo><msup><mi>r</mi><mn>2</mn></msup></mrow><mo>)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><msub><mi>Ï†</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’™</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>]</mo></mrow></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">\displaystyle=\frac{1}{t^{2}}\operatorname{\mathbb{E}}\left[\left(\langle\bm{\xi},\bm{x}\rangle-r^{2}\right)\varphi_{t}(\bm{\xi}-\bm{x})\right].</annotation><annotation encoding="application/x-llamapun">= divide start_ARG 1 end_ARG start_ARG italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG blackboard_E [ ( âŸ¨ bold_italic_Î¾ , bold_italic_x âŸ© - italic_r start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) italic_Ï† start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ - bold_italic_x ) ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.80)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">Using Cauchy-Schwarz and the representation <math alttext="p_{t}(\bm{\xi})\doteq\operatorname{\mathbb{E}}[\varphi_{t}(\bm{\xi}-\bm{x})]" class="ltx_Math" display="inline" id="S2.SS3.SSSx2.p2.m27"><semantics><mrow><mrow><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>â‰</mo><mrow><mi>ğ”¼</mi><mo>â¡</mo><mrow><mo stretchy="false">[</mo><mrow><msub><mi>Ï†</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’™</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">]</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">p_{t}(\bm{\xi})\doteq\operatorname{\mathbb{E}}[\varphi_{t}(\bm{\xi}-\bm{x})]</annotation><annotation encoding="application/x-llamapun">italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) â‰ blackboard_E [ italic_Ï† start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ - bold_italic_x ) ]</annotation></semantics></math> again, it holds</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S3.EGx140">
<tbody id="S2.E81"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\frac{1}{t^{2}}\operatorname{\mathbb{E}}\left[\left(-Rr-r^{2}\right)\varphi_{t}(\bm{\xi}-\bm{x})\right]\leq\langle\nabla p_{t}(\bm{\xi}),\bm{\xi}\rangle\leq\frac{1}{t^{2}}\operatorname{\mathbb{E}}\left[\left(Rr-r^{2}\right)\varphi_{t}(\bm{\xi}-\bm{x})\right]" class="ltx_Math" display="inline" id="S2.E81.m1"><semantics><mrow><mrow><mstyle displaystyle="true"><mfrac><mn>1</mn><msup><mi>t</mi><mn>2</mn></msup></mfrac></mstyle><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mi>ğ”¼</mi><mo>â¡</mo><mrow><mo>[</mo><mrow><mrow><mo>(</mo><mrow><mrow><mo>âˆ’</mo><mrow><mi>R</mi><mo lspace="0em" rspace="0em">â€‹</mo><mi>r</mi></mrow></mrow><mo>âˆ’</mo><msup><mi>r</mi><mn>2</mn></msup></mrow><mo>)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><msub><mi>Ï†</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’™</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>]</mo></mrow></mrow></mrow><mo>â‰¤</mo><mrow><mo stretchy="false">âŸ¨</mo><mrow><mrow><mo rspace="0.167em">âˆ‡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>,</mo><mi>ğƒ</mi><mo stretchy="false">âŸ©</mo></mrow><mo>â‰¤</mo><mrow><mstyle displaystyle="true"><mfrac><mn>1</mn><msup><mi>t</mi><mn>2</mn></msup></mfrac></mstyle><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mi>ğ”¼</mi><mo>â¡</mo><mrow><mo>[</mo><mrow><mrow><mo>(</mo><mrow><mrow><mi>R</mi><mo lspace="0em" rspace="0em">â€‹</mo><mi>r</mi></mrow><mo>âˆ’</mo><msup><mi>r</mi><mn>2</mn></msup></mrow><mo>)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><msub><mi>Ï†</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’™</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>]</mo></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle\frac{1}{t^{2}}\operatorname{\mathbb{E}}\left[\left(-Rr-r^{2}\right)\varphi_{t}(\bm{\xi}-\bm{x})\right]\leq\langle\nabla p_{t}(\bm{\xi}),\bm{\xi}\rangle\leq\frac{1}{t^{2}}\operatorname{\mathbb{E}}\left[\left(Rr-r^{2}\right)\varphi_{t}(\bm{\xi}-\bm{x})\right]</annotation><annotation encoding="application/x-llamapun">divide start_ARG 1 end_ARG start_ARG italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG blackboard_E [ ( - italic_R italic_r - italic_r start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) italic_Ï† start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ - bold_italic_x ) ] â‰¤ âŸ¨ âˆ‡ italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) , bold_italic_Î¾ âŸ© â‰¤ divide start_ARG 1 end_ARG start_ARG italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG blackboard_E [ ( italic_R italic_r - italic_r start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) italic_Ï† start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ - bold_italic_x ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.81)</span></td>
</tr></tbody>
<tbody id="S2.E82"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\frac{1}{t^{2}}\left(-Rr-r^{2}\right)\operatorname{\mathbb{E}}\left[\varphi_{t}(\bm{\xi}-\bm{x})\right]\leq\langle\nabla p_{t}(\bm{\xi}),\bm{\xi}\rangle\leq\frac{1}{t^{2}}\left(Rr-r^{2}\right)\operatorname{\mathbb{E}}\left[\varphi_{t}(\bm{\xi}-\bm{x})\right]" class="ltx_Math" display="inline" id="S2.E82.m1"><semantics><mrow><mrow><mstyle displaystyle="true"><mfrac><mn>1</mn><msup><mi>t</mi><mn>2</mn></msup></mfrac></mstyle><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo>(</mo><mrow><mrow><mo>âˆ’</mo><mrow><mi>R</mi><mo lspace="0em" rspace="0em">â€‹</mo><mi>r</mi></mrow></mrow><mo>âˆ’</mo><msup><mi>r</mi><mn>2</mn></msup></mrow><mo>)</mo></mrow><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mi>ğ”¼</mi><mo>â¡</mo><mrow><mo>[</mo><mrow><msub><mi>Ï†</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’™</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>]</mo></mrow></mrow></mrow><mo>â‰¤</mo><mrow><mo stretchy="false">âŸ¨</mo><mrow><mrow><mo rspace="0.167em">âˆ‡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>,</mo><mi>ğƒ</mi><mo stretchy="false">âŸ©</mo></mrow><mo>â‰¤</mo><mrow><mstyle displaystyle="true"><mfrac><mn>1</mn><msup><mi>t</mi><mn>2</mn></msup></mfrac></mstyle><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo>(</mo><mrow><mrow><mi>R</mi><mo lspace="0em" rspace="0em">â€‹</mo><mi>r</mi></mrow><mo>âˆ’</mo><msup><mi>r</mi><mn>2</mn></msup></mrow><mo>)</mo></mrow><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mi>ğ”¼</mi><mo>â¡</mo><mrow><mo>[</mo><mrow><msub><mi>Ï†</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’™</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>]</mo></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle\frac{1}{t^{2}}\left(-Rr-r^{2}\right)\operatorname{\mathbb{E}}\left[\varphi_{t}(\bm{\xi}-\bm{x})\right]\leq\langle\nabla p_{t}(\bm{\xi}),\bm{\xi}\rangle\leq\frac{1}{t^{2}}\left(Rr-r^{2}\right)\operatorname{\mathbb{E}}\left[\varphi_{t}(\bm{\xi}-\bm{x})\right]</annotation><annotation encoding="application/x-llamapun">divide start_ARG 1 end_ARG start_ARG italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG ( - italic_R italic_r - italic_r start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) blackboard_E [ italic_Ï† start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ - bold_italic_x ) ] â‰¤ âŸ¨ âˆ‡ italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) , bold_italic_Î¾ âŸ© â‰¤ divide start_ARG 1 end_ARG start_ARG italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG ( italic_R italic_r - italic_r start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) blackboard_E [ italic_Ï† start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ - bold_italic_x ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.82)</span></td>
</tr></tbody>
<tbody id="S2.E83"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle-\frac{r(R+r)}{t^{2}}p_{t}(\bm{\xi})\leq\langle\nabla p_{t}(\bm{\xi}),\bm{\xi}\rangle\leq-\frac{r(r-R)}{t^{2}}p_{t}(\bm{\xi})." class="ltx_Math" display="inline" id="S2.E83.m1"><semantics><mrow><mrow><mrow><mo>âˆ’</mo><mrow><mstyle displaystyle="true"><mfrac><mrow><mi>r</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mi>R</mi><mo>+</mo><mi>r</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><msup><mi>t</mi><mn>2</mn></msup></mfrac></mstyle><mo lspace="0em" rspace="0em">â€‹</mo><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>â‰¤</mo><mrow><mo stretchy="false">âŸ¨</mo><mrow><mrow><mo rspace="0.167em">âˆ‡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>,</mo><mi>ğƒ</mi><mo stretchy="false">âŸ©</mo></mrow><mo>â‰¤</mo><mrow><mo>âˆ’</mo><mrow><mstyle displaystyle="true"><mfrac><mrow><mi>r</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mi>r</mi><mo>âˆ’</mo><mi>R</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><msup><mi>t</mi><mn>2</mn></msup></mfrac></mstyle><mo lspace="0em" rspace="0em">â€‹</mo><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">\displaystyle-\frac{r(R+r)}{t^{2}}p_{t}(\bm{\xi})\leq\langle\nabla p_{t}(\bm{\xi}),\bm{\xi}\rangle\leq-\frac{r(r-R)}{t^{2}}p_{t}(\bm{\xi}).</annotation><annotation encoding="application/x-llamapun">- divide start_ARG italic_r ( italic_R + italic_r ) end_ARG start_ARG italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) â‰¤ âŸ¨ âˆ‡ italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) , bold_italic_Î¾ âŸ© â‰¤ - divide start_ARG italic_r ( italic_r - italic_R ) end_ARG start_ARG italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.83)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">For <math alttext="r&gt;R&gt;0" class="ltx_Math" display="inline" id="S2.SS3.SSSx2.p2.m28"><semantics><mrow><mi>r</mi><mo>&gt;</mo><mi>R</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">r&gt;R&gt;0</annotation><annotation encoding="application/x-llamapun">italic_r &gt; italic_R &gt; 0</annotation></semantics></math> (as is suitable, because we are going to take the limit <math alttext="r\to\infty" class="ltx_Math" display="inline" id="S2.SS3.SSSx2.p2.m29"><semantics><mrow><mi>r</mi><mo stretchy="false">â†’</mo><mi mathvariant="normal">âˆ</mi></mrow><annotation encoding="application/x-tex">r\to\infty</annotation><annotation encoding="application/x-llamapun">italic_r â†’ âˆ</annotation></semantics></math> while <math alttext="R" class="ltx_Math" display="inline" id="S2.SS3.SSSx2.p2.m30"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation><annotation encoding="application/x-llamapun">italic_R</annotation></semantics></math> is fixed), both sides are negative. This makes sense: most of the probability mass is contained within the ball of radius <math alttext="R" class="ltx_Math" display="inline" id="S2.SS3.SSSx2.p2.m31"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation><annotation encoding="application/x-llamapun">italic_R</annotation></semantics></math> and thus the score points inwards, having a negative inner product with the outward-pointing vector <math alttext="\bm{\xi}" class="ltx_Math" display="inline" id="S2.SS3.SSSx2.p2.m32"><semantics><mi>ğƒ</mi><annotation encoding="application/x-tex">\bm{\xi}</annotation><annotation encoding="application/x-llamapun">bold_italic_Î¾</annotation></semantics></math>. Thus using the appropriate bounds for <math alttext="p_{t}(\bm{\xi})" class="ltx_Math" display="inline" id="S2.SS3.SSSx2.p2.m33"><semantics><mrow><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">p_{t}(\bm{\xi})</annotation><annotation encoding="application/x-llamapun">italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ )</annotation></semantics></math>,</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E84">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="-\frac{r(R+r)}{t^{2}}\cdot C_{t}e^{[-r^{2}+2Rr]/(2t^{2})}\leq\langle\nabla p_{t}(\bm{\xi}),\bm{\xi}\rangle\leq-\frac{r(r-R)}{t^{2}}\cdot C_{t}e^{-[r^{2}+2R(r+R)]/(2t^{2})}." class="ltx_Math" display="block" id="S2.E84.m1"><semantics><mrow><mrow><mrow><mo>âˆ’</mo><mrow><mrow><mfrac><mrow><mi>r</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mi>R</mi><mo>+</mo><mi>r</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><msup><mi>t</mi><mn>2</mn></msup></mfrac><mo lspace="0.222em" rspace="0.222em">â‹…</mo><msub><mi>C</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>e</mi><mrow><mrow><mo stretchy="false">[</mo><mrow><mrow><mo>âˆ’</mo><msup><mi>r</mi><mn>2</mn></msup></mrow><mo>+</mo><mrow><mn>2</mn><mo lspace="0em" rspace="0em">â€‹</mo><mi>R</mi><mo lspace="0em" rspace="0em">â€‹</mo><mi>r</mi></mrow></mrow><mo stretchy="false">]</mo></mrow><mo>/</mo><mrow><mo stretchy="false">(</mo><mrow><mn>2</mn><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>t</mi><mn>2</mn></msup></mrow><mo stretchy="false">)</mo></mrow></mrow></msup></mrow></mrow><mo>â‰¤</mo><mrow><mo stretchy="false">âŸ¨</mo><mrow><mrow><mo rspace="0.167em">âˆ‡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>,</mo><mi>ğƒ</mi><mo stretchy="false">âŸ©</mo></mrow><mo>â‰¤</mo><mrow><mo>âˆ’</mo><mrow><mrow><mfrac><mrow><mi>r</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mi>r</mi><mo>âˆ’</mo><mi>R</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><msup><mi>t</mi><mn>2</mn></msup></mfrac><mo lspace="0.222em" rspace="0.222em">â‹…</mo><msub><mi>C</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>e</mi><mrow><mo>âˆ’</mo><mrow><mrow><mo stretchy="false">[</mo><mrow><msup><mi>r</mi><mn>2</mn></msup><mo>+</mo><mrow><mn>2</mn><mo lspace="0em" rspace="0em">â€‹</mo><mi>R</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mi>r</mi><mo>+</mo><mi>R</mi></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow><mo stretchy="false">]</mo></mrow><mo>/</mo><mrow><mo stretchy="false">(</mo><mrow><mn>2</mn><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>t</mi><mn>2</mn></msup></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></msup></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">-\frac{r(R+r)}{t^{2}}\cdot C_{t}e^{[-r^{2}+2Rr]/(2t^{2})}\leq\langle\nabla p_{t}(\bm{\xi}),\bm{\xi}\rangle\leq-\frac{r(r-R)}{t^{2}}\cdot C_{t}e^{-[r^{2}+2R(r+R)]/(2t^{2})}.</annotation><annotation encoding="application/x-llamapun">- divide start_ARG italic_r ( italic_R + italic_r ) end_ARG start_ARG italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG â‹… italic_C start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT italic_e start_POSTSUPERSCRIPT [ - italic_r start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + 2 italic_R italic_r ] / ( 2 italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) end_POSTSUPERSCRIPT â‰¤ âŸ¨ âˆ‡ italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) , bold_italic_Î¾ âŸ© â‰¤ - divide start_ARG italic_r ( italic_r - italic_R ) end_ARG start_ARG italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG â‹… italic_C start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT italic_e start_POSTSUPERSCRIPT - [ italic_r start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + 2 italic_R ( italic_r + italic_R ) ] / ( 2 italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.84)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">Then, noting that <math alttext="C_{t}=\mathrm{poly}(t^{-1})" class="ltx_Math" display="inline" id="S2.SS3.SSSx2.p2.m34"><semantics><mrow><msub><mi>C</mi><mi>t</mi></msub><mo>=</mo><mrow><mi>poly</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msup><mi>t</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mo stretchy="false">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">C_{t}=\mathrm{poly}(t^{-1})</annotation><annotation encoding="application/x-llamapun">italic_C start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = roman_poly ( italic_t start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT )</annotation></semantics></math>, we can compute</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E85">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="[c+\log p_{t}(\bm{\xi})]\langle\nabla p_{t}(\bm{\xi}),\bm{\xi}\rangle=\mathrm{poly}(r,R,t^{-1},c)e^{-\Theta_{r}(r^{2})}" class="ltx_Math" display="block" id="S2.E85.m1"><semantics><mrow><mrow><mrow><mo stretchy="false">[</mo><mrow><mi>c</mi><mo>+</mo><mrow><mrow><mi>log</mi><mo lspace="0.167em">â¡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mo stretchy="false">]</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">âŸ¨</mo><mrow><mrow><mo rspace="0.167em">âˆ‡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>,</mo><mi>ğƒ</mi><mo stretchy="false">âŸ©</mo></mrow></mrow><mo>=</mo><mrow><mi>poly</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>r</mi><mo>,</mo><mi>R</mi><mo>,</mo><msup><mi>t</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mo>,</mo><mi>c</mi><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>e</mi><mrow><mo>âˆ’</mo><mrow><msub><mi mathvariant="normal">Î˜</mi><mi>r</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msup><mi>r</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow></mrow></mrow></msup></mrow></mrow><annotation encoding="application/x-tex">[c+\log p_{t}(\bm{\xi})]\langle\nabla p_{t}(\bm{\xi}),\bm{\xi}\rangle=\mathrm{poly}(r,R,t^{-1},c)e^{-\Theta_{r}(r^{2})}</annotation><annotation encoding="application/x-llamapun">[ italic_c + roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) ] âŸ¨ âˆ‡ italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) , bold_italic_Î¾ âŸ© = roman_poly ( italic_r , italic_R , italic_t start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT , italic_c ) italic_e start_POSTSUPERSCRIPT - roman_Î˜ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( italic_r start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.85)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">So one can see that, letting the surface area of <math alttext="\partial B_{r}(\bm{0})" class="ltx_Math" display="inline" id="S2.SS3.SSSx2.p2.m35"><semantics><mrow><mo rspace="0em">âˆ‚</mo><mrow><msub><mi>B</mi><mi>r</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mn>ğŸ</mn><mo stretchy="false">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\partial B_{r}(\bm{0})</annotation><annotation encoding="application/x-llamapun">âˆ‚ italic_B start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( bold_0 )</annotation></semantics></math> be <math alttext="\omega_{D}r^{D-1}" class="ltx_Math" display="inline" id="S2.SS3.SSSx2.p2.m36"><semantics><mrow><msub><mi>Ï‰</mi><mi>D</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>r</mi><mrow><mi>D</mi><mo>âˆ’</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\omega_{D}r^{D-1}</annotation><annotation encoding="application/x-llamapun">italic_Ï‰ start_POSTSUBSCRIPT italic_D end_POSTSUBSCRIPT italic_r start_POSTSUPERSCRIPT italic_D - 1 end_POSTSUPERSCRIPT</annotation></semantics></math> where <math alttext="\omega_{D}" class="ltx_Math" display="inline" id="S2.SS3.SSSx2.p2.m37"><semantics><msub><mi>Ï‰</mi><mi>D</mi></msub><annotation encoding="application/x-tex">\omega_{D}</annotation><annotation encoding="application/x-llamapun">italic_Ï‰ start_POSTSUBSCRIPT italic_D end_POSTSUBSCRIPT</annotation></semantics></math> is a function of<math alttext="D" class="ltx_Math" display="inline" id="S2.SS3.SSSx2.p2.m38"><semantics><mi>D</mi><annotation encoding="application/x-tex">D</annotation><annotation encoding="application/x-llamapun">italic_D</annotation></semantics></math>, it holds</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E86">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\frac{1}{r}\int_{\partial B_{r}(\bm{0})}[c+\log p_{t}(\bm{\xi})]\langle\nabla p_{t}(\bm{\xi}),\bm{\xi}\rangle~{}\mathrm{d}\bm{\xi}=\mathrm{poly}(r,R,t^{-1},c)e^{-\Theta_{r}(r^{2})}" class="ltx_Math" display="block" id="S2.E86.m1"><semantics><mrow><mrow><mfrac><mn>1</mn><mi>r</mi></mfrac><mo lspace="0em" rspace="0em">â€‹</mo><mrow><msub><mo rspace="0em">âˆ«</mo><mrow><mo rspace="0em">âˆ‚</mo><mrow><msub><mi>B</mi><mi>r</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mn>ğŸ</mn><mo stretchy="false">)</mo></mrow></mrow></mrow></msub><mrow><mrow><mo stretchy="false">[</mo><mrow><mi>c</mi><mo>+</mo><mrow><mrow><mi>log</mi><mo lspace="0.167em">â¡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mo stretchy="false">]</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">âŸ¨</mo><mrow><mrow><mo rspace="0.167em">âˆ‡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>,</mo><mi>ğƒ</mi><mo stretchy="false">âŸ©</mo></mrow><mo lspace="0.330em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><mi>ğƒ</mi></mrow></mrow></mrow></mrow><mo>=</mo><mrow><mi>poly</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>r</mi><mo>,</mo><mi>R</mi><mo>,</mo><msup><mi>t</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mo>,</mo><mi>c</mi><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>e</mi><mrow><mo>âˆ’</mo><mrow><msub><mi mathvariant="normal">Î˜</mi><mi>r</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msup><mi>r</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow></mrow></mrow></msup></mrow></mrow><annotation encoding="application/x-tex">\frac{1}{r}\int_{\partial B_{r}(\bm{0})}[c+\log p_{t}(\bm{\xi})]\langle\nabla p_{t}(\bm{\xi}),\bm{\xi}\rangle~{}\mathrm{d}\bm{\xi}=\mathrm{poly}(r,R,t^{-1},c)e^{-\Theta_{r}(r^{2})}</annotation><annotation encoding="application/x-llamapun">divide start_ARG 1 end_ARG start_ARG italic_r end_ARG âˆ« start_POSTSUBSCRIPT âˆ‚ italic_B start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( bold_0 ) end_POSTSUBSCRIPT [ italic_c + roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) ] âŸ¨ âˆ‡ italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) , bold_italic_Î¾ âŸ© roman_d bold_italic_Î¾ = roman_poly ( italic_r , italic_R , italic_t start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT , italic_c ) italic_e start_POSTSUPERSCRIPT - roman_Î˜ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( italic_r start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.86)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">and therefore the exponentially decaying tails mean</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E87">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\lim_{r\to\infty}\frac{1}{r}\int_{\partial B_{r}(\bm{0})}[c+\log p_{t}(\bm{\xi})]\langle\nabla p_{t}(\bm{\xi}),\bm{\xi}\rangle~{}\mathrm{d}\bm{\xi}=0." class="ltx_Math" display="block" id="S2.E87.m1"><semantics><mrow><mrow><mrow><munder><mo movablelimits="false">lim</mo><mrow><mi>r</mi><mo stretchy="false">â†’</mo><mi mathvariant="normal">âˆ</mi></mrow></munder><mrow><mfrac><mn>1</mn><mi>r</mi></mfrac><mo lspace="0em" rspace="0em">â€‹</mo><mrow><msub><mo rspace="0em">âˆ«</mo><mrow><mo rspace="0em">âˆ‚</mo><mrow><msub><mi>B</mi><mi>r</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mn>ğŸ</mn><mo stretchy="false">)</mo></mrow></mrow></mrow></msub><mrow><mrow><mo stretchy="false">[</mo><mrow><mi>c</mi><mo>+</mo><mrow><mrow><mi>log</mi><mo lspace="0.167em">â¡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mo stretchy="false">]</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">âŸ¨</mo><mrow><mrow><mo rspace="0.167em">âˆ‡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>,</mo><mi>ğƒ</mi><mo stretchy="false">âŸ©</mo></mrow><mo lspace="0.330em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><mi>ğƒ</mi></mrow></mrow></mrow></mrow></mrow><mo>=</mo><mn>0</mn></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">\lim_{r\to\infty}\frac{1}{r}\int_{\partial B_{r}(\bm{0})}[c+\log p_{t}(\bm{\xi})]\langle\nabla p_{t}(\bm{\xi}),\bm{\xi}\rangle~{}\mathrm{d}\bm{\xi}=0.</annotation><annotation encoding="application/x-llamapun">roman_lim start_POSTSUBSCRIPT italic_r â†’ âˆ end_POSTSUBSCRIPT divide start_ARG 1 end_ARG start_ARG italic_r end_ARG âˆ« start_POSTSUBSCRIPT âˆ‚ italic_B start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ( bold_0 ) end_POSTSUBSCRIPT [ italic_c + roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) ] âŸ¨ âˆ‡ italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) , bold_italic_Î¾ âŸ© roman_d bold_italic_Î¾ = 0 .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.87)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">Finally, plugging into (<a class="ltx_ref" href="#S2.E64" title="Equation B.2.64 â€£ Integration by Parts in De Brujin Identity â€£ B.2.3 Technical Lemmas and Intermediate Results â€£ B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">B.2.64</span></a>), we have</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S3.EGx141">
<tbody id="S2.E88"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\int_{\mathbb{R}^{D}}\left\{\Delta p_{t}(\bm{\xi})[c+\log p_{t}(\bm{\xi})]+\langle\nabla\log p_{t}(\bm{\xi}),\nabla p_{t}(\bm{\xi})\rangle\right\}~{}\mathrm{d}\bm{\xi}=0" class="ltx_Math" display="inline" id="S2.E88.m1"><semantics><mrow><mrow><mstyle displaystyle="true"><msub><mo>âˆ«</mo><msup><mi>â„</mi><mi>D</mi></msup></msub></mstyle><mrow><mrow><mo>{</mo><mrow><mrow><mi mathvariant="normal">Î”</mi><mo lspace="0em" rspace="0em">â€‹</mo><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">[</mo><mrow><mi>c</mi><mo>+</mo><mrow><mrow><mi>log</mi><mo lspace="0.167em">â¡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mo stretchy="false">]</mo></mrow></mrow><mo>+</mo><mrow><mo stretchy="false">âŸ¨</mo><mrow><mrow><mrow><mo rspace="0.167em">âˆ‡</mo><mi>log</mi></mrow><mo lspace="0.167em">â¡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>,</mo><mrow><mrow><mo rspace="0.167em">âˆ‡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">âŸ©</mo></mrow></mrow><mo>}</mo></mrow><mo lspace="0.330em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><mi>ğƒ</mi></mrow></mrow></mrow><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\displaystyle\int_{\mathbb{R}^{D}}\left\{\Delta p_{t}(\bm{\xi})[c+\log p_{t}(\bm{\xi})]+\langle\nabla\log p_{t}(\bm{\xi}),\nabla p_{t}(\bm{\xi})\rangle\right\}~{}\mathrm{d}\bm{\xi}=0</annotation><annotation encoding="application/x-llamapun">âˆ« start_POSTSUBSCRIPT blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT end_POSTSUBSCRIPT { roman_Î” italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) [ italic_c + roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) ] + âŸ¨ âˆ‡ roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) , âˆ‡ italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) âŸ© } roman_d bold_italic_Î¾ = 0</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.88)</span></td>
</tr></tbody>
<tbody id="S2.E89"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\implies" class="ltx_Math" display="inline" id="S2.E89.m1"><semantics><mo stretchy="false">âŸ¹</mo><annotation encoding="application/x-tex">\displaystyle\implies</annotation><annotation encoding="application/x-llamapun">âŸ¹</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\int_{\mathbb{R}^{D}}\Delta p_{t}(\bm{\xi})[c+\log p_{t}(\bm{\xi})]~{}\mathrm{d}\bm{\xi}=-\int_{\mathbb{R}^{D}}\langle\nabla\log p_{t}(\bm{\xi}),\nabla p_{t}(\bm{\xi})\rangle~{}\mathrm{d}\bm{\xi}" class="ltx_Math" display="inline" id="S2.E89.m2"><semantics><mrow><mrow><mstyle displaystyle="true"><msub><mo>âˆ«</mo><msup><mi>â„</mi><mi>D</mi></msup></msub></mstyle><mrow><mi mathvariant="normal">Î”</mi><mo lspace="0em" rspace="0em">â€‹</mo><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">[</mo><mrow><mi>c</mi><mo>+</mo><mrow><mrow><mi>log</mi><mo lspace="0.167em">â¡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mo stretchy="false">]</mo></mrow><mo lspace="0.330em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><mi>ğƒ</mi></mrow></mrow></mrow><mo>=</mo><mrow><mo>âˆ’</mo><mrow><mstyle displaystyle="true"><msub><mo>âˆ«</mo><msup><mi>â„</mi><mi>D</mi></msup></msub></mstyle><mrow><mrow><mo stretchy="false">âŸ¨</mo><mrow><mrow><mrow><mo rspace="0.167em">âˆ‡</mo><mi>log</mi></mrow><mo lspace="0.167em">â¡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>,</mo><mrow><mrow><mo rspace="0.167em">âˆ‡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">âŸ©</mo></mrow><mo lspace="0.330em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><mi>ğƒ</mi></mrow></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle\int_{\mathbb{R}^{D}}\Delta p_{t}(\bm{\xi})[c+\log p_{t}(\bm{\xi})]~{}\mathrm{d}\bm{\xi}=-\int_{\mathbb{R}^{D}}\langle\nabla\log p_{t}(\bm{\xi}),\nabla p_{t}(\bm{\xi})\rangle~{}\mathrm{d}\bm{\xi}</annotation><annotation encoding="application/x-llamapun">âˆ« start_POSTSUBSCRIPT blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT end_POSTSUBSCRIPT roman_Î” italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) [ italic_c + roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) ] roman_d bold_italic_Î¾ = - âˆ« start_POSTSUBSCRIPT blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT end_POSTSUBSCRIPT âŸ¨ âˆ‡ roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) , âˆ‡ italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) âŸ© roman_d bold_italic_Î¾</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.89)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">as claimed.
âˆ</p>
</div>
</div>
</section>
<section class="ltx_subsubsection" id="S2.SS3.SSSx3">
<h4 class="ltx_title ltx_title_subsubsection">Local Invertibility of the Denoiser <math alttext="\bar{\bm{x}}" class="ltx_Math" display="inline" id="S2.SS3.SSSx3.m1"><semantics><mover accent="true"><mi>ğ’™</mi><mo>Â¯</mo></mover><annotation encoding="application/x-tex">\bar{\bm{x}}</annotation><annotation encoding="application/x-llamapun">overÂ¯ start_ARG bold_italic_x end_ARG</annotation></semantics></math>
</h4>
<div class="ltx_para" id="S2.SS3.SSSx3.p1">
<p class="ltx_p">Here we provide some results used in the proof of <a class="ltx_ref" href="#Thmtheorem4" title="Theorem B.4. â€£ B.2.2 Denoising Process Reduces Entropy Over Time â€£ B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Theorem</span>Â <span class="ltx_text ltx_ref_tag">B.4</span></a> which are appropriate generalizations of corresponding results in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="bib.html#bibx96" title="">Gri11</a>]</cite>.</p>
</div>
<div class="ltx_theorem ltx_theorem_lemma" id="Thmlemma3">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold">Lemma B.3</span></span><span class="ltx_text ltx_font_bold"> </span>(Generalization of <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="bib.html#bibx96" title="">Gri11</a>]</cite>, Lemma A.1)<span class="ltx_text ltx_font_bold">.</span>
</h6>
<div class="ltx_para" id="Thmlemma3.p1">
<p class="ltx_p"><span class="ltx_text ltx_font_italic">Let <math alttext="\bm{x}" class="ltx_Math" display="inline" id="Thmlemma3.p1.m1"><semantics><mi>ğ±</mi><annotation encoding="application/x-tex">\bm{x}</annotation><annotation encoding="application/x-llamapun">bold_italic_x</annotation></semantics></math> be any random variable such that <a class="ltx_ref" href="#Thmassumption1" title="Assumption B.1. â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Assumptions</span>Â <span class="ltx_text ltx_ref_tag">B.1</span></a> andÂ <a class="ltx_ref" href="#Thmassumption2" title="Assumption B.2. â€£ B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">B.2</span></a> hold, and let <math alttext="(\bm{x}_{t})_{t\in[0,T]}" class="ltx_Math" display="inline" id="Thmlemma3.p1.m2"><semantics><msub><mrow><mo stretchy="false">(</mo><msub><mi>ğ±</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><mrow><mi>t</mi><mo>âˆˆ</mo><mrow><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mi>T</mi><mo stretchy="false">]</mo></mrow></mrow></msub><annotation encoding="application/x-tex">(\bm{x}_{t})_{t\in[0,T]}</annotation><annotation encoding="application/x-llamapun">( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_t âˆˆ [ 0 , italic_T ] end_POSTSUBSCRIPT</annotation></semantics></math> be the stochastic process (<a class="ltx_ref" href="#S2.E1" title="Equation B.2.1 â€£ B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">B.2.1</span></a>). Let <math alttext="s,t\in[0,T]" class="ltx_Math" display="inline" id="Thmlemma3.p1.m3"><semantics><mrow><mrow><mi>s</mi><mo>,</mo><mi>t</mi></mrow><mo>âˆˆ</mo><mrow><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mi>T</mi><mo stretchy="false">]</mo></mrow></mrow><annotation encoding="application/x-tex">s,t\in[0,T]</annotation><annotation encoding="application/x-llamapun">italic_s , italic_t âˆˆ [ 0 , italic_T ]</annotation></semantics></math> be such that <math alttext="0\leq s&lt;t\leq T" class="ltx_Math" display="inline" id="Thmlemma3.p1.m4"><semantics><mrow><mn>0</mn><mo>â‰¤</mo><mi>s</mi><mo>&lt;</mo><mi>t</mi><mo>â‰¤</mo><mi>T</mi></mrow><annotation encoding="application/x-tex">0\leq s&lt;t\leq T</annotation><annotation encoding="application/x-llamapun">0 â‰¤ italic_s &lt; italic_t â‰¤ italic_T</annotation></semantics></math>, and let <math alttext="\bar{\bm{x}}(\bm{\xi})\doteq\operatorname{\mathbb{E}}[\bm{x}_{s}\mid\bm{x}_{t}=\bm{\xi}]" class="ltx_Math" display="inline" id="Thmlemma3.p1.m5"><semantics><mrow><mrow><mover accent="true"><mi>ğ±</mi><mo>Â¯</mo></mover><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğ›</mi><mo stretchy="false">)</mo></mrow></mrow><mo>â‰</mo><mrow><mi>ğ”¼</mi><mo>â¡</mo><mrow><mo stretchy="false">[</mo><mrow><mrow><msub><mi>ğ±</mi><mi>s</mi></msub><mo>âˆ£</mo><msub><mi>ğ±</mi><mi>t</mi></msub></mrow><mo>=</mo><mi>ğ›</mi></mrow><mo stretchy="false">]</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\bar{\bm{x}}(\bm{\xi})\doteq\operatorname{\mathbb{E}}[\bm{x}_{s}\mid\bm{x}_{t}=\bm{\xi}]</annotation><annotation encoding="application/x-llamapun">overÂ¯ start_ARG bold_italic_x end_ARG ( bold_italic_Î¾ ) â‰ blackboard_E [ bold_italic_x start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT âˆ£ bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = bold_italic_Î¾ ]</annotation></semantics></math>. The Jacobian <math alttext="\bar{\bm{x}}^{\prime}(\bm{\xi})" class="ltx_Math" display="inline" id="Thmlemma3.p1.m6"><semantics><mrow><msup><mover accent="true"><mi>ğ±</mi><mo>Â¯</mo></mover><mo>â€²</mo></msup><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğ›</mi><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">\bar{\bm{x}}^{\prime}(\bm{\xi})</annotation><annotation encoding="application/x-llamapun">overÂ¯ start_ARG bold_italic_x end_ARG start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT ( bold_italic_Î¾ )</annotation></semantics></math> is symmetric positive definite.</span></p>
</div>
</div>
<div class="ltx_proof">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h6>
<div class="ltx_para" id="S2.SS3.SSSx3.p2">
<p class="ltx_p">We have</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E90">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\bar{\bm{x}}^{\prime}(\bm{\xi})=\bm{I}+\left(1-\frac{s}{t}\right)t^{2}\nabla^{2}\log p_{t}(\bm{\xi})." class="ltx_Math" display="block" id="S2.E90.m1"><semantics><mrow><mrow><mrow><msup><mover accent="true"><mi>ğ’™</mi><mo>Â¯</mo></mover><mo>â€²</mo></msup><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mi>ğ‘°</mi><mo>+</mo><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>âˆ’</mo><mfrac><mi>s</mi><mi>t</mi></mfrac></mrow><mo>)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>t</mi><mn>2</mn></msup><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mrow><msup><mo rspace="0.167em">âˆ‡</mo><mn>2</mn></msup><mi>log</mi></mrow><mo lspace="0.167em">â¡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">\bar{\bm{x}}^{\prime}(\bm{\xi})=\bm{I}+\left(1-\frac{s}{t}\right)t^{2}\nabla^{2}\log p_{t}(\bm{\xi}).</annotation><annotation encoding="application/x-llamapun">overÂ¯ start_ARG bold_italic_x end_ARG start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT ( bold_italic_Î¾ ) = bold_italic_I + ( 1 - divide start_ARG italic_s end_ARG start_ARG italic_t end_ARG ) italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT âˆ‡ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.90)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">Here we expand</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E91">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\nabla^{2}\log p_{t}(\bm{\xi})=\frac{p_{t}(\bm{\xi})\nabla^{2}p_{t}(\bm{\xi})-(\nabla p_{t}(\bm{\xi}))(\nabla p_{t}(\bm{\xi}))^{\top}}{p_{t}(\bm{\xi})^{2}}." class="ltx_Math" display="block" id="S2.E91.m1"><semantics><mrow><mrow><mrow><mrow><mrow><msup><mo>âˆ‡</mo><mn>2</mn></msup><mi>log</mi></mrow><mo lspace="0.167em">â¡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mfrac><mrow><mrow><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><msup><mo rspace="0.167em">âˆ‡</mo><mn>2</mn></msup><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>âˆ’</mo><mrow><mrow><mo stretchy="false">(</mo><mrow><mrow><mo rspace="0.167em">âˆ‡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><msup><mrow><mo stretchy="false">(</mo><mrow><mrow><mo rspace="0.167em">âˆ‡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow><mo>âŠ¤</mo></msup></mrow></mrow><mrow><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><msup><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mn>2</mn></msup></mrow></mfrac></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">\nabla^{2}\log p_{t}(\bm{\xi})=\frac{p_{t}(\bm{\xi})\nabla^{2}p_{t}(\bm{\xi})-(\nabla p_{t}(\bm{\xi}))(\nabla p_{t}(\bm{\xi}))^{\top}}{p_{t}(\bm{\xi})^{2}}.</annotation><annotation encoding="application/x-llamapun">âˆ‡ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) = divide start_ARG italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) âˆ‡ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) - ( âˆ‡ italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) ) ( âˆ‡ italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT end_ARG start_ARG italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.91)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">So we need to ensure that</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S3.EGx142">
<tbody id="S2.E92"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\bar{\bm{x}}^{\prime}(\bm{\xi})" class="ltx_Math" display="inline" id="S2.E92.m1"><semantics><mrow><msup><mover accent="true"><mi>ğ’™</mi><mo>Â¯</mo></mover><mo>â€²</mo></msup><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">\displaystyle\bar{\bm{x}}^{\prime}(\bm{\xi})</annotation><annotation encoding="application/x-llamapun">overÂ¯ start_ARG bold_italic_x end_ARG start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT ( bold_italic_Î¾ )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\bm{I}+\left(1-\frac{s}{t}\right)t^{2}\frac{p_{t}(\bm{\xi})\nabla^{2}p_{t}(\bm{\xi})-(\nabla p_{t}(\bm{\xi}))(\nabla p_{t}(\bm{\xi}))^{\top}}{p_{t}(\bm{\xi})^{2}}" class="ltx_Math" display="inline" id="S2.E92.m2"><semantics><mrow><mi></mi><mo>=</mo><mrow><mi>ğ‘°</mi><mo>+</mo><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>âˆ’</mo><mstyle displaystyle="true"><mfrac><mi>s</mi><mi>t</mi></mfrac></mstyle></mrow><mo>)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>t</mi><mn>2</mn></msup><mo lspace="0em" rspace="0em">â€‹</mo><mstyle displaystyle="true"><mfrac><mrow><mrow><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><msup><mo rspace="0.167em">âˆ‡</mo><mn>2</mn></msup><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>âˆ’</mo><mrow><mrow><mo stretchy="false">(</mo><mrow><mrow><mo rspace="0.167em">âˆ‡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><msup><mrow><mo stretchy="false">(</mo><mrow><mrow><mo rspace="0.167em">âˆ‡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow><mo>âŠ¤</mo></msup></mrow></mrow><mrow><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><msup><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mn>2</mn></msup></mrow></mfrac></mstyle></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=\bm{I}+\left(1-\frac{s}{t}\right)t^{2}\frac{p_{t}(\bm{\xi})\nabla^{2}p_{t}(\bm{\xi})-(\nabla p_{t}(\bm{\xi}))(\nabla p_{t}(\bm{\xi}))^{\top}}{p_{t}(\bm{\xi})^{2}}</annotation><annotation encoding="application/x-llamapun">= bold_italic_I + ( 1 - divide start_ARG italic_s end_ARG start_ARG italic_t end_ARG ) italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT divide start_ARG italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) âˆ‡ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) - ( âˆ‡ italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) ) ( âˆ‡ italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT end_ARG start_ARG italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.92)</span></td>
</tr></tbody>
<tbody id="S2.E93"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{p_{t}(\bm{\xi})^{2}\bm{I}+\left(1-\frac{s}{t}\right)t^{2}\left[p_{t}(\bm{\xi})\nabla^{2}p_{t}(\bm{\xi})-(\nabla p_{t}(\bm{\xi}))(\nabla p_{t}(\bm{\xi}))^{\top}\right]}{p_{t}(\bm{\xi})^{2}}" class="ltx_Math" display="inline" id="S2.E93.m1"><semantics><mrow><mi></mi><mo>=</mo><mstyle displaystyle="true"><mfrac><mrow><mrow><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><msup><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mn>2</mn></msup><mo lspace="0em" rspace="0em">â€‹</mo><mi>ğ‘°</mi></mrow><mo>+</mo><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>âˆ’</mo><mfrac><mi>s</mi><mi>t</mi></mfrac></mrow><mo>)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>t</mi><mn>2</mn></msup><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo>[</mo><mrow><mrow><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><msup><mo rspace="0.167em">âˆ‡</mo><mn>2</mn></msup><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>âˆ’</mo><mrow><mrow><mo stretchy="false">(</mo><mrow><mrow><mo rspace="0.167em">âˆ‡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><msup><mrow><mo stretchy="false">(</mo><mrow><mrow><mo rspace="0.167em">âˆ‡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow><mo>âŠ¤</mo></msup></mrow></mrow><mo>]</mo></mrow></mrow></mrow><mrow><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><msup><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mn>2</mn></msup></mrow></mfrac></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle=\frac{p_{t}(\bm{\xi})^{2}\bm{I}+\left(1-\frac{s}{t}\right)t^{2}\left[p_{t}(\bm{\xi})\nabla^{2}p_{t}(\bm{\xi})-(\nabla p_{t}(\bm{\xi}))(\nabla p_{t}(\bm{\xi}))^{\top}\right]}{p_{t}(\bm{\xi})^{2}}</annotation><annotation encoding="application/x-llamapun">= divide start_ARG italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT bold_italic_I + ( 1 - divide start_ARG italic_s end_ARG start_ARG italic_t end_ARG ) italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT [ italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) âˆ‡ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) - ( âˆ‡ italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) ) ( âˆ‡ italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ] end_ARG start_ARG italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.93)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">is symmetric positive semidefinite. Indeed it is obviously symmetric (by Clairautâ€™s theorem). To show its positive semidefiniteness, we plug in the expectation representation of <math alttext="p_{t}" class="ltx_Math" display="inline" id="S2.SS3.SSSx3.p2.m1"><semantics><msub><mi>p</mi><mi>t</mi></msub><annotation encoding="application/x-tex">p_{t}</annotation><annotation encoding="application/x-llamapun">italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> given by (<a class="ltx_ref" href="#S2.E3" title="Equation B.2.3 â€£ B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">B.2.3</span></a>) (and <math alttext="\nabla p_{t}" class="ltx_Math" display="inline" id="S2.SS3.SSSx3.p2.m2"><semantics><mrow><mo rspace="0.167em">âˆ‡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\nabla p_{t}</annotation><annotation encoding="application/x-llamapun">âˆ‡ italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\Delta p_{t}" class="ltx_Math" display="inline" id="S2.SS3.SSSx3.p2.m3"><semantics><mrow><mi mathvariant="normal">Î”</mi><mo lspace="0em" rspace="0em">â€‹</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\Delta p_{t}</annotation><annotation encoding="application/x-llamapun">roman_Î” italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> by <a class="ltx_ref" href="#Thmproposition1" title="Proposition B.1. â€£ Derivative Computations â€£ B.2.3 Technical Lemmas and Intermediate Results â€£ B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Proposition</span>Â <span class="ltx_text ltx_ref_tag">B.1</span></a>) to obtain (where <math alttext="\bm{x}" class="ltx_Math" display="inline" id="S2.SS3.SSSx3.p2.m4"><semantics><mi>ğ’™</mi><annotation encoding="application/x-tex">\bm{x}</annotation><annotation encoding="application/x-llamapun">bold_italic_x</annotation></semantics></math> is as defined and <math alttext="\bm{y}" class="ltx_Math" display="inline" id="S2.SS3.SSSx3.p2.m5"><semantics><mi>ğ’š</mi><annotation encoding="application/x-tex">\bm{y}</annotation><annotation encoding="application/x-llamapun">bold_italic_y</annotation></semantics></math> is i.i.d.Â as <math alttext="\bm{x}" class="ltx_Math" display="inline" id="S2.SS3.SSSx3.p2.m6"><semantics><mi>ğ’™</mi><annotation encoding="application/x-tex">\bm{x}</annotation><annotation encoding="application/x-llamapun">bold_italic_x</annotation></semantics></math>),</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S3.EGx143">
<tbody id="S2.E94"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\bm{v}^{\top}[\bar{\bm{x}}^{\prime}(\bm{\xi})]\bm{v}" class="ltx_Math" display="inline" id="S2.E94.m1"><semantics><mrow><msup><mi>ğ’—</mi><mo>âŠ¤</mo></msup><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">[</mo><mrow><msup><mover accent="true"><mi>ğ’™</mi><mo>Â¯</mo></mover><mo>â€²</mo></msup><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">]</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mi>ğ’—</mi></mrow><annotation encoding="application/x-tex">\displaystyle\bm{v}^{\top}[\bar{\bm{x}}^{\prime}(\bm{\xi})]\bm{v}</annotation><annotation encoding="application/x-llamapun">bold_italic_v start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT [ overÂ¯ start_ARG bold_italic_x end_ARG start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT ( bold_italic_Î¾ ) ] bold_italic_v</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.94)</span></td>
</tr></tbody>
<tbody id="S2.E95"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=p_{t}(\bm{\xi})^{-2}\bm{v}^{\top}\Bigg{\{}p_{t}(\bm{\xi})^{2}\bm{I}+\left(1-\frac{s}{t}\right)t^{2}\operatorname{\mathbb{E}}[\varphi_{t}(\bm{\xi}-\bm{x})]\operatorname{\mathbb{E}}\left[\varphi_{t}(\bm{\xi}-\bm{x})\cdot\frac{(\bm{\xi}-\bm{x})(\bm{\xi}-\bm{x})^{\top}-t^{2}\bm{I}}{t^{4}}\right]" class="ltx_math_unparsed" display="inline" id="S2.E95.m1"><semantics><mrow><mo>=</mo><msub><mi>p</mi><mi>t</mi></msub><msup><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mrow><mo>âˆ’</mo><mn>2</mn></mrow></msup><msup><mi>ğ’—</mi><mo>âŠ¤</mo></msup><mrow><mo maxsize="260%" minsize="260%">{</mo><msub><mi>p</mi><mi>t</mi></msub><msup><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mn>2</mn></msup><mi>ğ‘°</mi><mo>+</mo><mrow><mo>(</mo><mn>1</mn><mo>âˆ’</mo><mstyle displaystyle="true"><mfrac><mi>s</mi><mi>t</mi></mfrac></mstyle><mo>)</mo></mrow><msup><mi>t</mi><mn>2</mn></msup><mi>ğ”¼</mi><mrow><mo stretchy="false">[</mo><msub><mi>Ï†</mi><mi>t</mi></msub><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’™</mi><mo stretchy="false">)</mo></mrow><mo rspace="0.167em" stretchy="false">]</mo></mrow><mi>ğ”¼</mi><mrow><mo>[</mo><msub><mi>Ï†</mi><mi>t</mi></msub><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’™</mi><mo rspace="0.055em" stretchy="false">)</mo></mrow><mo rspace="0.222em">â‹…</mo><mstyle displaystyle="true"><mfrac><mrow><mrow><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’™</mi></mrow><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><msup><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’™</mi></mrow><mo stretchy="false">)</mo></mrow><mo>âŠ¤</mo></msup></mrow><mo>âˆ’</mo><mrow><msup><mi>t</mi><mn>2</mn></msup><mo lspace="0em" rspace="0em">â€‹</mo><mi>ğ‘°</mi></mrow></mrow><msup><mi>t</mi><mn>4</mn></msup></mfrac></mstyle><mo>]</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=p_{t}(\bm{\xi})^{-2}\bm{v}^{\top}\Bigg{\{}p_{t}(\bm{\xi})^{2}\bm{I}+\left(1-\frac{s}{t}\right)t^{2}\operatorname{\mathbb{E}}[\varphi_{t}(\bm{\xi}-\bm{x})]\operatorname{\mathbb{E}}\left[\varphi_{t}(\bm{\xi}-\bm{x})\cdot\frac{(\bm{\xi}-\bm{x})(\bm{\xi}-\bm{x})^{\top}-t^{2}\bm{I}}{t^{4}}\right]</annotation><annotation encoding="application/x-llamapun">= italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) start_POSTSUPERSCRIPT - 2 end_POSTSUPERSCRIPT bold_italic_v start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT { italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT bold_italic_I + ( 1 - divide start_ARG italic_s end_ARG start_ARG italic_t end_ARG ) italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT blackboard_E [ italic_Ï† start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ - bold_italic_x ) ] blackboard_E [ italic_Ï† start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ - bold_italic_x ) â‹… divide start_ARG ( bold_italic_Î¾ - bold_italic_x ) ( bold_italic_Î¾ - bold_italic_x ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT - italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT bold_italic_I end_ARG start_ARG italic_t start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT end_ARG ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.95)</span></td>
</tr></tbody>
<tbody id="S2.E96"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\qquad\qquad\qquad-\left(1-\frac{s}{t}\right)t^{2}\operatorname{\mathbb{E}}\left[-\varphi_{t}(\bm{\xi}-\bm{x})\cdot\frac{\bm{\xi}-\bm{x}}{t^{2}}\right]\operatorname{\mathbb{E}}\left[-\varphi_{t}(\bm{\xi}-\bm{x})\cdot\frac{\bm{\xi}-\bm{x}}{t^{2}}\right]^{\top}\Bigg{\}}\bm{v}" class="ltx_math_unparsed" display="inline" id="S2.E96.m1"><semantics><mrow><mo>âˆ’</mo><mrow><mo>(</mo><mn>1</mn><mo>âˆ’</mo><mstyle displaystyle="true"><mfrac><mi>s</mi><mi>t</mi></mfrac></mstyle><mo>)</mo></mrow><msup><mi>t</mi><mn>2</mn></msup><mi>ğ”¼</mi><mrow><mo>[</mo><mo lspace="0em">âˆ’</mo><msub><mi>Ï†</mi><mi>t</mi></msub><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’™</mi><mo rspace="0.055em" stretchy="false">)</mo></mrow><mo rspace="0.222em">â‹…</mo><mstyle displaystyle="true"><mfrac><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’™</mi></mrow><msup><mi>t</mi><mn>2</mn></msup></mfrac></mstyle><mo rspace="0.167em">]</mo></mrow><mi>ğ”¼</mi><msup><mrow><mo>[</mo><mo lspace="0em">âˆ’</mo><msub><mi>Ï†</mi><mi>t</mi></msub><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’™</mi><mo rspace="0.055em" stretchy="false">)</mo></mrow><mo rspace="0.222em">â‹…</mo><mstyle displaystyle="true"><mfrac><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’™</mi></mrow><msup><mi>t</mi><mn>2</mn></msup></mfrac></mstyle><mo>]</mo></mrow><mo>âŠ¤</mo></msup><mo maxsize="260%" minsize="260%">}</mo><mi>ğ’—</mi></mrow><annotation encoding="application/x-tex">\displaystyle\qquad\qquad\qquad-\left(1-\frac{s}{t}\right)t^{2}\operatorname{\mathbb{E}}\left[-\varphi_{t}(\bm{\xi}-\bm{x})\cdot\frac{\bm{\xi}-\bm{x}}{t^{2}}\right]\operatorname{\mathbb{E}}\left[-\varphi_{t}(\bm{\xi}-\bm{x})\cdot\frac{\bm{\xi}-\bm{x}}{t^{2}}\right]^{\top}\Bigg{\}}\bm{v}</annotation><annotation encoding="application/x-llamapun">- ( 1 - divide start_ARG italic_s end_ARG start_ARG italic_t end_ARG ) italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT blackboard_E [ - italic_Ï† start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ - bold_italic_x ) â‹… divide start_ARG bold_italic_Î¾ - bold_italic_x end_ARG start_ARG italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG ] blackboard_E [ - italic_Ï† start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ - bold_italic_x ) â‹… divide start_ARG bold_italic_Î¾ - bold_italic_x end_ARG start_ARG italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG ] start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT } bold_italic_v</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.96)</span></td>
</tr></tbody>
<tbody id="S2.E97"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=p_{t}(\bm{\xi})^{-2}\bm{v}^{\top}\Bigg{\{}\operatorname{\mathbb{E}}[\varphi_{t}(\bm{\xi}-\bm{x})\varphi_{t}(\bm{\xi}-\bm{y})\bm{I}]" class="ltx_math_unparsed" display="inline" id="S2.E97.m1"><semantics><mrow><mo>=</mo><msub><mi>p</mi><mi>t</mi></msub><msup><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mrow><mo>âˆ’</mo><mn>2</mn></mrow></msup><msup><mi>ğ’—</mi><mo>âŠ¤</mo></msup><mrow><mo maxsize="260%" minsize="260%">{</mo><mi>ğ”¼</mi><mrow><mo stretchy="false">[</mo><msub><mi>Ï†</mi><mi>t</mi></msub><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’™</mi><mo stretchy="false">)</mo></mrow><msub><mi>Ï†</mi><mi>t</mi></msub><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’š</mi><mo stretchy="false">)</mo></mrow><mi>ğ‘°</mi><mo stretchy="false">]</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=p_{t}(\bm{\xi})^{-2}\bm{v}^{\top}\Bigg{\{}\operatorname{\mathbb{E}}[\varphi_{t}(\bm{\xi}-\bm{x})\varphi_{t}(\bm{\xi}-\bm{y})\bm{I}]</annotation><annotation encoding="application/x-llamapun">= italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) start_POSTSUPERSCRIPT - 2 end_POSTSUPERSCRIPT bold_italic_v start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT { blackboard_E [ italic_Ï† start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ - bold_italic_x ) italic_Ï† start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ - bold_italic_y ) bold_italic_I ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.97)</span></td>
</tr></tbody>
<tbody id="S2.E98"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\qquad\qquad\qquad+\left(1-\frac{s}{t}\right)t^{2}\operatorname{\mathbb{E}}\left[\varphi_{t}(\bm{\xi}-\bm{x})\varphi_{t}(\bm{\xi}-\bm{y})\cdot\frac{(\bm{\xi}-\bm{y})(\bm{\xi}-\bm{y})^{\top}-t^{2}\bm{I}}{t^{4}}\right]" class="ltx_Math" display="inline" id="S2.E98.m1"><semantics><mrow><mo>+</mo><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>âˆ’</mo><mstyle displaystyle="true"><mfrac><mi>s</mi><mi>t</mi></mfrac></mstyle></mrow><mo>)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>t</mi><mn>2</mn></msup><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mi>ğ”¼</mi><mo>â¡</mo><mrow><mo>[</mo><mrow><mrow><msub><mi>Ï†</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’™</mi></mrow><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><msub><mi>Ï†</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’š</mi></mrow><mo rspace="0.055em" stretchy="false">)</mo></mrow></mrow><mo rspace="0.222em">â‹…</mo><mstyle displaystyle="true"><mfrac><mrow><mrow><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’š</mi></mrow><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><msup><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’š</mi></mrow><mo stretchy="false">)</mo></mrow><mo>âŠ¤</mo></msup></mrow><mo>âˆ’</mo><mrow><msup><mi>t</mi><mn>2</mn></msup><mo lspace="0em" rspace="0em">â€‹</mo><mi>ğ‘°</mi></mrow></mrow><msup><mi>t</mi><mn>4</mn></msup></mfrac></mstyle></mrow><mo>]</mo></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle\qquad\qquad\qquad+\left(1-\frac{s}{t}\right)t^{2}\operatorname{\mathbb{E}}\left[\varphi_{t}(\bm{\xi}-\bm{x})\varphi_{t}(\bm{\xi}-\bm{y})\cdot\frac{(\bm{\xi}-\bm{y})(\bm{\xi}-\bm{y})^{\top}-t^{2}\bm{I}}{t^{4}}\right]</annotation><annotation encoding="application/x-llamapun">+ ( 1 - divide start_ARG italic_s end_ARG start_ARG italic_t end_ARG ) italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT blackboard_E [ italic_Ï† start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ - bold_italic_x ) italic_Ï† start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ - bold_italic_y ) â‹… divide start_ARG ( bold_italic_Î¾ - bold_italic_y ) ( bold_italic_Î¾ - bold_italic_y ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT - italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT bold_italic_I end_ARG start_ARG italic_t start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT end_ARG ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.98)</span></td>
</tr></tbody>
<tbody id="S2.E99"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\qquad\qquad\qquad-\left(1-\frac{s}{t}\right)t^{2}\operatorname{\mathbb{E}}\left[\varphi_{t}(\bm{\xi}-\bm{x})\varphi_{t}(\bm{\xi}-\bm{y})\cdot\frac{(\bm{\xi}-\bm{x})(\bm{\xi}-\bm{y})^{\top}}{t^{4}}\right]\Bigg{\}}" class="ltx_math_unparsed" display="inline" id="S2.E99.m1"><semantics><mrow><mo>âˆ’</mo><mrow><mo>(</mo><mn>1</mn><mo>âˆ’</mo><mstyle displaystyle="true"><mfrac><mi>s</mi><mi>t</mi></mfrac></mstyle><mo>)</mo></mrow><msup><mi>t</mi><mn>2</mn></msup><mi>ğ”¼</mi><mrow><mo>[</mo><msub><mi>Ï†</mi><mi>t</mi></msub><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’™</mi><mo stretchy="false">)</mo></mrow><msub><mi>Ï†</mi><mi>t</mi></msub><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’š</mi><mo rspace="0.055em" stretchy="false">)</mo></mrow><mo rspace="0.222em">â‹…</mo><mstyle displaystyle="true"><mfrac><mrow><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’™</mi></mrow><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><msup><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’š</mi></mrow><mo stretchy="false">)</mo></mrow><mo>âŠ¤</mo></msup></mrow><msup><mi>t</mi><mn>4</mn></msup></mfrac></mstyle><mo>]</mo></mrow><mo maxsize="260%" minsize="260%">}</mo></mrow><annotation encoding="application/x-tex">\displaystyle\qquad\qquad\qquad-\left(1-\frac{s}{t}\right)t^{2}\operatorname{\mathbb{E}}\left[\varphi_{t}(\bm{\xi}-\bm{x})\varphi_{t}(\bm{\xi}-\bm{y})\cdot\frac{(\bm{\xi}-\bm{x})(\bm{\xi}-\bm{y})^{\top}}{t^{4}}\right]\Bigg{\}}</annotation><annotation encoding="application/x-llamapun">- ( 1 - divide start_ARG italic_s end_ARG start_ARG italic_t end_ARG ) italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT blackboard_E [ italic_Ï† start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ - bold_italic_x ) italic_Ï† start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ - bold_italic_y ) â‹… divide start_ARG ( bold_italic_Î¾ - bold_italic_x ) ( bold_italic_Î¾ - bold_italic_y ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT end_ARG start_ARG italic_t start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT end_ARG ] }</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.99)</span></td>
</tr></tbody>
<tbody id="S2.E100"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{1-s/t}{p_{t}(\bm{\xi})^{2}}\bm{v}^{\top}\operatorname{\mathbb{E}}\mathopen{}\Bigg{[}\varphi_{t}(\bm{\xi}-\bm{x})\varphi_{t}(\bm{\xi}-\bm{y})\left\{\frac{1}{1-s/t}\bm{I}+\frac{(\bm{\xi}-\bm{y})(\bm{\xi}-\bm{y})^{\top}}{t^{2}}-\bm{I}-\frac{(\bm{\xi}-\bm{x})(\bm{\xi}-\bm{y})^{\top}}{t^{2}}\right\}\Bigg{]}\bm{v}" class="ltx_Math" display="inline" id="S2.E100.m1"><semantics><mrow><mi></mi><mo>=</mo><mrow><mstyle displaystyle="true"><mfrac><mrow><mn>1</mn><mo>âˆ’</mo><mrow><mi>s</mi><mo>/</mo><mi>t</mi></mrow></mrow><mrow><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><msup><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mn>2</mn></msup></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>ğ’—</mi><mo>âŠ¤</mo></msup><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mi>ğ”¼</mi><mo>â¡</mo><mrow><mo maxsize="260%" minsize="260%">[</mo><mrow><msub><mi>Ï†</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’™</mi></mrow><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><msub><mi>Ï†</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’š</mi></mrow><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo>{</mo><mrow><mrow><mrow><mstyle displaystyle="true"><mfrac><mn>1</mn><mrow><mn>1</mn><mo>âˆ’</mo><mrow><mi>s</mi><mo>/</mo><mi>t</mi></mrow></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em">â€‹</mo><mi>ğ‘°</mi></mrow><mo>+</mo><mstyle displaystyle="true"><mfrac><mrow><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’š</mi></mrow><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><msup><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’š</mi></mrow><mo stretchy="false">)</mo></mrow><mo>âŠ¤</mo></msup></mrow><msup><mi>t</mi><mn>2</mn></msup></mfrac></mstyle></mrow><mo>âˆ’</mo><mi>ğ‘°</mi><mo>âˆ’</mo><mstyle displaystyle="true"><mfrac><mrow><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’™</mi></mrow><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><msup><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’š</mi></mrow><mo stretchy="false">)</mo></mrow><mo>âŠ¤</mo></msup></mrow><msup><mi>t</mi><mn>2</mn></msup></mfrac></mstyle></mrow><mo>}</mo></mrow></mrow><mo maxsize="260%" minsize="260%">]</mo></mrow></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mi>ğ’—</mi></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=\frac{1-s/t}{p_{t}(\bm{\xi})^{2}}\bm{v}^{\top}\operatorname{\mathbb{E}}\mathopen{}\Bigg{[}\varphi_{t}(\bm{\xi}-\bm{x})\varphi_{t}(\bm{\xi}-\bm{y})\left\{\frac{1}{1-s/t}\bm{I}+\frac{(\bm{\xi}-\bm{y})(\bm{\xi}-\bm{y})^{\top}}{t^{2}}-\bm{I}-\frac{(\bm{\xi}-\bm{x})(\bm{\xi}-\bm{y})^{\top}}{t^{2}}\right\}\Bigg{]}\bm{v}</annotation><annotation encoding="application/x-llamapun">= divide start_ARG 1 - italic_s / italic_t end_ARG start_ARG italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG bold_italic_v start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT blackboard_E [ italic_Ï† start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ - bold_italic_x ) italic_Ï† start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ - bold_italic_y ) { divide start_ARG 1 end_ARG start_ARG 1 - italic_s / italic_t end_ARG bold_italic_I + divide start_ARG ( bold_italic_Î¾ - bold_italic_y ) ( bold_italic_Î¾ - bold_italic_y ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT end_ARG start_ARG italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG - bold_italic_I - divide start_ARG ( bold_italic_Î¾ - bold_italic_x ) ( bold_italic_Î¾ - bold_italic_y ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT end_ARG start_ARG italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG } ] bold_italic_v</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.100)</span></td>
</tr></tbody>
<tbody id="S2.E101"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{t-s}{tp_{t}(\bm{\xi})^{2}}\bm{v}^{\top}\operatorname{\mathbb{E}}\left[\frac{s}{t-s}\bm{I}+\frac{(\bm{\xi}-\bm{x})(\bm{\xi}-\bm{x})^{\top}}{2t^{2}}+\frac{(\bm{\xi}-\bm{y})(\bm{\xi}-\bm{y})^{\top}}{2t^{2}}-\frac{(\bm{\xi}-\bm{x})(\bm{\xi}-\bm{y})^{\top}}{t^{2}}\right]\bm{v}" class="ltx_Math" display="inline" id="S2.E101.m1"><semantics><mrow><mi></mi><mo>=</mo><mrow><mstyle displaystyle="true"><mfrac><mrow><mi>t</mi><mo>âˆ’</mo><mi>s</mi></mrow><mrow><mi>t</mi><mo lspace="0em" rspace="0em">â€‹</mo><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><msup><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mn>2</mn></msup></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>ğ’—</mi><mo>âŠ¤</mo></msup><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mi>ğ”¼</mi><mo>â¡</mo><mrow><mo>[</mo><mrow><mrow><mrow><mstyle displaystyle="true"><mfrac><mi>s</mi><mrow><mi>t</mi><mo>âˆ’</mo><mi>s</mi></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em">â€‹</mo><mi>ğ‘°</mi></mrow><mo>+</mo><mstyle displaystyle="true"><mfrac><mrow><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’™</mi></mrow><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><msup><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’™</mi></mrow><mo stretchy="false">)</mo></mrow><mo>âŠ¤</mo></msup></mrow><mrow><mn>2</mn><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>t</mi><mn>2</mn></msup></mrow></mfrac></mstyle><mo>+</mo><mstyle displaystyle="true"><mfrac><mrow><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’š</mi></mrow><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><msup><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’š</mi></mrow><mo stretchy="false">)</mo></mrow><mo>âŠ¤</mo></msup></mrow><mrow><mn>2</mn><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>t</mi><mn>2</mn></msup></mrow></mfrac></mstyle></mrow><mo>âˆ’</mo><mstyle displaystyle="true"><mfrac><mrow><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’™</mi></mrow><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><msup><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’š</mi></mrow><mo stretchy="false">)</mo></mrow><mo>âŠ¤</mo></msup></mrow><msup><mi>t</mi><mn>2</mn></msup></mfrac></mstyle></mrow><mo>]</mo></mrow></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mi>ğ’—</mi></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=\frac{t-s}{tp_{t}(\bm{\xi})^{2}}\bm{v}^{\top}\operatorname{\mathbb{E}}\left[\frac{s}{t-s}\bm{I}+\frac{(\bm{\xi}-\bm{x})(\bm{\xi}-\bm{x})^{\top}}{2t^{2}}+\frac{(\bm{\xi}-\bm{y})(\bm{\xi}-\bm{y})^{\top}}{2t^{2}}-\frac{(\bm{\xi}-\bm{x})(\bm{\xi}-\bm{y})^{\top}}{t^{2}}\right]\bm{v}</annotation><annotation encoding="application/x-llamapun">= divide start_ARG italic_t - italic_s end_ARG start_ARG italic_t italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG bold_italic_v start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT blackboard_E [ divide start_ARG italic_s end_ARG start_ARG italic_t - italic_s end_ARG bold_italic_I + divide start_ARG ( bold_italic_Î¾ - bold_italic_x ) ( bold_italic_Î¾ - bold_italic_x ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT end_ARG start_ARG 2 italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG + divide start_ARG ( bold_italic_Î¾ - bold_italic_y ) ( bold_italic_Î¾ - bold_italic_y ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT end_ARG start_ARG 2 italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG - divide start_ARG ( bold_italic_Î¾ - bold_italic_x ) ( bold_italic_Î¾ - bold_italic_y ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT end_ARG start_ARG italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG ] bold_italic_v</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.101)</span></td>
</tr></tbody>
<tbody id="S2.E102"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{t-s}{tp_{t}(\bm{\xi})^{2}}\bm{v}^{\top}\operatorname{\mathbb{E}}\left[\frac{s}{t-s}\bm{I}+\frac{1}{2t^{2}}\left((\bm{\xi}-\bm{x})(\bm{\xi}-\bm{x})^{\top}+(\bm{\xi}-\bm{y})(\bm{\xi}-\bm{y})^{\top}-2(\bm{\xi}-\bm{x})(\bm{\xi}-\bm{y})^{\top}\right)\right]\bm{v}" class="ltx_Math" display="inline" id="S2.E102.m1"><semantics><mrow><mi></mi><mo>=</mo><mrow><mstyle displaystyle="true"><mfrac><mrow><mi>t</mi><mo>âˆ’</mo><mi>s</mi></mrow><mrow><mi>t</mi><mo lspace="0em" rspace="0em">â€‹</mo><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><msup><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mn>2</mn></msup></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>ğ’—</mi><mo>âŠ¤</mo></msup><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mi>ğ”¼</mi><mo>â¡</mo><mrow><mo>[</mo><mrow><mrow><mstyle displaystyle="true"><mfrac><mi>s</mi><mrow><mi>t</mi><mo>âˆ’</mo><mi>s</mi></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em">â€‹</mo><mi>ğ‘°</mi></mrow><mo>+</mo><mrow><mstyle displaystyle="true"><mfrac><mn>1</mn><mrow><mn>2</mn><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>t</mi><mn>2</mn></msup></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo>(</mo><mrow><mrow><mrow><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’™</mi></mrow><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><msup><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’™</mi></mrow><mo stretchy="false">)</mo></mrow><mo>âŠ¤</mo></msup></mrow><mo>+</mo><mrow><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’š</mi></mrow><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><msup><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’š</mi></mrow><mo stretchy="false">)</mo></mrow><mo>âŠ¤</mo></msup></mrow></mrow><mo>âˆ’</mo><mrow><mn>2</mn><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’™</mi></mrow><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><msup><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’š</mi></mrow><mo stretchy="false">)</mo></mrow><mo>âŠ¤</mo></msup></mrow></mrow><mo>)</mo></mrow></mrow></mrow><mo>]</mo></mrow></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mi>ğ’—</mi></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=\frac{t-s}{tp_{t}(\bm{\xi})^{2}}\bm{v}^{\top}\operatorname{\mathbb{E}}\left[\frac{s}{t-s}\bm{I}+\frac{1}{2t^{2}}\left((\bm{\xi}-\bm{x})(\bm{\xi}-\bm{x})^{\top}+(\bm{\xi}-\bm{y})(\bm{\xi}-\bm{y})^{\top}-2(\bm{\xi}-\bm{x})(\bm{\xi}-\bm{y})^{\top}\right)\right]\bm{v}</annotation><annotation encoding="application/x-llamapun">= divide start_ARG italic_t - italic_s end_ARG start_ARG italic_t italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG bold_italic_v start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT blackboard_E [ divide start_ARG italic_s end_ARG start_ARG italic_t - italic_s end_ARG bold_italic_I + divide start_ARG 1 end_ARG start_ARG 2 italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG ( ( bold_italic_Î¾ - bold_italic_x ) ( bold_italic_Î¾ - bold_italic_x ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT + ( bold_italic_Î¾ - bold_italic_y ) ( bold_italic_Î¾ - bold_italic_y ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT - 2 ( bold_italic_Î¾ - bold_italic_x ) ( bold_italic_Î¾ - bold_italic_y ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ) ] bold_italic_v</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.102)</span></td>
</tr></tbody>
<tbody id="S2.E103"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{t-s}{tp_{t}(\bm{\xi})^{2}}\operatorname{\mathbb{E}}\left[\frac{s}{t-s}\|\bm{v}\|_{2}^{2}+\frac{1}{2t^{2}}\left([(\bm{\xi}-\bm{x})^{\top}\bm{v}]^{2}+[(\bm{\xi}-\bm{y})^{\top}\bm{v}]^{2}-2[(\bm{\xi}-\bm{x})^{\top}\bm{v}][(\bm{\xi}-\bm{y})^{\top}\bm{v}]\right)\right]" class="ltx_Math" display="inline" id="S2.E103.m1"><semantics><mrow><mi></mi><mo>=</mo><mrow><mstyle displaystyle="true"><mfrac><mrow><mi>t</mi><mo>âˆ’</mo><mi>s</mi></mrow><mrow><mi>t</mi><mo lspace="0em" rspace="0em">â€‹</mo><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><msup><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mn>2</mn></msup></mrow></mfrac></mstyle><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mi>ğ”¼</mi><mo>â¡</mo><mrow><mo>[</mo><mrow><mrow><mstyle displaystyle="true"><mfrac><mi>s</mi><mrow><mi>t</mi><mo>âˆ’</mo><mi>s</mi></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em">â€‹</mo><msubsup><mrow><mo stretchy="false">â€–</mo><mi>ğ’—</mi><mo stretchy="false">â€–</mo></mrow><mn>2</mn><mn>2</mn></msubsup></mrow><mo>+</mo><mrow><mstyle displaystyle="true"><mfrac><mn>1</mn><mrow><mn>2</mn><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>t</mi><mn>2</mn></msup></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo>(</mo><mrow><mrow><msup><mrow><mo stretchy="false">[</mo><mrow><msup><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’™</mi></mrow><mo stretchy="false">)</mo></mrow><mo>âŠ¤</mo></msup><mo lspace="0em" rspace="0em">â€‹</mo><mi>ğ’—</mi></mrow><mo stretchy="false">]</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mo stretchy="false">[</mo><mrow><msup><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’š</mi></mrow><mo stretchy="false">)</mo></mrow><mo>âŠ¤</mo></msup><mo lspace="0em" rspace="0em">â€‹</mo><mi>ğ’—</mi></mrow><mo stretchy="false">]</mo></mrow><mn>2</mn></msup></mrow><mo>âˆ’</mo><mrow><mn>2</mn><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">[</mo><mrow><msup><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’™</mi></mrow><mo stretchy="false">)</mo></mrow><mo>âŠ¤</mo></msup><mo lspace="0em" rspace="0em">â€‹</mo><mi>ğ’—</mi></mrow><mo stretchy="false">]</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">[</mo><mrow><msup><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’š</mi></mrow><mo stretchy="false">)</mo></mrow><mo>âŠ¤</mo></msup><mo lspace="0em" rspace="0em">â€‹</mo><mi>ğ’—</mi></mrow><mo stretchy="false">]</mo></mrow></mrow></mrow><mo>)</mo></mrow></mrow></mrow><mo>]</mo></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=\frac{t-s}{tp_{t}(\bm{\xi})^{2}}\operatorname{\mathbb{E}}\left[\frac{s}{t-s}\|\bm{v}\|_{2}^{2}+\frac{1}{2t^{2}}\left([(\bm{\xi}-\bm{x})^{\top}\bm{v}]^{2}+[(\bm{\xi}-\bm{y})^{\top}\bm{v}]^{2}-2[(\bm{\xi}-\bm{x})^{\top}\bm{v}][(\bm{\xi}-\bm{y})^{\top}\bm{v}]\right)\right]</annotation><annotation encoding="application/x-llamapun">= divide start_ARG italic_t - italic_s end_ARG start_ARG italic_t italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG blackboard_E [ divide start_ARG italic_s end_ARG start_ARG italic_t - italic_s end_ARG âˆ¥ bold_italic_v âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + divide start_ARG 1 end_ARG start_ARG 2 italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG ( [ ( bold_italic_Î¾ - bold_italic_x ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_v ] start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + [ ( bold_italic_Î¾ - bold_italic_y ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_v ] start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT - 2 [ ( bold_italic_Î¾ - bold_italic_x ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_v ] [ ( bold_italic_Î¾ - bold_italic_y ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_v ] ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.103)</span></td>
</tr></tbody>
<tbody id="S2.E104"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{t-s}{tp_{t}(\bm{\xi})^{2}}\operatorname{\mathbb{E}}\left[\frac{s}{t-s}\|\bm{v}\|_{2}^{2}+\frac{1}{2t^{2}}\left([(\bm{\xi}-\bm{x})^{\top}\bm{v}]^{2}+[(\bm{\xi}-\bm{y})^{\top}\bm{v}]^{2}-2[(\bm{\xi}-\bm{x})^{\top}\bm{v}][(\bm{\xi}-\bm{y})^{\top}\bm{v}]\right)\right]" class="ltx_Math" display="inline" id="S2.E104.m1"><semantics><mrow><mi></mi><mo>=</mo><mrow><mstyle displaystyle="true"><mfrac><mrow><mi>t</mi><mo>âˆ’</mo><mi>s</mi></mrow><mrow><mi>t</mi><mo lspace="0em" rspace="0em">â€‹</mo><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><msup><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mn>2</mn></msup></mrow></mfrac></mstyle><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mi>ğ”¼</mi><mo>â¡</mo><mrow><mo>[</mo><mrow><mrow><mstyle displaystyle="true"><mfrac><mi>s</mi><mrow><mi>t</mi><mo>âˆ’</mo><mi>s</mi></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em">â€‹</mo><msubsup><mrow><mo stretchy="false">â€–</mo><mi>ğ’—</mi><mo stretchy="false">â€–</mo></mrow><mn>2</mn><mn>2</mn></msubsup></mrow><mo>+</mo><mrow><mstyle displaystyle="true"><mfrac><mn>1</mn><mrow><mn>2</mn><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>t</mi><mn>2</mn></msup></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo>(</mo><mrow><mrow><msup><mrow><mo stretchy="false">[</mo><mrow><msup><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’™</mi></mrow><mo stretchy="false">)</mo></mrow><mo>âŠ¤</mo></msup><mo lspace="0em" rspace="0em">â€‹</mo><mi>ğ’—</mi></mrow><mo stretchy="false">]</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mo stretchy="false">[</mo><mrow><msup><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’š</mi></mrow><mo stretchy="false">)</mo></mrow><mo>âŠ¤</mo></msup><mo lspace="0em" rspace="0em">â€‹</mo><mi>ğ’—</mi></mrow><mo stretchy="false">]</mo></mrow><mn>2</mn></msup></mrow><mo>âˆ’</mo><mrow><mn>2</mn><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">[</mo><mrow><msup><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’™</mi></mrow><mo stretchy="false">)</mo></mrow><mo>âŠ¤</mo></msup><mo lspace="0em" rspace="0em">â€‹</mo><mi>ğ’—</mi></mrow><mo stretchy="false">]</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">[</mo><mrow><msup><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’š</mi></mrow><mo stretchy="false">)</mo></mrow><mo>âŠ¤</mo></msup><mo lspace="0em" rspace="0em">â€‹</mo><mi>ğ’—</mi></mrow><mo stretchy="false">]</mo></mrow></mrow></mrow><mo>)</mo></mrow></mrow></mrow><mo>]</mo></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=\frac{t-s}{tp_{t}(\bm{\xi})^{2}}\operatorname{\mathbb{E}}\left[\frac{s}{t-s}\|\bm{v}\|_{2}^{2}+\frac{1}{2t^{2}}\left([(\bm{\xi}-\bm{x})^{\top}\bm{v}]^{2}+[(\bm{\xi}-\bm{y})^{\top}\bm{v}]^{2}-2[(\bm{\xi}-\bm{x})^{\top}\bm{v}][(\bm{\xi}-\bm{y})^{\top}\bm{v}]\right)\right]</annotation><annotation encoding="application/x-llamapun">= divide start_ARG italic_t - italic_s end_ARG start_ARG italic_t italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG blackboard_E [ divide start_ARG italic_s end_ARG start_ARG italic_t - italic_s end_ARG âˆ¥ bold_italic_v âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + divide start_ARG 1 end_ARG start_ARG 2 italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG ( [ ( bold_italic_Î¾ - bold_italic_x ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_v ] start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + [ ( bold_italic_Î¾ - bold_italic_y ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_v ] start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT - 2 [ ( bold_italic_Î¾ - bold_italic_x ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_v ] [ ( bold_italic_Î¾ - bold_italic_y ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_v ] ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.104)</span></td>
</tr></tbody>
<tbody id="S2.E105"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{t-s}{tp_{t}(\bm{\xi})^{2}}\operatorname{\mathbb{E}}\left[\frac{s}{t-s}\|\bm{v}\|_{2}^{2}+\frac{1}{2t^{2}}\left([(\bm{\xi}-\bm{x})^{\top}\bm{v}]-[(\bm{\xi}-\bm{y})^{\top}\bm{v}]\right)^{2}\right]" class="ltx_Math" display="inline" id="S2.E105.m1"><semantics><mrow><mi></mi><mo>=</mo><mrow><mstyle displaystyle="true"><mfrac><mrow><mi>t</mi><mo>âˆ’</mo><mi>s</mi></mrow><mrow><mi>t</mi><mo lspace="0em" rspace="0em">â€‹</mo><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><msup><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mn>2</mn></msup></mrow></mfrac></mstyle><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mi>ğ”¼</mi><mo>â¡</mo><mrow><mo>[</mo><mrow><mrow><mstyle displaystyle="true"><mfrac><mi>s</mi><mrow><mi>t</mi><mo>âˆ’</mo><mi>s</mi></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em">â€‹</mo><msubsup><mrow><mo stretchy="false">â€–</mo><mi>ğ’—</mi><mo stretchy="false">â€–</mo></mrow><mn>2</mn><mn>2</mn></msubsup></mrow><mo>+</mo><mrow><mstyle displaystyle="true"><mfrac><mn>1</mn><mrow><mn>2</mn><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>t</mi><mn>2</mn></msup></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em">â€‹</mo><msup><mrow><mo>(</mo><mrow><mrow><mo stretchy="false">[</mo><mrow><msup><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’™</mi></mrow><mo stretchy="false">)</mo></mrow><mo>âŠ¤</mo></msup><mo lspace="0em" rspace="0em">â€‹</mo><mi>ğ’—</mi></mrow><mo stretchy="false">]</mo></mrow><mo>âˆ’</mo><mrow><mo stretchy="false">[</mo><mrow><msup><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’š</mi></mrow><mo stretchy="false">)</mo></mrow><mo>âŠ¤</mo></msup><mo lspace="0em" rspace="0em">â€‹</mo><mi>ğ’—</mi></mrow><mo stretchy="false">]</mo></mrow></mrow><mo>)</mo></mrow><mn>2</mn></msup></mrow></mrow><mo>]</mo></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=\frac{t-s}{tp_{t}(\bm{\xi})^{2}}\operatorname{\mathbb{E}}\left[\frac{s}{t-s}\|\bm{v}\|_{2}^{2}+\frac{1}{2t^{2}}\left([(\bm{\xi}-\bm{x})^{\top}\bm{v}]-[(\bm{\xi}-\bm{y})^{\top}\bm{v}]\right)^{2}\right]</annotation><annotation encoding="application/x-llamapun">= divide start_ARG italic_t - italic_s end_ARG start_ARG italic_t italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG blackboard_E [ divide start_ARG italic_s end_ARG start_ARG italic_t - italic_s end_ARG âˆ¥ bold_italic_v âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + divide start_ARG 1 end_ARG start_ARG 2 italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG ( [ ( bold_italic_Î¾ - bold_italic_x ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_v ] - [ ( bold_italic_Î¾ - bold_italic_y ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_v ] ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.105)</span></td>
</tr></tbody>
<tbody id="S2.E106"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{t-s}{tp_{t}(\bm{\xi})^{2}}\operatorname{\mathbb{E}}\left[\frac{s}{t-s}\|\bm{v}\|_{2}^{2}+\frac{1}{2t^{2}}[(\bm{y}-\bm{x})^{\top}\bm{v}]^{2}\right]" class="ltx_Math" display="inline" id="S2.E106.m1"><semantics><mrow><mi></mi><mo>=</mo><mrow><mstyle displaystyle="true"><mfrac><mrow><mi>t</mi><mo>âˆ’</mo><mi>s</mi></mrow><mrow><mi>t</mi><mo lspace="0em" rspace="0em">â€‹</mo><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><msup><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mn>2</mn></msup></mrow></mfrac></mstyle><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mi>ğ”¼</mi><mo>â¡</mo><mrow><mo>[</mo><mrow><mrow><mstyle displaystyle="true"><mfrac><mi>s</mi><mrow><mi>t</mi><mo>âˆ’</mo><mi>s</mi></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em">â€‹</mo><msubsup><mrow><mo stretchy="false">â€–</mo><mi>ğ’—</mi><mo stretchy="false">â€–</mo></mrow><mn>2</mn><mn>2</mn></msubsup></mrow><mo>+</mo><mrow><mstyle displaystyle="true"><mfrac><mn>1</mn><mrow><mn>2</mn><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>t</mi><mn>2</mn></msup></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em">â€‹</mo><msup><mrow><mo stretchy="false">[</mo><mrow><msup><mrow><mo stretchy="false">(</mo><mrow><mi>ğ’š</mi><mo>âˆ’</mo><mi>ğ’™</mi></mrow><mo stretchy="false">)</mo></mrow><mo>âŠ¤</mo></msup><mo lspace="0em" rspace="0em">â€‹</mo><mi>ğ’—</mi></mrow><mo stretchy="false">]</mo></mrow><mn>2</mn></msup></mrow></mrow><mo>]</mo></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=\frac{t-s}{tp_{t}(\bm{\xi})^{2}}\operatorname{\mathbb{E}}\left[\frac{s}{t-s}\|\bm{v}\|_{2}^{2}+\frac{1}{2t^{2}}[(\bm{y}-\bm{x})^{\top}\bm{v}]^{2}\right]</annotation><annotation encoding="application/x-llamapun">= divide start_ARG italic_t - italic_s end_ARG start_ARG italic_t italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG blackboard_E [ divide start_ARG italic_s end_ARG start_ARG italic_t - italic_s end_ARG âˆ¥ bold_italic_v âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + divide start_ARG 1 end_ARG start_ARG 2 italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG [ ( bold_italic_y - bold_italic_x ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_v ] start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.106)</span></td>
</tr></tbody>
<tbody id="S2.E107"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{s}{tp_{t}(\bm{\xi})^{2}}\|\bm{v}\|_{2}^{2}+\frac{t-s}{2t^{3}p_{t}(\bm{\xi})}\operatorname{\mathbb{E}}[\{(\bm{y}-\bm{x})^{\top}\bm{v}\}^{2}]" class="ltx_Math" display="inline" id="S2.E107.m1"><semantics><mrow><mi></mi><mo>=</mo><mrow><mrow><mstyle displaystyle="true"><mfrac><mi>s</mi><mrow><mi>t</mi><mo lspace="0em" rspace="0em">â€‹</mo><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><msup><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mn>2</mn></msup></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em">â€‹</mo><msubsup><mrow><mo stretchy="false">â€–</mo><mi>ğ’—</mi><mo stretchy="false">â€–</mo></mrow><mn>2</mn><mn>2</mn></msubsup></mrow><mo>+</mo><mrow><mstyle displaystyle="true"><mfrac><mrow><mi>t</mi><mo>âˆ’</mo><mi>s</mi></mrow><mrow><mn>2</mn><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>t</mi><mn>3</mn></msup><mo lspace="0em" rspace="0em">â€‹</mo><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow></mfrac></mstyle><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mi>ğ”¼</mi><mo>â¡</mo><mrow><mo stretchy="false">[</mo><msup><mrow><mo stretchy="false">{</mo><mrow><msup><mrow><mo stretchy="false">(</mo><mrow><mi>ğ’š</mi><mo>âˆ’</mo><mi>ğ’™</mi></mrow><mo stretchy="false">)</mo></mrow><mo>âŠ¤</mo></msup><mo lspace="0em" rspace="0em">â€‹</mo><mi>ğ’—</mi></mrow><mo stretchy="false">}</mo></mrow><mn>2</mn></msup><mo stretchy="false">]</mo></mrow></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=\frac{s}{tp_{t}(\bm{\xi})^{2}}\|\bm{v}\|_{2}^{2}+\frac{t-s}{2t^{3}p_{t}(\bm{\xi})}\operatorname{\mathbb{E}}[\{(\bm{y}-\bm{x})^{\top}\bm{v}\}^{2}]</annotation><annotation encoding="application/x-llamapun">= divide start_ARG italic_s end_ARG start_ARG italic_t italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG âˆ¥ bold_italic_v âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + divide start_ARG italic_t - italic_s end_ARG start_ARG 2 italic_t start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) end_ARG blackboard_E [ { ( bold_italic_y - bold_italic_x ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_v } start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.107)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">Since <math alttext="\bm{x}" class="ltx_Math" display="inline" id="S2.SS3.SSSx3.p2.m7"><semantics><mi>ğ’™</mi><annotation encoding="application/x-tex">\bm{x}</annotation><annotation encoding="application/x-llamapun">bold_italic_x</annotation></semantics></math> and <math alttext="\bm{y}" class="ltx_Math" display="inline" id="S2.SS3.SSSx3.p2.m8"><semantics><mi>ğ’š</mi><annotation encoding="application/x-tex">\bm{y}</annotation><annotation encoding="application/x-llamapun">bold_italic_y</annotation></semantics></math> are i.i.d., the whole integral (i.e., the original quadratic form) is <math alttext="0" class="ltx_Math" display="inline" id="S2.SS3.SSSx3.p2.m9"><mn>0</mn></math> if and only if <math alttext="s=0" class="ltx_Math" display="inline" id="S2.SS3.SSSx3.p2.m10"><semantics><mrow><mi>s</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">s=0</annotation><annotation encoding="application/x-llamapun">italic_s = 0</annotation></semantics></math> and <math alttext="\bm{x}" class="ltx_Math" display="inline" id="S2.SS3.SSSx3.p2.m11"><semantics><mi>ğ’™</mi><annotation encoding="application/x-tex">\bm{x}</annotation><annotation encoding="application/x-llamapun">bold_italic_x</annotation></semantics></math> has support entirely contained in an affine subspace which is orthogonal to <math alttext="\bm{v}" class="ltx_Math" display="inline" id="S2.SS3.SSSx3.p2.m12"><semantics><mi>ğ’—</mi><annotation encoding="application/x-tex">\bm{v}</annotation><annotation encoding="application/x-llamapun">bold_italic_v</annotation></semantics></math>. But this is ruled out by assumption (i.e., that <math alttext="\bm{x}" class="ltx_Math" display="inline" id="S2.SS3.SSSx3.p2.m13"><semantics><mi>ğ’™</mi><annotation encoding="application/x-tex">\bm{x}</annotation><annotation encoding="application/x-llamapun">bold_italic_x</annotation></semantics></math> has a density on <math alttext="\mathbb{R}^{D}" class="ltx_Math" display="inline" id="S2.SS3.SSSx3.p2.m14"><semantics><msup><mi>â„</mi><mi>D</mi></msup><annotation encoding="application/x-tex">\mathbb{R}^{D}</annotation><annotation encoding="application/x-llamapun">blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT</annotation></semantics></math>), so the Jacobian <math alttext="\bar{\bm{x}}^{\prime}(\bm{\xi})" class="ltx_Math" display="inline" id="S2.SS3.SSSx3.p2.m15"><semantics><mrow><msup><mover accent="true"><mi>ğ’™</mi><mo>Â¯</mo></mover><mo>â€²</mo></msup><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">\bar{\bm{x}}^{\prime}(\bm{\xi})</annotation><annotation encoding="application/x-llamapun">overÂ¯ start_ARG bold_italic_x end_ARG start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT ( bold_italic_Î¾ )</annotation></semantics></math> is symmetric positive definite.
âˆ</p>
</div>
</div>
<div class="ltx_theorem ltx_theorem_lemma" id="Thmlemma4">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold">Lemma B.4</span></span><span class="ltx_text ltx_font_bold"> </span>(Generalization of <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="bib.html#bibx96" title="">Gri11</a>]</cite> Corollary A.2, Part 1)<span class="ltx_text ltx_font_bold">.</span>
</h6>
<div class="ltx_para" id="Thmlemma4.p1">
<p class="ltx_p"><span class="ltx_text ltx_font_italic">Let <math alttext="f\colon\mathbb{R}^{D}\to\mathbb{R}^{D}" class="ltx_Math" display="inline" id="Thmlemma4.p1.m1"><semantics><mrow><mi>f</mi><mo lspace="0.278em" rspace="0.278em">:</mo><mrow><msup><mi>â„</mi><mi>D</mi></msup><mo stretchy="false">â†’</mo><msup><mi>â„</mi><mi>D</mi></msup></mrow></mrow><annotation encoding="application/x-tex">f\colon\mathbb{R}^{D}\to\mathbb{R}^{D}</annotation><annotation encoding="application/x-llamapun">italic_f : blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT â†’ blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT</annotation></semantics></math> be any differentiable function whose Jacobian <math alttext="f^{\prime}(\bm{x})" class="ltx_Math" display="inline" id="Thmlemma4.p1.m2"><semantics><mrow><msup><mi>f</mi><mo>â€²</mo></msup><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğ±</mi><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">f^{\prime}(\bm{x})</annotation><annotation encoding="application/x-llamapun">italic_f start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT ( bold_italic_x )</annotation></semantics></math> is symmetric positive definite. Then <math alttext="f" class="ltx_Math" display="inline" id="Thmlemma4.p1.m3"><semantics><mi>f</mi><annotation encoding="application/x-tex">f</annotation><annotation encoding="application/x-llamapun">italic_f</annotation></semantics></math> is injective, and hence invertible as a function <math alttext="\mathbb{R}^{D}\to\mathcal{R}(f)" class="ltx_Math" display="inline" id="Thmlemma4.p1.m4"><semantics><mrow><msup><mi>â„</mi><mi>D</mi></msup><mo stretchy="false">â†’</mo><mrow><mi class="ltx_font_mathcaligraphic">â„›</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\mathbb{R}^{D}\to\mathcal{R}(f)</annotation><annotation encoding="application/x-llamapun">blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT â†’ caligraphic_R ( italic_f )</annotation></semantics></math> where <math alttext="\mathcal{R}(f)" class="ltx_Math" display="inline" id="Thmlemma4.p1.m5"><semantics><mrow><mi class="ltx_font_mathcaligraphic">â„›</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathcal{R}(f)</annotation><annotation encoding="application/x-llamapun">caligraphic_R ( italic_f )</annotation></semantics></math> is the range of <math alttext="f" class="ltx_Math" display="inline" id="Thmlemma4.p1.m6"><semantics><mi>f</mi><annotation encoding="application/x-tex">f</annotation><annotation encoding="application/x-llamapun">italic_f</annotation></semantics></math>.</span></p>
</div>
</div>
<div class="ltx_proof">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h6>
<div class="ltx_para" id="S2.SS3.SSSx3.p3">
<p class="ltx_p">Suppose that <math alttext="f" class="ltx_Math" display="inline" id="S2.SS3.SSSx3.p3.m1"><semantics><mi>f</mi><annotation encoding="application/x-tex">f</annotation><annotation encoding="application/x-llamapun">italic_f</annotation></semantics></math> were not injective, i.e., there exists <math alttext="\bm{x},\bm{x}^{\prime}" class="ltx_Math" display="inline" id="S2.SS3.SSSx3.p3.m2"><semantics><mrow><mi>ğ’™</mi><mo>,</mo><msup><mi>ğ’™</mi><mo>â€²</mo></msup></mrow><annotation encoding="application/x-tex">\bm{x},\bm{x}^{\prime}</annotation><annotation encoding="application/x-llamapun">bold_italic_x , bold_italic_x start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT</annotation></semantics></math> such that <math alttext="f(\bm{x})=f(\bm{x}^{\prime})" class="ltx_Math" display="inline" id="S2.SS3.SSSx3.p3.m3"><semantics><mrow><mrow><mi>f</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğ’™</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mi>f</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msup><mi>ğ’™</mi><mo>â€²</mo></msup><mo stretchy="false">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">f(\bm{x})=f(\bm{x}^{\prime})</annotation><annotation encoding="application/x-llamapun">italic_f ( bold_italic_x ) = italic_f ( bold_italic_x start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT )</annotation></semantics></math> while <math alttext="\bm{x}\neq\bm{x}^{\prime}" class="ltx_Math" display="inline" id="S2.SS3.SSSx3.p3.m4"><semantics><mrow><mi>ğ’™</mi><mo>â‰ </mo><msup><mi>ğ’™</mi><mo>â€²</mo></msup></mrow><annotation encoding="application/x-tex">\bm{x}\neq\bm{x}^{\prime}</annotation><annotation encoding="application/x-llamapun">bold_italic_x â‰  bold_italic_x start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT</annotation></semantics></math>. Define <math alttext="\bm{v}\doteq(\bm{x}^{\prime}-\bm{x})/\|\bm{x}^{\prime}-\bm{x}\|_{2}" class="ltx_Math" display="inline" id="S2.SS3.SSSx3.p3.m5"><semantics><mrow><mi>ğ’—</mi><mo>â‰</mo><mrow><mrow><mo stretchy="false">(</mo><mrow><msup><mi>ğ’™</mi><mo>â€²</mo></msup><mo>âˆ’</mo><mi>ğ’™</mi></mrow><mo stretchy="false">)</mo></mrow><mo>/</mo><msub><mrow><mo stretchy="false">â€–</mo><mrow><msup><mi>ğ’™</mi><mo>â€²</mo></msup><mo>âˆ’</mo><mi>ğ’™</mi></mrow><mo stretchy="false">â€–</mo></mrow><mn>2</mn></msub></mrow></mrow><annotation encoding="application/x-tex">\bm{v}\doteq(\bm{x}^{\prime}-\bm{x})/\|\bm{x}^{\prime}-\bm{x}\|_{2}</annotation><annotation encoding="application/x-llamapun">bold_italic_v â‰ ( bold_italic_x start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT - bold_italic_x ) / âˆ¥ bold_italic_x start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT - bold_italic_x âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>. Define the function <math alttext="g\colon\mathbb{R}\to\mathbb{R}" class="ltx_Math" display="inline" id="S2.SS3.SSSx3.p3.m6"><semantics><mrow><mi>g</mi><mo lspace="0.278em" rspace="0.278em">:</mo><mrow><mi>â„</mi><mo stretchy="false">â†’</mo><mi>â„</mi></mrow></mrow><annotation encoding="application/x-tex">g\colon\mathbb{R}\to\mathbb{R}</annotation><annotation encoding="application/x-llamapun">italic_g : blackboard_R â†’ blackboard_R</annotation></semantics></math> as <math alttext="g(t)\doteq\bm{v}^{\top}f(\bm{x}+t\bm{v})" class="ltx_Math" display="inline" id="S2.SS3.SSSx3.p3.m7"><semantics><mrow><mrow><mi>g</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mrow><mo>â‰</mo><mrow><msup><mi>ğ’—</mi><mo>âŠ¤</mo></msup><mo lspace="0em" rspace="0em">â€‹</mo><mi>f</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mi>ğ’™</mi><mo>+</mo><mrow><mi>t</mi><mo lspace="0em" rspace="0em">â€‹</mo><mi>ğ’—</mi></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">g(t)\doteq\bm{v}^{\top}f(\bm{x}+t\bm{v})</annotation><annotation encoding="application/x-llamapun">italic_g ( italic_t ) â‰ bold_italic_v start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT italic_f ( bold_italic_x + italic_t bold_italic_v )</annotation></semantics></math>. Then <math alttext="g(0)=\bm{v}^{\top}f(\bm{x})=\bm{v}^{\top}f(\bm{x}^{\prime})=g(\|\bm{x}^{\prime}-\bm{x}\|_{2})" class="ltx_Math" display="inline" id="S2.SS3.SSSx3.p3.m8"><semantics><mrow><mrow><mi>g</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><msup><mi>ğ’—</mi><mo>âŠ¤</mo></msup><mo lspace="0em" rspace="0em">â€‹</mo><mi>f</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğ’™</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><msup><mi>ğ’—</mi><mo>âŠ¤</mo></msup><mo lspace="0em" rspace="0em">â€‹</mo><mi>f</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msup><mi>ğ’™</mi><mo>â€²</mo></msup><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mi>g</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msub><mrow><mo stretchy="false">â€–</mo><mrow><msup><mi>ğ’™</mi><mo>â€²</mo></msup><mo>âˆ’</mo><mi>ğ’™</mi></mrow><mo stretchy="false">â€–</mo></mrow><mn>2</mn></msub><mo stretchy="false">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">g(0)=\bm{v}^{\top}f(\bm{x})=\bm{v}^{\top}f(\bm{x}^{\prime})=g(\|\bm{x}^{\prime}-\bm{x}\|_{2})</annotation><annotation encoding="application/x-llamapun">italic_g ( 0 ) = bold_italic_v start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT italic_f ( bold_italic_x ) = bold_italic_v start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT italic_f ( bold_italic_x start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT ) = italic_g ( âˆ¥ bold_italic_x start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT - bold_italic_x âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT )</annotation></semantics></math>. Since <math alttext="f" class="ltx_Math" display="inline" id="S2.SS3.SSSx3.p3.m9"><semantics><mi>f</mi><annotation encoding="application/x-tex">f</annotation><annotation encoding="application/x-llamapun">italic_f</annotation></semantics></math> is differentiable, <math alttext="g" class="ltx_Math" display="inline" id="S2.SS3.SSSx3.p3.m10"><semantics><mi>g</mi><annotation encoding="application/x-tex">g</annotation><annotation encoding="application/x-llamapun">italic_g</annotation></semantics></math> is differentiable, so the derivative <math alttext="g^{\prime}" class="ltx_Math" display="inline" id="S2.SS3.SSSx3.p3.m11"><semantics><msup><mi>g</mi><mo>â€²</mo></msup><annotation encoding="application/x-tex">g^{\prime}</annotation><annotation encoding="application/x-llamapun">italic_g start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT</annotation></semantics></math> must vanish for some <math alttext="t^{\ast}\in(0,\|\bm{x}^{\prime}-\bm{x}\|_{2})" class="ltx_Math" display="inline" id="S2.SS3.SSSx3.p3.m12"><semantics><mrow><msup><mi>t</mi><mo>âˆ—</mo></msup><mo>âˆˆ</mo><mrow><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><msub><mrow><mo stretchy="false">â€–</mo><mrow><msup><mi>ğ’™</mi><mo>â€²</mo></msup><mo>âˆ’</mo><mi>ğ’™</mi></mrow><mo stretchy="false">â€–</mo></mrow><mn>2</mn></msub><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">t^{\ast}\in(0,\|\bm{x}^{\prime}-\bm{x}\|_{2})</annotation><annotation encoding="application/x-llamapun">italic_t start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT âˆˆ ( 0 , âˆ¥ bold_italic_x start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT - bold_italic_x âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT )</annotation></semantics></math> by the mean value theorem. However,</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E108">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="g^{\prime}(t^{\ast})\doteq\bm{v}^{\top}\left[f^{\prime}(\bm{x}+t^{\ast}\bm{v})\right]\bm{v}&gt;0" class="ltx_Math" display="block" id="S2.E108.m1"><semantics><mrow><mrow><msup><mi>g</mi><mo>â€²</mo></msup><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msup><mi>t</mi><mo>âˆ—</mo></msup><mo stretchy="false">)</mo></mrow></mrow><mo>â‰</mo><mrow><msup><mi>ğ’—</mi><mo>âŠ¤</mo></msup><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo>[</mo><mrow><msup><mi>f</mi><mo>â€²</mo></msup><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mi>ğ’™</mi><mo>+</mo><mrow><msup><mi>t</mi><mo>âˆ—</mo></msup><mo lspace="0em" rspace="0em">â€‹</mo><mi>ğ’—</mi></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>]</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mi>ğ’—</mi></mrow><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">g^{\prime}(t^{\ast})\doteq\bm{v}^{\top}\left[f^{\prime}(\bm{x}+t^{\ast}\bm{v})\right]\bm{v}&gt;0</annotation><annotation encoding="application/x-llamapun">italic_g start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT ( italic_t start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT ) â‰ bold_italic_v start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT [ italic_f start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT ( bold_italic_x + italic_t start_POSTSUPERSCRIPT âˆ— end_POSTSUPERSCRIPT bold_italic_v ) ] bold_italic_v &gt; 0</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.108)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">since the Jacobian is positive definite. Thus we arrive at a contradiction, as claimed.
âˆ</p>
</div>
</div>
<div class="ltx_para" id="S2.SS3.SSSx3.p4">
<p class="ltx_p">Combining the above two results, we obtain the following crucial result.</p>
</div>
<div class="ltx_theorem ltx_theorem_corollary" id="Thmcorollary1">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold">Corollary B.1</span></span><span class="ltx_text ltx_font_bold"> </span>(Generalization of <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="bib.html#bibx96" title="">Gri11</a>]</cite> Corollary A.2, Part 2)<span class="ltx_text ltx_font_bold">.</span>
</h6>
<div class="ltx_para" id="Thmcorollary1.p1">
<p class="ltx_p"><span class="ltx_text ltx_font_italic">Let <math alttext="\bm{x}" class="ltx_Math" display="inline" id="Thmcorollary1.p1.m1"><semantics><mi>ğ±</mi><annotation encoding="application/x-tex">\bm{x}</annotation><annotation encoding="application/x-llamapun">bold_italic_x</annotation></semantics></math> be any random variable such that <a class="ltx_ref" href="#Thmassumption1" title="Assumption B.1. â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Assumptions</span>Â <span class="ltx_text ltx_ref_tag">B.1</span></a> andÂ <a class="ltx_ref" href="#Thmassumption2" title="Assumption B.2. â€£ B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">B.2</span></a> hold, and let <math alttext="(\bm{x}_{t})_{t\in[0,T]}" class="ltx_Math" display="inline" id="Thmcorollary1.p1.m2"><semantics><msub><mrow><mo stretchy="false">(</mo><msub><mi>ğ±</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><mrow><mi>t</mi><mo>âˆˆ</mo><mrow><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mi>T</mi><mo stretchy="false">]</mo></mrow></mrow></msub><annotation encoding="application/x-tex">(\bm{x}_{t})_{t\in[0,T]}</annotation><annotation encoding="application/x-llamapun">( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_t âˆˆ [ 0 , italic_T ] end_POSTSUBSCRIPT</annotation></semantics></math> be the stochastic process (<a class="ltx_ref" href="#S2.E1" title="Equation B.2.1 â€£ B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">B.2.1</span></a>). Let <math alttext="s,t\in[0,T]" class="ltx_Math" display="inline" id="Thmcorollary1.p1.m3"><semantics><mrow><mrow><mi>s</mi><mo>,</mo><mi>t</mi></mrow><mo>âˆˆ</mo><mrow><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mi>T</mi><mo stretchy="false">]</mo></mrow></mrow><annotation encoding="application/x-tex">s,t\in[0,T]</annotation><annotation encoding="application/x-llamapun">italic_s , italic_t âˆˆ [ 0 , italic_T ]</annotation></semantics></math> be such that <math alttext="0\leq s&lt;t\leq T" class="ltx_Math" display="inline" id="Thmcorollary1.p1.m4"><semantics><mrow><mn>0</mn><mo>â‰¤</mo><mi>s</mi><mo>&lt;</mo><mi>t</mi><mo>â‰¤</mo><mi>T</mi></mrow><annotation encoding="application/x-tex">0\leq s&lt;t\leq T</annotation><annotation encoding="application/x-llamapun">0 â‰¤ italic_s &lt; italic_t â‰¤ italic_T</annotation></semantics></math>, and let <math alttext="\bar{\bm{x}}(\bm{\xi})\doteq\operatorname{\mathbb{E}}[\bm{x}_{s}\mid\bm{x}_{t}=\bm{\xi}]" class="ltx_Math" display="inline" id="Thmcorollary1.p1.m5"><semantics><mrow><mrow><mover accent="true"><mi>ğ±</mi><mo>Â¯</mo></mover><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğ›</mi><mo stretchy="false">)</mo></mrow></mrow><mo>â‰</mo><mrow><mi>ğ”¼</mi><mo>â¡</mo><mrow><mo stretchy="false">[</mo><mrow><mrow><msub><mi>ğ±</mi><mi>s</mi></msub><mo>âˆ£</mo><msub><mi>ğ±</mi><mi>t</mi></msub></mrow><mo>=</mo><mi>ğ›</mi></mrow><mo stretchy="false">]</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\bar{\bm{x}}(\bm{\xi})\doteq\operatorname{\mathbb{E}}[\bm{x}_{s}\mid\bm{x}_{t}=\bm{\xi}]</annotation><annotation encoding="application/x-llamapun">overÂ¯ start_ARG bold_italic_x end_ARG ( bold_italic_Î¾ ) â‰ blackboard_E [ bold_italic_x start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT âˆ£ bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = bold_italic_Î¾ ]</annotation></semantics></math>. Then <math alttext="\bar{\bm{x}}" class="ltx_Math" display="inline" id="Thmcorollary1.p1.m6"><semantics><mover accent="true"><mi>ğ±</mi><mo>Â¯</mo></mover><annotation encoding="application/x-tex">\bar{\bm{x}}</annotation><annotation encoding="application/x-llamapun">overÂ¯ start_ARG bold_italic_x end_ARG</annotation></semantics></math> is injective, and therefore invertible onto its range.</span></p>
</div>
</div>
<div class="ltx_proof">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h6>
<div class="ltx_para" id="S2.SS3.SSSx3.p5">
<p class="ltx_p">The only thing left to show is that <math alttext="\bar{\bm{x}}" class="ltx_Math" display="inline" id="S2.SS3.SSSx3.p5.m1"><semantics><mover accent="true"><mi>ğ’™</mi><mo>Â¯</mo></mover><annotation encoding="application/x-tex">\bar{\bm{x}}</annotation><annotation encoding="application/x-llamapun">overÂ¯ start_ARG bold_italic_x end_ARG</annotation></semantics></math> is differentiable, but this is immediate from Tweedieâ€™s formula (<a class="ltx_ref" href="Ch3.html#Thmtheorem3" title="Theorem 3.3 (Tweedieâ€™s Formula). â€£ 3.2.1 Diffusion and Denoising Processes â€£ 3.2 Compression via Denoising â€£ Chapter 3 Pursuing Low-Dimensional Distributions via Lossy Compression â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Theorem</span>Â <span class="ltx_text ltx_ref_tag">3.3</span></a>) which shows that <math alttext="\bar{\bm{x}}" class="ltx_Math" display="inline" id="S2.SS3.SSSx3.p5.m2"><semantics><mover accent="true"><mi>ğ’™</mi><mo>Â¯</mo></mover><annotation encoding="application/x-tex">\bar{\bm{x}}</annotation><annotation encoding="application/x-llamapun">overÂ¯ start_ARG bold_italic_x end_ARG</annotation></semantics></math> is differentiable if and only if <math alttext="\nabla\log p_{t}" class="ltx_Math" display="inline" id="S2.SS3.SSSx3.p5.m3"><semantics><mrow><mrow><mo rspace="0.167em">âˆ‡</mo><mi>log</mi></mrow><mo lspace="0.167em">â¡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\nabla\log p_{t}</annotation><annotation encoding="application/x-llamapun">âˆ‡ roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is differentiable, and this is provided by <a class="ltx_ref" href="#S2.E3" title="In B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Equation</span>Â <span class="ltx_text ltx_ref_tag">B.2.3</span></a>.
âˆ</p>
</div>
</div>
</section>
<section class="ltx_subsubsection" id="S2.SS3.SSSx4">
<h4 class="ltx_title ltx_title_subsubsection">Controlling the Laplacian <math alttext="\Delta\log p_{t}" class="ltx_Math" display="inline" id="S2.SS3.SSSx4.m1"><semantics><mrow><mi mathvariant="normal">Î”</mi><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mi>log</mi><mo lspace="0.167em">â¡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow></mrow><annotation encoding="application/x-tex">\Delta\log p_{t}</annotation><annotation encoding="application/x-llamapun">roman_Î” roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>
</h4>
<div class="ltx_para" id="S2.SS3.SSSx4.p1">
<p class="ltx_p">Finally, we develop a technical estimate which is required for the proof of <a class="ltx_ref" href="#Thmtheorem4" title="Theorem B.4. â€£ B.2.2 Denoising Process Reduces Entropy Over Time â€£ B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Theorem</span>Â <span class="ltx_text ltx_ref_tag">B.4</span></a> and actually motivates the assumption for the viable <math alttext="t" class="ltx_Math" display="inline" id="S2.SS3.SSSx4.p1.m1"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation><annotation encoding="application/x-llamapun">italic_t</annotation></semantics></math>.</p>
</div>
<div class="ltx_theorem ltx_theorem_lemma" id="Thmlemma5">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold">Lemma B.5</span></span><span class="ltx_text ltx_font_bold">.</span>
</h6>
<div class="ltx_para" id="Thmlemma5.p1">
<p class="ltx_p"><span class="ltx_text ltx_font_italic">Let <math alttext="\bm{x}" class="ltx_Math" display="inline" id="Thmlemma5.p1.m1"><semantics><mi>ğ±</mi><annotation encoding="application/x-tex">\bm{x}</annotation><annotation encoding="application/x-llamapun">bold_italic_x</annotation></semantics></math> be any random variable such that <a class="ltx_ref" href="#Thmassumption1" title="Assumption B.1. â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Assumptions</span>Â <span class="ltx_text ltx_ref_tag">B.1</span></a> andÂ <a class="ltx_ref" href="#Thmassumption2" title="Assumption B.2. â€£ B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">B.2</span></a> hold, and let <math alttext="(\bm{x}_{t})_{t\in[0,T]}" class="ltx_Math" display="inline" id="Thmlemma5.p1.m2"><semantics><msub><mrow><mo stretchy="false">(</mo><msub><mi>ğ±</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><mrow><mi>t</mi><mo>âˆˆ</mo><mrow><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mi>T</mi><mo stretchy="false">]</mo></mrow></mrow></msub><annotation encoding="application/x-tex">(\bm{x}_{t})_{t\in[0,T]}</annotation><annotation encoding="application/x-llamapun">( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_t âˆˆ [ 0 , italic_T ] end_POSTSUBSCRIPT</annotation></semantics></math> be the stochastic process (<a class="ltx_ref" href="#S2.E1" title="Equation B.2.1 â€£ B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">B.2.1</span></a>). Let <math alttext="p_{t}" class="ltx_Math" display="inline" id="Thmlemma5.p1.m3"><semantics><msub><mi>p</mi><mi>t</mi></msub><annotation encoding="application/x-tex">p_{t}</annotation><annotation encoding="application/x-llamapun">italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> be the density of <math alttext="\bm{x}_{t}" class="ltx_Math" display="inline" id="Thmlemma5.p1.m4"><semantics><msub><mi>ğ±</mi><mi>t</mi></msub><annotation encoding="application/x-tex">\bm{x}_{t}</annotation><annotation encoding="application/x-llamapun">bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>. Then, for <math alttext="t&gt;0" class="ltx_Math" display="inline" id="Thmlemma5.p1.m5"><semantics><mrow><mi>t</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">t&gt;0</annotation><annotation encoding="application/x-llamapun">italic_t &gt; 0</annotation></semantics></math> it holds</span></p>
<table class="ltx_equation ltx_eqn_table" id="S2.E109">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\sup_{\bm{\xi}\in\mathbb{R}^{D}}\lvert\Delta\log p_{t}(\bm{\xi})\rvert\leq\max\left(\frac{D}{t^{2}},\left\lvert\frac{R}{t^{4}}-\frac{D}{t^{2}}\right\rvert\right)." class="ltx_Math" display="block" id="S2.E109.m1"><semantics><mrow><mrow><mrow><munder><mo movablelimits="false">sup</mo><mrow><mi>ğƒ</mi><mo>âˆˆ</mo><msup><mi>â„</mi><mi>D</mi></msup></mrow></munder><mrow><mo lspace="0em" stretchy="false">|</mo><mrow><mi mathvariant="normal">Î”</mi><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mi>log</mi><mo lspace="0.167em">â¡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">|</mo></mrow></mrow><mo>â‰¤</mo><mrow><mi>max</mi><mo>â¡</mo><mrow><mo>(</mo><mfrac><mi>D</mi><msup><mi>t</mi><mn>2</mn></msup></mfrac><mo>,</mo><mrow><mo>|</mo><mrow><mfrac><mi>R</mi><msup><mi>t</mi><mn>4</mn></msup></mfrac><mo>âˆ’</mo><mfrac><mi>D</mi><msup><mi>t</mi><mn>2</mn></msup></mfrac></mrow><mo>|</mo></mrow><mo>)</mo></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">\sup_{\bm{\xi}\in\mathbb{R}^{D}}\lvert\Delta\log p_{t}(\bm{\xi})\rvert\leq\max\left(\frac{D}{t^{2}},\left\lvert\frac{R}{t^{4}}-\frac{D}{t^{2}}\right\rvert\right).</annotation><annotation encoding="application/x-llamapun">roman_sup start_POSTSUBSCRIPT bold_italic_Î¾ âˆˆ blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT end_POSTSUBSCRIPT | roman_Î” roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) | â‰¤ roman_max ( divide start_ARG italic_D end_ARG start_ARG italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG , | divide start_ARG italic_R end_ARG start_ARG italic_t start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT end_ARG - divide start_ARG italic_D end_ARG start_ARG italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG | ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.109)</span></td>
</tr></tbody>
</table>
</div>
</div>
<div class="ltx_proof">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h6>
<div class="ltx_para" id="S2.SS3.SSSx4.p2">
<p class="ltx_p">By chain rule, a simple exercise computes</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E110">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\Delta\log p_{t}(\bm{\xi})=\frac{\Delta p_{t}(\bm{\xi})}{p_{t}(\bm{\xi})}-\frac{\|\nabla p_{t}(\bm{\xi})\|_{2}^{2}}{p_{t}(\bm{\xi})^{2}}." class="ltx_Math" display="block" id="S2.E110.m1"><semantics><mrow><mrow><mrow><mi mathvariant="normal">Î”</mi><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mi>log</mi><mo lspace="0.167em">â¡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mfrac><mrow><mi mathvariant="normal">Î”</mi><mo lspace="0em" rspace="0em">â€‹</mo><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mrow><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow></mfrac><mo>âˆ’</mo><mfrac><msubsup><mrow><mo stretchy="false">â€–</mo><mrow><mrow><mo rspace="0.167em">âˆ‡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">â€–</mo></mrow><mn>2</mn><mn>2</mn></msubsup><mrow><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><msup><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mn>2</mn></msup></mrow></mfrac></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">\Delta\log p_{t}(\bm{\xi})=\frac{\Delta p_{t}(\bm{\xi})}{p_{t}(\bm{\xi})}-\frac{\|\nabla p_{t}(\bm{\xi})\|_{2}^{2}}{p_{t}(\bm{\xi})^{2}}.</annotation><annotation encoding="application/x-llamapun">roman_Î” roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) = divide start_ARG roman_Î” italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) end_ARG start_ARG italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) end_ARG - divide start_ARG âˆ¥ âˆ‡ italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.110)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">Using <a class="ltx_ref" href="#Thmproposition1" title="Proposition B.1. â€£ Derivative Computations â€£ B.2.3 Technical Lemmas and Intermediate Results â€£ B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Proposition</span>Â <span class="ltx_text ltx_ref_tag">B.1</span></a> to write the terms in <math alttext="\Delta p_{t}(\bm{\xi})" class="ltx_Math" display="inline" id="S2.SS3.SSSx4.p2.m1"><semantics><mrow><mi mathvariant="normal">Î”</mi><mo lspace="0em" rspace="0em">â€‹</mo><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">\Delta p_{t}(\bm{\xi})</annotation><annotation encoding="application/x-llamapun">roman_Î” italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ )</annotation></semantics></math>, we obtain</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S3.EGx144">
<tbody id="S2.E111"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\frac{\Delta p_{t}(\bm{\xi})}{p_{t}(\bm{\xi})}" class="ltx_Math" display="inline" id="S2.E111.m1"><semantics><mstyle displaystyle="true"><mfrac><mrow><mi mathvariant="normal">Î”</mi><mo lspace="0em" rspace="0em">â€‹</mo><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mrow><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow></mfrac></mstyle><annotation encoding="application/x-tex">\displaystyle\frac{\Delta p_{t}(\bm{\xi})}{p_{t}(\bm{\xi})}</annotation><annotation encoding="application/x-llamapun">divide start_ARG roman_Î” italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) end_ARG start_ARG italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) end_ARG</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{\operatorname{\mathbb{E}}\left[\frac{\|\bm{\xi}-\bm{x}\|_{2}^{2}-Dt^{2}}{t^{4}}\cdot\varphi_{t}(\bm{\xi}-\bm{x})\right]}{\operatorname{\mathbb{E}}[\varphi_{t}(\bm{\xi}-\bm{x})]}" class="ltx_Math" display="inline" id="S2.E111.m2"><semantics><mrow><mi></mi><mo>=</mo><mstyle displaystyle="true"><mfrac><mrow><mi>ğ”¼</mi><mo>â¡</mo><mrow><mo>[</mo><mrow><mrow><mfrac><mrow><msubsup><mrow><mo stretchy="false">â€–</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’™</mi></mrow><mo stretchy="false">â€–</mo></mrow><mn>2</mn><mn>2</mn></msubsup><mo>âˆ’</mo><mrow><mi>D</mi><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>t</mi><mn>2</mn></msup></mrow></mrow><msup><mi>t</mi><mn>4</mn></msup></mfrac><mo lspace="0.222em" rspace="0.222em">â‹…</mo><msub><mi>Ï†</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’™</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>]</mo></mrow></mrow><mrow><mi>ğ”¼</mi><mo>â¡</mo><mrow><mo stretchy="false">[</mo><mrow><msub><mi>Ï†</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’™</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">]</mo></mrow></mrow></mfrac></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle=\frac{\operatorname{\mathbb{E}}\left[\frac{\|\bm{\xi}-\bm{x}\|_{2}^{2}-Dt^{2}}{t^{4}}\cdot\varphi_{t}(\bm{\xi}-\bm{x})\right]}{\operatorname{\mathbb{E}}[\varphi_{t}(\bm{\xi}-\bm{x})]}</annotation><annotation encoding="application/x-llamapun">= divide start_ARG blackboard_E [ divide start_ARG âˆ¥ bold_italic_Î¾ - bold_italic_x âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT - italic_D italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG italic_t start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT end_ARG â‹… italic_Ï† start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ - bold_italic_x ) ] end_ARG start_ARG blackboard_E [ italic_Ï† start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ - bold_italic_x ) ] end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.111)</span></td>
</tr></tbody>
<tbody id="S2.E112"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{\int_{\mathbb{R}^{D}}\left\{\frac{\|\bm{\xi}-\bm{u}\|_{2}^{2}-Dt^{2}}{t^{4}}\right\}\varphi_{t}(\bm{\xi}-\bm{u})p(\bm{u})~{}\mathrm{d}\bm{u}}{\int_{\mathbb{R}^{D}}\varphi_{t}(\bm{\xi}-\bm{u})p(\bm{u})~{}\mathrm{d}\bm{u}}." class="ltx_Math" display="inline" id="S2.E112.m1"><semantics><mrow><mrow><mi></mi><mo>=</mo><mstyle displaystyle="true"><mfrac><mrow><msub><mo>âˆ«</mo><msup><mi>â„</mi><mi>D</mi></msup></msub><mrow><mrow><mo lspace="0em">{</mo><mfrac><mrow><msubsup><mrow><mo stretchy="false">â€–</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’–</mi></mrow><mo stretchy="false">â€–</mo></mrow><mn>2</mn><mn>2</mn></msubsup><mo>âˆ’</mo><mrow><mi>D</mi><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>t</mi><mn>2</mn></msup></mrow></mrow><msup><mi>t</mi><mn>4</mn></msup></mfrac><mo>}</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><msub><mi>Ï†</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’–</mi></mrow><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mi>p</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğ’–</mi><mo stretchy="false">)</mo></mrow><mo lspace="0.330em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><mi>ğ’–</mi></mrow></mrow></mrow><mrow><msub><mo>âˆ«</mo><msup><mi>â„</mi><mi>D</mi></msup></msub><mrow><msub><mi>Ï†</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’–</mi></mrow><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mi>p</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğ’–</mi><mo stretchy="false">)</mo></mrow><mo lspace="0.330em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><mi>ğ’–</mi></mrow></mrow></mrow></mfrac></mstyle></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">\displaystyle=\frac{\int_{\mathbb{R}^{D}}\left\{\frac{\|\bm{\xi}-\bm{u}\|_{2}^{2}-Dt^{2}}{t^{4}}\right\}\varphi_{t}(\bm{\xi}-\bm{u})p(\bm{u})~{}\mathrm{d}\bm{u}}{\int_{\mathbb{R}^{D}}\varphi_{t}(\bm{\xi}-\bm{u})p(\bm{u})~{}\mathrm{d}\bm{u}}.</annotation><annotation encoding="application/x-llamapun">= divide start_ARG âˆ« start_POSTSUBSCRIPT blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT end_POSTSUBSCRIPT { divide start_ARG âˆ¥ bold_italic_Î¾ - bold_italic_u âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT - italic_D italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG italic_t start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT end_ARG } italic_Ï† start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ - bold_italic_u ) italic_p ( bold_italic_u ) roman_d bold_italic_u end_ARG start_ARG âˆ« start_POSTSUBSCRIPT blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT end_POSTSUBSCRIPT italic_Ï† start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ - bold_italic_u ) italic_p ( bold_italic_u ) roman_d bold_italic_u end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.112)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">This looks like a Bayesian marginalization, so let us define the appropriate normalized density</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E113">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="q_{\bm{\xi}}(\bm{u})=\frac{\varphi_{t}(\bm{\xi}-\bm{u})p(\bm{u})}{\int_{\mathbb{R}^{D}}\varphi_{t}(\bm{\xi}-\bm{v})p(\bm{v})~{}\mathrm{d}\bm{v}}=\frac{\varphi_{t}(\bm{\xi}-\bm{u})p(\bm{u})}{\operatorname{\mathbb{E}}[\varphi_{t}(\bm{\xi}-\bm{x})]}=\frac{\varphi_{t}(\bm{\xi}-\bm{u})p(\bm{u})}{p_{t}(\bm{\xi})}" class="ltx_Math" display="block" id="S2.E113.m1"><semantics><mrow><mrow><msub><mi>q</mi><mi>ğƒ</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğ’–</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mfrac><mrow><msub><mi>Ï†</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’–</mi></mrow><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mi>p</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğ’–</mi><mo stretchy="false">)</mo></mrow></mrow><mrow><msub><mo>âˆ«</mo><msup><mi>â„</mi><mi>D</mi></msup></msub><mrow><msub><mi>Ï†</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’—</mi></mrow><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mi>p</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğ’—</mi><mo stretchy="false">)</mo></mrow><mo lspace="0.330em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><mi>ğ’—</mi></mrow></mrow></mrow></mfrac><mo>=</mo><mfrac><mrow><msub><mi>Ï†</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’–</mi></mrow><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mi>p</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğ’–</mi><mo stretchy="false">)</mo></mrow></mrow><mrow><mi>ğ”¼</mi><mo>â¡</mo><mrow><mo stretchy="false">[</mo><mrow><msub><mi>Ï†</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’™</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">]</mo></mrow></mrow></mfrac><mo>=</mo><mfrac><mrow><msub><mi>Ï†</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’–</mi></mrow><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mi>p</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğ’–</mi><mo stretchy="false">)</mo></mrow></mrow><mrow><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex">q_{\bm{\xi}}(\bm{u})=\frac{\varphi_{t}(\bm{\xi}-\bm{u})p(\bm{u})}{\int_{\mathbb{R}^{D}}\varphi_{t}(\bm{\xi}-\bm{v})p(\bm{v})~{}\mathrm{d}\bm{v}}=\frac{\varphi_{t}(\bm{\xi}-\bm{u})p(\bm{u})}{\operatorname{\mathbb{E}}[\varphi_{t}(\bm{\xi}-\bm{x})]}=\frac{\varphi_{t}(\bm{\xi}-\bm{u})p(\bm{u})}{p_{t}(\bm{\xi})}</annotation><annotation encoding="application/x-llamapun">italic_q start_POSTSUBSCRIPT bold_italic_Î¾ end_POSTSUBSCRIPT ( bold_italic_u ) = divide start_ARG italic_Ï† start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ - bold_italic_u ) italic_p ( bold_italic_u ) end_ARG start_ARG âˆ« start_POSTSUBSCRIPT blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT end_POSTSUBSCRIPT italic_Ï† start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ - bold_italic_v ) italic_p ( bold_italic_v ) roman_d bold_italic_v end_ARG = divide start_ARG italic_Ï† start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ - bold_italic_u ) italic_p ( bold_italic_u ) end_ARG start_ARG blackboard_E [ italic_Ï† start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ - bold_italic_x ) ] end_ARG = divide start_ARG italic_Ï† start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ - bold_italic_u ) italic_p ( bold_italic_u ) end_ARG start_ARG italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.113)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">Then, defining <math alttext="\bm{y}_{\bm{\xi}}\sim q_{\bm{\xi}}" class="ltx_Math" display="inline" id="S2.SS3.SSSx4.p2.m2"><semantics><mrow><msub><mi>ğ’š</mi><mi>ğƒ</mi></msub><mo>âˆ¼</mo><msub><mi>q</mi><mi>ğƒ</mi></msub></mrow><annotation encoding="application/x-tex">\bm{y}_{\bm{\xi}}\sim q_{\bm{\xi}}</annotation><annotation encoding="application/x-llamapun">bold_italic_y start_POSTSUBSCRIPT bold_italic_Î¾ end_POSTSUBSCRIPT âˆ¼ italic_q start_POSTSUBSCRIPT bold_italic_Î¾ end_POSTSUBSCRIPT</annotation></semantics></math>, we can write</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E114">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\frac{\Delta p_{t}(\bm{\xi})}{p_{t}(\bm{\xi})}=\int_{\mathbb{R}^{D}}\left\{\frac{\|\bm{\xi}-\bm{u}\|_{2}^{2}-Dt^{2}}{t^{4}}\right\}q_{\bm{\xi}}(\bm{u})~{}\mathrm{d}\bm{u}=\frac{1}{t^{4}}\operatorname{\mathbb{E}}[\|\bm{\xi}-\bm{y}_{\bm{\xi}}\|_{2}^{2}]-\frac{D}{t^{2}}." class="ltx_Math" display="block" id="S2.E114.m1"><semantics><mrow><mrow><mfrac><mrow><mi mathvariant="normal">Î”</mi><mo lspace="0em" rspace="0em">â€‹</mo><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mrow><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow></mfrac><mo rspace="0.111em">=</mo><mrow><msub><mo rspace="0em">âˆ«</mo><msup><mi>â„</mi><mi>D</mi></msup></msub><mrow><mrow><mo>{</mo><mfrac><mrow><msubsup><mrow><mo stretchy="false">â€–</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’–</mi></mrow><mo stretchy="false">â€–</mo></mrow><mn>2</mn><mn>2</mn></msubsup><mo>âˆ’</mo><mrow><mi>D</mi><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>t</mi><mn>2</mn></msup></mrow></mrow><msup><mi>t</mi><mn>4</mn></msup></mfrac><mo>}</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><msub><mi>q</mi><mi>ğƒ</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğ’–</mi><mo stretchy="false">)</mo></mrow><mo lspace="0.330em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><mi>ğ’–</mi></mrow></mrow></mrow><mo>=</mo><mrow><mrow><mfrac><mn>1</mn><msup><mi>t</mi><mn>4</mn></msup></mfrac><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mi>ğ”¼</mi><mo>â¡</mo><mrow><mo stretchy="false">[</mo><msubsup><mrow><mo stretchy="false">â€–</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><msub><mi>ğ’š</mi><mi>ğƒ</mi></msub></mrow><mo stretchy="false">â€–</mo></mrow><mn>2</mn><mn>2</mn></msubsup><mo stretchy="false">]</mo></mrow></mrow></mrow><mo>âˆ’</mo><mfrac><mi>D</mi><msup><mi>t</mi><mn>2</mn></msup></mfrac></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">\frac{\Delta p_{t}(\bm{\xi})}{p_{t}(\bm{\xi})}=\int_{\mathbb{R}^{D}}\left\{\frac{\|\bm{\xi}-\bm{u}\|_{2}^{2}-Dt^{2}}{t^{4}}\right\}q_{\bm{\xi}}(\bm{u})~{}\mathrm{d}\bm{u}=\frac{1}{t^{4}}\operatorname{\mathbb{E}}[\|\bm{\xi}-\bm{y}_{\bm{\xi}}\|_{2}^{2}]-\frac{D}{t^{2}}.</annotation><annotation encoding="application/x-llamapun">divide start_ARG roman_Î” italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) end_ARG start_ARG italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) end_ARG = âˆ« start_POSTSUBSCRIPT blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT end_POSTSUBSCRIPT { divide start_ARG âˆ¥ bold_italic_Î¾ - bold_italic_u âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT - italic_D italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG italic_t start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT end_ARG } italic_q start_POSTSUBSCRIPT bold_italic_Î¾ end_POSTSUBSCRIPT ( bold_italic_u ) roman_d bold_italic_u = divide start_ARG 1 end_ARG start_ARG italic_t start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT end_ARG blackboard_E [ âˆ¥ bold_italic_Î¾ - bold_italic_y start_POSTSUBSCRIPT bold_italic_Î¾ end_POSTSUBSCRIPT âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ] - divide start_ARG italic_D end_ARG start_ARG italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.114)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">Similarly, writing out the second term (non-squared) we obtain</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E115">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\frac{\nabla p_{t}(\bm{\xi})}{p_{t}(\bm{\xi})}=-\frac{\bm{\xi}-\operatorname{\mathbb{E}}[\bm{y}_{\bm{\xi}}]}{t^{2}}." class="ltx_Math" display="block" id="S2.E115.m1"><semantics><mrow><mrow><mfrac><mrow><mrow><mo rspace="0.167em">âˆ‡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mrow><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow></mfrac><mo>=</mo><mrow><mo>âˆ’</mo><mfrac><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mrow><mi>ğ”¼</mi><mo>â¡</mo><mrow><mo stretchy="false">[</mo><msub><mi>ğ’š</mi><mi>ğƒ</mi></msub><mo stretchy="false">]</mo></mrow></mrow></mrow><msup><mi>t</mi><mn>2</mn></msup></mfrac></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">\frac{\nabla p_{t}(\bm{\xi})}{p_{t}(\bm{\xi})}=-\frac{\bm{\xi}-\operatorname{\mathbb{E}}[\bm{y}_{\bm{\xi}}]}{t^{2}}.</annotation><annotation encoding="application/x-llamapun">divide start_ARG âˆ‡ italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) end_ARG start_ARG italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) end_ARG = - divide start_ARG bold_italic_Î¾ - blackboard_E [ bold_italic_y start_POSTSUBSCRIPT bold_italic_Î¾ end_POSTSUBSCRIPT ] end_ARG start_ARG italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.115)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">Letting <math alttext="\bm{z}_{\bm{\xi}}\doteq\bm{y}_{\bm{\xi}}-\bm{\xi}" class="ltx_Math" display="inline" id="S2.SS3.SSSx4.p2.m3"><semantics><mrow><msub><mi>ğ’›</mi><mi>ğƒ</mi></msub><mo>â‰</mo><mrow><msub><mi>ğ’š</mi><mi>ğƒ</mi></msub><mo>âˆ’</mo><mi>ğƒ</mi></mrow></mrow><annotation encoding="application/x-tex">\bm{z}_{\bm{\xi}}\doteq\bm{y}_{\bm{\xi}}-\bm{\xi}</annotation><annotation encoding="application/x-llamapun">bold_italic_z start_POSTSUBSCRIPT bold_italic_Î¾ end_POSTSUBSCRIPT â‰ bold_italic_y start_POSTSUBSCRIPT bold_italic_Î¾ end_POSTSUBSCRIPT - bold_italic_Î¾</annotation></semantics></math>, it holds</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E116">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\frac{\Delta p_{t}(\bm{\xi})}{p_{t}(\bm{\xi})}=\frac{\operatorname{\mathbb{E}}[\|\bm{z}_{\bm{\xi}}\|_{2}^{2}]}{t^{4}}-\frac{D}{t^{2}},\qquad\frac{\nabla p_{t}(\bm{\xi})}{p_{t}(\bm{\xi})}=\frac{\operatorname{\mathbb{E}}[\bm{z}_{\bm{\xi}}]}{t^{2}}." class="ltx_Math" display="block" id="S2.E116.m1"><semantics><mrow><mrow><mrow><mfrac><mrow><mi mathvariant="normal">Î”</mi><mo lspace="0em" rspace="0em">â€‹</mo><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mrow><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow></mfrac><mo>=</mo><mrow><mfrac><mrow><mi>ğ”¼</mi><mo>â¡</mo><mrow><mo stretchy="false">[</mo><msubsup><mrow><mo stretchy="false">â€–</mo><msub><mi>ğ’›</mi><mi>ğƒ</mi></msub><mo stretchy="false">â€–</mo></mrow><mn>2</mn><mn>2</mn></msubsup><mo stretchy="false">]</mo></mrow></mrow><msup><mi>t</mi><mn>4</mn></msup></mfrac><mo>âˆ’</mo><mfrac><mi>D</mi><msup><mi>t</mi><mn>2</mn></msup></mfrac></mrow></mrow><mo rspace="2.167em">,</mo><mrow><mfrac><mrow><mrow><mo rspace="0.167em">âˆ‡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mrow><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow></mfrac><mo>=</mo><mfrac><mrow><mi>ğ”¼</mi><mo>â¡</mo><mrow><mo stretchy="false">[</mo><msub><mi>ğ’›</mi><mi>ğƒ</mi></msub><mo stretchy="false">]</mo></mrow></mrow><msup><mi>t</mi><mn>2</mn></msup></mfrac></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">\frac{\Delta p_{t}(\bm{\xi})}{p_{t}(\bm{\xi})}=\frac{\operatorname{\mathbb{E}}[\|\bm{z}_{\bm{\xi}}\|_{2}^{2}]}{t^{4}}-\frac{D}{t^{2}},\qquad\frac{\nabla p_{t}(\bm{\xi})}{p_{t}(\bm{\xi})}=\frac{\operatorname{\mathbb{E}}[\bm{z}_{\bm{\xi}}]}{t^{2}}.</annotation><annotation encoding="application/x-llamapun">divide start_ARG roman_Î” italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) end_ARG start_ARG italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) end_ARG = divide start_ARG blackboard_E [ âˆ¥ bold_italic_z start_POSTSUBSCRIPT bold_italic_Î¾ end_POSTSUBSCRIPT âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ] end_ARG start_ARG italic_t start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT end_ARG - divide start_ARG italic_D end_ARG start_ARG italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG , divide start_ARG âˆ‡ italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) end_ARG start_ARG italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) end_ARG = divide start_ARG blackboard_E [ bold_italic_z start_POSTSUBSCRIPT bold_italic_Î¾ end_POSTSUBSCRIPT ] end_ARG start_ARG italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.116)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">Thus writing <math alttext="\Delta\log p_{t}" class="ltx_Math" display="inline" id="S2.SS3.SSSx4.p2.m4"><semantics><mrow><mi mathvariant="normal">Î”</mi><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mi>log</mi><mo lspace="0.167em">â¡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow></mrow><annotation encoding="application/x-tex">\Delta\log p_{t}</annotation><annotation encoding="application/x-llamapun">roman_Î” roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> out fully, we have</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S3.EGx145">
<tbody id="S2.E117"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\Delta\log p_{t}(\bm{\xi})" class="ltx_Math" display="inline" id="S2.E117.m1"><semantics><mrow><mi mathvariant="normal">Î”</mi><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mi>log</mi><mo lspace="0.167em">â¡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">\displaystyle\Delta\log p_{t}(\bm{\xi})</annotation><annotation encoding="application/x-llamapun">roman_Î” roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{\operatorname{\mathbb{E}}[\|\bm{z}_{\bm{\xi}}\|_{2}^{2}]}{t^{4}}-\frac{D}{t^{2}}-\frac{\|\operatorname{\mathbb{E}}[\bm{z}_{\bm{\xi}}]\|_{2}^{2}}{t^{4}}" class="ltx_Math" display="inline" id="S2.E117.m2"><semantics><mrow><mi></mi><mo>=</mo><mrow><mstyle displaystyle="true"><mfrac><mrow><mi>ğ”¼</mi><mo>â¡</mo><mrow><mo stretchy="false">[</mo><msubsup><mrow><mo stretchy="false">â€–</mo><msub><mi>ğ’›</mi><mi>ğƒ</mi></msub><mo stretchy="false">â€–</mo></mrow><mn>2</mn><mn>2</mn></msubsup><mo stretchy="false">]</mo></mrow></mrow><msup><mi>t</mi><mn>4</mn></msup></mfrac></mstyle><mo>âˆ’</mo><mstyle displaystyle="true"><mfrac><mi>D</mi><msup><mi>t</mi><mn>2</mn></msup></mfrac></mstyle><mo>âˆ’</mo><mstyle displaystyle="true"><mfrac><msubsup><mrow><mo stretchy="false">â€–</mo><mrow><mi>ğ”¼</mi><mo>â¡</mo><mrow><mo stretchy="false">[</mo><msub><mi>ğ’›</mi><mi>ğƒ</mi></msub><mo stretchy="false">]</mo></mrow></mrow><mo stretchy="false">â€–</mo></mrow><mn>2</mn><mn>2</mn></msubsup><msup><mi>t</mi><mn>4</mn></msup></mfrac></mstyle></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=\frac{\operatorname{\mathbb{E}}[\|\bm{z}_{\bm{\xi}}\|_{2}^{2}]}{t^{4}}-\frac{D}{t^{2}}-\frac{\|\operatorname{\mathbb{E}}[\bm{z}_{\bm{\xi}}]\|_{2}^{2}}{t^{4}}</annotation><annotation encoding="application/x-llamapun">= divide start_ARG blackboard_E [ âˆ¥ bold_italic_z start_POSTSUBSCRIPT bold_italic_Î¾ end_POSTSUBSCRIPT âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ] end_ARG start_ARG italic_t start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT end_ARG - divide start_ARG italic_D end_ARG start_ARG italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG - divide start_ARG âˆ¥ blackboard_E [ bold_italic_z start_POSTSUBSCRIPT bold_italic_Î¾ end_POSTSUBSCRIPT ] âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG italic_t start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.117)</span></td>
</tr></tbody>
<tbody id="S2.E118"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{\operatorname{\mathbb{E}}[\|\bm{z}_{\bm{\xi}}\|_{2}^{2}]-\|\operatorname{\mathbb{E}}[\bm{z}_{\bm{\xi}}]\|_{2}^{2}}{t^{4}}-\frac{D}{t^{2}}" class="ltx_Math" display="inline" id="S2.E118.m1"><semantics><mrow><mi></mi><mo>=</mo><mrow><mstyle displaystyle="true"><mfrac><mrow><mrow><mi>ğ”¼</mi><mo>â¡</mo><mrow><mo stretchy="false">[</mo><msubsup><mrow><mo stretchy="false">â€–</mo><msub><mi>ğ’›</mi><mi>ğƒ</mi></msub><mo stretchy="false">â€–</mo></mrow><mn>2</mn><mn>2</mn></msubsup><mo stretchy="false">]</mo></mrow></mrow><mo>âˆ’</mo><msubsup><mrow><mo stretchy="false">â€–</mo><mrow><mi>ğ”¼</mi><mo>â¡</mo><mrow><mo stretchy="false">[</mo><msub><mi>ğ’›</mi><mi>ğƒ</mi></msub><mo stretchy="false">]</mo></mrow></mrow><mo stretchy="false">â€–</mo></mrow><mn>2</mn><mn>2</mn></msubsup></mrow><msup><mi>t</mi><mn>4</mn></msup></mfrac></mstyle><mo>âˆ’</mo><mstyle displaystyle="true"><mfrac><mi>D</mi><msup><mi>t</mi><mn>2</mn></msup></mfrac></mstyle></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=\frac{\operatorname{\mathbb{E}}[\|\bm{z}_{\bm{\xi}}\|_{2}^{2}]-\|\operatorname{\mathbb{E}}[\bm{z}_{\bm{\xi}}]\|_{2}^{2}}{t^{4}}-\frac{D}{t^{2}}</annotation><annotation encoding="application/x-llamapun">= divide start_ARG blackboard_E [ âˆ¥ bold_italic_z start_POSTSUBSCRIPT bold_italic_Î¾ end_POSTSUBSCRIPT âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ] - âˆ¥ blackboard_E [ bold_italic_z start_POSTSUBSCRIPT bold_italic_Î¾ end_POSTSUBSCRIPT ] âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG italic_t start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT end_ARG - divide start_ARG italic_D end_ARG start_ARG italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.118)</span></td>
</tr></tbody>
<tbody id="S2.E119"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{\operatorname{tr}(\operatorname{Cov}(\bm{z}_{\bm{\xi}}))}{t^{4}}-\frac{D}{t^{2}}" class="ltx_Math" display="inline" id="S2.E119.m1"><semantics><mrow><mi></mi><mo>=</mo><mrow><mstyle displaystyle="true"><mfrac><mrow><mi>tr</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><mrow><mi>Cov</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ’›</mi><mi>ğƒ</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><msup><mi>t</mi><mn>4</mn></msup></mfrac></mstyle><mo>âˆ’</mo><mstyle displaystyle="true"><mfrac><mi>D</mi><msup><mi>t</mi><mn>2</mn></msup></mfrac></mstyle></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=\frac{\operatorname{tr}(\operatorname{Cov}(\bm{z}_{\bm{\xi}}))}{t^{4}}-\frac{D}{t^{2}}</annotation><annotation encoding="application/x-llamapun">= divide start_ARG roman_tr ( roman_Cov ( bold_italic_z start_POSTSUBSCRIPT bold_italic_Î¾ end_POSTSUBSCRIPT ) ) end_ARG start_ARG italic_t start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT end_ARG - divide start_ARG italic_D end_ARG start_ARG italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.119)</span></td>
</tr></tbody>
<tbody id="S2.E120"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{\operatorname{tr}(\operatorname{Cov}(\bm{y}_{\bm{\xi}}))}{t^{4}}-\frac{D}{t^{2}}." class="ltx_Math" display="inline" id="S2.E120.m1"><semantics><mrow><mrow><mi></mi><mo>=</mo><mrow><mstyle displaystyle="true"><mfrac><mrow><mi>tr</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><mrow><mi>Cov</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ’š</mi><mi>ğƒ</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><msup><mi>t</mi><mn>4</mn></msup></mfrac></mstyle><mo>âˆ’</mo><mstyle displaystyle="true"><mfrac><mi>D</mi><msup><mi>t</mi><mn>2</mn></msup></mfrac></mstyle></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">\displaystyle=\frac{\operatorname{tr}(\operatorname{Cov}(\bm{y}_{\bm{\xi}}))}{t^{4}}-\frac{D}{t^{2}}.</annotation><annotation encoding="application/x-llamapun">= divide start_ARG roman_tr ( roman_Cov ( bold_italic_y start_POSTSUBSCRIPT bold_italic_Î¾ end_POSTSUBSCRIPT ) ) end_ARG start_ARG italic_t start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT end_ARG - divide start_ARG italic_D end_ARG start_ARG italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.120)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">A trivial lower bound on this trace is <math alttext="0" class="ltx_Math" display="inline" id="S2.SS3.SSSx4.p2.m5"><mn>0</mn></math>, since covariance matrices are positive semidefinite. To find an upper bound, note that <math alttext="\bm{y}_{\bm{\xi}}" class="ltx_Math" display="inline" id="S2.SS3.SSSx4.p2.m6"><semantics><msub><mi>ğ’š</mi><mi>ğƒ</mi></msub><annotation encoding="application/x-tex">\bm{y}_{\bm{\xi}}</annotation><annotation encoding="application/x-llamapun">bold_italic_y start_POSTSUBSCRIPT bold_italic_Î¾ end_POSTSUBSCRIPT</annotation></semantics></math> takes values only in the support of <math alttext="\bm{x}" class="ltx_Math" display="inline" id="S2.SS3.SSSx4.p2.m7"><semantics><mi>ğ’™</mi><annotation encoding="application/x-tex">\bm{x}</annotation><annotation encoding="application/x-llamapun">bold_italic_x</annotation></semantics></math> (since <math alttext="p" class="ltx_Math" display="inline" id="S2.SS3.SSSx4.p2.m8"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation><annotation encoding="application/x-llamapun">italic_p</annotation></semantics></math> is a factor of the density <math alttext="q_{\bm{\xi}}" class="ltx_Math" display="inline" id="S2.SS3.SSSx4.p2.m9"><semantics><msub><mi>q</mi><mi>ğƒ</mi></msub><annotation encoding="application/x-tex">q_{\bm{\xi}}</annotation><annotation encoding="application/x-llamapun">italic_q start_POSTSUBSCRIPT bold_italic_Î¾ end_POSTSUBSCRIPT</annotation></semantics></math> of <math alttext="\bm{y}_{\bm{\xi}}" class="ltx_Math" display="inline" id="S2.SS3.SSSx4.p2.m10"><semantics><msub><mi>ğ’š</mi><mi>ğƒ</mi></msub><annotation encoding="application/x-tex">\bm{y}_{\bm{\xi}}</annotation><annotation encoding="application/x-llamapun">bold_italic_y start_POSTSUBSCRIPT bold_italic_Î¾ end_POSTSUBSCRIPT</annotation></semantics></math>), which by <a class="ltx_ref" href="#Thmassumption1" title="Assumption B.1. â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Assumption</span>Â <span class="ltx_text ltx_ref_tag">B.1</span></a> is a compact set <math alttext="\mathcal{S}" class="ltx_Math" display="inline" id="S2.SS3.SSSx4.p2.m11"><semantics><mi class="ltx_font_mathcaligraphic">ğ’®</mi><annotation encoding="application/x-tex">\mathcal{S}</annotation><annotation encoding="application/x-llamapun">caligraphic_S</annotation></semantics></math> with radius <math alttext="R\doteq\sup_{\bm{\xi}\in\mathbb{R}^{D}}\|\bm{\xi}\|_{2}" class="ltx_Math" display="inline" id="S2.SS3.SSSx4.p2.m12"><semantics><mrow><mi>R</mi><mo rspace="0.1389em">â‰</mo><mrow><msub><mo lspace="0.1389em" rspace="0em">sup</mo><mrow><mi>ğƒ</mi><mo>âˆˆ</mo><msup><mi>â„</mi><mi>D</mi></msup></mrow></msub><msub><mrow><mo stretchy="false">â€–</mo><mi>ğƒ</mi><mo stretchy="false">â€–</mo></mrow><mn>2</mn></msub></mrow></mrow><annotation encoding="application/x-tex">R\doteq\sup_{\bm{\xi}\in\mathbb{R}^{D}}\|\bm{\xi}\|_{2}</annotation><annotation encoding="application/x-llamapun">italic_R â‰ roman_sup start_POSTSUBSCRIPT bold_italic_Î¾ âˆˆ blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT end_POSTSUBSCRIPT âˆ¥ bold_italic_Î¾ âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>. So</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E121">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\operatorname{tr}(\operatorname{Cov}(\bm{y}_{\bm{\xi}}))=\operatorname{\mathbb{E}}[\|\bm{y}_{\bm{\xi}}\|_{2}^{2}]-\|\operatorname{\mathbb{E}}[\bm{y}_{\bm{\xi}}]\|_{2}^{2}\leq\operatorname{\mathbb{E}}[\|\bm{y}_{\bm{\xi}}\|_{2}^{2}]\leq R^{2}." class="ltx_Math" display="block" id="S2.E121.m1"><semantics><mrow><mrow><mrow><mi>tr</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><mrow><mi>Cov</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ’š</mi><mi>ğƒ</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mi>ğ”¼</mi><mo>â¡</mo><mrow><mo stretchy="false">[</mo><msubsup><mrow><mo stretchy="false">â€–</mo><msub><mi>ğ’š</mi><mi>ğƒ</mi></msub><mo stretchy="false">â€–</mo></mrow><mn>2</mn><mn>2</mn></msubsup><mo stretchy="false">]</mo></mrow></mrow><mo>âˆ’</mo><msubsup><mrow><mo stretchy="false">â€–</mo><mrow><mi>ğ”¼</mi><mo>â¡</mo><mrow><mo stretchy="false">[</mo><msub><mi>ğ’š</mi><mi>ğƒ</mi></msub><mo stretchy="false">]</mo></mrow></mrow><mo stretchy="false">â€–</mo></mrow><mn>2</mn><mn>2</mn></msubsup></mrow><mo>â‰¤</mo><mrow><mi>ğ”¼</mi><mo>â¡</mo><mrow><mo stretchy="false">[</mo><msubsup><mrow><mo stretchy="false">â€–</mo><msub><mi>ğ’š</mi><mi>ğƒ</mi></msub><mo stretchy="false">â€–</mo></mrow><mn>2</mn><mn>2</mn></msubsup><mo stretchy="false">]</mo></mrow></mrow><mo>â‰¤</mo><msup><mi>R</mi><mn>2</mn></msup></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">\operatorname{tr}(\operatorname{Cov}(\bm{y}_{\bm{\xi}}))=\operatorname{\mathbb{E}}[\|\bm{y}_{\bm{\xi}}\|_{2}^{2}]-\|\operatorname{\mathbb{E}}[\bm{y}_{\bm{\xi}}]\|_{2}^{2}\leq\operatorname{\mathbb{E}}[\|\bm{y}_{\bm{\xi}}\|_{2}^{2}]\leq R^{2}.</annotation><annotation encoding="application/x-llamapun">roman_tr ( roman_Cov ( bold_italic_y start_POSTSUBSCRIPT bold_italic_Î¾ end_POSTSUBSCRIPT ) ) = blackboard_E [ âˆ¥ bold_italic_y start_POSTSUBSCRIPT bold_italic_Î¾ end_POSTSUBSCRIPT âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ] - âˆ¥ blackboard_E [ bold_italic_y start_POSTSUBSCRIPT bold_italic_Î¾ end_POSTSUBSCRIPT ] âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT â‰¤ blackboard_E [ âˆ¥ bold_italic_y start_POSTSUBSCRIPT bold_italic_Î¾ end_POSTSUBSCRIPT âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ] â‰¤ italic_R start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.121)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">Therefore</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E122">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="-\frac{D}{t^{2}}\leq\Delta\log p_{t}(\bm{\xi})\leq\frac{R^{2}}{t^{4}}-\frac{D}{t^{2}}," class="ltx_Math" display="block" id="S2.E122.m1"><semantics><mrow><mrow><mrow><mo>âˆ’</mo><mfrac><mi>D</mi><msup><mi>t</mi><mn>2</mn></msup></mfrac></mrow><mo>â‰¤</mo><mrow><mi mathvariant="normal">Î”</mi><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mi>log</mi><mo lspace="0.167em">â¡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>â‰¤</mo><mrow><mfrac><msup><mi>R</mi><mn>2</mn></msup><msup><mi>t</mi><mn>4</mn></msup></mfrac><mo>âˆ’</mo><mfrac><mi>D</mi><msup><mi>t</mi><mn>2</mn></msup></mfrac></mrow></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">-\frac{D}{t^{2}}\leq\Delta\log p_{t}(\bm{\xi})\leq\frac{R^{2}}{t^{4}}-\frac{D}{t^{2}},</annotation><annotation encoding="application/x-llamapun">- divide start_ARG italic_D end_ARG start_ARG italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG â‰¤ roman_Î” roman_log italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) â‰¤ divide start_ARG italic_R start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG italic_t start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT end_ARG - divide start_ARG italic_D end_ARG start_ARG italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.122)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">which shows the claim.
âˆ</p>
</div>
</div>
</section>
<section class="ltx_subsubsection" id="S2.SS3.SSSx5">
<h4 class="ltx_title ltx_title_subsubsection">Derivative Computations</h4>
<div class="ltx_para" id="S2.SS3.SSSx5.p1">
<p class="ltx_p">Here we calculate some useful derivatives which will be reused throughout the appendix.</p>
</div>
<div class="ltx_theorem ltx_theorem_proposition" id="Thmproposition1">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold">Proposition B.1</span></span><span class="ltx_text ltx_font_bold">.</span>
</h6>
<div class="ltx_para" id="Thmproposition1.p1">
<p class="ltx_p"><span class="ltx_text ltx_font_italic">Let <math alttext="\bm{x}" class="ltx_Math" display="inline" id="Thmproposition1.p1.m1"><semantics><mi>ğ±</mi><annotation encoding="application/x-tex">\bm{x}</annotation><annotation encoding="application/x-llamapun">bold_italic_x</annotation></semantics></math> be any random variable such that <a class="ltx_ref" href="#Thmassumption1" title="Assumption B.1. â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Assumptions</span>Â <span class="ltx_text ltx_ref_tag">B.1</span></a> andÂ <a class="ltx_ref" href="#Thmassumption2" title="Assumption B.2. â€£ B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">B.2</span></a> hold, and let <math alttext="(\bm{x}_{t})_{t\in[0,T]}" class="ltx_Math" display="inline" id="Thmproposition1.p1.m2"><semantics><msub><mrow><mo stretchy="false">(</mo><msub><mi>ğ±</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><mrow><mi>t</mi><mo>âˆˆ</mo><mrow><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mi>T</mi><mo stretchy="false">]</mo></mrow></mrow></msub><annotation encoding="application/x-tex">(\bm{x}_{t})_{t\in[0,T]}</annotation><annotation encoding="application/x-llamapun">( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT italic_t âˆˆ [ 0 , italic_T ] end_POSTSUBSCRIPT</annotation></semantics></math> be the stochastic process (<a class="ltx_ref" href="#S2.E1" title="Equation B.2.1 â€£ B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">B.2.1</span></a>). For <math alttext="t\geq 0" class="ltx_Math" display="inline" id="Thmproposition1.p1.m3"><semantics><mrow><mi>t</mi><mo>â‰¥</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">t\geq 0</annotation><annotation encoding="application/x-llamapun">italic_t â‰¥ 0</annotation></semantics></math>, let <math alttext="p_{t}" class="ltx_Math" display="inline" id="Thmproposition1.p1.m4"><semantics><msub><mi>p</mi><mi>t</mi></msub><annotation encoding="application/x-tex">p_{t}</annotation><annotation encoding="application/x-llamapun">italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> be the density of <math alttext="\bm{x}_{t}" class="ltx_Math" display="inline" id="Thmproposition1.p1.m5"><semantics><msub><mi>ğ±</mi><mi>t</mi></msub><annotation encoding="application/x-tex">\bm{x}_{t}</annotation><annotation encoding="application/x-llamapun">bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>. Then</span></p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S3.EGx146">
<tbody id="S2.E123"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\frac{\partial p_{t}}{\partial t}(\bm{\xi})" class="ltx_Math" display="inline" id="S2.E123.m1"><semantics><mrow><mstyle displaystyle="true"><mfrac><mrow><mo rspace="0em">âˆ‚</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mrow><mo rspace="0em">âˆ‚</mo><mi>t</mi></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">\displaystyle\frac{\partial p_{t}}{\partial t}(\bm{\xi})</annotation><annotation encoding="application/x-llamapun">divide start_ARG âˆ‚ italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG start_ARG âˆ‚ italic_t end_ARG ( bold_italic_Î¾ )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\operatorname{\mathbb{E}}\left[\varphi_{t}(\bm{\xi}-\bm{x})\cdot\frac{\|\bm{\xi}-\bm{x}\|_{2}^{2}-Dt^{2}}{t^{3}}\right]" class="ltx_Math" display="inline" id="S2.E123.m2"><semantics><mrow><mi></mi><mo>=</mo><mrow><mi>ğ”¼</mi><mo>â¡</mo><mrow><mo>[</mo><mrow><mrow><msub><mi>Ï†</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’™</mi></mrow><mo rspace="0.055em" stretchy="false">)</mo></mrow></mrow><mo rspace="0.222em">â‹…</mo><mstyle displaystyle="true"><mfrac><mrow><msubsup><mrow><mo stretchy="false">â€–</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’™</mi></mrow><mo stretchy="false">â€–</mo></mrow><mn>2</mn><mn>2</mn></msubsup><mo>âˆ’</mo><mrow><mi>D</mi><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>t</mi><mn>2</mn></msup></mrow></mrow><msup><mi>t</mi><mn>3</mn></msup></mfrac></mstyle></mrow><mo>]</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=\operatorname{\mathbb{E}}\left[\varphi_{t}(\bm{\xi}-\bm{x})\cdot\frac{\|\bm{\xi}-\bm{x}\|_{2}^{2}-Dt^{2}}{t^{3}}\right]</annotation><annotation encoding="application/x-llamapun">= blackboard_E [ italic_Ï† start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ - bold_italic_x ) â‹… divide start_ARG âˆ¥ bold_italic_Î¾ - bold_italic_x âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT - italic_D italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG italic_t start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT end_ARG ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.123)</span></td>
</tr></tbody>
<tbody id="S2.E124"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\nabla p_{t}(\bm{\xi})" class="ltx_Math" display="inline" id="S2.E124.m1"><semantics><mrow><mrow><mo rspace="0.167em">âˆ‡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">\displaystyle\nabla p_{t}(\bm{\xi})</annotation><annotation encoding="application/x-llamapun">âˆ‡ italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=-\operatorname{\mathbb{E}}\left[\varphi_{t}(\bm{\xi}-\bm{x})\cdot\frac{\bm{\xi}-\bm{x}}{t^{2}}\right]" class="ltx_Math" display="inline" id="S2.E124.m2"><semantics><mrow><mi></mi><mo>=</mo><mrow><mo rspace="0.167em">âˆ’</mo><mrow><mi>ğ”¼</mi><mo>â¡</mo><mrow><mo>[</mo><mrow><mrow><msub><mi>Ï†</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’™</mi></mrow><mo rspace="0.055em" stretchy="false">)</mo></mrow></mrow><mo rspace="0.222em">â‹…</mo><mstyle displaystyle="true"><mfrac><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’™</mi></mrow><msup><mi>t</mi><mn>2</mn></msup></mfrac></mstyle></mrow><mo>]</mo></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=-\operatorname{\mathbb{E}}\left[\varphi_{t}(\bm{\xi}-\bm{x})\cdot\frac{\bm{\xi}-\bm{x}}{t^{2}}\right]</annotation><annotation encoding="application/x-llamapun">= - blackboard_E [ italic_Ï† start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ - bold_italic_x ) â‹… divide start_ARG bold_italic_Î¾ - bold_italic_x end_ARG start_ARG italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.124)</span></td>
</tr></tbody>
<tbody id="S2.E125"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\nabla^{2}p_{t}(\bm{\xi})" class="ltx_Math" display="inline" id="S2.E125.m1"><semantics><mrow><mrow><msup><mo>âˆ‡</mo><mn>2</mn></msup><msub><mi>p</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">\displaystyle\nabla^{2}p_{t}(\bm{\xi})</annotation><annotation encoding="application/x-llamapun">âˆ‡ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\operatorname{\mathbb{E}}\left[\varphi_{t}(\bm{\xi}-\bm{x})\cdot\frac{(\bm{\xi}-\bm{x})(\bm{\xi}-\bm{x})^{\top}-t^{2}\bm{I}}{t^{4}}\right]" class="ltx_Math" display="inline" id="S2.E125.m2"><semantics><mrow><mi></mi><mo>=</mo><mrow><mi>ğ”¼</mi><mo>â¡</mo><mrow><mo>[</mo><mrow><mrow><msub><mi>Ï†</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’™</mi></mrow><mo rspace="0.055em" stretchy="false">)</mo></mrow></mrow><mo rspace="0.222em">â‹…</mo><mstyle displaystyle="true"><mfrac><mrow><mrow><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’™</mi></mrow><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><msup><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’™</mi></mrow><mo stretchy="false">)</mo></mrow><mo>âŠ¤</mo></msup></mrow><mo>âˆ’</mo><mrow><msup><mi>t</mi><mn>2</mn></msup><mo lspace="0em" rspace="0em">â€‹</mo><mi>ğ‘°</mi></mrow></mrow><msup><mi>t</mi><mn>4</mn></msup></mfrac></mstyle></mrow><mo>]</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=\operatorname{\mathbb{E}}\left[\varphi_{t}(\bm{\xi}-\bm{x})\cdot\frac{(\bm{\xi}-\bm{x})(\bm{\xi}-\bm{x})^{\top}-t^{2}\bm{I}}{t^{4}}\right]</annotation><annotation encoding="application/x-llamapun">= blackboard_E [ italic_Ï† start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ - bold_italic_x ) â‹… divide start_ARG ( bold_italic_Î¾ - bold_italic_x ) ( bold_italic_Î¾ - bold_italic_x ) start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT - italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT bold_italic_I end_ARG start_ARG italic_t start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT end_ARG ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.125)</span></td>
</tr></tbody>
<tbody id="S2.E126"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\Delta p_{t}(\bm{\xi})" class="ltx_Math" display="inline" id="S2.E126.m1"><semantics><mrow><mi mathvariant="normal">Î”</mi><mo lspace="0em" rspace="0em">â€‹</mo><msub><mi>p</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">\displaystyle\Delta p_{t}(\bm{\xi})</annotation><annotation encoding="application/x-llamapun">roman_Î” italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\operatorname{\mathbb{E}}\left[\varphi_{t}(\bm{\xi}-\bm{x})\cdot\frac{\|\bm{\xi}-\bm{x}\|_{2}^{2}-Dt^{2}}{t^{4}}\right]." class="ltx_Math" display="inline" id="S2.E126.m2"><semantics><mrow><mrow><mi></mi><mo>=</mo><mrow><mi>ğ”¼</mi><mo>â¡</mo><mrow><mo>[</mo><mrow><mrow><msub><mi>Ï†</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’™</mi></mrow><mo rspace="0.055em" stretchy="false">)</mo></mrow></mrow><mo rspace="0.222em">â‹…</mo><mstyle displaystyle="true"><mfrac><mrow><msubsup><mrow><mo stretchy="false">â€–</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’™</mi></mrow><mo stretchy="false">â€–</mo></mrow><mn>2</mn><mn>2</mn></msubsup><mo>âˆ’</mo><mrow><mi>D</mi><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>t</mi><mn>2</mn></msup></mrow></mrow><msup><mi>t</mi><mn>4</mn></msup></mfrac></mstyle></mrow><mo>]</mo></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">\displaystyle=\operatorname{\mathbb{E}}\left[\varphi_{t}(\bm{\xi}-\bm{x})\cdot\frac{\|\bm{\xi}-\bm{x}\|_{2}^{2}-Dt^{2}}{t^{4}}\right].</annotation><annotation encoding="application/x-llamapun">= blackboard_E [ italic_Ï† start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ - bold_italic_x ) â‹… divide start_ARG âˆ¥ bold_italic_Î¾ - bold_italic_x âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT - italic_D italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG italic_t start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT end_ARG ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.126)</span></td>
</tr></tbody>
</table>
</div>
</div>
<div class="ltx_proof">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h6>
<div class="ltx_para" id="S2.SS3.SSSx5.p2">
<p class="ltx_p">We use the convolution representation of <math alttext="p_{t}" class="ltx_Math" display="inline" id="S2.SS3.SSSx5.p2.m1"><semantics><msub><mi>p</mi><mi>t</mi></msub><annotation encoding="application/x-tex">p_{t}</annotation><annotation encoding="application/x-llamapun">italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, namely (<a class="ltx_ref" href="#S2.E3" title="Equation B.2.3 â€£ B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">B.2.3</span></a>). First taking the time derivative, a computation yields that <a class="ltx_ref" href="#Thmproposition3" title="Proposition B.3 ([Jon82], Section 11.12). â€£ Differentiating Under the Integral Sign â€£ B.2.3 Technical Lemmas and Intermediate Results â€£ B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Proposition</span>Â <span class="ltx_text ltx_ref_tag">B.3</span></a> applies,<span class="ltx_note ltx_role_footnote" id="footnote6"><sup class="ltx_note_mark">6</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">6</sup><span class="ltx_tag ltx_tag_note">6</span>We use <math alttext="f_{t}(\bm{\xi})=p(\bm{\xi})\varphi_{t}(\bm{\xi}-\bm{x})" class="ltx_Math" display="inline" id="footnote6.m1"><semantics><mrow><mrow><msub><mi>f</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mi>p</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><msub><mi>Ï†</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’™</mi></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">f_{t}(\bm{\xi})=p(\bm{\xi})\varphi_{t}(\bm{\xi}-\bm{x})</annotation><annotation encoding="application/x-llamapun">italic_f start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) = italic_p ( bold_italic_Î¾ ) italic_Ï† start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ - bold_italic_x )</annotation></semantics></math>, noting that it is twice continuously differentiable in <math alttext="\bm{\xi}" class="ltx_Math" display="inline" id="footnote6.m2"><semantics><mi>ğƒ</mi><annotation encoding="application/x-tex">\bm{\xi}</annotation><annotation encoding="application/x-llamapun">bold_italic_Î¾</annotation></semantics></math> and (more than) twice continuously differentiable in <math alttext="t" class="ltx_Math" display="inline" id="footnote6.m3"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation><annotation encoding="application/x-llamapun">italic_t</annotation></semantics></math>. Then to check the local integrability of <math alttext="f_{t}" class="ltx_Math" display="inline" id="footnote6.m4"><semantics><msub><mi>f</mi><mi>t</mi></msub><annotation encoding="application/x-tex">f_{t}</annotation><annotation encoding="application/x-llamapun">italic_f start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> we compute <math alttext="\frac{\partial f_{t}}{\partial t}(\bm{\xi})=f_{t}(\bm{\xi})\cdot\frac{1}{t^{3}}(\|\bm{\xi}-\bm{x}\|_{2}^{2}-Dt^{2})" class="ltx_Math" display="inline" id="footnote6.m5"><semantics><mrow><mrow><mfrac><mrow><mo rspace="0em">âˆ‚</mo><msub><mi>f</mi><mi>t</mi></msub></mrow><mrow><mo rspace="0em">âˆ‚</mo><mi>t</mi></mrow></mfrac><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mrow><msub><mi>f</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo rspace="0.055em" stretchy="false">)</mo></mrow></mrow><mo rspace="0.222em">â‹…</mo><mfrac><mn>1</mn><msup><mi>t</mi><mn>3</mn></msup></mfrac></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><msubsup><mrow><mo stretchy="false">â€–</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’™</mi></mrow><mo stretchy="false">â€–</mo></mrow><mn>2</mn><mn>2</mn></msubsup><mo>âˆ’</mo><mrow><mi>D</mi><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>t</mi><mn>2</mn></msup></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\frac{\partial f_{t}}{\partial t}(\bm{\xi})=f_{t}(\bm{\xi})\cdot\frac{1}{t^{3}}(\|\bm{\xi}-\bm{x}\|_{2}^{2}-Dt^{2})</annotation><annotation encoding="application/x-llamapun">divide start_ARG âˆ‚ italic_f start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG start_ARG âˆ‚ italic_t end_ARG ( bold_italic_Î¾ ) = italic_f start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) â‹… divide start_ARG 1 end_ARG start_ARG italic_t start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT end_ARG ( âˆ¥ bold_italic_Î¾ - bold_italic_x âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT - italic_D italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math>, which is is easy to check integrable over <math alttext="\bm{\xi}" class="ltx_Math" display="inline" id="footnote6.m6"><semantics><mi>ğƒ</mi><annotation encoding="application/x-tex">\bm{\xi}</annotation><annotation encoding="application/x-llamapun">bold_italic_Î¾</annotation></semantics></math> and <math alttext="t\in[t_{\min},t_{\max}]" class="ltx_Math" display="inline" id="footnote6.m7"><semantics><mrow><mi>t</mi><mo>âˆˆ</mo><mrow><mo stretchy="false">[</mo><msub><mi>t</mi><mi>min</mi></msub><mo>,</mo><msub><mi>t</mi><mi>max</mi></msub><mo stretchy="false">]</mo></mrow></mrow><annotation encoding="application/x-tex">t\in[t_{\min},t_{\max}]</annotation><annotation encoding="application/x-llamapun">italic_t âˆˆ [ italic_t start_POSTSUBSCRIPT roman_min end_POSTSUBSCRIPT , italic_t start_POSTSUBSCRIPT roman_max end_POSTSUBSCRIPT ]</annotation></semantics></math> where <math alttext="t_{\min}&gt;0" class="ltx_Math" display="inline" id="footnote6.m8"><semantics><mrow><msub><mi>t</mi><mi>min</mi></msub><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">t_{\min}&gt;0</annotation><annotation encoding="application/x-llamapun">italic_t start_POSTSUBSCRIPT roman_min end_POSTSUBSCRIPT &gt; 0</annotation></semantics></math>. (Indeed, <math alttext="f_{t}" class="ltx_Math" display="inline" id="footnote6.m9"><semantics><msub><mi>f</mi><mi>t</mi></msub><annotation encoding="application/x-tex">f_{t}</annotation><annotation encoding="application/x-llamapun">italic_f start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> has exponentially decaying tails, so the quadratic term in the product is of no issue.)</span></span></span> so we can bring the derivative inside the integral/expectation as:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E127">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\frac{\partial p_{t}}{\partial t}(\bm{\xi})=\frac{\partial}{\partial t}\operatorname{\mathbb{E}}[\varphi_{t}(\bm{\xi}-\bm{x})]=\operatorname{\mathbb{E}}\left[\frac{\partial}{\partial t}\varphi_{t}(\bm{\xi}-\bm{x})\right]=\frac{\partial\varphi_{t}}{\partial t}*p." class="ltx_Math" display="block" id="S2.E127.m1"><semantics><mrow><mrow><mrow><mfrac><mrow><mo rspace="0em">âˆ‚</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mrow><mo rspace="0em">âˆ‚</mo><mi>t</mi></mrow></mfrac><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mfrac><mo>âˆ‚</mo><mrow><mo rspace="0em">âˆ‚</mo><mi>t</mi></mrow></mfrac><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mi>ğ”¼</mi><mo>â¡</mo><mrow><mo stretchy="false">[</mo><mrow><msub><mi>Ï†</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’™</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">]</mo></mrow></mrow></mrow><mo>=</mo><mrow><mi>ğ”¼</mi><mo>â¡</mo><mrow><mo>[</mo><mrow><mfrac><mo>âˆ‚</mo><mrow><mo rspace="0em">âˆ‚</mo><mi>t</mi></mrow></mfrac><mo lspace="0em" rspace="0em">â€‹</mo><msub><mi>Ï†</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’™</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>]</mo></mrow></mrow><mo>=</mo><mrow><mfrac><mrow><mo rspace="0em">âˆ‚</mo><msub><mi>Ï†</mi><mi>t</mi></msub></mrow><mrow><mo rspace="0em">âˆ‚</mo><mi>t</mi></mrow></mfrac><mo lspace="0.222em" rspace="0.222em">âˆ—</mo><mi>p</mi></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">\frac{\partial p_{t}}{\partial t}(\bm{\xi})=\frac{\partial}{\partial t}\operatorname{\mathbb{E}}[\varphi_{t}(\bm{\xi}-\bm{x})]=\operatorname{\mathbb{E}}\left[\frac{\partial}{\partial t}\varphi_{t}(\bm{\xi}-\bm{x})\right]=\frac{\partial\varphi_{t}}{\partial t}*p.</annotation><annotation encoding="application/x-llamapun">divide start_ARG âˆ‚ italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG start_ARG âˆ‚ italic_t end_ARG ( bold_italic_Î¾ ) = divide start_ARG âˆ‚ end_ARG start_ARG âˆ‚ italic_t end_ARG blackboard_E [ italic_Ï† start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ - bold_italic_x ) ] = blackboard_E [ divide start_ARG âˆ‚ end_ARG start_ARG âˆ‚ italic_t end_ARG italic_Ï† start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ - bold_italic_x ) ] = divide start_ARG âˆ‚ italic_Ï† start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG start_ARG âˆ‚ italic_t end_ARG âˆ— italic_p .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.127)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">Meanwhile, by properties of convolutions (<a class="ltx_ref" href="#Thmproposition4" title="Proposition B.4 ([BB11], Proposition 4.20). â€£ Differentiating Under the Integral Sign â€£ B.2.3 Technical Lemmas and Intermediate Results â€£ B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Proposition</span>Â <span class="ltx_text ltx_ref_tag">B.4</span></a>) and using the fact that <math alttext="p" class="ltx_Math" display="inline" id="S2.SS3.SSSx5.p2.m2"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation><annotation encoding="application/x-llamapun">italic_p</annotation></semantics></math> is compactly supported (<a class="ltx_ref" href="#Thmassumption1" title="Assumption B.1. â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Assumption</span>Â <span class="ltx_text ltx_ref_tag">B.1</span></a>),</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E128">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="p_{t}=\varphi_{t}*p\implies\nabla p_{t}=\nabla\varphi_{t}*p\implies\nabla^{2}p_{t}=\nabla^{2}\varphi_{t}*p\implies\Delta p_{t}=\Delta\varphi_{t}*p." class="ltx_Math" display="block" id="S2.E128.m1"><semantics><mrow><mrow><msub><mi>p</mi><mi>t</mi></msub><mo>=</mo><mrow><msub><mi>Ï†</mi><mi>t</mi></msub><mo lspace="0.222em" rspace="0.222em">âˆ—</mo><mi>p</mi></mrow><mo stretchy="false">âŸ¹</mo><mrow><mo rspace="0.167em">âˆ‡</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo>=</mo><mrow><mo rspace="0.167em">âˆ‡</mo><mrow><msub><mi>Ï†</mi><mi>t</mi></msub><mo lspace="0.222em" rspace="0.222em">âˆ—</mo><mi>p</mi></mrow></mrow><mo stretchy="false">âŸ¹</mo><mrow><msup><mo rspace="0.167em">âˆ‡</mo><mn>2</mn></msup><msub><mi>p</mi><mi>t</mi></msub></mrow><mo>=</mo><mrow><msup><mo rspace="0.167em">âˆ‡</mo><mn>2</mn></msup><mrow><msub><mi>Ï†</mi><mi>t</mi></msub><mo lspace="0.222em" rspace="0.222em">âˆ—</mo><mi>p</mi></mrow></mrow><mo stretchy="false">âŸ¹</mo><mrow><mi mathvariant="normal">Î”</mi><mo lspace="0em" rspace="0em">â€‹</mo><msub><mi>p</mi><mi>t</mi></msub></mrow><mo>=</mo><mrow><mrow><mi mathvariant="normal">Î”</mi><mo lspace="0em" rspace="0em">â€‹</mo><msub><mi>Ï†</mi><mi>t</mi></msub></mrow><mo lspace="0.222em" rspace="0.222em">âˆ—</mo><mi>p</mi></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">p_{t}=\varphi_{t}*p\implies\nabla p_{t}=\nabla\varphi_{t}*p\implies\nabla^{2}p_{t}=\nabla^{2}\varphi_{t}*p\implies\Delta p_{t}=\Delta\varphi_{t}*p.</annotation><annotation encoding="application/x-llamapun">italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = italic_Ï† start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT âˆ— italic_p âŸ¹ âˆ‡ italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = âˆ‡ italic_Ï† start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT âˆ— italic_p âŸ¹ âˆ‡ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = âˆ‡ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_Ï† start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT âˆ— italic_p âŸ¹ roman_Î” italic_p start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = roman_Î” italic_Ï† start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT âˆ— italic_p .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.128)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">The rest of the computation follows from <a class="ltx_ref" href="#Thmproposition2" title="Proposition B.2. â€£ Derivative Computations â€£ B.2.3 Technical Lemmas and Intermediate Results â€£ B.2 Diffusion and Denoising Processes â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Proposition</span>Â <span class="ltx_text ltx_ref_tag">B.2</span></a>.
âˆ</p>
</div>
</div>
<div class="ltx_theorem ltx_theorem_proposition" id="Thmproposition2">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold">Proposition B.2</span></span><span class="ltx_text ltx_font_bold">.</span>
</h6>
<div class="ltx_para" id="Thmproposition2.p1">
<p class="ltx_p"><span class="ltx_text ltx_font_italic">For <math alttext="t&gt;0" class="ltx_Math" display="inline" id="Thmproposition2.p1.m1"><semantics><mrow><mi>t</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">t&gt;0</annotation><annotation encoding="application/x-llamapun">italic_t &gt; 0</annotation></semantics></math> and <math alttext="\bm{\xi}\in\mathbb{R}^{D}" class="ltx_Math" display="inline" id="Thmproposition2.p1.m2"><semantics><mrow><mi>ğ›</mi><mo>âˆˆ</mo><msup><mi>â„</mi><mi>D</mi></msup></mrow><annotation encoding="application/x-tex">\bm{\xi}\in\mathbb{R}^{D}</annotation><annotation encoding="application/x-llamapun">bold_italic_Î¾ âˆˆ blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT</annotation></semantics></math> it holds</span></p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S3.EGx147">
<tbody id="S2.E129"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\frac{\partial}{\partial t}\varphi_{t}(\bm{\xi})" class="ltx_Math" display="inline" id="S2.E129.m1"><semantics><mrow><mstyle displaystyle="true"><mfrac><mo>âˆ‚</mo><mrow><mo rspace="0em">âˆ‚</mo><mi>t</mi></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em">â€‹</mo><msub><mi>Ï†</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">\displaystyle\frac{\partial}{\partial t}\varphi_{t}(\bm{\xi})</annotation><annotation encoding="application/x-llamapun">divide start_ARG âˆ‚ end_ARG start_ARG âˆ‚ italic_t end_ARG italic_Ï† start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\varphi_{t}(\bm{\xi})\cdot\frac{\|\bm{\xi}\|_{2}^{2}-Dt^{2}}{t^{3}}" class="ltx_Math" display="inline" id="S2.E129.m2"><semantics><mrow><mi></mi><mo>=</mo><mrow><mrow><msub><mi>Ï†</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo rspace="0.055em" stretchy="false">)</mo></mrow></mrow><mo rspace="0.222em">â‹…</mo><mstyle displaystyle="true"><mfrac><mrow><msubsup><mrow><mo stretchy="false">â€–</mo><mi>ğƒ</mi><mo stretchy="false">â€–</mo></mrow><mn>2</mn><mn>2</mn></msubsup><mo>âˆ’</mo><mrow><mi>D</mi><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>t</mi><mn>2</mn></msup></mrow></mrow><msup><mi>t</mi><mn>3</mn></msup></mfrac></mstyle></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=\varphi_{t}(\bm{\xi})\cdot\frac{\|\bm{\xi}\|_{2}^{2}-Dt^{2}}{t^{3}}</annotation><annotation encoding="application/x-llamapun">= italic_Ï† start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) â‹… divide start_ARG âˆ¥ bold_italic_Î¾ âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT - italic_D italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG italic_t start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.129)</span></td>
</tr></tbody>
<tbody id="S2.E130"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\nabla\varphi_{t}(\bm{\xi})" class="ltx_Math" display="inline" id="S2.E130.m1"><semantics><mrow><mrow><mo rspace="0.167em">âˆ‡</mo><msub><mi>Ï†</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">\displaystyle\nabla\varphi_{t}(\bm{\xi})</annotation><annotation encoding="application/x-llamapun">âˆ‡ italic_Ï† start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=-\varphi_{t}(\bm{\xi})\cdot\frac{\bm{\xi}}{t^{2}}" class="ltx_Math" display="inline" id="S2.E130.m2"><semantics><mrow><mi></mi><mo>=</mo><mrow><mo>âˆ’</mo><mrow><mrow><msub><mi>Ï†</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo rspace="0.055em" stretchy="false">)</mo></mrow></mrow><mo rspace="0.222em">â‹…</mo><mstyle displaystyle="true"><mfrac><mi>ğƒ</mi><msup><mi>t</mi><mn>2</mn></msup></mfrac></mstyle></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=-\varphi_{t}(\bm{\xi})\cdot\frac{\bm{\xi}}{t^{2}}</annotation><annotation encoding="application/x-llamapun">= - italic_Ï† start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) â‹… divide start_ARG bold_italic_Î¾ end_ARG start_ARG italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.130)</span></td>
</tr></tbody>
<tbody id="S2.E131"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\nabla^{2}\varphi_{t}(\bm{\xi})" class="ltx_Math" display="inline" id="S2.E131.m1"><semantics><mrow><mrow><msup><mo>âˆ‡</mo><mn>2</mn></msup><msub><mi>Ï†</mi><mi>t</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">\displaystyle\nabla^{2}\varphi_{t}(\bm{\xi})</annotation><annotation encoding="application/x-llamapun">âˆ‡ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_Ï† start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\varphi_{t}(\bm{\xi})\cdot\frac{\bm{\xi}\bm{\xi}^{\top}-t^{2}\bm{I}}{t^{4}}" class="ltx_Math" display="inline" id="S2.E131.m2"><semantics><mrow><mi></mi><mo>=</mo><mrow><mrow><msub><mi>Ï†</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo rspace="0.055em" stretchy="false">)</mo></mrow></mrow><mo rspace="0.222em">â‹…</mo><mstyle displaystyle="true"><mfrac><mrow><mrow><mi>ğƒ</mi><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>ğƒ</mi><mo>âŠ¤</mo></msup></mrow><mo>âˆ’</mo><mrow><msup><mi>t</mi><mn>2</mn></msup><mo lspace="0em" rspace="0em">â€‹</mo><mi>ğ‘°</mi></mrow></mrow><msup><mi>t</mi><mn>4</mn></msup></mfrac></mstyle></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=\varphi_{t}(\bm{\xi})\cdot\frac{\bm{\xi}\bm{\xi}^{\top}-t^{2}\bm{I}}{t^{4}}</annotation><annotation encoding="application/x-llamapun">= italic_Ï† start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) â‹… divide start_ARG bold_italic_Î¾ bold_italic_Î¾ start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT - italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT bold_italic_I end_ARG start_ARG italic_t start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.131)</span></td>
</tr></tbody>
<tbody id="S2.E132"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\Delta\varphi_{t}(\bm{\xi})" class="ltx_Math" display="inline" id="S2.E132.m1"><semantics><mrow><mi mathvariant="normal">Î”</mi><mo lspace="0em" rspace="0em">â€‹</mo><msub><mi>Ï†</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">\displaystyle\Delta\varphi_{t}(\bm{\xi})</annotation><annotation encoding="application/x-llamapun">roman_Î” italic_Ï† start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\varphi_{t}(\bm{\xi})\cdot\frac{\|\bm{\xi}\|_{2}^{2}-Dt^{2}}{t^{4}}." class="ltx_Math" display="inline" id="S2.E132.m2"><semantics><mrow><mrow><mi></mi><mo>=</mo><mrow><mrow><msub><mi>Ï†</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo rspace="0.055em" stretchy="false">)</mo></mrow></mrow><mo rspace="0.222em">â‹…</mo><mstyle displaystyle="true"><mfrac><mrow><msubsup><mrow><mo stretchy="false">â€–</mo><mi>ğƒ</mi><mo stretchy="false">â€–</mo></mrow><mn>2</mn><mn>2</mn></msubsup><mo>âˆ’</mo><mrow><mi>D</mi><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>t</mi><mn>2</mn></msup></mrow></mrow><msup><mi>t</mi><mn>4</mn></msup></mfrac></mstyle></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">\displaystyle=\varphi_{t}(\bm{\xi})\cdot\frac{\|\bm{\xi}\|_{2}^{2}-Dt^{2}}{t^{4}}.</annotation><annotation encoding="application/x-llamapun">= italic_Ï† start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) â‹… divide start_ARG âˆ¥ bold_italic_Î¾ âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT - italic_D italic_t start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG italic_t start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.132)</span></td>
</tr></tbody>
</table>
</div>
</div>
<div class="ltx_proof">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h6>
<div class="ltx_para" id="S2.SS3.SSSx5.p3">
<p class="ltx_p">Direct computation.
âˆ</p>
</div>
</div>
</section>
<section class="ltx_subsubsection" id="S2.SS3.SSSx6">
<h4 class="ltx_title ltx_title_subsubsection">Differentiating Under the Integral Sign</h4>
<div class="ltx_para" id="S2.SS3.SSSx6.p1">
<p class="ltx_p">In this appendix, we differentiate under the integral sign many times, and it is important to know when we can do this. There are two kinds of differentiating under the integral sign:</p>
<ol class="ltx_enumerate" id="S2.I5">
<li class="ltx_item" id="S2.I5.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S2.I5.i1.p1">
<p class="ltx_p">Differentiating an integral <math alttext="\int f_{t}(\bm{\xi})~{}\mathrm{d}\bm{\xi}" class="ltx_Math" display="inline" id="S2.I5.i1.p1.m1"><semantics><mrow><mo>âˆ«</mo><mrow><msub><mi>f</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mo lspace="0.330em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><mi>ğƒ</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">\int f_{t}(\bm{\xi})~{}\mathrm{d}\bm{\xi}</annotation><annotation encoding="application/x-llamapun">âˆ« italic_f start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) roman_d bold_italic_Î¾</annotation></semantics></math> with respect to the auxiliary parameter <math alttext="t" class="ltx_Math" display="inline" id="S2.I5.i1.p1.m2"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation><annotation encoding="application/x-llamapun">italic_t</annotation></semantics></math>.</p>
</div>
</li>
<li class="ltx_item" id="S2.I5.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S2.I5.i2.p1">
<p class="ltx_p">Differentiating a convolution <math alttext="(f*g)(\bm{\xi})=\int f(\bm{\xi})g(\bm{\xi}-\bm{u})~{}\mathrm{d}u" class="ltx_Math" display="inline" id="S2.I5.i2.p1.m1"><semantics><mrow><mrow><mrow><mo stretchy="false">(</mo><mrow><mi>f</mi><mo lspace="0.222em" rspace="0.222em">âˆ—</mo><mi>g</mi></mrow><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo rspace="0.111em">=</mo><mrow><mo>âˆ«</mo><mrow><mi>f</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mi>g</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’–</mi></mrow><mo stretchy="false">)</mo></mrow><mo lspace="0.330em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><mi>u</mi></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">(f*g)(\bm{\xi})=\int f(\bm{\xi})g(\bm{\xi}-\bm{u})~{}\mathrm{d}u</annotation><annotation encoding="application/x-llamapun">( italic_f âˆ— italic_g ) ( bold_italic_Î¾ ) = âˆ« italic_f ( bold_italic_Î¾ ) italic_g ( bold_italic_Î¾ - bold_italic_u ) roman_d italic_u</annotation></semantics></math> with respect to the variable <math alttext="\bm{\xi}" class="ltx_Math" display="inline" id="S2.I5.i2.p1.m2"><semantics><mi>ğƒ</mi><annotation encoding="application/x-tex">\bm{\xi}</annotation><annotation encoding="application/x-llamapun">bold_italic_Î¾</annotation></semantics></math>.</p>
</div>
</li>
</ol>
</div>
<div class="ltx_para" id="S2.SS3.SSSx6.p2">
<p class="ltx_p">For the first category, we give a concrete result, stated without proof but attributable to <a class="ltx_ref ltx_href" href="https://planetmath.org/differentiationundertheintegralsign" title="">the linked source</a>, which derives the following result as a special case of a more general theorem about the interaction of differential operators and tempered distributions, much beyond the scope of the book. A full formal reference can be found in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="bib.html#bibx126" title="">Jon82</a>]</cite>.</p>
</div>
<div class="ltx_theorem ltx_theorem_proposition" id="Thmproposition3">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold">Proposition B.3</span></span><span class="ltx_text ltx_font_bold"> </span>(<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="bib.html#bibx126" title="">Jon82</a>]</cite>, Section 11.12)<span class="ltx_text ltx_font_bold">.</span>
</h6>
<div class="ltx_para" id="Thmproposition3.p1">
<p class="ltx_p"><span class="ltx_text ltx_font_italic">Let <math alttext="f\colon(0,T)\times\mathbb{R}^{D}\to\mathbb{R}" class="ltx_Math" display="inline" id="Thmproposition3.p1.m1"><semantics><mrow><mi>f</mi><mo lspace="0.278em" rspace="0.278em">:</mo><mrow><mrow><mrow><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mi>T</mi><mo rspace="0.055em" stretchy="false">)</mo></mrow><mo rspace="0.222em">Ã—</mo><msup><mi>â„</mi><mi>D</mi></msup></mrow><mo stretchy="false">â†’</mo><mi>â„</mi></mrow></mrow><annotation encoding="application/x-tex">f\colon(0,T)\times\mathbb{R}^{D}\to\mathbb{R}</annotation><annotation encoding="application/x-llamapun">italic_f : ( 0 , italic_T ) Ã— blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT â†’ blackboard_R</annotation></semantics></math> be such that:</span></p>
<ul class="ltx_itemize" id="S2.I6">
<li class="ltx_item" id="S2.I6.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span>
<div class="ltx_para" id="S2.I6.i1.p1">
<p class="ltx_p"><math alttext="f" class="ltx_Math" display="inline" id="S2.I6.i1.p1.m1"><semantics><mi>f</mi><annotation encoding="application/x-tex">f</annotation><annotation encoding="application/x-llamapun">italic_f</annotation></semantics></math><span class="ltx_text ltx_font_italic"> is a jointly measurable function of </span><math alttext="(t,\bm{\xi})" class="ltx_Math" display="inline" id="S2.I6.i1.p1.m2"><semantics><mrow><mo stretchy="false">(</mo><mi>t</mi><mo>,</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(t,\bm{\xi})</annotation><annotation encoding="application/x-llamapun">( italic_t , bold_italic_Î¾ )</annotation></semantics></math><span class="ltx_text ltx_font_italic">;</span></p>
</div>
</li>
<li class="ltx_item" id="S2.I6.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span>
<div class="ltx_para" id="S2.I6.i2.p1">
<p class="ltx_p"><span class="ltx_text ltx_font_italic">For Lebesgue-almost every </span><math alttext="\bm{\xi}\in\mathbb{R}^{D}" class="ltx_Math" display="inline" id="S2.I6.i2.p1.m1"><semantics><mrow><mi>ğƒ</mi><mo>âˆˆ</mo><msup><mi>â„</mi><mi>D</mi></msup></mrow><annotation encoding="application/x-tex">\bm{\xi}\in\mathbb{R}^{D}</annotation><annotation encoding="application/x-llamapun">bold_italic_Î¾ âˆˆ blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT</annotation></semantics></math><span class="ltx_text ltx_font_italic">, the function </span><math alttext="t\mapsto f_{t}(\bm{\xi})" class="ltx_Math" display="inline" id="S2.I6.i2.p1.m2"><semantics><mrow><mi>t</mi><mo stretchy="false">â†¦</mo><mrow><msub><mi>f</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">t\mapsto f_{t}(\bm{\xi})</annotation><annotation encoding="application/x-llamapun">italic_t â†¦ italic_f start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ )</annotation></semantics></math><span class="ltx_text ltx_font_italic"> is absolutely continuous;</span></p>
</div>
</li>
<li class="ltx_item" id="S2.I6.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">â€¢</span>
<div class="ltx_para" id="S2.I6.i3.p1">
<p class="ltx_p"><math alttext="\frac{\partial f_{t}}{\partial t}" class="ltx_Math" display="inline" id="S2.I6.i3.p1.m1"><semantics><mfrac><mrow><mo rspace="0em">âˆ‚</mo><msub><mi>f</mi><mi>t</mi></msub></mrow><mrow><mo rspace="0em">âˆ‚</mo><mi>t</mi></mrow></mfrac><annotation encoding="application/x-tex">\frac{\partial f_{t}}{\partial t}</annotation><annotation encoding="application/x-llamapun">divide start_ARG âˆ‚ italic_f start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG start_ARG âˆ‚ italic_t end_ARG</annotation></semantics></math><span class="ltx_text ltx_font_italic"> is locally integrable, i.e., for every </span><math alttext="[t_{\min},t_{\max}]\subseteq(0,T)" class="ltx_Math" display="inline" id="S2.I6.i3.p1.m2"><semantics><mrow><mrow><mo stretchy="false">[</mo><msub><mi>t</mi><mi>min</mi></msub><mo>,</mo><msub><mi>t</mi><mi>max</mi></msub><mo stretchy="false">]</mo></mrow><mo>âŠ†</mo><mrow><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mi>T</mi><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">[t_{\min},t_{\max}]\subseteq(0,T)</annotation><annotation encoding="application/x-llamapun">[ italic_t start_POSTSUBSCRIPT roman_min end_POSTSUBSCRIPT , italic_t start_POSTSUBSCRIPT roman_max end_POSTSUBSCRIPT ] âŠ† ( 0 , italic_T )</annotation></semantics></math><span class="ltx_text ltx_font_italic"> it holds</span></p>
<table class="ltx_equation ltx_eqn_table" id="S2.E133">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\int_{t_{\min}}^{t_{\max}}\int_{\mathbb{R}^{D}}\left\lvert\frac{\partial f_{t}}{\partial t}(\bm{\xi})\right\rvert~{}\mathrm{d}\bm{\xi}&lt;\infty." class="ltx_Math" display="block" id="S2.E133.m1"><semantics><mrow><mrow><mrow><msubsup><mo>âˆ«</mo><msub><mi>t</mi><mi>min</mi></msub><msub><mi>t</mi><mi>max</mi></msub></msubsup><mrow><msub><mo lspace="0.167em" rspace="0em">âˆ«</mo><msup><mi>â„</mi><mi>D</mi></msup></msub><mrow><mrow><mo>|</mo><mrow><mfrac><mrow><mo rspace="0em">âˆ‚</mo><msub><mi>f</mi><mi>t</mi></msub></mrow><mrow><mo rspace="0em">âˆ‚</mo><mi>t</mi></mrow></mfrac><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>|</mo></mrow><mo lspace="0.330em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><mi>ğƒ</mi></mrow></mrow></mrow></mrow><mo>&lt;</mo><mi mathvariant="normal">âˆ</mi></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">\int_{t_{\min}}^{t_{\max}}\int_{\mathbb{R}^{D}}\left\lvert\frac{\partial f_{t}}{\partial t}(\bm{\xi})\right\rvert~{}\mathrm{d}\bm{\xi}&lt;\infty.</annotation><annotation encoding="application/x-llamapun">âˆ« start_POSTSUBSCRIPT italic_t start_POSTSUBSCRIPT roman_min end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t start_POSTSUBSCRIPT roman_max end_POSTSUBSCRIPT end_POSTSUPERSCRIPT âˆ« start_POSTSUBSCRIPT blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT end_POSTSUBSCRIPT | divide start_ARG âˆ‚ italic_f start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG start_ARG âˆ‚ italic_t end_ARG ( bold_italic_Î¾ ) | roman_d bold_italic_Î¾ &lt; âˆ .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.133)</span></td>
</tr></tbody>
</table>
</div>
</li>
</ul>
<p class="ltx_p"><span class="ltx_text ltx_font_italic">Then <math alttext="t\mapsto\int_{\mathbb{R}^{D}}f_{t}(\bm{\xi})~{}\mathrm{d}\bm{\xi}" class="ltx_Math" display="inline" id="Thmproposition3.p1.m2"><semantics><mrow><mi>t</mi><mo rspace="0.111em" stretchy="false">â†¦</mo><mrow><msub><mo>âˆ«</mo><msup><mi>â„</mi><mi>D</mi></msup></msub><mrow><msub><mi>f</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğ›</mi><mo stretchy="false">)</mo></mrow><mo lspace="0.330em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><mi>ğ›</mi></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">t\mapsto\int_{\mathbb{R}^{D}}f_{t}(\bm{\xi})~{}\mathrm{d}\bm{\xi}</annotation><annotation encoding="application/x-llamapun">italic_t â†¦ âˆ« start_POSTSUBSCRIPT blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT end_POSTSUBSCRIPT italic_f start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) roman_d bold_italic_Î¾</annotation></semantics></math> is an absolutely continuous function on <math alttext="(0,T)" class="ltx_Math" display="inline" id="Thmproposition3.p1.m3"><semantics><mrow><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mi>T</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(0,T)</annotation><annotation encoding="application/x-llamapun">( 0 , italic_T )</annotation></semantics></math>, and its derivative is</span></p>
<table class="ltx_equation ltx_eqn_table" id="S2.E134">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\frac{\mathrm{d}}{\mathrm{d}t}\int_{\mathbb{R}^{D}}f_{t}(\bm{\xi})~{}\mathrm{d}\bm{\xi}=\int_{\mathbb{R}^{D}}\frac{\partial}{\partial t}f_{t}(\bm{\xi})~{}\mathrm{d}\bm{\xi}," class="ltx_Math" display="block" id="S2.E134.m1"><semantics><mrow><mrow><mrow><mfrac><mi mathvariant="normal">d</mi><mrow><mi mathvariant="normal">d</mi><mo lspace="0em" rspace="0em">â€‹</mo><mi>t</mi></mrow></mfrac><mo lspace="0em" rspace="0em">â€‹</mo><mrow><msub><mo>âˆ«</mo><msup><mi>â„</mi><mi>D</mi></msup></msub><mrow><msub><mi>f</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mo lspace="0.330em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><mi>ğƒ</mi></mrow></mrow></mrow></mrow><mo rspace="0.111em">=</mo><mrow><msub><mo>âˆ«</mo><msup><mi>â„</mi><mi>D</mi></msup></msub><mrow><mfrac><mo>âˆ‚</mo><mrow><mo rspace="0em">âˆ‚</mo><mi>t</mi></mrow></mfrac><mo lspace="0em" rspace="0em">â€‹</mo><msub><mi>f</mi><mi>t</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mo lspace="0.330em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><mi>ğƒ</mi></mrow></mrow></mrow></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">\frac{\mathrm{d}}{\mathrm{d}t}\int_{\mathbb{R}^{D}}f_{t}(\bm{\xi})~{}\mathrm{d}\bm{\xi}=\int_{\mathbb{R}^{D}}\frac{\partial}{\partial t}f_{t}(\bm{\xi})~{}\mathrm{d}\bm{\xi},</annotation><annotation encoding="application/x-llamapun">divide start_ARG roman_d end_ARG start_ARG roman_d italic_t end_ARG âˆ« start_POSTSUBSCRIPT blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT end_POSTSUBSCRIPT italic_f start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) roman_d bold_italic_Î¾ = âˆ« start_POSTSUBSCRIPT blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT end_POSTSUBSCRIPT divide start_ARG âˆ‚ end_ARG start_ARG âˆ‚ italic_t end_ARG italic_f start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_Î¾ ) roman_d bold_italic_Î¾ ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.134)</span></td>
</tr></tbody>
</table>
<p class="ltx_p"><span class="ltx_text ltx_font_italic">defined for almost every <math alttext="t\in(0,T)" class="ltx_Math" display="inline" id="Thmproposition3.p1.m4"><semantics><mrow><mi>t</mi><mo>âˆˆ</mo><mrow><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mi>T</mi><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">t\in(0,T)</annotation><annotation encoding="application/x-llamapun">italic_t âˆˆ ( 0 , italic_T )</annotation></semantics></math>.</span></p>
</div>
</div>
<div class="ltx_para" id="S2.SS3.SSSx6.p3">
<p class="ltx_p">For the second category, we give another concrete result, stated without proof but fully formalized in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="bib.html#bibx30" title="">BB11</a>]</cite>.</p>
</div>
<div class="ltx_theorem ltx_theorem_proposition" id="Thmproposition4">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold">Proposition B.4</span></span><span class="ltx_text ltx_font_bold"> </span>(<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="bib.html#bibx30" title="">BB11</a>]</cite>, Proposition 4.20)<span class="ltx_text ltx_font_bold">.</span>
</h6>
<div class="ltx_para" id="Thmproposition4.p1">
<p class="ltx_p"><span class="ltx_text ltx_font_italic">Let <math alttext="f" class="ltx_Math" display="inline" id="Thmproposition4.p1.m1"><semantics><mi>f</mi><annotation encoding="application/x-tex">f</annotation><annotation encoding="application/x-llamapun">italic_f</annotation></semantics></math> be <math alttext="k" class="ltx_Math" display="inline" id="Thmproposition4.p1.m2"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation><annotation encoding="application/x-llamapun">italic_k</annotation></semantics></math>-times continuously differentiable with compact support, and let <math alttext="g" class="ltx_Math" display="inline" id="Thmproposition4.p1.m3"><semantics><mi>g</mi><annotation encoding="application/x-tex">g</annotation><annotation encoding="application/x-llamapun">italic_g</annotation></semantics></math> be locally integrable. Then the convolution <math alttext="f*g" class="ltx_Math" display="inline" id="Thmproposition4.p1.m4"><semantics><mrow><mi>f</mi><mo lspace="0.222em" rspace="0.222em">âˆ—</mo><mi>g</mi></mrow><annotation encoding="application/x-tex">f*g</annotation><annotation encoding="application/x-llamapun">italic_f âˆ— italic_g</annotation></semantics></math> defined by</span></p>
<table class="ltx_equation ltx_eqn_table" id="S2.E135">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="(f*g)(\bm{\xi})\doteq\int_{\mathbb{R}^{D}}f(\bm{u})g(\bm{\xi}-\bm{u})~{}\mathrm{d}\bm{u}" class="ltx_Math" display="block" id="S2.E135.m1"><semantics><mrow><mrow><mrow><mo stretchy="false">(</mo><mrow><mi>f</mi><mo lspace="0.222em" rspace="0.222em">âˆ—</mo><mi>g</mi></mrow><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo rspace="0.111em">â‰</mo><mrow><msub><mo>âˆ«</mo><msup><mi>â„</mi><mi>D</mi></msup></msub><mrow><mi>f</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğ’–</mi><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mi>g</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mi>ğ’–</mi></mrow><mo stretchy="false">)</mo></mrow><mo lspace="0.330em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><mi>ğ’–</mi></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">(f*g)(\bm{\xi})\doteq\int_{\mathbb{R}^{D}}f(\bm{u})g(\bm{\xi}-\bm{u})~{}\mathrm{d}\bm{u}</annotation><annotation encoding="application/x-llamapun">( italic_f âˆ— italic_g ) ( bold_italic_Î¾ ) â‰ âˆ« start_POSTSUBSCRIPT blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT end_POSTSUBSCRIPT italic_f ( bold_italic_u ) italic_g ( bold_italic_Î¾ - bold_italic_u ) roman_d bold_italic_u</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.135)</span></td>
</tr></tbody>
</table>
<p class="ltx_p"><span class="ltx_text ltx_font_italic">is <math alttext="k" class="ltx_Math" display="inline" id="Thmproposition4.p1.m5"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation><annotation encoding="application/x-llamapun">italic_k</annotation></semantics></math>-times continuously differentiable, and its derivative of order <math alttext="k" class="ltx_Math" display="inline" id="Thmproposition4.p1.m6"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation><annotation encoding="application/x-llamapun">italic_k</annotation></semantics></math> is</span></p>
<table class="ltx_equation ltx_eqn_table" id="S2.E136">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\nabla^{k}(f*g)=(\nabla^{k}f)*g." class="ltx_Math" display="block" id="S2.E136.m1"><semantics><mrow><mrow><mrow><msup><mo>âˆ‡</mo><mi>k</mi></msup><mrow><mo stretchy="false">(</mo><mrow><mi>f</mi><mo lspace="0.222em" rspace="0.222em">âˆ—</mo><mi>g</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mo stretchy="false">(</mo><mrow><msup><mo rspace="0.167em">âˆ‡</mo><mi>k</mi></msup><mi>f</mi></mrow><mo rspace="0.055em" stretchy="false">)</mo></mrow><mo rspace="0.222em">âˆ—</mo><mi>g</mi></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">\nabla^{k}(f*g)=(\nabla^{k}f)*g.</annotation><annotation encoding="application/x-llamapun">âˆ‡ start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT ( italic_f âˆ— italic_g ) = ( âˆ‡ start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT italic_f ) âˆ— italic_g .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.136)</span></td>
</tr></tbody>
</table>
</div>
</div>
<div class="ltx_para" id="S2.SS3.SSSx6.p4">
<p class="ltx_p">Although not in the book, a simple integration by parts argument shows that if <math alttext="g" class="ltx_Math" display="inline" id="S2.SS3.SSSx6.p4.m1"><semantics><mi>g</mi><annotation encoding="application/x-tex">g</annotation><annotation encoding="application/x-llamapun">italic_g</annotation></semantics></math> is also <math alttext="k" class="ltx_Math" display="inline" id="S2.SS3.SSSx6.p4.m2"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation><annotation encoding="application/x-llamapun">italic_k</annotation></semantics></math>-times differentiable, then we can â€œtrade offâ€ the regularity:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E137">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\nabla^{k}(f*g)=f*(\nabla^{k}g)." class="ltx_Math" display="block" id="S2.E137.m1"><semantics><mrow><mrow><mrow><msup><mo>âˆ‡</mo><mi>k</mi></msup><mrow><mo stretchy="false">(</mo><mrow><mi>f</mi><mo lspace="0.222em" rspace="0.222em">âˆ—</mo><mi>g</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mi>f</mi><mo lspace="0.222em" rspace="0.222em">âˆ—</mo><mrow><mo stretchy="false">(</mo><mrow><msup><mo rspace="0.167em">âˆ‡</mo><mi>k</mi></msup><mi>g</mi></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">\nabla^{k}(f*g)=f*(\nabla^{k}g).</annotation><annotation encoding="application/x-llamapun">âˆ‡ start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT ( italic_f âˆ— italic_g ) = italic_f âˆ— ( âˆ‡ start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT italic_g ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.2.137)</span></td>
</tr></tbody>
</table>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">B.3 </span>Lossy Coding and Sphere Packing</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p">In this section, we prove <a class="ltx_ref" href="Ch3.html#Thmtheorem6" title="Theorem 3.6. â€£ 3.3.2 Rate Distortion and Data Geometry â€£ 3.3 Compression via Lossy Coding â€£ Chapter 3 Pursuing Low-Dimensional Distributions via Lossy Compression â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Theorem</span>Â <span class="ltx_text ltx_ref_tag">3.6</span></a>.
Following our conventions throughout this appendix, we write <math alttext="\mathcal{S}=\operatorname{Supp}(\bm{x})" class="ltx_Math" display="inline" id="S3.p1.m1"><semantics><mrow><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mo>=</mo><mrow><mi>Supp</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><mi>ğ’™</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\mathcal{S}=\operatorname{Supp}(\bm{x})</annotation><annotation encoding="application/x-llamapun">caligraphic_S = roman_Supp ( bold_italic_x )</annotation></semantics></math>
for the compact support of the random variable <math alttext="\bm{x}" class="ltx_Math" display="inline" id="S3.p1.m2"><semantics><mi>ğ’™</mi><annotation encoding="application/x-tex">\bm{x}</annotation><annotation encoding="application/x-llamapun">bold_italic_x</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.p2">
<p class="ltx_p">As foreshadowed, we will make a regularity assumption on the support set <math alttext="\mathcal{S}" class="ltx_Math" display="inline" id="S3.p2.m1"><semantics><mi class="ltx_font_mathcaligraphic">ğ’®</mi><annotation encoding="application/x-tex">\mathcal{S}</annotation><annotation encoding="application/x-llamapun">caligraphic_S</annotation></semantics></math>
to prove <a class="ltx_ref" href="Ch3.html#Thmtheorem6" title="Theorem 3.6. â€£ 3.3.2 Rate Distortion and Data Geometry â€£ 3.3 Compression via Lossy Coding â€£ Chapter 3 Pursuing Low-Dimensional Distributions via Lossy Compression â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Theorem</span>Â <span class="ltx_text ltx_ref_tag">3.6</span></a>. One possibility for
proceeding under minimal assumptions would be to instantiate the results of
<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="bib.html#bibx226" title="">RBK18</a>, <a class="ltx_ref" href="bib.html#bibx227" title="">RKB23</a>]</cite> in our setting, since these results apply
to sets <math alttext="\mathcal{S}" class="ltx_Math" display="inline" id="S3.p2.m2"><semantics><mi class="ltx_font_mathcaligraphic">ğ’®</mi><annotation encoding="application/x-tex">\mathcal{S}</annotation><annotation encoding="application/x-llamapun">caligraphic_S</annotation></semantics></math> with very low regularity (e.g., Cantor-like sets with fractal
structure). However, we have found precisely computing the constants in these
results, a necessary endeavor to assert a conclusion like
<a class="ltx_ref" href="Ch3.html#Thmtheorem6" title="Theorem 3.6. â€£ 3.3.2 Rate Distortion and Data Geometry â€£ 3.3 Compression via Lossy Coding â€£ Chapter 3 Pursuing Low-Dimensional Distributions via Lossy Compression â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Theorem</span>Â <span class="ltx_text ltx_ref_tag">3.6</span></a>, to be somewhat onerous in our
setting.
Our approach is therefore to add a geometric regularity assumption on
the set <math alttext="\mathcal{S}" class="ltx_Math" display="inline" id="S3.p2.m3"><semantics><mi class="ltx_font_mathcaligraphic">ğ’®</mi><annotation encoding="application/x-tex">\mathcal{S}</annotation><annotation encoding="application/x-llamapun">caligraphic_S</annotation></semantics></math> that sacrifices some generality, but allows us to develop
a more transparent argument. To avoid sacrificing too much generality, we must
ensure that low-dimensionality in the set <math alttext="\mathcal{S}" class="ltx_Math" display="inline" id="S3.p2.m4"><semantics><mi class="ltx_font_mathcaligraphic">ğ’®</mi><annotation encoding="application/x-tex">\mathcal{S}</annotation><annotation encoding="application/x-llamapun">caligraphic_S</annotation></semantics></math> is not prohibited.
We therefore consider the running example we have used throughout the book, the
mixture of low-rank Gaussian distributions. In this geometric setting, we will
enforce this via assuming that <math alttext="\mathcal{S}" class="ltx_Math" display="inline" id="S3.p2.m5"><semantics><mi class="ltx_font_mathcaligraphic">ğ’®</mi><annotation encoding="application/x-tex">\mathcal{S}</annotation><annotation encoding="application/x-llamapun">caligraphic_S</annotation></semantics></math> is a union of hyperspheres, which is
equivalent to the Gaussian assumption in high dimensions with overwhelming
probability.</p>
</div>
<div class="ltx_theorem ltx_theorem_assumption" id="Thmassumption3">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold">Assumption B.3</span></span><span class="ltx_text ltx_font_bold">.</span>
</h6>
<div class="ltx_para" id="Thmassumption3.p1">
<p class="ltx_p">The support <math alttext="\mathcal{S}\subset\mathbb{R}^{D}" class="ltx_Math" display="inline" id="Thmassumption3.p1.m1"><semantics><mrow><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mo>âŠ‚</mo><msup><mi>â„</mi><mi>D</mi></msup></mrow><annotation encoding="application/x-tex">\mathcal{S}\subset\mathbb{R}^{D}</annotation><annotation encoding="application/x-llamapun">caligraphic_S âŠ‚ blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT</annotation></semantics></math> of the random variable <math alttext="\bm{x}" class="ltx_Math" display="inline" id="Thmassumption3.p1.m2"><semantics><mi>ğ’™</mi><annotation encoding="application/x-tex">\bm{x}</annotation><annotation encoding="application/x-llamapun">bold_italic_x</annotation></semantics></math> is a finite
union of <math alttext="K" class="ltx_Math" display="inline" id="Thmassumption3.p1.m3"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation><annotation encoding="application/x-llamapun">italic_K</annotation></semantics></math> spheres, each with dimension <math alttext="d_{k}" class="ltx_Math" display="inline" id="Thmassumption3.p1.m4"><semantics><msub><mi>d</mi><mi>k</mi></msub><annotation encoding="application/x-tex">d_{k}</annotation><annotation encoding="application/x-llamapun">italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="k\in[K]" class="ltx_Math" display="inline" id="Thmassumption3.p1.m5"><semantics><mrow><mi>k</mi><mo>âˆˆ</mo><mrow><mo stretchy="false">[</mo><mi>K</mi><mo stretchy="false">]</mo></mrow></mrow><annotation encoding="application/x-tex">k\in[K]</annotation><annotation encoding="application/x-llamapun">italic_k âˆˆ [ italic_K ]</annotation></semantics></math>.
The probability that <math alttext="\bm{x}" class="ltx_Math" display="inline" id="Thmassumption3.p1.m6"><semantics><mi>ğ’™</mi><annotation encoding="application/x-tex">\bm{x}</annotation><annotation encoding="application/x-llamapun">bold_italic_x</annotation></semantics></math> is drawn from the <math alttext="k" class="ltx_Math" display="inline" id="Thmassumption3.p1.m7"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation><annotation encoding="application/x-llamapun">italic_k</annotation></semantics></math>-th sphere is given by
<math alttext="\pi_{k}\in[0,1]" class="ltx_Math" display="inline" id="Thmassumption3.p1.m8"><semantics><mrow><msub><mi>Ï€</mi><mi>k</mi></msub><mo>âˆˆ</mo><mrow><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></mrow><annotation encoding="application/x-tex">\pi_{k}\in[0,1]</annotation><annotation encoding="application/x-llamapun">italic_Ï€ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT âˆˆ [ 0 , 1 ]</annotation></semantics></math>, and conditional on being drawn from the <math alttext="k" class="ltx_Math" display="inline" id="Thmassumption3.p1.m9"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation><annotation encoding="application/x-llamapun">italic_k</annotation></semantics></math>-th sphere,
<math alttext="\bm{x}" class="ltx_Math" display="inline" id="Thmassumption3.p1.m10"><semantics><mi>ğ’™</mi><annotation encoding="application/x-tex">\bm{x}</annotation><annotation encoding="application/x-llamapun">bold_italic_x</annotation></semantics></math> is uniformly distributed on that sphere.
The supports satisfy that each sphere is mutually orthogonal with all
others.
</p>
</div>
</div>
<div class="ltx_para" id="S3.p3">
<p class="ltx_p">We proceed under the simplifying <a class="ltx_ref" href="#Thmassumption3" title="Assumption B.3. â€£ B.3 Lossy Coding and Sphere Packing â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Assumption</span>Â <span class="ltx_text ltx_ref_tag">B.3</span></a> in order to
simplify excessive technicality, and to connect to an important running example
used throughout the monograph. We believe our results can be generalized to
support <math alttext="\mathcal{S}" class="ltx_Math" display="inline" id="S3.p3.m1"><semantics><mi class="ltx_font_mathcaligraphic">ğ’®</mi><annotation encoding="application/x-tex">\mathcal{S}</annotation><annotation encoding="application/x-llamapun">caligraphic_S</annotation></semantics></math> from the class of <span class="ltx_text ltx_font_italic">sets with positive reach</span> with
additional technical effort, but leave this for the future.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.3.1 </span>Proof of Relationship Between Rate Distortion and Covering</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p">We briefly sketch the proof, then proceed to establishing three fundamental
lemmas, then give the proof. The proof will depend on notions introduced in the
sketch below.</p>
</div>
<div class="ltx_para" id="S3.SS1.p2">
<p class="ltx_p">Obtaining an upper bound on the rate distortion function
(<a class="ltx_ref" href="Ch3.html#S3.E3" title="Equation 3.3.3 â€£ 3.3.2 Rate Distortion and Data Geometry â€£ 3.3 Compression via Lossy Coding â€£ Chapter 3 Pursuing Low-Dimensional Distributions via Lossy Compression â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">3.3.3</span></a>) is straightforward: by the rate
characterization (i.e., the rate distortion function is the minimum rate of
a code for <math alttext="\bm{x}" class="ltx_Math" display="inline" id="S3.SS1.p2.m1"><semantics><mi>ğ’™</mi><annotation encoding="application/x-tex">\bm{x}</annotation><annotation encoding="application/x-llamapun">bold_italic_x</annotation></semantics></math> with expected squared <math alttext="\ell^{2}" class="ltx_Math" display="inline" id="S3.SS1.p2.m2"><semantics><msup><mi mathvariant="normal">â„“</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\ell^{2}</annotation><annotation encoding="application/x-llamapun">roman_â„“ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math> distortion <math alttext="\epsilon" class="ltx_Math" display="inline" id="S3.SS1.p2.m3"><semantics><mi>Ïµ</mi><annotation encoding="application/x-tex">\epsilon</annotation><annotation encoding="application/x-llamapun">italic_Ïµ</annotation></semantics></math>), upper
bounding <math alttext="\mathcal{R}_{\epsilon}(\bm{x})" class="ltx_Math" display="inline" id="S3.SS1.p2.m4"><semantics><mrow><msub><mi class="ltx_font_mathcaligraphic">â„›</mi><mi>Ïµ</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğ’™</mi><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathcal{R}_{\epsilon}(\bm{x})</annotation><annotation encoding="application/x-llamapun">caligraphic_R start_POSTSUBSCRIPT italic_Ïµ end_POSTSUBSCRIPT ( bold_italic_x )</annotation></semantics></math> only requires demonstrating one code for <math alttext="\bm{x}" class="ltx_Math" display="inline" id="S3.SS1.p2.m5"><semantics><mi>ğ’™</mi><annotation encoding="application/x-tex">\bm{x}</annotation><annotation encoding="application/x-llamapun">bold_italic_x</annotation></semantics></math> that
achieves this target distortion, and any <math alttext="\epsilon" class="ltx_Math" display="inline" id="S3.SS1.p2.m6"><semantics><mi>Ïµ</mi><annotation encoding="application/x-tex">\epsilon</annotation><annotation encoding="application/x-llamapun">italic_Ïµ</annotation></semantics></math>-covering of <math alttext="\operatorname{Supp}(\bm{x})" class="ltx_Math" display="inline" id="S3.SS1.p2.m7"><semantics><mrow><mi>Supp</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><mi>ğ’™</mi><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">\operatorname{Supp}(\bm{x})</annotation><annotation encoding="application/x-llamapun">roman_Supp ( bold_italic_x )</annotation></semantics></math>
achieves this, with rate equal to the base-<math alttext="2" class="ltx_Math" display="inline" id="S3.SS1.p2.m8"><semantics><mn>2</mn><annotation encoding="application/x-tex">2</annotation><annotation encoding="application/x-llamapun">2</annotation></semantics></math> logarithm of the cardinality of
the covering.
The lower bound is more subtle. We make use of the Shannon lower bound,
discussed in <a class="ltx_ref" href="Ch3.html#Thmremark7" title="Remark 3.7. â€£ 3.3.2 Rate Distortion and Data Geometry â€£ 3.3 Compression via Lossy Coding â€£ Chapter 3 Pursuing Low-Dimensional Distributions via Lossy Compression â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Remark</span>Â <span class="ltx_text ltx_ref_tag">3.7</span></a>: working out the constants in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="bib.html#bibx163" title="">LZ94</a>, Â§III,
(22)]</cite> gives a more precise version of the result quoted in
<a class="ltx_ref" href="Ch3.html#S3.E10" title="In Remark 3.7. â€£ 3.3.2 Rate Distortion and Data Geometry â€£ 3.3 Compression via Lossy Coding â€£ Chapter 3 Pursuing Low-Dimensional Distributions via Lossy Compression â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Equation</span>Â <span class="ltx_text ltx_ref_tag">3.3.10</span></a> (in bits, of course): for any random variable <math alttext="\bm{x}" class="ltx_Math" display="inline" id="S3.SS1.p2.m9"><semantics><mi>ğ’™</mi><annotation encoding="application/x-tex">\bm{x}</annotation><annotation encoding="application/x-llamapun">bold_italic_x</annotation></semantics></math> with compact
support and a density, it holds</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{R}_{\epsilon}(\bm{x})\geq h(\bm{x})-\log\operatorname{vol}(B_{\epsilon})+\log\left(\frac{2}{D\Gamma(D/2)}\left(\frac{D}{2e}\right)^{D/2}\right)," class="ltx_Math" display="block" id="S3.E1.m1"><semantics><mrow><mrow><mrow><msub><mi class="ltx_font_mathcaligraphic">â„›</mi><mi>Ïµ</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğ’™</mi><mo stretchy="false">)</mo></mrow></mrow><mo>â‰¥</mo><mrow><mrow><mrow><mi>h</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğ’™</mi><mo stretchy="false">)</mo></mrow></mrow><mo>âˆ’</mo><mrow><mi>log</mi><mo lspace="0.167em">â¡</mo><mrow><mi>vol</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><msub><mi>B</mi><mi>Ïµ</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow><mo>+</mo><mrow><mi>log</mi><mo>â¡</mo><mrow><mo>(</mo><mrow><mfrac><mn>2</mn><mrow><mi>D</mi><mo lspace="0em" rspace="0em">â€‹</mo><mi mathvariant="normal">Î“</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mi>D</mi><mo>/</mo><mn>2</mn></mrow><mo stretchy="false">)</mo></mrow></mrow></mfrac><mo lspace="0em" rspace="0em">â€‹</mo><msup><mrow><mo>(</mo><mfrac><mi>D</mi><mrow><mn>2</mn><mo lspace="0em" rspace="0em">â€‹</mo><mi>e</mi></mrow></mfrac><mo>)</mo></mrow><mrow><mi>D</mi><mo>/</mo><mn>2</mn></mrow></msup></mrow><mo>)</mo></mrow></mrow></mrow></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">\mathcal{R}_{\epsilon}(\bm{x})\geq h(\bm{x})-\log\operatorname{vol}(B_{\epsilon})+\log\left(\frac{2}{D\Gamma(D/2)}\left(\frac{D}{2e}\right)^{D/2}\right),</annotation><annotation encoding="application/x-llamapun">caligraphic_R start_POSTSUBSCRIPT italic_Ïµ end_POSTSUBSCRIPT ( bold_italic_x ) â‰¥ italic_h ( bold_italic_x ) - roman_log roman_vol ( italic_B start_POSTSUBSCRIPT italic_Ïµ end_POSTSUBSCRIPT ) + roman_log ( divide start_ARG 2 end_ARG start_ARG italic_D roman_Î“ ( italic_D / 2 ) end_ARG ( divide start_ARG italic_D end_ARG start_ARG 2 italic_e end_ARG ) start_POSTSUPERSCRIPT italic_D / 2 end_POSTSUPERSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.3.1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">with entropy (etc.) in nats in this expression.
The constant can be easily estimated using Stirlingâ€™s approximation.
A quantitative form of Stirlingâ€™s approximation which is often useful gives
for any <math alttext="x&gt;0" class="ltx_Math" display="inline" id="S3.SS1.p2.m10"><semantics><mrow><mi>x</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">x&gt;0</annotation><annotation encoding="application/x-llamapun">italic_x &gt; 0</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="bib.html#bibx122" title="">Jam15</a>]</cite></p>
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\Gamma(x)\leq\sqrt{2\pi}x^{x-1/2}e^{-x}e^{1/(12x)}." class="ltx_Math" display="block" id="S3.E2.m1"><semantics><mrow><mrow><mrow><mi mathvariant="normal">Î“</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mrow><mo>â‰¤</mo><mrow><msqrt><mrow><mn>2</mn><mo lspace="0em" rspace="0em">â€‹</mo><mi>Ï€</mi></mrow></msqrt><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>x</mi><mrow><mi>x</mi><mo>âˆ’</mo><mrow><mn>1</mn><mo>/</mo><mn>2</mn></mrow></mrow></msup><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>e</mi><mrow><mo>âˆ’</mo><mi>x</mi></mrow></msup><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>e</mi><mrow><mn>1</mn><mo>/</mo><mrow><mo stretchy="false">(</mo><mrow><mn>12</mn><mo lspace="0em" rspace="0em">â€‹</mo><mi>x</mi></mrow><mo stretchy="false">)</mo></mrow></mrow></msup></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">\Gamma(x)\leq\sqrt{2\pi}x^{x-1/2}e^{-x}e^{1/(12x)}.</annotation><annotation encoding="application/x-llamapun">roman_Î“ ( italic_x ) â‰¤ square-root start_ARG 2 italic_Ï€ end_ARG italic_x start_POSTSUPERSCRIPT italic_x - 1 / 2 end_POSTSUPERSCRIPT italic_e start_POSTSUPERSCRIPT - italic_x end_POSTSUPERSCRIPT italic_e start_POSTSUPERSCRIPT 1 / ( 12 italic_x ) end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.3.2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">We will apply this bound to <math alttext="\Gamma(D/2)" class="ltx_Math" display="inline" id="S3.SS1.p2.m11"><semantics><mrow><mi mathvariant="normal">Î“</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mi>D</mi><mo>/</mo><mn>2</mn></mrow><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">\Gamma(D/2)</annotation><annotation encoding="application/x-llamapun">roman_Î“ ( italic_D / 2 )</annotation></semantics></math> in <a class="ltx_ref" href="#S3.E1" title="In B.3.1 Proof of Relationship Between Rate Distortion and Covering â€£ B.3 Lossy Coding and Sphere Packing â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Equation</span>Â <span class="ltx_text ltx_ref_tag">B.3.1</span></a>.
We get</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S3.EGx148">
<tbody id="S3.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\log\left(\frac{2}{D\Gamma(D/2)}\left(\frac{D}{2e}\right)^{D/2}\right)" class="ltx_Math" display="inline" id="S3.E3.m1"><semantics><mrow><mi>log</mi><mo>â¡</mo><mrow><mo>(</mo><mrow><mstyle displaystyle="true"><mfrac><mn>2</mn><mrow><mi>D</mi><mo lspace="0em" rspace="0em">â€‹</mo><mi mathvariant="normal">Î“</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mi>D</mi><mo>/</mo><mn>2</mn></mrow><mo stretchy="false">)</mo></mrow></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em">â€‹</mo><msup><mrow><mo>(</mo><mstyle displaystyle="true"><mfrac><mi>D</mi><mrow><mn>2</mn><mo lspace="0em" rspace="0em">â€‹</mo><mi>e</mi></mrow></mfrac></mstyle><mo>)</mo></mrow><mrow><mi>D</mi><mo>/</mo><mn>2</mn></mrow></msup></mrow><mo>)</mo></mrow></mrow><annotation encoding="application/x-tex">\displaystyle\log\left(\frac{2}{D\Gamma(D/2)}\left(\frac{D}{2e}\right)^{D/2}\right)</annotation><annotation encoding="application/x-llamapun">roman_log ( divide start_ARG 2 end_ARG start_ARG italic_D roman_Î“ ( italic_D / 2 ) end_ARG ( divide start_ARG italic_D end_ARG start_ARG 2 italic_e end_ARG ) start_POSTSUPERSCRIPT italic_D / 2 end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\geq-\frac{1}{6D}+\log\left(\frac{2}{D}\left(\frac{D}{2e}\right)^{D/2}\cdot\sqrt{\frac{D}{4\pi}}\left(\frac{D}{2e}\right)^{-D/2}\right)" class="ltx_Math" display="inline" id="S3.E3.m2"><semantics><mrow><mi></mi><mo>â‰¥</mo><mrow><mrow><mo>âˆ’</mo><mstyle displaystyle="true"><mfrac><mn>1</mn><mrow><mn>6</mn><mo lspace="0em" rspace="0em">â€‹</mo><mi>D</mi></mrow></mfrac></mstyle></mrow><mo>+</mo><mrow><mi>log</mi><mo>â¡</mo><mrow><mo>(</mo><mrow><mrow><mrow><mstyle displaystyle="true"><mfrac><mn>2</mn><mi>D</mi></mfrac></mstyle><mo lspace="0em" rspace="0em">â€‹</mo><msup><mrow><mo>(</mo><mstyle displaystyle="true"><mfrac><mi>D</mi><mrow><mn>2</mn><mo lspace="0em" rspace="0em">â€‹</mo><mi>e</mi></mrow></mfrac></mstyle><mo rspace="0.055em">)</mo></mrow><mrow><mi>D</mi><mo>/</mo><mn>2</mn></mrow></msup></mrow><mo rspace="0.222em">â‹…</mo><msqrt><mstyle displaystyle="true"><mfrac><mi>D</mi><mrow><mn>4</mn><mo lspace="0em" rspace="0em">â€‹</mo><mi>Ï€</mi></mrow></mfrac></mstyle></msqrt></mrow><mo lspace="0em" rspace="0em">â€‹</mo><msup><mrow><mo>(</mo><mstyle displaystyle="true"><mfrac><mi>D</mi><mrow><mn>2</mn><mo lspace="0em" rspace="0em">â€‹</mo><mi>e</mi></mrow></mfrac></mstyle><mo>)</mo></mrow><mrow><mo>âˆ’</mo><mrow><mi>D</mi><mo>/</mo><mn>2</mn></mrow></mrow></msup></mrow><mo>)</mo></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle\geq-\frac{1}{6D}+\log\left(\frac{2}{D}\left(\frac{D}{2e}\right)^{D/2}\cdot\sqrt{\frac{D}{4\pi}}\left(\frac{D}{2e}\right)^{-D/2}\right)</annotation><annotation encoding="application/x-llamapun">â‰¥ - divide start_ARG 1 end_ARG start_ARG 6 italic_D end_ARG + roman_log ( divide start_ARG 2 end_ARG start_ARG italic_D end_ARG ( divide start_ARG italic_D end_ARG start_ARG 2 italic_e end_ARG ) start_POSTSUPERSCRIPT italic_D / 2 end_POSTSUPERSCRIPT â‹… square-root start_ARG divide start_ARG italic_D end_ARG start_ARG 4 italic_Ï€ end_ARG end_ARG ( divide start_ARG italic_D end_ARG start_ARG 2 italic_e end_ARG ) start_POSTSUPERSCRIPT - italic_D / 2 end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.3.3)</span></td>
</tr></tbody>
<tbody id="S3.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=-\frac{1}{6D}-\frac{1}{2}\log D\pi," class="ltx_Math" display="inline" id="S3.E4.m1"><semantics><mrow><mrow><mi></mi><mo>=</mo><mrow><mrow><mo>âˆ’</mo><mstyle displaystyle="true"><mfrac><mn>1</mn><mrow><mn>6</mn><mo lspace="0em" rspace="0em">â€‹</mo><mi>D</mi></mrow></mfrac></mstyle></mrow><mo>âˆ’</mo><mrow><mstyle displaystyle="true"><mfrac><mn>1</mn><mn>2</mn></mfrac></mstyle><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mi>log</mi><mo lspace="0.167em">â¡</mo><mrow><mi>D</mi><mo lspace="0em" rspace="0em">â€‹</mo><mi>Ï€</mi></mrow></mrow></mrow></mrow></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">\displaystyle=-\frac{1}{6D}-\frac{1}{2}\log D\pi,</annotation><annotation encoding="application/x-llamapun">= - divide start_ARG 1 end_ARG start_ARG 6 italic_D end_ARG - divide start_ARG 1 end_ARG start_ARG 2 end_ARG roman_log italic_D italic_Ï€ ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.3.4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">which we can take for the explicit value of the constant <math alttext="C_{D}" class="ltx_Math" display="inline" id="S3.SS1.p2.m12"><semantics><msub><mi>C</mi><mi>D</mi></msub><annotation encoding="application/x-tex">C_{D}</annotation><annotation encoding="application/x-llamapun">italic_C start_POSTSUBSCRIPT italic_D end_POSTSUBSCRIPT</annotation></semantics></math> in <a class="ltx_ref" href="Ch3.html#S3.E10" title="In Remark 3.7. â€£ 3.3.2 Rate Distortion and Data Geometry â€£ 3.3 Compression via Lossy Coding â€£ Chapter 3 Pursuing Low-Dimensional Distributions via Lossy Compression â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Equation</span>Â <span class="ltx_text ltx_ref_tag">3.3.10</span></a>.
Summarizing the fully quantified Shannon lower bound (in bits):</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{R}_{\epsilon}(\bm{x})\geq h(\bm{x})-\log_{2}\operatorname{vol}(B_{\epsilon})-O(\log D)." class="ltx_Math" display="block" id="S3.E5.m1"><semantics><mrow><mrow><mrow><msub><mi class="ltx_font_mathcaligraphic">â„›</mi><mi>Ïµ</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğ’™</mi><mo stretchy="false">)</mo></mrow></mrow><mo>â‰¥</mo><mrow><mrow><mi>h</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğ’™</mi><mo stretchy="false">)</mo></mrow></mrow><mo>âˆ’</mo><mrow><msub><mi>log</mi><mn>2</mn></msub><mo lspace="0.167em">â¡</mo><mrow><mi>vol</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><msub><mi>B</mi><mi>Ïµ</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>âˆ’</mo><mrow><mi>O</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mi>log</mi><mo lspace="0.167em">â¡</mo><mi>D</mi></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">\mathcal{R}_{\epsilon}(\bm{x})\geq h(\bm{x})-\log_{2}\operatorname{vol}(B_{\epsilon})-O(\log D).</annotation><annotation encoding="application/x-llamapun">caligraphic_R start_POSTSUBSCRIPT italic_Ïµ end_POSTSUBSCRIPT ( bold_italic_x ) â‰¥ italic_h ( bold_italic_x ) - roman_log start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT roman_vol ( italic_B start_POSTSUBSCRIPT italic_Ïµ end_POSTSUBSCRIPT ) - italic_O ( roman_log italic_D ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.3.5)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS1.p3">
<p class="ltx_p">Now, the important constraint for our current purposes is that the Shannon lower
bound requires the random variable <math alttext="\bm{x}" class="ltx_Math" display="inline" id="S3.SS1.p3.m1"><semantics><mi>ğ’™</mi><annotation encoding="application/x-tex">\bm{x}</annotation><annotation encoding="application/x-llamapun">bold_italic_x</annotation></semantics></math> to have a density, which rules out many
low-dimensional distributions of interest.
But let us momentarily consider the situation when <math alttext="\bm{x}" class="ltx_Math" display="inline" id="S3.SS1.p3.m2"><semantics><mi>ğ’™</mi><annotation encoding="application/x-tex">\bm{x}</annotation><annotation encoding="application/x-llamapun">bold_italic_x</annotation></semantics></math> does admit a density.
The assumption that <math alttext="\bm{x}" class="ltx_Math" display="inline" id="S3.SS1.p3.m3"><semantics><mi>ğ’™</mi><annotation encoding="application/x-tex">\bm{x}</annotation><annotation encoding="application/x-llamapun">bold_italic_x</annotation></semantics></math> is uniformly distributed on its support is easily
formalized in this setting: for any Borel set <math alttext="A\subset\mathcal{S}" class="ltx_Math" display="inline" id="S3.SS1.p3.m4"><semantics><mrow><mi>A</mi><mo>âŠ‚</mo><mi class="ltx_font_mathcaligraphic">ğ’®</mi></mrow><annotation encoding="application/x-tex">A\subset\mathcal{S}</annotation><annotation encoding="application/x-llamapun">italic_A âŠ‚ caligraphic_S</annotation></semantics></math>, we have</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\operatorname{\mathbb{P}}[\bm{x}\in A]=\int_{A}\frac{1}{\operatorname{vol}(\mathcal{S})}~{}\mathrm{d}\bm{x}." class="ltx_Math" display="block" id="S3.E6.m1"><semantics><mrow><mrow><mrow><mi>â„™</mi><mo>â¡</mo><mrow><mo stretchy="false">[</mo><mrow><mi>ğ’™</mi><mo>âˆˆ</mo><mi>A</mi></mrow><mo stretchy="false">]</mo></mrow></mrow><mo rspace="0.111em">=</mo><mrow><msub><mo>âˆ«</mo><mi>A</mi></msub><mrow><mfrac><mn>1</mn><mrow><mi>vol</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mo stretchy="false">)</mo></mrow></mrow></mfrac><mo lspace="0.330em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><mi>ğ’™</mi></mrow></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">\operatorname{\mathbb{P}}[\bm{x}\in A]=\int_{A}\frac{1}{\operatorname{vol}(\mathcal{S})}~{}\mathrm{d}\bm{x}.</annotation><annotation encoding="application/x-llamapun">blackboard_P [ bold_italic_x âˆˆ italic_A ] = âˆ« start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT divide start_ARG 1 end_ARG start_ARG roman_vol ( caligraphic_S ) end_ARG roman_d bold_italic_x .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.3.6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">Then the entropy <math alttext="h(\bm{x})" class="ltx_Math" display="inline" id="S3.SS1.p3.m5"><semantics><mrow><mi>h</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğ’™</mi><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">h(\bm{x})</annotation><annotation encoding="application/x-llamapun">italic_h ( bold_italic_x )</annotation></semantics></math> is just</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="h(\bm{x})=\log_{2}\operatorname{vol}(\mathcal{S})." class="ltx_Math" display="block" id="S3.E7.m1"><semantics><mrow><mrow><mrow><mi>h</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğ’™</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><msub><mi>log</mi><mn>2</mn></msub><mo lspace="0.167em">â¡</mo><mrow><mi>vol</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">h(\bm{x})=\log_{2}\operatorname{vol}(\mathcal{S}).</annotation><annotation encoding="application/x-llamapun">italic_h ( bold_italic_x ) = roman_log start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT roman_vol ( caligraphic_S ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.3.7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">The proof then concludes with a lemma that relates the ratio <math alttext="\operatorname{vol}(\mathcal{S})/\operatorname{vol}(B_{\epsilon})" class="ltx_Math" display="inline" id="S3.SS1.p3.m6"><semantics><mrow><mrow><mi>vol</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mo stretchy="false">)</mo></mrow></mrow><mo>/</mo><mrow><mi>vol</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><msub><mi>B</mi><mi>Ïµ</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\operatorname{vol}(\mathcal{S})/\operatorname{vol}(B_{\epsilon})</annotation><annotation encoding="application/x-llamapun">roman_vol ( caligraphic_S ) / roman_vol ( italic_B start_POSTSUBSCRIPT italic_Ïµ end_POSTSUBSCRIPT )</annotation></semantics></math> to the <math alttext="\epsilon" class="ltx_Math" display="inline" id="S3.SS1.p3.m7"><semantics><mi>Ïµ</mi><annotation encoding="application/x-tex">\epsilon</annotation><annotation encoding="application/x-llamapun">italic_Ïµ</annotation></semantics></math>-covering number of <math alttext="\mathcal{S}" class="ltx_Math" display="inline" id="S3.SS1.p3.m8"><semantics><mi class="ltx_font_mathcaligraphic">ğ’®</mi><annotation encoding="application/x-tex">\mathcal{S}</annotation><annotation encoding="application/x-llamapun">caligraphic_S</annotation></semantics></math> by
<math alttext="\epsilon" class="ltx_Math" display="inline" id="S3.SS1.p3.m9"><semantics><mi>Ïµ</mi><annotation encoding="application/x-tex">\epsilon</annotation><annotation encoding="application/x-llamapun">italic_Ïµ</annotation></semantics></math> balls.</p>
</div>
<div class="ltx_para" id="S3.SS1.p4">
<p class="ltx_p">To extend the program above to degenerate distributions satisfying
<a class="ltx_ref" href="#Thmassumption3" title="Assumption B.3. â€£ B.3 Lossy Coding and Sphere Packing â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Assumption</span>Â <span class="ltx_text ltx_ref_tag">B.3</span></a>,
our proof of the lower bound in <a class="ltx_ref" href="Ch3.html#Thmtheorem6" title="Theorem 3.6. â€£ 3.3.2 Rate Distortion and Data Geometry â€£ 3.3 Compression via Lossy Coding â€£ Chapter 3 Pursuing Low-Dimensional Distributions via Lossy Compression â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Theorem</span>Â <span class="ltx_text ltx_ref_tag">3.6</span></a> will
leverage an approximation argument of the actual low-dimensional
distribution <math alttext="\bm{x}" class="ltx_Math" display="inline" id="S3.SS1.p4.m1"><semantics><mi>ğ’™</mi><annotation encoding="application/x-tex">\bm{x}</annotation><annotation encoding="application/x-llamapun">bold_italic_x</annotation></semantics></math> by â€œnearbyâ€ low-dimensional distributions which have
densities.
We will then link the parameter introduced in
the approximating sequence to the distortion parameter <math alttext="\epsilon" class="ltx_Math" display="inline" id="S3.SS1.p4.m2"><semantics><mi>Ïµ</mi><annotation encoding="application/x-tex">\epsilon</annotation><annotation encoding="application/x-llamapun">italic_Ïµ</annotation></semantics></math> in order to
obtain the desired conclusion in <a class="ltx_ref" href="Ch3.html#Thmtheorem6" title="Theorem 3.6. â€£ 3.3.2 Rate Distortion and Data Geometry â€£ 3.3 Compression via Lossy Coding â€£ Chapter 3 Pursuing Low-Dimensional Distributions via Lossy Compression â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Theorem</span>Â <span class="ltx_text ltx_ref_tag">3.6</span></a>.</p>
</div>
<div class="ltx_theorem ltx_theorem_definition" id="Thmdefinition1">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold">Definition B.1</span></span><span class="ltx_text ltx_font_bold">.</span>
</h6>
<div class="ltx_para" id="Thmdefinition1.p1">
<p class="ltx_p">Let <math alttext="\mathcal{S}" class="ltx_Math" display="inline" id="Thmdefinition1.p1.m1"><semantics><mi class="ltx_font_mathcaligraphic">ğ’®</mi><annotation encoding="application/x-tex">\mathcal{S}</annotation><annotation encoding="application/x-llamapun">caligraphic_S</annotation></semantics></math> be a compact set.
For any <math alttext="\delta&gt;0" class="ltx_Math" display="inline" id="Thmdefinition1.p1.m2"><semantics><mrow><mi>Î´</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\delta&gt;0</annotation><annotation encoding="application/x-llamapun">italic_Î´ &gt; 0</annotation></semantics></math>, define the <math alttext="\delta" class="ltx_Math" display="inline" id="Thmdefinition1.p1.m3"><semantics><mi>Î´</mi><annotation encoding="application/x-tex">\delta</annotation><annotation encoding="application/x-llamapun">italic_Î´</annotation></semantics></math>-thickening of <math alttext="\mathcal{S}" class="ltx_Math" display="inline" id="Thmdefinition1.p1.m4"><semantics><mi class="ltx_font_mathcaligraphic">ğ’®</mi><annotation encoding="application/x-tex">\mathcal{S}</annotation><annotation encoding="application/x-llamapun">caligraphic_S</annotation></semantics></math>, denoted
<math alttext="\mathcal{S}_{\delta}" class="ltx_Math" display="inline" id="Thmdefinition1.p1.m5"><semantics><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mi>Î´</mi></msub><annotation encoding="application/x-tex">\mathcal{S}_{\delta}</annotation><annotation encoding="application/x-llamapun">caligraphic_S start_POSTSUBSCRIPT italic_Î´ end_POSTSUBSCRIPT</annotation></semantics></math>, by</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{S}_{\delta}=\left\{\bm{\xi}\in\mathbb{R}^{D}\mid\mathrm{dist}(\bm{\xi},\mathcal{S})\leq\delta\right\}." class="ltx_Math" display="block" id="S3.E8.m1"><semantics><mrow><mrow><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mi>Î´</mi></msub><mo>=</mo><mrow><mo>{</mo><mrow><mi>ğƒ</mi><mo>âˆˆ</mo><msup><mi>â„</mi><mi>D</mi></msup></mrow><mo fence="true" lspace="0em" rspace="0em">âˆ£</mo><mrow><mrow><mi>dist</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo>,</mo><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mo stretchy="false">)</mo></mrow></mrow><mo>â‰¤</mo><mi>Î´</mi></mrow><mo>}</mo></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">\mathcal{S}_{\delta}=\left\{\bm{\xi}\in\mathbb{R}^{D}\mid\mathrm{dist}(\bm{\xi},\mathcal{S})\leq\delta\right\}.</annotation><annotation encoding="application/x-llamapun">caligraphic_S start_POSTSUBSCRIPT italic_Î´ end_POSTSUBSCRIPT = { bold_italic_Î¾ âˆˆ blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT âˆ£ roman_dist ( bold_italic_Î¾ , caligraphic_S ) â‰¤ italic_Î´ } .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.3.8)</span></td>
</tr></tbody>
</table>
</div>
</div>
<div class="ltx_para" id="S3.SS1.p5">
<p class="ltx_p">The distance function referenced in <a class="ltx_ref" href="#Thmdefinition1" title="Definition B.1. â€£ B.3.1 Proof of Relationship Between Rate Distortion and Covering â€£ B.3 Lossy Coding and Sphere Packing â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Definition</span>Â <span class="ltx_text ltx_ref_tag">B.1</span></a> is defined by</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\operatorname{dist}(\bm{\xi},\mathcal{S})=\inf_{\bm{\xi}^{\prime}\in\mathcal{S}}\left\|\bm{\xi}-\bm{\xi}^{\prime}\right\|_{2}." class="ltx_Math" display="block" id="S3.E9.m1"><semantics><mrow><mrow><mrow><mi>dist</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo>,</mo><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mo stretchy="false">)</mo></mrow></mrow><mo rspace="0.1389em">=</mo><mrow><munder><mo lspace="0.1389em" movablelimits="false" rspace="0em">inf</mo><mrow><msup><mi>ğƒ</mi><mo>â€²</mo></msup><mo>âˆˆ</mo><mi class="ltx_font_mathcaligraphic">ğ’®</mi></mrow></munder><msub><mrow><mo>â€–</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><msup><mi>ğƒ</mi><mo>â€²</mo></msup></mrow><mo>â€–</mo></mrow><mn>2</mn></msub></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">\operatorname{dist}(\bm{\xi},\mathcal{S})=\inf_{\bm{\xi}^{\prime}\in\mathcal{S}}\left\|\bm{\xi}-\bm{\xi}^{\prime}\right\|_{2}.</annotation><annotation encoding="application/x-llamapun">roman_dist ( bold_italic_Î¾ , caligraphic_S ) = roman_inf start_POSTSUBSCRIPT bold_italic_Î¾ start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT âˆˆ caligraphic_S end_POSTSUBSCRIPT âˆ¥ bold_italic_Î¾ - bold_italic_Î¾ start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.3.9)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">For a compact set <math alttext="\mathcal{S}" class="ltx_Math" display="inline" id="S3.SS1.p5.m1"><semantics><mi class="ltx_font_mathcaligraphic">ğ’®</mi><annotation encoding="application/x-tex">\mathcal{S}</annotation><annotation encoding="application/x-llamapun">caligraphic_S</annotation></semantics></math>, Weierstrassâ€™s theorem implies that for any <math alttext="\bm{\xi}\in\mathbb{R}^{D}" class="ltx_Math" display="inline" id="S3.SS1.p5.m2"><semantics><mrow><mi>ğƒ</mi><mo>âˆˆ</mo><msup><mi>â„</mi><mi>D</mi></msup></mrow><annotation encoding="application/x-tex">\bm{\xi}\in\mathbb{R}^{D}</annotation><annotation encoding="application/x-llamapun">bold_italic_Î¾ âˆˆ blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT</annotation></semantics></math>, there is always some <math alttext="\bm{\xi}^{\prime}\in\mathcal{S}" class="ltx_Math" display="inline" id="S3.SS1.p5.m3"><semantics><mrow><msup><mi>ğƒ</mi><mo>â€²</mo></msup><mo>âˆˆ</mo><mi class="ltx_font_mathcaligraphic">ğ’®</mi></mrow><annotation encoding="application/x-tex">\bm{\xi}^{\prime}\in\mathcal{S}</annotation><annotation encoding="application/x-llamapun">bold_italic_Î¾ start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT âˆˆ caligraphic_S</annotation></semantics></math> attaining the infimum in the distance
function.
Compactness of <math alttext="\mathcal{S}_{\delta}" class="ltx_Math" display="inline" id="S3.SS1.p5.m4"><semantics><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mi>Î´</mi></msub><annotation encoding="application/x-tex">\mathcal{S}_{\delta}</annotation><annotation encoding="application/x-llamapun">caligraphic_S start_POSTSUBSCRIPT italic_Î´ end_POSTSUBSCRIPT</annotation></semantics></math> follows readily from compactness of <math alttext="\mathcal{S}" class="ltx_Math" display="inline" id="S3.SS1.p5.m5"><semantics><mi class="ltx_font_mathcaligraphic">ğ’®</mi><annotation encoding="application/x-tex">\mathcal{S}</annotation><annotation encoding="application/x-llamapun">caligraphic_S</annotation></semantics></math>, so
<math alttext="\operatorname{vol}(\mathcal{S}_{\delta})" class="ltx_Math" display="inline" id="S3.SS1.p5.m6"><semantics><mrow><mi>vol</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mi>Î´</mi></msub><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">\operatorname{vol}(\mathcal{S}_{\delta})</annotation><annotation encoding="application/x-llamapun">roman_vol ( caligraphic_S start_POSTSUBSCRIPT italic_Î´ end_POSTSUBSCRIPT )</annotation></semantics></math> is finite for any <math alttext="\delta&gt;0" class="ltx_Math" display="inline" id="S3.SS1.p5.m7"><semantics><mrow><mi>Î´</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\delta&gt;0</annotation><annotation encoding="application/x-llamapun">italic_Î´ &gt; 0</annotation></semantics></math>. It is then possible to
make the following definition of a thickened random variable, specialized to
<a class="ltx_ref" href="#Thmassumption3" title="Assumption B.3. â€£ B.3 Lossy Coding and Sphere Packing â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Assumption</span>Â <span class="ltx_text ltx_ref_tag">B.3</span></a>.</p>
</div>
<div class="ltx_theorem ltx_theorem_definition" id="Thmdefinition2">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold">Definition B.2</span></span><span class="ltx_text ltx_font_bold">.</span>
</h6>
<div class="ltx_para" id="Thmdefinition2.p1">
<p class="ltx_p">Let <math alttext="\bm{x}" class="ltx_Math" display="inline" id="Thmdefinition2.p1.m1"><semantics><mi>ğ’™</mi><annotation encoding="application/x-tex">\bm{x}</annotation><annotation encoding="application/x-llamapun">bold_italic_x</annotation></semantics></math> be a random variable such that <math alttext="\operatorname{Supp}(\bm{x})=\mathcal{S}" class="ltx_Math" display="inline" id="Thmdefinition2.p1.m2"><semantics><mrow><mrow><mi>Supp</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><mi>ğ’™</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mi class="ltx_font_mathcaligraphic">ğ’®</mi></mrow><annotation encoding="application/x-tex">\operatorname{Supp}(\bm{x})=\mathcal{S}</annotation><annotation encoding="application/x-llamapun">roman_Supp ( bold_italic_x ) = caligraphic_S</annotation></semantics></math> is a union of
<math alttext="K" class="ltx_Math" display="inline" id="Thmdefinition2.p1.m3"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation><annotation encoding="application/x-llamapun">italic_K</annotation></semantics></math> hyperspheres, distributed as in <a class="ltx_ref" href="#Thmassumption3" title="Assumption B.3. â€£ B.3 Lossy Coding and Sphere Packing â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Assumption</span>Â <span class="ltx_text ltx_ref_tag">B.3</span></a>.
Denote the support of each component of the mixture by <math alttext="\mathcal{S}_{k}" class="ltx_Math" display="inline" id="Thmdefinition2.p1.m4"><semantics><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mi>k</mi></msub><annotation encoding="application/x-tex">\mathcal{S}_{k}</annotation><annotation encoding="application/x-llamapun">caligraphic_S start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>.
Define the thickened random variable <math alttext="\bm{x}_{\delta}" class="ltx_Math" display="inline" id="Thmdefinition2.p1.m5"><semantics><msub><mi>ğ’™</mi><mi>Î´</mi></msub><annotation encoding="application/x-tex">\bm{x}_{\delta}</annotation><annotation encoding="application/x-llamapun">bold_italic_x start_POSTSUBSCRIPT italic_Î´ end_POSTSUBSCRIPT</annotation></semantics></math> as the mixture of
measures where each component measure is uniform on the thickened set
<math alttext="\mathcal{S}_{k,\delta}" class="ltx_Math" display="inline" id="Thmdefinition2.p1.m6"><semantics><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mrow><mi>k</mi><mo>,</mo><mi>Î´</mi></mrow></msub><annotation encoding="application/x-tex">\mathcal{S}_{k,\delta}</annotation><annotation encoding="application/x-llamapun">caligraphic_S start_POSTSUBSCRIPT italic_k , italic_Î´ end_POSTSUBSCRIPT</annotation></semantics></math> (<a class="ltx_ref" href="#Thmdefinition1" title="Definition B.1. â€£ B.3.1 Proof of Relationship Between Rate Distortion and Covering â€£ B.3 Lossy Coding and Sphere Packing â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Definition</span>Â <span class="ltx_text ltx_ref_tag">B.1</span></a>), for <math alttext="k\in[K]" class="ltx_Math" display="inline" id="Thmdefinition2.p1.m7"><semantics><mrow><mi>k</mi><mo>âˆˆ</mo><mrow><mo stretchy="false">[</mo><mi>K</mi><mo stretchy="false">]</mo></mrow></mrow><annotation encoding="application/x-tex">k\in[K]</annotation><annotation encoding="application/x-llamapun">italic_k âˆˆ [ italic_K ]</annotation></semantics></math>, with mixing
weights <math alttext="\pi_{k}" class="ltx_Math" display="inline" id="Thmdefinition2.p1.m8"><semantics><msub><mi>Ï€</mi><mi>k</mi></msub><annotation encoding="application/x-tex">\pi_{k}</annotation><annotation encoding="application/x-llamapun">italic_Ï€ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
</div>
<div class="ltx_theorem ltx_theorem_lemma" id="Thmlemma6">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold">Lemma B.6</span></span><span class="ltx_text ltx_font_bold">.</span>
</h6>
<div class="ltx_para" id="Thmlemma6.p1">
<p class="ltx_p"><span class="ltx_text ltx_font_italic">Suppose the random variable <math alttext="\bm{x}" class="ltx_Math" display="inline" id="Thmlemma6.p1.m1"><semantics><mi>ğ±</mi><annotation encoding="application/x-tex">\bm{x}</annotation><annotation encoding="application/x-llamapun">bold_italic_x</annotation></semantics></math> satisfies
<a class="ltx_ref" href="#Thmassumption3" title="Assumption B.3. â€£ B.3 Lossy Coding and Sphere Packing â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Assumption</span>Â <span class="ltx_text ltx_ref_tag">B.3</span></a>. Then if <math alttext="0&lt;\delta&lt;\tfrac{1}{2}" class="ltx_Math" display="inline" id="Thmlemma6.p1.m2"><semantics><mrow><mn>0</mn><mo>&lt;</mo><mi>Î´</mi><mo>&lt;</mo><mfrac><mn>1</mn><mn>2</mn></mfrac></mrow><annotation encoding="application/x-tex">0&lt;\delta&lt;\tfrac{1}{2}</annotation><annotation encoding="application/x-llamapun">0 &lt; italic_Î´ &lt; divide start_ARG 1 end_ARG start_ARG 2 end_ARG</annotation></semantics></math>, the
thickened random variable <math alttext="\bm{x}_{\delta}" class="ltx_Math" display="inline" id="Thmlemma6.p1.m3"><semantics><msub><mi>ğ±</mi><mi>Î´</mi></msub><annotation encoding="application/x-tex">\bm{x}_{\delta}</annotation><annotation encoding="application/x-llamapun">bold_italic_x start_POSTSUBSCRIPT italic_Î´ end_POSTSUBSCRIPT</annotation></semantics></math> (<a class="ltx_ref" href="#Thmdefinition2" title="Definition B.2. â€£ B.3.1 Proof of Relationship Between Rate Distortion and Covering â€£ B.3 Lossy Coding and Sphere Packing â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Definition</span>Â <span class="ltx_text ltx_ref_tag">B.2</span></a>)
satisfies for any <math alttext="\epsilon&gt;0" class="ltx_Math" display="inline" id="Thmlemma6.p1.m4"><semantics><mrow><mi>Ïµ</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\epsilon&gt;0</annotation><annotation encoding="application/x-llamapun">italic_Ïµ &gt; 0</annotation></semantics></math></span></p>
<table class="ltx_equation ltx_eqn_table" id="S3.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="R_{\delta+\epsilon}(\bm{x}_{\delta})\leq R_{\epsilon}(\bm{x})." class="ltx_Math" display="block" id="S3.E10.m1"><semantics><mrow><mrow><mrow><msub><mi>R</mi><mrow><mi>Î´</mi><mo>+</mo><mi>Ïµ</mi></mrow></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ’™</mi><mi>Î´</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>â‰¤</mo><mrow><msub><mi>R</mi><mi>Ïµ</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğ’™</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">R_{\delta+\epsilon}(\bm{x}_{\delta})\leq R_{\epsilon}(\bm{x}).</annotation><annotation encoding="application/x-llamapun">italic_R start_POSTSUBSCRIPT italic_Î´ + italic_Ïµ end_POSTSUBSCRIPT ( bold_italic_x start_POSTSUBSCRIPT italic_Î´ end_POSTSUBSCRIPT ) â‰¤ italic_R start_POSTSUBSCRIPT italic_Ïµ end_POSTSUBSCRIPT ( bold_italic_x ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.3.10)</span></td>
</tr></tbody>
</table>
</div>
</div>
<div class="ltx_para" id="S3.SS1.p6">
<p class="ltx_p">The proof of <a class="ltx_ref" href="#Thmlemma6" title="Lemma B.6. â€£ B.3.1 Proof of Relationship Between Rate Distortion and Covering â€£ B.3 Lossy Coding and Sphere Packing â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Lemma</span>Â <span class="ltx_text ltx_ref_tag">B.6</span></a> is deferred to
<a class="ltx_ref" href="#S3.SS2" title="B.3.2 Deferred Proofs â€£ B.3 Lossy Coding and Sphere Packing â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Section</span>Â <span class="ltx_text ltx_ref_tag">B.3.2</span></a>.
Using <a class="ltx_ref" href="#Thmlemma6" title="Lemma B.6. â€£ B.3.1 Proof of Relationship Between Rate Distortion and Covering â€£ B.3 Lossy Coding and Sphere Packing â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Lemma</span>Â <span class="ltx_text ltx_ref_tag">B.6</span></a>, the above program can be realized,
because the random variable <math alttext="\bm{x}_{\delta}" class="ltx_Math" display="inline" id="S3.SS1.p6.m1"><semantics><msub><mi>ğ’™</mi><mi>Î´</mi></msub><annotation encoding="application/x-tex">\bm{x}_{\delta}</annotation><annotation encoding="application/x-llamapun">bold_italic_x start_POSTSUBSCRIPT italic_Î´ end_POSTSUBSCRIPT</annotation></semantics></math> has a density that is uniform with
respect to the Lebesgue measure.</p>
</div>
<div class="ltx_proof">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">(Proof of <a class="ltx_ref" href="Ch3.html#Thmtheorem6" title="Theorem 3.6. â€£ 3.3.2 Rate Distortion and Data Geometry â€£ 3.3 Compression via Lossy Coding â€£ Chapter 3 Pursuing Low-Dimensional Distributions via Lossy Compression â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Theorem</span>Â <span class="ltx_text ltx_ref_tag">3.6</span></a>).</h6>
<div class="ltx_para" id="S3.SS1.p7">
<p class="ltx_p">The upper bound is readily shown. If <math alttext="S" class="ltx_Math" display="inline" id="S3.SS1.p7.m1"><semantics><mi>S</mi><annotation encoding="application/x-tex">S</annotation><annotation encoding="application/x-llamapun">italic_S</annotation></semantics></math> is any <math alttext="\epsilon" class="ltx_Math" display="inline" id="S3.SS1.p7.m2"><semantics><mi>Ïµ</mi><annotation encoding="application/x-tex">\epsilon</annotation><annotation encoding="application/x-llamapun">italic_Ïµ</annotation></semantics></math>-cover of the
support of <math alttext="\bm{x}" class="ltx_Math" display="inline" id="S3.SS1.p7.m3"><semantics><mi>ğ’™</mi><annotation encoding="application/x-tex">\bm{x}</annotation><annotation encoding="application/x-llamapun">bold_italic_x</annotation></semantics></math> with cardinality <math alttext="\mathcal{N}_{\epsilon}(\operatorname{Supp}(\bm{x}))" class="ltx_Math" display="inline" id="S3.SS1.p7.m4"><semantics><mrow><msub><mi class="ltx_font_mathcaligraphic">ğ’©</mi><mi>Ïµ</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mi>Supp</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><mi>ğ’™</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathcal{N}_{\epsilon}(\operatorname{Supp}(\bm{x}))</annotation><annotation encoding="application/x-llamapun">caligraphic_N start_POSTSUBSCRIPT italic_Ïµ end_POSTSUBSCRIPT ( roman_Supp ( bold_italic_x ) )</annotation></semantics></math>, then consider the
coding scheme assigning to each <math alttext="\bm{\xi}\in\operatorname{Supp}(\bm{x})" class="ltx_Math" display="inline" id="S3.SS1.p7.m5"><semantics><mrow><mi>ğƒ</mi><mo>âˆˆ</mo><mrow><mi>Supp</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><mi>ğ’™</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\bm{\xi}\in\operatorname{Supp}(\bm{x})</annotation><annotation encoding="application/x-llamapun">bold_italic_Î¾ âˆˆ roman_Supp ( bold_italic_x )</annotation></semantics></math> the reconstruction
<math alttext="\hat{\bm{\xi}}=\operatorname*{arg\ min}_{\bm{\xi}^{\prime}\in S}\,\|\bm{\xi}-\bm{\xi}^{\prime}\|_{2}" class="ltx_Math" display="inline" id="S3.SS1.p7.m6"><semantics><mrow><mover accent="true"><mi>ğƒ</mi><mo>^</mo></mover><mo>=</mo><mrow><msub><mrow><mi>arg</mi><mo lspace="0.500em" rspace="0em">â€‹</mo><mi>min</mi></mrow><mrow><msup><mi>ğƒ</mi><mo>â€²</mo></msup><mo>âˆˆ</mo><mi>S</mi></mrow></msub><mo>â¡</mo><msub><mrow><mo stretchy="false">â€–</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><msup><mi>ğƒ</mi><mo>â€²</mo></msup></mrow><mo stretchy="false">â€–</mo></mrow><mn>2</mn></msub></mrow></mrow><annotation encoding="application/x-tex">\hat{\bm{\xi}}=\operatorname*{arg\ min}_{\bm{\xi}^{\prime}\in S}\,\|\bm{\xi}-\bm{\xi}^{\prime}\|_{2}</annotation><annotation encoding="application/x-llamapun">over^ start_ARG bold_italic_Î¾ end_ARG = start_OPERATOR roman_arg roman_min end_OPERATOR start_POSTSUBSCRIPT bold_italic_Î¾ start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT âˆˆ italic_S end_POSTSUBSCRIPT âˆ¥ bold_italic_Î¾ - bold_italic_Î¾ start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>, with ties
broken arbitrarily. Then ties occur with probability zero, and the fact that
<math alttext="S" class="ltx_Math" display="inline" id="S3.SS1.p7.m7"><semantics><mi>S</mi><annotation encoding="application/x-tex">S</annotation><annotation encoding="application/x-llamapun">italic_S</annotation></semantics></math> covers <math alttext="\operatorname{Supp}(\bm{x})" class="ltx_Math" display="inline" id="S3.SS1.p7.m8"><semantics><mrow><mi>Supp</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><mi>ğ’™</mi><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">\operatorname{Supp}(\bm{x})</annotation><annotation encoding="application/x-llamapun">roman_Supp ( bold_italic_x )</annotation></semantics></math> at scale <math alttext="\epsilon" class="ltx_Math" display="inline" id="S3.SS1.p7.m9"><semantics><mi>Ïµ</mi><annotation encoding="application/x-tex">\epsilon</annotation><annotation encoding="application/x-llamapun">italic_Ïµ</annotation></semantics></math> guarantees distortion no larger
than <math alttext="\epsilon" class="ltx_Math" display="inline" id="S3.SS1.p7.m10"><semantics><mi>Ïµ</mi><annotation encoding="application/x-tex">\epsilon</annotation><annotation encoding="application/x-llamapun">italic_Ïµ</annotation></semantics></math>; the rate of this scheme is <math alttext="\log_{2}\mathcal{N}_{\epsilon}(\operatorname{Supp}(\bm{x}))" class="ltx_Math" display="inline" id="S3.SS1.p7.m11"><semantics><mrow><mrow><msub><mi>log</mi><mn>2</mn></msub><mo lspace="0.167em">â¡</mo><msub><mi class="ltx_font_mathcaligraphic">ğ’©</mi><mi>Ïµ</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mi>Supp</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><mi>ğ’™</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">\log_{2}\mathcal{N}_{\epsilon}(\operatorname{Supp}(\bm{x}))</annotation><annotation encoding="application/x-llamapun">roman_log start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT caligraphic_N start_POSTSUBSCRIPT italic_Ïµ end_POSTSUBSCRIPT ( roman_Supp ( bold_italic_x ) )</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS1.p8">
<p class="ltx_p">For the lower bound, let <math alttext="0&lt;\delta&lt;\tfrac{1}{2}" class="ltx_Math" display="inline" id="S3.SS1.p8.m1"><semantics><mrow><mn>0</mn><mo>&lt;</mo><mi>Î´</mi><mo>&lt;</mo><mfrac><mn>1</mn><mn>2</mn></mfrac></mrow><annotation encoding="application/x-tex">0&lt;\delta&lt;\tfrac{1}{2}</annotation><annotation encoding="application/x-llamapun">0 &lt; italic_Î´ &lt; divide start_ARG 1 end_ARG start_ARG 2 end_ARG</annotation></semantics></math>, and consider the
thickened random variable <math alttext="\bm{x}_{\delta}" class="ltx_Math" display="inline" id="S3.SS1.p8.m2"><semantics><msub><mi>ğ’™</mi><mi>Î´</mi></msub><annotation encoding="application/x-tex">\bm{x}_{\delta}</annotation><annotation encoding="application/x-llamapun">bold_italic_x start_POSTSUBSCRIPT italic_Î´ end_POSTSUBSCRIPT</annotation></semantics></math>. By
<a class="ltx_ref" href="#Thmlemma6" title="Lemma B.6. â€£ B.3.1 Proof of Relationship Between Rate Distortion and Covering â€£ B.3 Lossy Coding and Sphere Packing â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Lemma</span>Â <span class="ltx_text ltx_ref_tag">B.6</span></a>, we have</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="R_{\delta+\epsilon}(\bm{x}_{\delta})\leq R_{\epsilon}(\bm{x})." class="ltx_Math" display="block" id="S3.E11.m1"><semantics><mrow><mrow><mrow><msub><mi>R</mi><mrow><mi>Î´</mi><mo>+</mo><mi>Ïµ</mi></mrow></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ’™</mi><mi>Î´</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>â‰¤</mo><mrow><msub><mi>R</mi><mi>Ïµ</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğ’™</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">R_{\delta+\epsilon}(\bm{x}_{\delta})\leq R_{\epsilon}(\bm{x}).</annotation><annotation encoding="application/x-llamapun">italic_R start_POSTSUBSCRIPT italic_Î´ + italic_Ïµ end_POSTSUBSCRIPT ( bold_italic_x start_POSTSUBSCRIPT italic_Î´ end_POSTSUBSCRIPT ) â‰¤ italic_R start_POSTSUBSCRIPT italic_Ïµ end_POSTSUBSCRIPT ( bold_italic_x ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.3.11)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">Since <math alttext="\bm{x}_{\delta}" class="ltx_Math" display="inline" id="S3.SS1.p8.m3"><semantics><msub><mi>ğ’™</mi><mi>Î´</mi></msub><annotation encoding="application/x-tex">\bm{x}_{\delta}</annotation><annotation encoding="application/x-llamapun">bold_italic_x start_POSTSUBSCRIPT italic_Î´ end_POSTSUBSCRIPT</annotation></semantics></math> has a Lebesgue density that is uniform, we can then
apply the Shannon lower bound, in the form (<a class="ltx_ref" href="#S3.E5" title="Equation B.3.5 â€£ B.3.1 Proof of Relationship Between Rate Distortion and Covering â€£ B.3 Lossy Coding and Sphere Packing â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">B.3.5</span></a>), to get</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E12">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\log_{2}\operatorname{vol}(\operatorname{Supp}(\bm{x}_{\delta}))-\log_{2}\operatorname{vol}(B_{\delta+\epsilon})-O(\log D)\leq R_{\epsilon}(\bm{x})." class="ltx_Math" display="block" id="S3.E12.m1"><semantics><mrow><mrow><mrow><mrow><msub><mi>log</mi><mn>2</mn></msub><mo lspace="0.167em">â¡</mo><mrow><mi>vol</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><mrow><mi>Supp</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ’™</mi><mi>Î´</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>âˆ’</mo><mrow><msub><mi>log</mi><mn>2</mn></msub><mo lspace="0.167em">â¡</mo><mrow><mi>vol</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><msub><mi>B</mi><mrow><mi>Î´</mi><mo>+</mo><mi>Ïµ</mi></mrow></msub><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>âˆ’</mo><mrow><mi>O</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mi>log</mi><mo lspace="0.167em">â¡</mo><mi>D</mi></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>â‰¤</mo><mrow><msub><mi>R</mi><mi>Ïµ</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğ’™</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">\log_{2}\operatorname{vol}(\operatorname{Supp}(\bm{x}_{\delta}))-\log_{2}\operatorname{vol}(B_{\delta+\epsilon})-O(\log D)\leq R_{\epsilon}(\bm{x}).</annotation><annotation encoding="application/x-llamapun">roman_log start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT roman_vol ( roman_Supp ( bold_italic_x start_POSTSUBSCRIPT italic_Î´ end_POSTSUBSCRIPT ) ) - roman_log start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT roman_vol ( italic_B start_POSTSUBSCRIPT italic_Î´ + italic_Ïµ end_POSTSUBSCRIPT ) - italic_O ( roman_log italic_D ) â‰¤ italic_R start_POSTSUBSCRIPT italic_Ïµ end_POSTSUBSCRIPT ( bold_italic_x ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.3.12)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">Finally, we need to lower bound the ratio</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E13">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\frac{\operatorname{vol}(\operatorname{Supp}(\bm{x}_{\delta}))}{\operatorname{vol}(B_{\delta+\epsilon})}" class="ltx_Math" display="block" id="S3.E13.m1"><semantics><mfrac><mrow><mi>vol</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><mrow><mi>Supp</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ’™</mi><mi>Î´</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mrow><mi>vol</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><msub><mi>B</mi><mrow><mi>Î´</mi><mo>+</mo><mi>Ïµ</mi></mrow></msub><mo stretchy="false">)</mo></mrow></mrow></mfrac><annotation encoding="application/x-tex">\frac{\operatorname{vol}(\operatorname{Supp}(\bm{x}_{\delta}))}{\operatorname{vol}(B_{\delta+\epsilon})}</annotation><annotation encoding="application/x-llamapun">divide start_ARG roman_vol ( roman_Supp ( bold_italic_x start_POSTSUBSCRIPT italic_Î´ end_POSTSUBSCRIPT ) ) end_ARG start_ARG roman_vol ( italic_B start_POSTSUBSCRIPT italic_Î´ + italic_Ïµ end_POSTSUBSCRIPT ) end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.3.13)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">in terms of the covering number.
Since <math alttext="\operatorname{Supp}(\bm{x}_{\delta})=\operatorname{Supp}(\bm{x})+B_{\delta}" class="ltx_Math" display="inline" id="S3.SS1.p8.m4"><semantics><mrow><mrow><mi>Supp</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ’™</mi><mi>Î´</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mi>Supp</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><mi>ğ’™</mi><mo stretchy="false">)</mo></mrow></mrow><mo>+</mo><msub><mi>B</mi><mi>Î´</mi></msub></mrow></mrow><annotation encoding="application/x-tex">\operatorname{Supp}(\bm{x}_{\delta})=\operatorname{Supp}(\bm{x})+B_{\delta}</annotation><annotation encoding="application/x-llamapun">roman_Supp ( bold_italic_x start_POSTSUBSCRIPT italic_Î´ end_POSTSUBSCRIPT ) = roman_Supp ( bold_italic_x ) + italic_B start_POSTSUBSCRIPT italic_Î´ end_POSTSUBSCRIPT</annotation></semantics></math>, where <math alttext="+" class="ltx_Math" display="inline" id="S3.SS1.p8.m5"><semantics><mo>+</mo><annotation encoding="application/x-tex">+</annotation><annotation encoding="application/x-llamapun">+</annotation></semantics></math> here
denotes the Minkowski sum, a standard application of volume bound arguments
(see e.g.Â <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="bib.html#bibx273" title="">Ver18</a>, Proposition 4.2.12]</cite>) gives</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E14">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\operatorname{vol}(\operatorname{Supp}(\bm{x}_{\delta}))\geq\mathcal{N}_{2\delta}(\operatorname{Supp}(\bm{x}))\operatorname{vol}(B_{\delta})." class="ltx_Math" display="block" id="S3.E14.m1"><semantics><mrow><mrow><mrow><mi>vol</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><mrow><mi>Supp</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ’™</mi><mi>Î´</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>â‰¥</mo><mrow><msub><mi class="ltx_font_mathcaligraphic">ğ’©</mi><mrow><mn>2</mn><mo lspace="0em" rspace="0em">â€‹</mo><mi>Î´</mi></mrow></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mi>Supp</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><mi>ğ’™</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow><mo lspace="0.167em" rspace="0em">â€‹</mo><mrow><mi>vol</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><msub><mi>B</mi><mi>Î´</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">\operatorname{vol}(\operatorname{Supp}(\bm{x}_{\delta}))\geq\mathcal{N}_{2\delta}(\operatorname{Supp}(\bm{x}))\operatorname{vol}(B_{\delta}).</annotation><annotation encoding="application/x-llamapun">roman_vol ( roman_Supp ( bold_italic_x start_POSTSUBSCRIPT italic_Î´ end_POSTSUBSCRIPT ) ) â‰¥ caligraphic_N start_POSTSUBSCRIPT 2 italic_Î´ end_POSTSUBSCRIPT ( roman_Supp ( bold_italic_x ) ) roman_vol ( italic_B start_POSTSUBSCRIPT italic_Î´ end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.3.14)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">Hence</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S3.EGx149">
<tbody id="S3.E15"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\frac{\operatorname{vol}(\operatorname{Supp}(\bm{x}_{\delta}))}{\operatorname{vol}(B_{\delta+\epsilon})}" class="ltx_Math" display="inline" id="S3.E15.m1"><semantics><mstyle displaystyle="true"><mfrac><mrow><mi>vol</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><mrow><mi>Supp</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ’™</mi><mi>Î´</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mrow><mi>vol</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><msub><mi>B</mi><mrow><mi>Î´</mi><mo>+</mo><mi>Ïµ</mi></mrow></msub><mo stretchy="false">)</mo></mrow></mrow></mfrac></mstyle><annotation encoding="application/x-tex">\displaystyle\frac{\operatorname{vol}(\operatorname{Supp}(\bm{x}_{\delta}))}{\operatorname{vol}(B_{\delta+\epsilon})}</annotation><annotation encoding="application/x-llamapun">divide start_ARG roman_vol ( roman_Supp ( bold_italic_x start_POSTSUBSCRIPT italic_Î´ end_POSTSUBSCRIPT ) ) end_ARG start_ARG roman_vol ( italic_B start_POSTSUBSCRIPT italic_Î´ + italic_Ïµ end_POSTSUBSCRIPT ) end_ARG</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\geq\mathcal{N}_{2\delta}(\operatorname{Supp}(\bm{x}))\frac{\operatorname{vol}(B_{\delta})}{\operatorname{vol}(B_{\delta+\epsilon})}" class="ltx_Math" display="inline" id="S3.E15.m2"><semantics><mrow><mi></mi><mo>â‰¥</mo><mrow><msub><mi class="ltx_font_mathcaligraphic">ğ’©</mi><mrow><mn>2</mn><mo lspace="0em" rspace="0em">â€‹</mo><mi>Î´</mi></mrow></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mi>Supp</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><mi>ğ’™</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mstyle displaystyle="true"><mfrac><mrow><mi>vol</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><msub><mi>B</mi><mi>Î´</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mrow><mi>vol</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><msub><mi>B</mi><mrow><mi>Î´</mi><mo>+</mo><mi>Ïµ</mi></mrow></msub><mo stretchy="false">)</mo></mrow></mrow></mfrac></mstyle></mrow></mrow><annotation encoding="application/x-tex">\displaystyle\geq\mathcal{N}_{2\delta}(\operatorname{Supp}(\bm{x}))\frac{\operatorname{vol}(B_{\delta})}{\operatorname{vol}(B_{\delta+\epsilon})}</annotation><annotation encoding="application/x-llamapun">â‰¥ caligraphic_N start_POSTSUBSCRIPT 2 italic_Î´ end_POSTSUBSCRIPT ( roman_Supp ( bold_italic_x ) ) divide start_ARG roman_vol ( italic_B start_POSTSUBSCRIPT italic_Î´ end_POSTSUBSCRIPT ) end_ARG start_ARG roman_vol ( italic_B start_POSTSUBSCRIPT italic_Î´ + italic_Ïµ end_POSTSUBSCRIPT ) end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.3.15)</span></td>
</tr></tbody>
<tbody id="S3.E16"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathcal{N}_{2\delta}(\operatorname{Supp}(\bm{x}))\left(\frac{\delta}{\delta+\epsilon}\right)^{D}." class="ltx_Math" display="inline" id="S3.E16.m1"><semantics><mrow><mrow><mi></mi><mo>=</mo><mrow><msub><mi class="ltx_font_mathcaligraphic">ğ’©</mi><mrow><mn>2</mn><mo lspace="0em" rspace="0em">â€‹</mo><mi>Î´</mi></mrow></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mi>Supp</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><mi>ğ’™</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><msup><mrow><mo>(</mo><mstyle displaystyle="true"><mfrac><mi>Î´</mi><mrow><mi>Î´</mi><mo>+</mo><mi>Ïµ</mi></mrow></mfrac></mstyle><mo>)</mo></mrow><mi>D</mi></msup></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">\displaystyle=\mathcal{N}_{2\delta}(\operatorname{Supp}(\bm{x}))\left(\frac{\delta}{\delta+\epsilon}\right)^{D}.</annotation><annotation encoding="application/x-llamapun">= caligraphic_N start_POSTSUBSCRIPT 2 italic_Î´ end_POSTSUBSCRIPT ( roman_Supp ( bold_italic_x ) ) ( divide start_ARG italic_Î´ end_ARG start_ARG italic_Î´ + italic_Ïµ end_ARG ) start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.3.16)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">Choosing <math alttext="\delta=\epsilon/2" class="ltx_Math" display="inline" id="S3.SS1.p8.m6"><semantics><mrow><mi>Î´</mi><mo>=</mo><mrow><mi>Ïµ</mi><mo>/</mo><mn>2</mn></mrow></mrow><annotation encoding="application/x-tex">\delta=\epsilon/2</annotation><annotation encoding="application/x-llamapun">italic_Î´ = italic_Ïµ / 2</annotation></semantics></math> gives from the Shannon lower bound
(<a class="ltx_ref" href="#S3.E12" title="Equation B.3.12 â€£ B.3.1 Proof of Relationship Between Rate Distortion and Covering â€£ B.3 Lossy Coding and Sphere Packing â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">B.3.12</span></a>) and the above estimates</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E17">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\log_{2}\mathcal{N}_{\epsilon}(\operatorname{Supp}(\bm{x}))-O(D)\leq R_{\epsilon}(\bm{x})," class="ltx_Math" display="block" id="S3.E17.m1"><semantics><mrow><mrow><mrow><mrow><mrow><msub><mi>log</mi><mn>2</mn></msub><mo lspace="0.167em">â¡</mo><msub><mi class="ltx_font_mathcaligraphic">ğ’©</mi><mi>Ïµ</mi></msub></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mi>Supp</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><mi>ğ’™</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>âˆ’</mo><mrow><mi>O</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>D</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>â‰¤</mo><mrow><msub><mi>R</mi><mi>Ïµ</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğ’™</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">\log_{2}\mathcal{N}_{\epsilon}(\operatorname{Supp}(\bm{x}))-O(D)\leq R_{\epsilon}(\bm{x}),</annotation><annotation encoding="application/x-llamapun">roman_log start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT caligraphic_N start_POSTSUBSCRIPT italic_Ïµ end_POSTSUBSCRIPT ( roman_Supp ( bold_italic_x ) ) - italic_O ( italic_D ) â‰¤ italic_R start_POSTSUBSCRIPT italic_Ïµ end_POSTSUBSCRIPT ( bold_italic_x ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.3.17)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">as was to be shown.</p>
</div>
<div class="ltx_para" id="S3.SS1.p9">
<p class="ltx_p">âˆ</p>
</div>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.3.2 </span>Deferred Proofs</h3>
<div class="ltx_proof">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">(Proof of <a class="ltx_ref" href="#Thmlemma6" title="Lemma B.6. â€£ B.3.1 Proof of Relationship Between Rate Distortion and Covering â€£ B.3 Lossy Coding and Sphere Packing â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Lemma</span>Â <span class="ltx_text ltx_ref_tag">B.6</span></a>).</h6>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p">It suffices to show that any code for <math alttext="\bm{x}" class="ltx_Math" display="inline" id="S3.SS2.p1.m1"><semantics><mi>ğ’™</mi><annotation encoding="application/x-tex">\bm{x}</annotation><annotation encoding="application/x-llamapun">bold_italic_x</annotation></semantics></math> with expected squared distortion
<math alttext="\epsilon^{2}" class="ltx_Math" display="inline" id="S3.SS2.p1.m2"><semantics><msup><mi>Ïµ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\epsilon^{2}</annotation><annotation encoding="application/x-llamapun">italic_Ïµ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math> produces a code for <math alttext="\bm{x}_{\delta}" class="ltx_Math" display="inline" id="S3.SS2.p1.m3"><semantics><msub><mi>ğ’™</mi><mi>Î´</mi></msub><annotation encoding="application/x-tex">\bm{x}_{\delta}</annotation><annotation encoding="application/x-llamapun">bold_italic_x start_POSTSUBSCRIPT italic_Î´ end_POSTSUBSCRIPT</annotation></semantics></math> with the same rate and
distortion not much larger, for a suitable choice of <math alttext="\delta" class="ltx_Math" display="inline" id="S3.SS2.p1.m4"><semantics><mi>Î´</mi><annotation encoding="application/x-tex">\delta</annotation><annotation encoding="application/x-llamapun">italic_Î´</annotation></semantics></math>.
So fix such a code for <math alttext="\bm{x}" class="ltx_Math" display="inline" id="S3.SS2.p1.m5"><semantics><mi>ğ’™</mi><annotation encoding="application/x-tex">\bm{x}</annotation><annotation encoding="application/x-llamapun">bold_italic_x</annotation></semantics></math>, achieving rate <math alttext="R" class="ltx_Math" display="inline" id="S3.SS2.p1.m6"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation><annotation encoding="application/x-llamapun">italic_R</annotation></semantics></math> and expected squared
distortion <math alttext="\epsilon^{2}" class="ltx_Math" display="inline" id="S3.SS2.p1.m7"><semantics><msup><mi>Ïµ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\epsilon^{2}</annotation><annotation encoding="application/x-llamapun">italic_Ïµ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math>. We write <math alttext="\hat{\bm{x}}" class="ltx_Math" display="inline" id="S3.SS2.p1.m8"><semantics><mover accent="true"><mi>ğ’™</mi><mo>^</mo></mover><annotation encoding="application/x-tex">\hat{\bm{x}}</annotation><annotation encoding="application/x-llamapun">over^ start_ARG bold_italic_x end_ARG</annotation></semantics></math> for the reconstructed random
variable using this code, and <math alttext="\mathrm{q}:\operatorname{Supp}(\bm{x})\to\operatorname{Supp}(\bm{x})" class="ltx_Math" display="inline" id="S3.SS2.p1.m9"><semantics><mrow><mi mathvariant="normal">q</mi><mo lspace="0.278em" rspace="0.278em">:</mo><mrow><mrow><mi>Supp</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><mi>ğ’™</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">â†’</mo><mrow><mi>Supp</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><mi>ğ’™</mi><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">\mathrm{q}:\operatorname{Supp}(\bm{x})\to\operatorname{Supp}(\bm{x})</annotation><annotation encoding="application/x-llamapun">roman_q : roman_Supp ( bold_italic_x ) â†’ roman_Supp ( bold_italic_x )</annotation></semantics></math>
for the associated encoding-decoding mapping (i.e., <math alttext="\hat{\bm{x}}=\mathrm{q}(\bm{x})" class="ltx_Math" display="inline" id="S3.SS2.p1.m10"><semantics><mrow><mover accent="true"><mi>ğ’™</mi><mo>^</mo></mover><mo>=</mo><mrow><mi mathvariant="normal">q</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğ’™</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\hat{\bm{x}}=\mathrm{q}(\bm{x})</annotation><annotation encoding="application/x-llamapun">over^ start_ARG bold_italic_x end_ARG = roman_q ( bold_italic_x )</annotation></semantics></math>).</p>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p">Now let <math alttext="\mathcal{S}_{k}" class="ltx_Math" display="inline" id="S3.SS2.p2.m1"><semantics><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mi>k</mi></msub><annotation encoding="application/x-tex">\mathcal{S}_{k}</annotation><annotation encoding="application/x-llamapun">caligraphic_S start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> denote the <math alttext="k" class="ltx_Math" display="inline" id="S3.SS2.p2.m2"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation><annotation encoding="application/x-llamapun">italic_k</annotation></semantics></math>-th hypersphere in the support of <math alttext="\bm{x}" class="ltx_Math" display="inline" id="S3.SS2.p2.m3"><semantics><mi>ğ’™</mi><annotation encoding="application/x-tex">\bm{x}</annotation><annotation encoding="application/x-llamapun">bold_italic_x</annotation></semantics></math>.
There is an orthonormal basis <math alttext="\bm{U}_{k}\in\mathbb{R}^{D\times d_{k}}" class="ltx_Math" display="inline" id="S3.SS2.p2.m4"><semantics><mrow><msub><mi>ğ‘¼</mi><mi>k</mi></msub><mo>âˆˆ</mo><msup><mi>â„</mi><mrow><mi>D</mi><mo lspace="0.222em" rspace="0.222em">Ã—</mo><msub><mi>d</mi><mi>k</mi></msub></mrow></msup></mrow><annotation encoding="application/x-tex">\bm{U}_{k}\in\mathbb{R}^{D\times d_{k}}</annotation><annotation encoding="application/x-llamapun">bold_italic_U start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT âˆˆ blackboard_R start_POSTSUPERSCRIPT italic_D Ã— italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> such that
<math alttext="\operatorname{Span}(\mathcal{S}_{k})=\operatorname{Span}(\bm{U}_{k})" class="ltx_Math" display="inline" id="S3.SS2.p2.m5"><semantics><mrow><mrow><mi>Span</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mi>k</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mi>Span</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ‘¼</mi><mi>k</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\operatorname{Span}(\mathcal{S}_{k})=\operatorname{Span}(\bm{U}_{k})</annotation><annotation encoding="application/x-llamapun">roman_Span ( caligraphic_S start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) = roman_Span ( bold_italic_U start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT )</annotation></semantics></math>.
The following orthogonal decomposition of the support set <math alttext="\mathcal{S}" class="ltx_Math" display="inline" id="S3.SS2.p2.m6"><semantics><mi class="ltx_font_mathcaligraphic">ğ’®</mi><annotation encoding="application/x-tex">\mathcal{S}</annotation><annotation encoding="application/x-llamapun">caligraphic_S</annotation></semantics></math>
will be used repeatedly throughout the proof.
We have</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S3.EGx150">
<tbody id="S3.E18"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{S}_{\delta}" class="ltx_Math" display="inline" id="S3.E18.m1"><semantics><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mi>Î´</mi></msub><annotation encoding="application/x-tex">\displaystyle\mathcal{S}_{\delta}</annotation><annotation encoding="application/x-llamapun">caligraphic_S start_POSTSUBSCRIPT italic_Î´ end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\{\bm{\xi}\in\mathbb{R}^{D}\mid\exists k\in[K]\&gt;:\&gt;\operatorname{dist}(\bm{\xi},\mathcal{S}_{k})\leq\delta\}" class="ltx_Math" display="inline" id="S3.E18.m2"><semantics><mrow><mi></mi><mo>=</mo><mrow><mo stretchy="false">{</mo><mrow><mi>ğƒ</mi><mo>âˆˆ</mo><msup><mi>â„</mi><mi>D</mi></msup></mrow><mo fence="true" lspace="0em" rspace="0.167em">âˆ£</mo><mrow><mrow><mrow><mo rspace="0.167em">âˆƒ</mo><mi>k</mi></mrow><mo>âˆˆ</mo><mrow><mo stretchy="false">[</mo><mi>K</mi><mo rspace="0.498em" stretchy="false">]</mo></mrow></mrow><mo rspace="0.498em">:</mo><mrow><mrow><mi>dist</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo>,</mo><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mi>k</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>â‰¤</mo><mi>Î´</mi></mrow></mrow><mo stretchy="false">}</mo></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=\{\bm{\xi}\in\mathbb{R}^{D}\mid\exists k\in[K]\&gt;:\&gt;\operatorname{dist}(\bm{\xi},\mathcal{S}_{k})\leq\delta\}</annotation><annotation encoding="application/x-llamapun">= { bold_italic_Î¾ âˆˆ blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT âˆ£ âˆƒ italic_k âˆˆ [ italic_K ] : roman_dist ( bold_italic_Î¾ , caligraphic_S start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) â‰¤ italic_Î´ }</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.3.18)</span></td>
</tr></tbody>
<tbody id="S3.E19"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\bigcup_{k\in[K]}\{\bm{\xi}\in\mathbb{R}^{D}\mid\operatorname{dist}(\bm{\xi},\mathcal{S}_{k})\leq\delta\}." class="ltx_Math" display="inline" id="S3.E19.m1"><semantics><mrow><mrow><mi></mi><mo>=</mo><mrow><mstyle displaystyle="true"><munder><mo movablelimits="false">â‹ƒ</mo><mrow><mi>k</mi><mo>âˆˆ</mo><mrow><mo stretchy="false">[</mo><mi>K</mi><mo stretchy="false">]</mo></mrow></mrow></munder></mstyle><mrow><mo stretchy="false">{</mo><mrow><mi>ğƒ</mi><mo>âˆˆ</mo><msup><mi>â„</mi><mi>D</mi></msup></mrow><mo fence="true" lspace="0em" rspace="0.167em">âˆ£</mo><mrow><mrow><mi>dist</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo>,</mo><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mi>k</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>â‰¤</mo><mi>Î´</mi></mrow><mo stretchy="false">}</mo></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">\displaystyle=\bigcup_{k\in[K]}\{\bm{\xi}\in\mathbb{R}^{D}\mid\operatorname{dist}(\bm{\xi},\mathcal{S}_{k})\leq\delta\}.</annotation><annotation encoding="application/x-llamapun">= â‹ƒ start_POSTSUBSCRIPT italic_k âˆˆ [ italic_K ] end_POSTSUBSCRIPT { bold_italic_Î¾ âˆˆ blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT âˆ£ roman_dist ( bold_italic_Î¾ , caligraphic_S start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) â‰¤ italic_Î´ } .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.3.19)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">By orthogonal projection, for any <math alttext="k\in[K]" class="ltx_Math" display="inline" id="S3.SS2.p2.m7"><semantics><mrow><mi>k</mi><mo>âˆˆ</mo><mrow><mo stretchy="false">[</mo><mi>K</mi><mo stretchy="false">]</mo></mrow></mrow><annotation encoding="application/x-tex">k\in[K]</annotation><annotation encoding="application/x-llamapun">italic_k âˆˆ [ italic_K ]</annotation></semantics></math> any <math alttext="\bm{\xi}\in\mathbb{R}^{D}" class="ltx_Math" display="inline" id="S3.SS2.p2.m8"><semantics><mrow><mi>ğƒ</mi><mo>âˆˆ</mo><msup><mi>â„</mi><mi>D</mi></msup></mrow><annotation encoding="application/x-tex">\bm{\xi}\in\mathbb{R}^{D}</annotation><annotation encoding="application/x-llamapun">bold_italic_Î¾ âˆˆ blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT</annotation></semantics></math> can be
written as <math alttext="\bm{\xi}=\bm{\xi}^{\|}+\bm{\xi}^{\perp}" class="ltx_Math" display="inline" id="S3.SS2.p2.m9"><semantics><mrow><mi>ğƒ</mi><mo>=</mo><mrow><msup><mi>ğƒ</mi><mo>âˆ¥</mo></msup><mo>+</mo><msup><mi>ğƒ</mi><mo>âŸ‚</mo></msup></mrow></mrow><annotation encoding="application/x-tex">\bm{\xi}=\bm{\xi}^{\|}+\bm{\xi}^{\perp}</annotation><annotation encoding="application/x-llamapun">bold_italic_Î¾ = bold_italic_Î¾ start_POSTSUPERSCRIPT âˆ¥ end_POSTSUPERSCRIPT + bold_italic_Î¾ start_POSTSUPERSCRIPT âŸ‚ end_POSTSUPERSCRIPT</annotation></semantics></math>, with <math alttext="\bm{\xi}^{\|}\in\operatorname{Span}(\mathcal{S}_{k})" class="ltx_Math" display="inline" id="S3.SS2.p2.m10"><semantics><mrow><msup><mi>ğƒ</mi><mo>âˆ¥</mo></msup><mo>âˆˆ</mo><mrow><mi>Span</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mi>k</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\bm{\xi}^{\|}\in\operatorname{Span}(\mathcal{S}_{k})</annotation><annotation encoding="application/x-llamapun">bold_italic_Î¾ start_POSTSUPERSCRIPT âˆ¥ end_POSTSUPERSCRIPT âˆˆ roman_Span ( caligraphic_S start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT )</annotation></semantics></math>
and <math alttext="\langle\bm{\xi}^{\|},\bm{\xi}^{\perp}\rangle=0" class="ltx_Math" display="inline" id="S3.SS2.p2.m11"><semantics><mrow><mrow><mo stretchy="false">âŸ¨</mo><msup><mi>ğƒ</mi><mo>âˆ¥</mo></msup><mo>,</mo><msup><mi>ğƒ</mi><mo>âŸ‚</mo></msup><mo stretchy="false">âŸ©</mo></mrow><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\langle\bm{\xi}^{\|},\bm{\xi}^{\perp}\rangle=0</annotation><annotation encoding="application/x-llamapun">âŸ¨ bold_italic_Î¾ start_POSTSUPERSCRIPT âˆ¥ end_POSTSUPERSCRIPT , bold_italic_Î¾ start_POSTSUPERSCRIPT âŸ‚ end_POSTSUPERSCRIPT âŸ© = 0</annotation></semantics></math>.
Then for any <math alttext="\bm{\xi}^{\prime}\in\mathcal{S}_{k}" class="ltx_Math" display="inline" id="S3.SS2.p2.m12"><semantics><mrow><msup><mi>ğƒ</mi><mo>â€²</mo></msup><mo>âˆˆ</mo><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">\bm{\xi}^{\prime}\in\mathcal{S}_{k}</annotation><annotation encoding="application/x-llamapun">bold_italic_Î¾ start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT âˆˆ caligraphic_S start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>, we have</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S3.EGx151">
<tbody id="S3.E20"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\left\|\bm{\xi}-\bm{\xi}^{\prime}\right\|_{2}^{2}=\left\|\bm{\xi}^{\|}+\bm{\xi}^{\perp}-\bm{\xi}^{\prime}\right\|_{2}^{2}" class="ltx_Math" display="inline" id="S3.E20.m1"><semantics><mrow><msubsup><mrow><mo>â€–</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><msup><mi>ğƒ</mi><mo>â€²</mo></msup></mrow><mo>â€–</mo></mrow><mn>2</mn><mn>2</mn></msubsup><mo>=</mo><msubsup><mrow><mo>â€–</mo><mrow><mrow><msup><mi>ğƒ</mi><mo>âˆ¥</mo></msup><mo>+</mo><msup><mi>ğƒ</mi><mo>âŸ‚</mo></msup></mrow><mo>âˆ’</mo><msup><mi>ğƒ</mi><mo>â€²</mo></msup></mrow><mo>â€–</mo></mrow><mn>2</mn><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">\displaystyle\left\|\bm{\xi}-\bm{\xi}^{\prime}\right\|_{2}^{2}=\left\|\bm{\xi}^{\|}+\bm{\xi}^{\perp}-\bm{\xi}^{\prime}\right\|_{2}^{2}</annotation><annotation encoding="application/x-llamapun">âˆ¥ bold_italic_Î¾ - bold_italic_Î¾ start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT = âˆ¥ bold_italic_Î¾ start_POSTSUPERSCRIPT âˆ¥ end_POSTSUPERSCRIPT + bold_italic_Î¾ start_POSTSUPERSCRIPT âŸ‚ end_POSTSUPERSCRIPT - bold_italic_Î¾ start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\left\|\bm{\xi}^{\|}\right\|_{2}^{2}+\left\|\bm{\xi}^{\perp}\right\|_{2}^{2}+\left\|\bm{\xi}^{\prime}\right\|_{2}^{2}-2\left\langle\bm{\xi}^{\|},\bm{\xi}^{\prime}\right\rangle" class="ltx_Math" display="inline" id="S3.E20.m2"><semantics><mrow><mi></mi><mo>=</mo><mrow><mrow><msubsup><mrow><mo>â€–</mo><msup><mi>ğƒ</mi><mo>âˆ¥</mo></msup><mo>â€–</mo></mrow><mn>2</mn><mn>2</mn></msubsup><mo>+</mo><msubsup><mrow><mo>â€–</mo><msup><mi>ğƒ</mi><mo>âŸ‚</mo></msup><mo>â€–</mo></mrow><mn>2</mn><mn>2</mn></msubsup><mo>+</mo><msubsup><mrow><mo>â€–</mo><msup><mi>ğƒ</mi><mo>â€²</mo></msup><mo>â€–</mo></mrow><mn>2</mn><mn>2</mn></msubsup></mrow><mo>âˆ’</mo><mrow><mn>2</mn><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo>âŸ¨</mo><msup><mi>ğƒ</mi><mo>âˆ¥</mo></msup><mo>,</mo><msup><mi>ğƒ</mi><mo>â€²</mo></msup><mo>âŸ©</mo></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=\left\|\bm{\xi}^{\|}\right\|_{2}^{2}+\left\|\bm{\xi}^{\perp}\right\|_{2}^{2}+\left\|\bm{\xi}^{\prime}\right\|_{2}^{2}-2\left\langle\bm{\xi}^{\|},\bm{\xi}^{\prime}\right\rangle</annotation><annotation encoding="application/x-llamapun">= âˆ¥ bold_italic_Î¾ start_POSTSUPERSCRIPT âˆ¥ end_POSTSUPERSCRIPT âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + âˆ¥ bold_italic_Î¾ start_POSTSUPERSCRIPT âŸ‚ end_POSTSUPERSCRIPT âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + âˆ¥ bold_italic_Î¾ start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT - 2 âŸ¨ bold_italic_Î¾ start_POSTSUPERSCRIPT âˆ¥ end_POSTSUPERSCRIPT , bold_italic_Î¾ start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT âŸ©</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.3.20)</span></td>
</tr></tbody>
<tbody id="S3.E21"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\geq\left\|\bm{\xi}^{\|}\right\|_{2}^{2}+\left\|\bm{\xi}^{\prime}\right\|_{2}^{2}-2\left\langle\bm{\xi}^{\|},\bm{\xi}^{\prime}\right\rangle" class="ltx_Math" display="inline" id="S3.E21.m1"><semantics><mrow><mi></mi><mo>â‰¥</mo><mrow><mrow><msubsup><mrow><mo>â€–</mo><msup><mi>ğƒ</mi><mo>âˆ¥</mo></msup><mo>â€–</mo></mrow><mn>2</mn><mn>2</mn></msubsup><mo>+</mo><msubsup><mrow><mo>â€–</mo><msup><mi>ğƒ</mi><mo>â€²</mo></msup><mo>â€–</mo></mrow><mn>2</mn><mn>2</mn></msubsup></mrow><mo>âˆ’</mo><mrow><mn>2</mn><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo>âŸ¨</mo><msup><mi>ğƒ</mi><mo>âˆ¥</mo></msup><mo>,</mo><msup><mi>ğƒ</mi><mo>â€²</mo></msup><mo>âŸ©</mo></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle\geq\left\|\bm{\xi}^{\|}\right\|_{2}^{2}+\left\|\bm{\xi}^{\prime}\right\|_{2}^{2}-2\left\langle\bm{\xi}^{\|},\bm{\xi}^{\prime}\right\rangle</annotation><annotation encoding="application/x-llamapun">â‰¥ âˆ¥ bold_italic_Î¾ start_POSTSUPERSCRIPT âˆ¥ end_POSTSUPERSCRIPT âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + âˆ¥ bold_italic_Î¾ start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT - 2 âŸ¨ bold_italic_Î¾ start_POSTSUPERSCRIPT âˆ¥ end_POSTSUPERSCRIPT , bold_italic_Î¾ start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT âŸ©</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.3.21)</span></td>
</tr></tbody>
<tbody id="S3.E22"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\left\|\bm{\xi}^{\|}-\bm{\xi}^{\prime}\right\|_{2}^{2}." class="ltx_Math" display="inline" id="S3.E22.m1"><semantics><mrow><mrow><mi></mi><mo>=</mo><msubsup><mrow><mo>â€–</mo><mrow><msup><mi>ğƒ</mi><mo>âˆ¥</mo></msup><mo>âˆ’</mo><msup><mi>ğƒ</mi><mo>â€²</mo></msup></mrow><mo>â€–</mo></mrow><mn>2</mn><mn>2</mn></msubsup></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">\displaystyle=\left\|\bm{\xi}^{\|}-\bm{\xi}^{\prime}\right\|_{2}^{2}.</annotation><annotation encoding="application/x-llamapun">= âˆ¥ bold_italic_Î¾ start_POSTSUPERSCRIPT âˆ¥ end_POSTSUPERSCRIPT - bold_italic_Î¾ start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.3.22)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">Further, it is known that for any nonzero <math alttext="\bm{\xi}^{\|}\in\operatorname{Span}(\mathcal{S}_{k})" class="ltx_Math" display="inline" id="S3.SS2.p2.m13"><semantics><mrow><msup><mi>ğƒ</mi><mo>âˆ¥</mo></msup><mo>âˆˆ</mo><mrow><mi>Span</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mi>k</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\bm{\xi}^{\|}\in\operatorname{Span}(\mathcal{S}_{k})</annotation><annotation encoding="application/x-llamapun">bold_italic_Î¾ start_POSTSUPERSCRIPT âˆ¥ end_POSTSUPERSCRIPT âˆˆ roman_Span ( caligraphic_S start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT )</annotation></semantics></math>,</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E23">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\inf_{\bm{\xi}^{\prime}\in\mathcal{S}_{k}}\,\left\|\bm{\xi}^{\|}-\bm{\xi}^{\prime}\right\|_{2}^{2}=\left\|\bm{\xi}^{\|}-\frac{\bm{\xi}^{\|}}{\|\bm{\xi}^{\|}\|_{2}}\right\|_{2}^{2}." class="ltx_Math" display="block" id="S3.E23.m1"><semantics><mrow><mrow><mrow><munder><mo movablelimits="false">inf</mo><mrow><msup><mi>ğƒ</mi><mo>â€²</mo></msup><mo>âˆˆ</mo><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mi>k</mi></msub></mrow></munder><msubsup><mrow><mo lspace="0.170em">â€–</mo><mrow><msup><mi>ğƒ</mi><mo>âˆ¥</mo></msup><mo>âˆ’</mo><msup><mi>ğƒ</mi><mo>â€²</mo></msup></mrow><mo>â€–</mo></mrow><mn>2</mn><mn>2</mn></msubsup></mrow><mo>=</mo><msubsup><mrow><mo>â€–</mo><mrow><msup><mi>ğƒ</mi><mo>âˆ¥</mo></msup><mo>âˆ’</mo><mfrac><msup><mi>ğƒ</mi><mo>âˆ¥</mo></msup><msub><mrow><mo stretchy="false">â€–</mo><msup><mi>ğƒ</mi><mo>âˆ¥</mo></msup><mo stretchy="false">â€–</mo></mrow><mn>2</mn></msub></mfrac></mrow><mo>â€–</mo></mrow><mn>2</mn><mn>2</mn></msubsup></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">\inf_{\bm{\xi}^{\prime}\in\mathcal{S}_{k}}\,\left\|\bm{\xi}^{\|}-\bm{\xi}^{\prime}\right\|_{2}^{2}=\left\|\bm{\xi}^{\|}-\frac{\bm{\xi}^{\|}}{\|\bm{\xi}^{\|}\|_{2}}\right\|_{2}^{2}.</annotation><annotation encoding="application/x-llamapun">roman_inf start_POSTSUBSCRIPT bold_italic_Î¾ start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT âˆˆ caligraphic_S start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT âˆ¥ bold_italic_Î¾ start_POSTSUPERSCRIPT âˆ¥ end_POSTSUPERSCRIPT - bold_italic_Î¾ start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT = âˆ¥ bold_italic_Î¾ start_POSTSUPERSCRIPT âˆ¥ end_POSTSUPERSCRIPT - divide start_ARG bold_italic_Î¾ start_POSTSUPERSCRIPT âˆ¥ end_POSTSUPERSCRIPT end_ARG start_ARG âˆ¥ bold_italic_Î¾ start_POSTSUPERSCRIPT âˆ¥ end_POSTSUPERSCRIPT âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_ARG âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.3.23)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">If <math alttext="\bm{\xi}^{\|}" class="ltx_Math" display="inline" id="S3.SS2.p2.m14"><semantics><msup><mi>ğƒ</mi><mo>âˆ¥</mo></msup><annotation encoding="application/x-tex">\bm{\xi}^{\|}</annotation><annotation encoding="application/x-llamapun">bold_italic_Î¾ start_POSTSUPERSCRIPT âˆ¥ end_POSTSUPERSCRIPT</annotation></semantics></math> is zero, it is clear that the above distance is equal to <math alttext="1" class="ltx_Math" display="inline" id="S3.SS2.p2.m15"><semantics><mn>1</mn><annotation encoding="application/x-tex">1</annotation><annotation encoding="application/x-llamapun">1</annotation></semantics></math>
for every <math alttext="\bm{\xi}^{\prime}\in\mathcal{S}_{k}" class="ltx_Math" display="inline" id="S3.SS2.p2.m16"><semantics><mrow><msup><mi>ğƒ</mi><mo>â€²</mo></msup><mo>âˆˆ</mo><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">\bm{\xi}^{\prime}\in\mathcal{S}_{k}</annotation><annotation encoding="application/x-llamapun">bold_italic_Î¾ start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT âˆˆ caligraphic_S start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>.
Hence, if we define a projection mapping
<math alttext="\pi_{\mathcal{S}_{k}}(\bm{\xi})" class="ltx_Math" display="inline" id="S3.SS2.p2.m17"><semantics><mrow><msub><mi>Ï€</mi><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mi>k</mi></msub></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">\pi_{\mathcal{S}_{k}}(\bm{\xi})</annotation><annotation encoding="application/x-llamapun">italic_Ï€ start_POSTSUBSCRIPT caligraphic_S start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_Î¾ )</annotation></semantics></math>
by</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E24">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\pi_{S_{k}}(\bm{\xi})=\frac{\bm{U}_{k}\bm{U}_{k}^{\top}\bm{\xi}}{\|\bm{U}_{k}^{\top}\bm{\xi}\|_{2}}" class="ltx_Math" display="block" id="S3.E24.m1"><semantics><mrow><mrow><msub><mi>Ï€</mi><msub><mi>S</mi><mi>k</mi></msub></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mfrac><mrow><msub><mi>ğ‘¼</mi><mi>k</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><msubsup><mi>ğ‘¼</mi><mi>k</mi><mo>âŠ¤</mo></msubsup><mo lspace="0em" rspace="0em">â€‹</mo><mi>ğƒ</mi></mrow><msub><mrow><mo stretchy="false">â€–</mo><mrow><msubsup><mi>ğ‘¼</mi><mi>k</mi><mo>âŠ¤</mo></msubsup><mo lspace="0em" rspace="0em">â€‹</mo><mi>ğƒ</mi></mrow><mo stretchy="false">â€–</mo></mrow><mn>2</mn></msub></mfrac></mrow><annotation encoding="application/x-tex">\pi_{S_{k}}(\bm{\xi})=\frac{\bm{U}_{k}\bm{U}_{k}^{\top}\bm{\xi}}{\|\bm{U}_{k}^{\top}\bm{\xi}\|_{2}}</annotation><annotation encoding="application/x-llamapun">italic_Ï€ start_POSTSUBSCRIPT italic_S start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_Î¾ ) = divide start_ARG bold_italic_U start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT bold_italic_U start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Î¾ end_ARG start_ARG âˆ¥ bold_italic_U start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Î¾ âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.3.24)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">for any <math alttext="\bm{\xi}\in\mathbb{R}^{D}" class="ltx_Math" display="inline" id="S3.SS2.p2.m18"><semantics><mrow><mi>ğƒ</mi><mo>âˆˆ</mo><msup><mi>â„</mi><mi>D</mi></msup></mrow><annotation encoding="application/x-tex">\bm{\xi}\in\mathbb{R}^{D}</annotation><annotation encoding="application/x-llamapun">bold_italic_Î¾ âˆˆ blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT</annotation></semantics></math> with <math alttext="\bm{U}_{k}^{\top}\bm{\xi}\neq\mathbf{0}" class="ltx_Math" display="inline" id="S3.SS2.p2.m19"><semantics><mrow><mrow><msubsup><mi>ğ‘¼</mi><mi>k</mi><mo>âŠ¤</mo></msubsup><mo lspace="0em" rspace="0em">â€‹</mo><mi>ğƒ</mi></mrow><mo>â‰ </mo><mn>ğŸ</mn></mrow><annotation encoding="application/x-tex">\bm{U}_{k}^{\top}\bm{\xi}\neq\mathbf{0}</annotation><annotation encoding="application/x-llamapun">bold_italic_U start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Î¾ â‰  bold_0</annotation></semantics></math>, then
<math alttext="\pi_{\mathcal{S}_{k}}(\bm{\xi})=\operatorname*{arg\ min}_{\bm{\xi}^{\prime}\in\mathcal{S}_{k}}\left\|\bm{\xi}^{\prime}-\bm{\xi}\right\|_{2}" class="ltx_Math" display="inline" id="S3.SS2.p2.m20"><semantics><mrow><mrow><msub><mi>Ï€</mi><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mi>k</mi></msub></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><msub><mrow><mi>arg</mi><mo lspace="0.500em" rspace="0em">â€‹</mo><mi>min</mi></mrow><mrow><msup><mi>ğƒ</mi><mo>â€²</mo></msup><mo>âˆˆ</mo><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mi>k</mi></msub></mrow></msub><mo>â¡</mo><msub><mrow><mo>â€–</mo><mrow><msup><mi>ğƒ</mi><mo>â€²</mo></msup><mo>âˆ’</mo><mi>ğƒ</mi></mrow><mo>â€–</mo></mrow><mn>2</mn></msub></mrow></mrow><annotation encoding="application/x-tex">\pi_{\mathcal{S}_{k}}(\bm{\xi})=\operatorname*{arg\ min}_{\bm{\xi}^{\prime}\in\mathcal{S}_{k}}\left\|\bm{\xi}^{\prime}-\bm{\xi}\right\|_{2}</annotation><annotation encoding="application/x-llamapun">italic_Ï€ start_POSTSUBSCRIPT caligraphic_S start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_Î¾ ) = start_OPERATOR roman_arg roman_min end_OPERATOR start_POSTSUBSCRIPT bold_italic_Î¾ start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT âˆˆ caligraphic_S start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT âˆ¥ bold_italic_Î¾ start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT - bold_italic_Î¾ âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>.
We choose <math alttext="0&lt;\delta&lt;1" class="ltx_Math" display="inline" id="S3.SS2.p2.m21"><semantics><mrow><mn>0</mn><mo>&lt;</mo><mi>Î´</mi><mo>&lt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">0&lt;\delta&lt;1</annotation><annotation encoding="application/x-llamapun">0 &lt; italic_Î´ &lt; 1</annotation></semantics></math>, so that the thickened set <math alttext="\mathcal{S}_{\delta}" class="ltx_Math" display="inline" id="S3.SS2.p2.m22"><semantics><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mi>Î´</mi></msub><annotation encoding="application/x-tex">\mathcal{S}_{\delta}</annotation><annotation encoding="application/x-llamapun">caligraphic_S start_POSTSUBSCRIPT italic_Î´ end_POSTSUBSCRIPT</annotation></semantics></math>
contains no points <math alttext="\bm{\xi}\in\mathbb{R}^{D}" class="ltx_Math" display="inline" id="S3.SS2.p2.m23"><semantics><mrow><mi>ğƒ</mi><mo>âˆˆ</mo><msup><mi>â„</mi><mi>D</mi></msup></mrow><annotation encoding="application/x-tex">\bm{\xi}\in\mathbb{R}^{D}</annotation><annotation encoding="application/x-llamapun">bold_italic_Î¾ âˆˆ blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT</annotation></semantics></math> at which any of the projection maps
<math alttext="\pi_{\mathcal{S}_{k}}" class="ltx_Math" display="inline" id="S3.SS2.p2.m24"><semantics><msub><mi>Ï€</mi><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mi>k</mi></msub></msub><annotation encoding="application/x-tex">\pi_{\mathcal{S}_{k}}</annotation><annotation encoding="application/x-llamapun">italic_Ï€ start_POSTSUBSCRIPT caligraphic_S start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> is not well-defined.
So the thickened set <math alttext="\mathcal{S}_{\delta}" class="ltx_Math" display="inline" id="S3.SS2.p2.m25"><semantics><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mi>Î´</mi></msub><annotation encoding="application/x-tex">\mathcal{S}_{\delta}</annotation><annotation encoding="application/x-llamapun">caligraphic_S start_POSTSUBSCRIPT italic_Î´ end_POSTSUBSCRIPT</annotation></semantics></math> satisfies</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S3.EGx152">
<tbody id="S3.E25"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{S}_{\delta}" class="ltx_Math" display="inline" id="S3.E25.m1"><semantics><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mi>Î´</mi></msub><annotation encoding="application/x-tex">\displaystyle\mathcal{S}_{\delta}</annotation><annotation encoding="application/x-llamapun">caligraphic_S start_POSTSUBSCRIPT italic_Î´ end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\bigcup_{k\in[K]}\left\{\bm{\xi}\in\mathbb{R}^{D}\mid\left\|\bm{\xi}-\frac{\bm{U}_{k}\bm{U}_{k}^{\top}\bm{\xi}}{\|\bm{U}_{k}^{\top}\bm{\xi}\|_{2}}\right\|_{2}\leq\delta\right\}." class="ltx_Math" display="inline" id="S3.E25.m2"><semantics><mrow><mrow><mi></mi><mo>=</mo><mrow><mstyle displaystyle="true"><munder><mo movablelimits="false">â‹ƒ</mo><mrow><mi>k</mi><mo>âˆˆ</mo><mrow><mo stretchy="false">[</mo><mi>K</mi><mo stretchy="false">]</mo></mrow></mrow></munder></mstyle><mrow><mo>{</mo><mrow><mi>ğƒ</mi><mo>âˆˆ</mo><msup><mi>â„</mi><mi>D</mi></msup></mrow><mo fence="true" lspace="0em" rspace="0em">âˆ£</mo><mrow><msub><mrow><mo>â€–</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mstyle displaystyle="true"><mfrac><mrow><msub><mi>ğ‘¼</mi><mi>k</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><msubsup><mi>ğ‘¼</mi><mi>k</mi><mo>âŠ¤</mo></msubsup><mo lspace="0em" rspace="0em">â€‹</mo><mi>ğƒ</mi></mrow><msub><mrow><mo stretchy="false">â€–</mo><mrow><msubsup><mi>ğ‘¼</mi><mi>k</mi><mo>âŠ¤</mo></msubsup><mo lspace="0em" rspace="0em">â€‹</mo><mi>ğƒ</mi></mrow><mo stretchy="false">â€–</mo></mrow><mn>2</mn></msub></mfrac></mstyle></mrow><mo>â€–</mo></mrow><mn>2</mn></msub><mo>â‰¤</mo><mi>Î´</mi></mrow><mo>}</mo></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">\displaystyle=\bigcup_{k\in[K]}\left\{\bm{\xi}\in\mathbb{R}^{D}\mid\left\|\bm{\xi}-\frac{\bm{U}_{k}\bm{U}_{k}^{\top}\bm{\xi}}{\|\bm{U}_{k}^{\top}\bm{\xi}\|_{2}}\right\|_{2}\leq\delta\right\}.</annotation><annotation encoding="application/x-llamapun">= â‹ƒ start_POSTSUBSCRIPT italic_k âˆˆ [ italic_K ] end_POSTSUBSCRIPT { bold_italic_Î¾ âˆˆ blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT âˆ£ âˆ¥ bold_italic_Î¾ - divide start_ARG bold_italic_U start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT bold_italic_U start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Î¾ end_ARG start_ARG âˆ¥ bold_italic_U start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Î¾ âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_ARG âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT â‰¤ italic_Î´ } .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.3.25)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">These distances can be rewritten in terms of the orthogonal decomposition as</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S3.EGx153">
<tbody id="S3.E26"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\left\|\bm{\xi}-\frac{\bm{U}_{k}\bm{U}_{k}^{\top}\bm{\xi}}{\|\bm{U}_{k}^{\top}\bm{\xi}\|_{2}}\right\|_{2}^{2}" class="ltx_Math" display="inline" id="S3.E26.m1"><semantics><msubsup><mrow><mo>â€–</mo><mrow><mi>ğƒ</mi><mo>âˆ’</mo><mstyle displaystyle="true"><mfrac><mrow><msub><mi>ğ‘¼</mi><mi>k</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><msubsup><mi>ğ‘¼</mi><mi>k</mi><mo>âŠ¤</mo></msubsup><mo lspace="0em" rspace="0em">â€‹</mo><mi>ğƒ</mi></mrow><msub><mrow><mo stretchy="false">â€–</mo><mrow><msubsup><mi>ğ‘¼</mi><mi>k</mi><mo>âŠ¤</mo></msubsup><mo lspace="0em" rspace="0em">â€‹</mo><mi>ğƒ</mi></mrow><mo stretchy="false">â€–</mo></mrow><mn>2</mn></msub></mfrac></mstyle></mrow><mo>â€–</mo></mrow><mn>2</mn><mn>2</mn></msubsup><annotation encoding="application/x-tex">\displaystyle\left\|\bm{\xi}-\frac{\bm{U}_{k}\bm{U}_{k}^{\top}\bm{\xi}}{\|\bm{U}_{k}^{\top}\bm{\xi}\|_{2}}\right\|_{2}^{2}</annotation><annotation encoding="application/x-llamapun">âˆ¥ bold_italic_Î¾ - divide start_ARG bold_italic_U start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT bold_italic_U start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Î¾ end_ARG start_ARG âˆ¥ bold_italic_U start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Î¾ âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_ARG âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\left\|\bm{\xi}\right\|_{2}^{2}-2\|\bm{U}_{k}^{\top}\bm{\xi}\|_{2}+1" class="ltx_Math" display="inline" id="S3.E26.m2"><semantics><mrow><mi></mi><mo>=</mo><mrow><mrow><msubsup><mrow><mo>â€–</mo><mi>ğƒ</mi><mo>â€–</mo></mrow><mn>2</mn><mn>2</mn></msubsup><mo>âˆ’</mo><mrow><mn>2</mn><mo lspace="0em" rspace="0em">â€‹</mo><msub><mrow><mo stretchy="false">â€–</mo><mrow><msubsup><mi>ğ‘¼</mi><mi>k</mi><mo>âŠ¤</mo></msubsup><mo lspace="0em" rspace="0em">â€‹</mo><mi>ğƒ</mi></mrow><mo stretchy="false">â€–</mo></mrow><mn>2</mn></msub></mrow></mrow><mo>+</mo><mn>1</mn></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=\left\|\bm{\xi}\right\|_{2}^{2}-2\|\bm{U}_{k}^{\top}\bm{\xi}\|_{2}+1</annotation><annotation encoding="application/x-llamapun">= âˆ¥ bold_italic_Î¾ âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT - 2 âˆ¥ bold_italic_U start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Î¾ âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT + 1</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.3.26)</span></td>
</tr></tbody>
<tbody id="S3.E27"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\left\|\bm{\xi}^{\|}\right\|_{2}^{2}+\left\|\bm{\xi}^{\perp}\right\|_{2}^{2}-2\|\bm{U}_{k}^{\top}\bm{\xi}^{\|}\|_{2}+1" class="ltx_Math" display="inline" id="S3.E27.m1"><semantics><mrow><mi></mi><mo>=</mo><mrow><mrow><mrow><msubsup><mrow><mo>â€–</mo><msup><mi>ğƒ</mi><mo>âˆ¥</mo></msup><mo>â€–</mo></mrow><mn>2</mn><mn>2</mn></msubsup><mo>+</mo><msubsup><mrow><mo>â€–</mo><msup><mi>ğƒ</mi><mo>âŸ‚</mo></msup><mo>â€–</mo></mrow><mn>2</mn><mn>2</mn></msubsup></mrow><mo>âˆ’</mo><mrow><mn>2</mn><mo lspace="0em" rspace="0em">â€‹</mo><msub><mrow><mo stretchy="false">â€–</mo><mrow><msubsup><mi>ğ‘¼</mi><mi>k</mi><mo>âŠ¤</mo></msubsup><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>ğƒ</mi><mo>âˆ¥</mo></msup></mrow><mo stretchy="false">â€–</mo></mrow><mn>2</mn></msub></mrow></mrow><mo>+</mo><mn>1</mn></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=\left\|\bm{\xi}^{\|}\right\|_{2}^{2}+\left\|\bm{\xi}^{\perp}\right\|_{2}^{2}-2\|\bm{U}_{k}^{\top}\bm{\xi}^{\|}\|_{2}+1</annotation><annotation encoding="application/x-llamapun">= âˆ¥ bold_italic_Î¾ start_POSTSUPERSCRIPT âˆ¥ end_POSTSUPERSCRIPT âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + âˆ¥ bold_italic_Î¾ start_POSTSUPERSCRIPT âŸ‚ end_POSTSUPERSCRIPT âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT - 2 âˆ¥ bold_italic_U start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Î¾ start_POSTSUPERSCRIPT âˆ¥ end_POSTSUPERSCRIPT âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT + 1</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.3.27)</span></td>
</tr></tbody>
<tbody id="S3.E28"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\left\|\bm{\xi}^{\perp}\right\|_{2}^{2}+\left(\left\|\bm{\xi}^{\|}\right\|_{2}-1\right)^{2}." class="ltx_Math" display="inline" id="S3.E28.m1"><semantics><mrow><mrow><mi></mi><mo>=</mo><mrow><msubsup><mrow><mo>â€–</mo><msup><mi>ğƒ</mi><mo>âŸ‚</mo></msup><mo>â€–</mo></mrow><mn>2</mn><mn>2</mn></msubsup><mo>+</mo><msup><mrow><mo>(</mo><mrow><msub><mrow><mo>â€–</mo><msup><mi>ğƒ</mi><mo>âˆ¥</mo></msup><mo>â€–</mo></mrow><mn>2</mn></msub><mo>âˆ’</mo><mn>1</mn></mrow><mo>)</mo></mrow><mn>2</mn></msup></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">\displaystyle=\left\|\bm{\xi}^{\perp}\right\|_{2}^{2}+\left(\left\|\bm{\xi}^{\|}\right\|_{2}-1\right)^{2}.</annotation><annotation encoding="application/x-llamapun">= âˆ¥ bold_italic_Î¾ start_POSTSUPERSCRIPT âŸ‚ end_POSTSUPERSCRIPT âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + ( âˆ¥ bold_italic_Î¾ start_POSTSUPERSCRIPT âˆ¥ end_POSTSUPERSCRIPT âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT - 1 ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.3.28)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">We are going to show next that every such <math alttext="\bm{\xi}\in\mathcal{S}_{\delta}" class="ltx_Math" display="inline" id="S3.SS2.p2.m26"><semantics><mrow><mi>ğƒ</mi><mo>âˆˆ</mo><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mi>Î´</mi></msub></mrow><annotation encoding="application/x-tex">\bm{\xi}\in\mathcal{S}_{\delta}</annotation><annotation encoding="application/x-llamapun">bold_italic_Î¾ âˆˆ caligraphic_S start_POSTSUBSCRIPT italic_Î´ end_POSTSUBSCRIPT</annotation></semantics></math> can be
uniquely associated to a projection onto a single subspace in the mixture,
which will allow us to define a corresponding projection onto <math alttext="\mathcal{S}" class="ltx_Math" display="inline" id="S3.SS2.p2.m27"><semantics><mi class="ltx_font_mathcaligraphic">ğ’®</mi><annotation encoding="application/x-tex">\mathcal{S}</annotation><annotation encoding="application/x-llamapun">caligraphic_S</annotation></semantics></math>.
Given a <math alttext="\bm{\xi}\in\mathcal{S}_{\delta}" class="ltx_Math" display="inline" id="S3.SS2.p2.m28"><semantics><mrow><mi>ğƒ</mi><mo>âˆˆ</mo><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mi>Î´</mi></msub></mrow><annotation encoding="application/x-tex">\bm{\xi}\in\mathcal{S}_{\delta}</annotation><annotation encoding="application/x-llamapun">bold_italic_Î¾ âˆˆ caligraphic_S start_POSTSUBSCRIPT italic_Î´ end_POSTSUBSCRIPT</annotation></semantics></math>, by the above, we can find a subspace
<math alttext="\bm{U}_{k}" class="ltx_Math" display="inline" id="S3.SS2.p2.m29"><semantics><msub><mi>ğ‘¼</mi><mi>k</mi></msub><annotation encoding="application/x-tex">\bm{U}_{k}</annotation><annotation encoding="application/x-llamapun">bold_italic_U start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> such that the orthogonal decomposition <math alttext="\bm{\xi}=\bm{\xi}^{\|}_{k}+\bm{\xi}^{\perp}_{k}" class="ltx_Math" display="inline" id="S3.SS2.p2.m30"><semantics><mrow><mi>ğƒ</mi><mo>=</mo><mrow><msubsup><mi>ğƒ</mi><mi>k</mi><mo>âˆ¥</mo></msubsup><mo>+</mo><msubsup><mi>ğƒ</mi><mi>k</mi><mo>âŸ‚</mo></msubsup></mrow></mrow><annotation encoding="application/x-tex">\bm{\xi}=\bm{\xi}^{\|}_{k}+\bm{\xi}^{\perp}_{k}</annotation><annotation encoding="application/x-llamapun">bold_italic_Î¾ = bold_italic_Î¾ start_POSTSUPERSCRIPT âˆ¥ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT + bold_italic_Î¾ start_POSTSUPERSCRIPT âŸ‚ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> satisfies</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E29">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\left\|\bm{\xi}^{\perp}_{k}\right\|_{2}^{2}+\left(\left\|\bm{\xi}^{\|}_{k}\right\|_{2}-1\right)^{2}\leq\delta^{2}." class="ltx_Math" display="block" id="S3.E29.m1"><semantics><mrow><mrow><mrow><msubsup><mrow><mo>â€–</mo><msubsup><mi>ğƒ</mi><mi>k</mi><mo>âŸ‚</mo></msubsup><mo>â€–</mo></mrow><mn>2</mn><mn>2</mn></msubsup><mo>+</mo><msup><mrow><mo>(</mo><mrow><msub><mrow><mo>â€–</mo><msubsup><mi>ğƒ</mi><mi>k</mi><mo>âˆ¥</mo></msubsup><mo>â€–</mo></mrow><mn>2</mn></msub><mo>âˆ’</mo><mn>1</mn></mrow><mo>)</mo></mrow><mn>2</mn></msup></mrow><mo>â‰¤</mo><msup><mi>Î´</mi><mn>2</mn></msup></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">\left\|\bm{\xi}^{\perp}_{k}\right\|_{2}^{2}+\left(\left\|\bm{\xi}^{\|}_{k}\right\|_{2}-1\right)^{2}\leq\delta^{2}.</annotation><annotation encoding="application/x-llamapun">âˆ¥ bold_italic_Î¾ start_POSTSUPERSCRIPT âŸ‚ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + ( âˆ¥ bold_italic_Î¾ start_POSTSUPERSCRIPT âˆ¥ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT - 1 ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT â‰¤ italic_Î´ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.3.29)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">Consider the decomposition <math alttext="\bm{\xi}=\bm{\xi}_{j}^{\|}+\bm{\xi}_{j}^{\perp}" class="ltx_Math" display="inline" id="S3.SS2.p2.m31"><semantics><mrow><mi>ğƒ</mi><mo>=</mo><mrow><msubsup><mi>ğƒ</mi><mi>j</mi><mo>âˆ¥</mo></msubsup><mo>+</mo><msubsup><mi>ğƒ</mi><mi>j</mi><mo>âŸ‚</mo></msubsup></mrow></mrow><annotation encoding="application/x-tex">\bm{\xi}=\bm{\xi}_{j}^{\|}+\bm{\xi}_{j}^{\perp}</annotation><annotation encoding="application/x-llamapun">bold_italic_Î¾ = bold_italic_Î¾ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ¥ end_POSTSUPERSCRIPT + bold_italic_Î¾ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŸ‚ end_POSTSUPERSCRIPT</annotation></semantics></math> for some <math alttext="j\neq k" class="ltx_Math" display="inline" id="S3.SS2.p2.m32"><semantics><mrow><mi>j</mi><mo>â‰ </mo><mi>k</mi></mrow><annotation encoding="application/x-tex">j\neq k</annotation><annotation encoding="application/x-llamapun">italic_j â‰  italic_k</annotation></semantics></math>. We have</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S3.EGx154">
<tbody id="S3.E30"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\left\|\bm{\xi}_{j}^{\|}\right\|_{2}=\left\|\bm{U}_{j}\bm{U}_{j}^{\top}\bm{\xi}\right\|_{2}" class="ltx_Math" display="inline" id="S3.E30.m1"><semantics><mrow><msub><mrow><mo>â€–</mo><msubsup><mi>ğƒ</mi><mi>j</mi><mo>âˆ¥</mo></msubsup><mo>â€–</mo></mrow><mn>2</mn></msub><mo>=</mo><msub><mrow><mo>â€–</mo><mrow><msub><mi>ğ‘¼</mi><mi>j</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><msubsup><mi>ğ‘¼</mi><mi>j</mi><mo>âŠ¤</mo></msubsup><mo lspace="0em" rspace="0em">â€‹</mo><mi>ğƒ</mi></mrow><mo>â€–</mo></mrow><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\displaystyle\left\|\bm{\xi}_{j}^{\|}\right\|_{2}=\left\|\bm{U}_{j}\bm{U}_{j}^{\top}\bm{\xi}\right\|_{2}</annotation><annotation encoding="application/x-llamapun">âˆ¥ bold_italic_Î¾ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âˆ¥ end_POSTSUPERSCRIPT âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = âˆ¥ bold_italic_U start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT bold_italic_U start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Î¾ âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\left\|\bm{U}_{j}\bm{U}_{j}^{\top}(\bm{U}_{k}\bm{U}_{k}^{\top}\bm{\xi}+(\bm{I}-\bm{U}_{k}\bm{U}_{k}^{\top})\bm{\xi})\right\|_{2}" class="ltx_Math" display="inline" id="S3.E30.m2"><semantics><mrow><mi></mi><mo>=</mo><msub><mrow><mo>â€–</mo><mrow><msub><mi>ğ‘¼</mi><mi>j</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><msubsup><mi>ğ‘¼</mi><mi>j</mi><mo>âŠ¤</mo></msubsup><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mrow><msub><mi>ğ‘¼</mi><mi>k</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><msubsup><mi>ğ‘¼</mi><mi>k</mi><mo>âŠ¤</mo></msubsup><mo lspace="0em" rspace="0em">â€‹</mo><mi>ğƒ</mi></mrow><mo>+</mo><mrow><mrow><mo stretchy="false">(</mo><mrow><mi>ğ‘°</mi><mo>âˆ’</mo><mrow><msub><mi>ğ‘¼</mi><mi>k</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><msubsup><mi>ğ‘¼</mi><mi>k</mi><mo>âŠ¤</mo></msubsup></mrow></mrow><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mi>ğƒ</mi></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>â€–</mo></mrow><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\displaystyle=\left\|\bm{U}_{j}\bm{U}_{j}^{\top}(\bm{U}_{k}\bm{U}_{k}^{\top}\bm{\xi}+(\bm{I}-\bm{U}_{k}\bm{U}_{k}^{\top})\bm{\xi})\right\|_{2}</annotation><annotation encoding="application/x-llamapun">= âˆ¥ bold_italic_U start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT bold_italic_U start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( bold_italic_U start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT bold_italic_U start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT bold_italic_Î¾ + ( bold_italic_I - bold_italic_U start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT bold_italic_U start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ) bold_italic_Î¾ ) âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.3.30)</span></td>
</tr></tbody>
<tbody id="S3.E31"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\left\|\bm{U}_{j}\bm{U}_{j}^{\top}(\bm{I}-\bm{U}_{k}\bm{U}_{k}^{\top})\bm{\xi}\right\|_{2}" class="ltx_Math" display="inline" id="S3.E31.m1"><semantics><mrow><mi></mi><mo>=</mo><msub><mrow><mo>â€–</mo><mrow><msub><mi>ğ‘¼</mi><mi>j</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><msubsup><mi>ğ‘¼</mi><mi>j</mi><mo>âŠ¤</mo></msubsup><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><mi>ğ‘°</mi><mo>âˆ’</mo><mrow><msub><mi>ğ‘¼</mi><mi>k</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><msubsup><mi>ğ‘¼</mi><mi>k</mi><mo>âŠ¤</mo></msubsup></mrow></mrow><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mi>ğƒ</mi></mrow><mo>â€–</mo></mrow><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\displaystyle=\left\|\bm{U}_{j}\bm{U}_{j}^{\top}(\bm{I}-\bm{U}_{k}\bm{U}_{k}^{\top})\bm{\xi}\right\|_{2}</annotation><annotation encoding="application/x-llamapun">= âˆ¥ bold_italic_U start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT bold_italic_U start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ( bold_italic_I - bold_italic_U start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT bold_italic_U start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ) bold_italic_Î¾ âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.3.31)</span></td>
</tr></tbody>
<tbody id="S3.E32"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\leq\left\|(\bm{I}-\bm{U}_{k}\bm{U}_{k}^{\top})\bm{\xi}\right\|_{2}=\left\|\bm{\xi}_{k}^{\perp}\right\|_{2}\leq\delta," class="ltx_Math" display="inline" id="S3.E32.m1"><semantics><mrow><mrow><mi></mi><mo>â‰¤</mo><msub><mrow><mo>â€–</mo><mrow><mrow><mo stretchy="false">(</mo><mrow><mi>ğ‘°</mi><mo>âˆ’</mo><mrow><msub><mi>ğ‘¼</mi><mi>k</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><msubsup><mi>ğ‘¼</mi><mi>k</mi><mo>âŠ¤</mo></msubsup></mrow></mrow><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mi>ğƒ</mi></mrow><mo>â€–</mo></mrow><mn>2</mn></msub><mo>=</mo><msub><mrow><mo>â€–</mo><msubsup><mi>ğƒ</mi><mi>k</mi><mo>âŸ‚</mo></msubsup><mo>â€–</mo></mrow><mn>2</mn></msub><mo>â‰¤</mo><mi>Î´</mi></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">\displaystyle\leq\left\|(\bm{I}-\bm{U}_{k}\bm{U}_{k}^{\top})\bm{\xi}\right\|_{2}=\left\|\bm{\xi}_{k}^{\perp}\right\|_{2}\leq\delta,</annotation><annotation encoding="application/x-llamapun">â‰¤ âˆ¥ ( bold_italic_I - bold_italic_U start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT bold_italic_U start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŠ¤ end_POSTSUPERSCRIPT ) bold_italic_Î¾ âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = âˆ¥ bold_italic_Î¾ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT âŸ‚ end_POSTSUPERSCRIPT âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT â‰¤ italic_Î´ ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.3.32)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">where the second line uses the orthogonality assumption on the subspaces
<math alttext="\bm{U}_{k}" class="ltx_Math" display="inline" id="S3.SS2.p2.m33"><semantics><msub><mi>ğ‘¼</mi><mi>k</mi></msub><annotation encoding="application/x-tex">\bm{U}_{k}</annotation><annotation encoding="application/x-llamapun">bold_italic_U start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>, and the third uses the fact that orthogonal projections are
nonexpansive.
Hence, the <math alttext="j" class="ltx_Math" display="inline" id="S3.SS2.p2.m34"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation><annotation encoding="application/x-llamapun">italic_j</annotation></semantics></math>-th distance satisfies</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E33">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\left\|\bm{\xi}^{\perp}_{j}\right\|_{2}^{2}+\left(\left\|\bm{\xi}^{\|}_{j}\right\|_{2}-1\right)^{2}\geq(1-\delta)^{2}." class="ltx_Math" display="block" id="S3.E33.m1"><semantics><mrow><mrow><mrow><msubsup><mrow><mo>â€–</mo><msubsup><mi>ğƒ</mi><mi>j</mi><mo>âŸ‚</mo></msubsup><mo>â€–</mo></mrow><mn>2</mn><mn>2</mn></msubsup><mo>+</mo><msup><mrow><mo>(</mo><mrow><msub><mrow><mo>â€–</mo><msubsup><mi>ğƒ</mi><mi>j</mi><mo>âˆ¥</mo></msubsup><mo>â€–</mo></mrow><mn>2</mn></msub><mo>âˆ’</mo><mn>1</mn></mrow><mo>)</mo></mrow><mn>2</mn></msup></mrow><mo>â‰¥</mo><msup><mrow><mo stretchy="false">(</mo><mrow><mn>1</mn><mo>âˆ’</mo><mi>Î´</mi></mrow><mo stretchy="false">)</mo></mrow><mn>2</mn></msup></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">\left\|\bm{\xi}^{\perp}_{j}\right\|_{2}^{2}+\left(\left\|\bm{\xi}^{\|}_{j}\right\|_{2}-1\right)^{2}\geq(1-\delta)^{2}.</annotation><annotation encoding="application/x-llamapun">âˆ¥ bold_italic_Î¾ start_POSTSUPERSCRIPT âŸ‚ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + ( âˆ¥ bold_italic_Î¾ start_POSTSUPERSCRIPT âˆ¥ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT - 1 ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT â‰¥ ( 1 - italic_Î´ ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.3.33)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">This implies that if <math alttext="0&lt;\delta&lt;1/2" class="ltx_Math" display="inline" id="S3.SS2.p2.m35"><semantics><mrow><mn>0</mn><mo>&lt;</mo><mi>Î´</mi><mo>&lt;</mo><mrow><mn>1</mn><mo>/</mo><mn>2</mn></mrow></mrow><annotation encoding="application/x-tex">0&lt;\delta&lt;1/2</annotation><annotation encoding="application/x-llamapun">0 &lt; italic_Î´ &lt; 1 / 2</annotation></semantics></math>, every <math alttext="\bm{\xi}\in\mathcal{S}_{\delta}" class="ltx_Math" display="inline" id="S3.SS2.p2.m36"><semantics><mrow><mi>ğƒ</mi><mo>âˆˆ</mo><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mi>Î´</mi></msub></mrow><annotation encoding="application/x-tex">\bm{\xi}\in\mathcal{S}_{\delta}</annotation><annotation encoding="application/x-llamapun">bold_italic_Î¾ âˆˆ caligraphic_S start_POSTSUBSCRIPT italic_Î´ end_POSTSUBSCRIPT</annotation></semantics></math> has
a unique closest subspace in the mixture.
Hence, under this condition, the following mapping <math alttext="\pi_{\mathcal{S}}:\mathcal{S}_{\delta}\to\mathcal{S}" class="ltx_Math" display="inline" id="S3.SS2.p2.m37"><semantics><mrow><msub><mi>Ï€</mi><mi class="ltx_font_mathcaligraphic">ğ’®</mi></msub><mo lspace="0.278em" rspace="0.278em">:</mo><mrow><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mi>Î´</mi></msub><mo stretchy="false">â†’</mo><mi class="ltx_font_mathcaligraphic">ğ’®</mi></mrow></mrow><annotation encoding="application/x-tex">\pi_{\mathcal{S}}:\mathcal{S}_{\delta}\to\mathcal{S}</annotation><annotation encoding="application/x-llamapun">italic_Ï€ start_POSTSUBSCRIPT caligraphic_S end_POSTSUBSCRIPT : caligraphic_S start_POSTSUBSCRIPT italic_Î´ end_POSTSUBSCRIPT â†’ caligraphic_S</annotation></semantics></math> is well-defined:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E34">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\pi_{\mathcal{S}}(\bm{\xi})=\pi_{\mathcal{S}_{k_{\star}}}(\bm{\xi}),\enspace\text{where}\enspace k_{\star}=\operatorname*{arg\ min}_{k\in[K]}\,\operatorname{dist}(\bm{\xi},\mathcal{S}_{k})." class="ltx_Math" display="block" id="S3.E34.m1"><semantics><mrow><mrow><mrow><mrow><msub><mi>Ï€</mi><mi class="ltx_font_mathcaligraphic">ğ’®</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><msub><mi>Ï€</mi><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><msub><mi>k</mi><mo>â‹†</mo></msub></msub></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mo rspace="0.667em">,</mo><mrow><mrow><mtext>where</mtext><mo lspace="0.500em" rspace="0em">â€‹</mo><msub><mi>k</mi><mo>â‹†</mo></msub></mrow><mo>=</mo><mrow><mrow><munder><mrow><mi>arg</mi><mo lspace="0.500em" rspace="0em">â€‹</mo><mi>min</mi></mrow><mrow><mi>k</mi><mo>âˆˆ</mo><mrow><mo stretchy="false">[</mo><mi>K</mi><mo stretchy="false">]</mo></mrow></mrow></munder><mo lspace="0.167em">â¡</mo><mi>dist</mi></mrow><mo>â¡</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo>,</mo><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mi>k</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">\pi_{\mathcal{S}}(\bm{\xi})=\pi_{\mathcal{S}_{k_{\star}}}(\bm{\xi}),\enspace\text{where}\enspace k_{\star}=\operatorname*{arg\ min}_{k\in[K]}\,\operatorname{dist}(\bm{\xi},\mathcal{S}_{k}).</annotation><annotation encoding="application/x-llamapun">italic_Ï€ start_POSTSUBSCRIPT caligraphic_S end_POSTSUBSCRIPT ( bold_italic_Î¾ ) = italic_Ï€ start_POSTSUBSCRIPT caligraphic_S start_POSTSUBSCRIPT italic_k start_POSTSUBSCRIPT â‹† end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_Î¾ ) , where italic_k start_POSTSUBSCRIPT â‹† end_POSTSUBSCRIPT = start_OPERATOR roman_arg roman_min end_OPERATOR start_POSTSUBSCRIPT italic_k âˆˆ [ italic_K ] end_POSTSUBSCRIPT roman_dist ( bold_italic_Î¾ , caligraphic_S start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.3.34)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS2.p3">
<p class="ltx_p">Now, we define a code for <math alttext="\bm{x}_{\delta}" class="ltx_Math" display="inline" id="S3.SS2.p3.m1"><semantics><msub><mi>ğ’™</mi><mi>Î´</mi></msub><annotation encoding="application/x-tex">\bm{x}_{\delta}</annotation><annotation encoding="application/x-llamapun">bold_italic_x start_POSTSUBSCRIPT italic_Î´ end_POSTSUBSCRIPT</annotation></semantics></math> by</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E35">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{\bm{x}}_{\delta}=\mathrm{q}(\pi_{\mathcal{S}}(\bm{x}_{\delta}))." class="ltx_Math" display="block" id="S3.E35.m1"><semantics><mrow><mrow><msub><mover accent="true"><mi>ğ’™</mi><mo>^</mo></mover><mi>Î´</mi></msub><mo>=</mo><mrow><mi mathvariant="normal">q</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><msub><mi>Ï€</mi><mi class="ltx_font_mathcaligraphic">ğ’®</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ’™</mi><mi>Î´</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">\hat{\bm{x}}_{\delta}=\mathrm{q}(\pi_{\mathcal{S}}(\bm{x}_{\delta})).</annotation><annotation encoding="application/x-llamapun">over^ start_ARG bold_italic_x end_ARG start_POSTSUBSCRIPT italic_Î´ end_POSTSUBSCRIPT = roman_q ( italic_Ï€ start_POSTSUBSCRIPT caligraphic_S end_POSTSUBSCRIPT ( bold_italic_x start_POSTSUBSCRIPT italic_Î´ end_POSTSUBSCRIPT ) ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.3.35)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">Clearly this is associated to a rate-<math alttext="R" class="ltx_Math" display="inline" id="S3.SS2.p3.m2"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation><annotation encoding="application/x-llamapun">italic_R</annotation></semantics></math> code for <math alttext="\bm{x}_{\delta}" class="ltx_Math" display="inline" id="S3.SS2.p3.m3"><semantics><msub><mi>ğ’™</mi><mi>Î´</mi></msub><annotation encoding="application/x-tex">\bm{x}_{\delta}</annotation><annotation encoding="application/x-llamapun">bold_italic_x start_POSTSUBSCRIPT italic_Î´ end_POSTSUBSCRIPT</annotation></semantics></math>, because it
uses the encoding-decoding mappings from the rate-<math alttext="R" class="ltx_Math" display="inline" id="S3.SS2.p3.m4"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation><annotation encoding="application/x-llamapun">italic_R</annotation></semantics></math> code for <math alttext="\bm{x}" class="ltx_Math" display="inline" id="S3.SS2.p3.m5"><semantics><mi>ğ’™</mi><annotation encoding="application/x-tex">\bm{x}</annotation><annotation encoding="application/x-llamapun">bold_italic_x</annotation></semantics></math>. We
have to show that it achieves small distortion.
We calculate</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S3.EGx155">
<tbody id="S3.E36"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbb{E}\left[\left\|\bm{x}_{\delta}-\hat{\bm{x}}_{\delta}\right\|_{2}^{2}\right]" class="ltx_Math" display="inline" id="S3.E36.m1"><semantics><mrow><mi>ğ”¼</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo>[</mo><msubsup><mrow><mo>â€–</mo><mrow><msub><mi>ğ’™</mi><mi>Î´</mi></msub><mo>âˆ’</mo><msub><mover accent="true"><mi>ğ’™</mi><mo>^</mo></mover><mi>Î´</mi></msub></mrow><mo>â€–</mo></mrow><mn>2</mn><mn>2</mn></msubsup><mo>]</mo></mrow></mrow><annotation encoding="application/x-tex">\displaystyle\mathbb{E}\left[\left\|\bm{x}_{\delta}-\hat{\bm{x}}_{\delta}\right\|_{2}^{2}\right]</annotation><annotation encoding="application/x-llamapun">blackboard_E [ âˆ¥ bold_italic_x start_POSTSUBSCRIPT italic_Î´ end_POSTSUBSCRIPT - over^ start_ARG bold_italic_x end_ARG start_POSTSUBSCRIPT italic_Î´ end_POSTSUBSCRIPT âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ]</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathbb{E}\left[\left\|\bm{x}_{\delta}-\mathrm{q}(\pi_{\mathcal{S}}(\bm{x}_{\delta}))\right\|_{2}^{2}\right]" class="ltx_Math" display="inline" id="S3.E36.m2"><semantics><mrow><mi></mi><mo>=</mo><mrow><mi>ğ”¼</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo>[</mo><msubsup><mrow><mo>â€–</mo><mrow><msub><mi>ğ’™</mi><mi>Î´</mi></msub><mo>âˆ’</mo><mrow><mi mathvariant="normal">q</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><msub><mi>Ï€</mi><mi class="ltx_font_mathcaligraphic">ğ’®</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ’™</mi><mi>Î´</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>â€–</mo></mrow><mn>2</mn><mn>2</mn></msubsup><mo>]</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=\mathbb{E}\left[\left\|\bm{x}_{\delta}-\mathrm{q}(\pi_{\mathcal{S}}(\bm{x}_{\delta}))\right\|_{2}^{2}\right]</annotation><annotation encoding="application/x-llamapun">= blackboard_E [ âˆ¥ bold_italic_x start_POSTSUBSCRIPT italic_Î´ end_POSTSUBSCRIPT - roman_q ( italic_Ï€ start_POSTSUBSCRIPT caligraphic_S end_POSTSUBSCRIPT ( bold_italic_x start_POSTSUBSCRIPT italic_Î´ end_POSTSUBSCRIPT ) ) âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.3.36)</span></td>
</tr></tbody>
<tbody id="S3.E37"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\leq\left(\mathbb{E}\left[\left\|\bm{x}_{\delta}-\pi_{\mathcal{S}}(\bm{x}_{\delta})\right\|_{2}^{2}\right]^{1/2}+\mathbb{E}\left[\left\|\pi_{\mathcal{S}}(\bm{x}_{\delta})-\mathrm{q}(\pi_{\mathcal{S}}(\bm{x}_{\delta}))\right\|_{2}^{2}\right]^{1/2}\right)^{2}," class="ltx_Math" display="inline" id="S3.E37.m1"><semantics><mrow><mrow><mi></mi><mo>â‰¤</mo><msup><mrow><mo>(</mo><mrow><mrow><mi>ğ”¼</mi><mo lspace="0em" rspace="0em">â€‹</mo><msup><mrow><mo>[</mo><msubsup><mrow><mo>â€–</mo><mrow><msub><mi>ğ’™</mi><mi>Î´</mi></msub><mo>âˆ’</mo><mrow><msub><mi>Ï€</mi><mi class="ltx_font_mathcaligraphic">ğ’®</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ’™</mi><mi>Î´</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>â€–</mo></mrow><mn>2</mn><mn>2</mn></msubsup><mo>]</mo></mrow><mrow><mn>1</mn><mo>/</mo><mn>2</mn></mrow></msup></mrow><mo>+</mo><mrow><mi>ğ”¼</mi><mo lspace="0em" rspace="0em">â€‹</mo><msup><mrow><mo>[</mo><msubsup><mrow><mo>â€–</mo><mrow><mrow><msub><mi>Ï€</mi><mi class="ltx_font_mathcaligraphic">ğ’®</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ’™</mi><mi>Î´</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>âˆ’</mo><mrow><mi mathvariant="normal">q</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><msub><mi>Ï€</mi><mi class="ltx_font_mathcaligraphic">ğ’®</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ’™</mi><mi>Î´</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>â€–</mo></mrow><mn>2</mn><mn>2</mn></msubsup><mo>]</mo></mrow><mrow><mn>1</mn><mo>/</mo><mn>2</mn></mrow></msup></mrow></mrow><mo>)</mo></mrow><mn>2</mn></msup></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">\displaystyle\leq\left(\mathbb{E}\left[\left\|\bm{x}_{\delta}-\pi_{\mathcal{S}}(\bm{x}_{\delta})\right\|_{2}^{2}\right]^{1/2}+\mathbb{E}\left[\left\|\pi_{\mathcal{S}}(\bm{x}_{\delta})-\mathrm{q}(\pi_{\mathcal{S}}(\bm{x}_{\delta}))\right\|_{2}^{2}\right]^{1/2}\right)^{2},</annotation><annotation encoding="application/x-llamapun">â‰¤ ( blackboard_E [ âˆ¥ bold_italic_x start_POSTSUBSCRIPT italic_Î´ end_POSTSUBSCRIPT - italic_Ï€ start_POSTSUBSCRIPT caligraphic_S end_POSTSUBSCRIPT ( bold_italic_x start_POSTSUBSCRIPT italic_Î´ end_POSTSUBSCRIPT ) âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ] start_POSTSUPERSCRIPT 1 / 2 end_POSTSUPERSCRIPT + blackboard_E [ âˆ¥ italic_Ï€ start_POSTSUBSCRIPT caligraphic_S end_POSTSUBSCRIPT ( bold_italic_x start_POSTSUBSCRIPT italic_Î´ end_POSTSUBSCRIPT ) - roman_q ( italic_Ï€ start_POSTSUBSCRIPT caligraphic_S end_POSTSUBSCRIPT ( bold_italic_x start_POSTSUBSCRIPT italic_Î´ end_POSTSUBSCRIPT ) ) âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ] start_POSTSUPERSCRIPT 1 / 2 end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.3.37)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">where the inequality uses the Minkowski inequality.
Now, by <a class="ltx_ref" href="#Thmdefinition1" title="Definition B.1. â€£ B.3.1 Proof of Relationship Between Rate Distortion and Covering â€£ B.3 Lossy Coding and Sphere Packing â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Definitions</span>Â <span class="ltx_text ltx_ref_tag">B.1</span></a> andÂ <a class="ltx_ref" href="#Thmdefinition2" title="Definition B.2. â€£ B.3.1 Proof of Relationship Between Rate Distortion and Covering â€£ B.3 Lossy Coding and Sphere Packing â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">B.2</span></a>, we have
deterministically</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E38">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\left\|\bm{x}_{\delta}-\pi_{\mathcal{S}}(\bm{x}_{\delta})\right\|_{2}^{2}\leq\delta^{2}," class="ltx_Math" display="block" id="S3.E38.m1"><semantics><mrow><mrow><msubsup><mrow><mo>â€–</mo><mrow><msub><mi>ğ’™</mi><mi>Î´</mi></msub><mo>âˆ’</mo><mrow><msub><mi>Ï€</mi><mi class="ltx_font_mathcaligraphic">ğ’®</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ’™</mi><mi>Î´</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>â€–</mo></mrow><mn>2</mn><mn>2</mn></msubsup><mo>â‰¤</mo><msup><mi>Î´</mi><mn>2</mn></msup></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">\left\|\bm{x}_{\delta}-\pi_{\mathcal{S}}(\bm{x}_{\delta})\right\|_{2}^{2}\leq\delta^{2},</annotation><annotation encoding="application/x-llamapun">âˆ¥ bold_italic_x start_POSTSUBSCRIPT italic_Î´ end_POSTSUBSCRIPT - italic_Ï€ start_POSTSUBSCRIPT caligraphic_S end_POSTSUBSCRIPT ( bold_italic_x start_POSTSUBSCRIPT italic_Î´ end_POSTSUBSCRIPT ) âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT â‰¤ italic_Î´ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.3.38)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">so the expectation also satisfies this estimate.
For the second term, it will suffice to characterize the density of the
random variable <math alttext="\pi_{\mathcal{S}}(\bm{x}_{\delta})" class="ltx_Math" display="inline" id="S3.SS2.p3.m6"><semantics><mrow><msub><mi>Ï€</mi><mi class="ltx_font_mathcaligraphic">ğ’®</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ’™</mi><mi>Î´</mi></msub><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">\pi_{\mathcal{S}}(\bm{x}_{\delta})</annotation><annotation encoding="application/x-llamapun">italic_Ï€ start_POSTSUBSCRIPT caligraphic_S end_POSTSUBSCRIPT ( bold_italic_x start_POSTSUBSCRIPT italic_Î´ end_POSTSUBSCRIPT )</annotation></semantics></math> as being sufficiently close to the
density of <math alttext="\bm{x}" class="ltx_Math" display="inline" id="S3.SS2.p3.m7"><semantics><mi>ğ’™</mi><annotation encoding="application/x-tex">\bm{x}</annotation><annotation encoding="application/x-llamapun">bold_italic_x</annotation></semantics></math>â€”which, as <a class="ltx_ref" href="#Thmassumption3" title="Assumption B.3. â€£ B.3 Lossy Coding and Sphere Packing â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Assumption</span>Â <span class="ltx_text ltx_ref_tag">B.3</span></a> implies, is
a mixture of uniform distributions on each sub-sphere <math alttext="\mathcal{S}_{k}" class="ltx_Math" display="inline" id="S3.SS2.p3.m8"><semantics><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mi>k</mi></msub><annotation encoding="application/x-tex">\mathcal{S}_{k}</annotation><annotation encoding="application/x-llamapun">caligraphic_S start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>.
By the argument above, every point <math alttext="\bm{\xi}\in\mathcal{S}_{\delta}" class="ltx_Math" display="inline" id="S3.SS2.p3.m9"><semantics><mrow><mi>ğƒ</mi><mo>âˆˆ</mo><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mi>Î´</mi></msub></mrow><annotation encoding="application/x-tex">\bm{\xi}\in\mathcal{S}_{\delta}</annotation><annotation encoding="application/x-llamapun">bold_italic_Î¾ âˆˆ caligraphic_S start_POSTSUBSCRIPT italic_Î´ end_POSTSUBSCRIPT</annotation></semantics></math> can be associated
to one and only one subspace <math alttext="\bm{U}_{k}" class="ltx_Math" display="inline" id="S3.SS2.p3.m10"><semantics><msub><mi>ğ‘¼</mi><mi>k</mi></msub><annotation encoding="application/x-tex">\bm{U}_{k}</annotation><annotation encoding="application/x-llamapun">bold_italic_U start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>, which means that the mixture
components in the definition of <math alttext="\mathcal{S}_{\delta}" class="ltx_Math" display="inline" id="S3.SS2.p3.m11"><semantics><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mi>Î´</mi></msub><annotation encoding="application/x-tex">\mathcal{S}_{\delta}</annotation><annotation encoding="application/x-llamapun">caligraphic_S start_POSTSUBSCRIPT italic_Î´ end_POSTSUBSCRIPT</annotation></semantics></math> (recall
<a class="ltx_ref" href="#Thmdefinition2" title="Definition B.2. â€£ B.3.1 Proof of Relationship Between Rate Distortion and Covering â€£ B.3 Lossy Coding and Sphere Packing â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Definition</span>Â <span class="ltx_text ltx_ref_tag">B.2</span></a>) do not overlap. Hence, the density
<math alttext="\pi_{\mathcal{S}}(\bm{x}_{\delta})" class="ltx_Math" display="inline" id="S3.SS2.p3.m12"><semantics><mrow><msub><mi>Ï€</mi><mi class="ltx_font_mathcaligraphic">ğ’®</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ’™</mi><mi>Î´</mi></msub><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">\pi_{\mathcal{S}}(\bm{x}_{\delta})</annotation><annotation encoding="application/x-llamapun">italic_Ï€ start_POSTSUBSCRIPT caligraphic_S end_POSTSUBSCRIPT ( bold_italic_x start_POSTSUBSCRIPT italic_Î´ end_POSTSUBSCRIPT )</annotation></semantics></math> can be characterized by studying the effect of
<math alttext="\pi_{\mathcal{S}_{k}}" class="ltx_Math" display="inline" id="S3.SS2.p3.m13"><semantics><msub><mi>Ï€</mi><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mi>k</mi></msub></msub><annotation encoding="application/x-tex">\pi_{\mathcal{S}_{k}}</annotation><annotation encoding="application/x-llamapun">italic_Ï€ start_POSTSUBSCRIPT caligraphic_S start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> on the conditional random variable <math alttext="\bm{x}_{\delta}" class="ltx_Math" display="inline" id="S3.SS2.p3.m14"><semantics><msub><mi>ğ’™</mi><mi>Î´</mi></msub><annotation encoding="application/x-tex">\bm{x}_{\delta}</annotation><annotation encoding="application/x-llamapun">bold_italic_x start_POSTSUBSCRIPT italic_Î´ end_POSTSUBSCRIPT</annotation></semantics></math>, conditioned
on being drawn from <math alttext="\mathcal{S}_{k,\delta}" class="ltx_Math" display="inline" id="S3.SS2.p3.m15"><semantics><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mrow><mi>k</mi><mo>,</mo><mi>Î´</mi></mrow></msub><annotation encoding="application/x-tex">\mathcal{S}_{k,\delta}</annotation><annotation encoding="application/x-llamapun">caligraphic_S start_POSTSUBSCRIPT italic_k , italic_Î´ end_POSTSUBSCRIPT</annotation></semantics></math>. Denote this measure by <math alttext="\mu_{k,\delta}" class="ltx_Math" display="inline" id="S3.SS2.p3.m16"><semantics><msub><mi>Î¼</mi><mrow><mi>k</mi><mo>,</mo><mi>Î´</mi></mrow></msub><annotation encoding="application/x-tex">\mu_{k,\delta}</annotation><annotation encoding="application/x-llamapun">italic_Î¼ start_POSTSUBSCRIPT italic_k , italic_Î´ end_POSTSUBSCRIPT</annotation></semantics></math>.
We claim that the pushforward of this measure under <math alttext="\pi_{\mathcal{S}_{k}}" class="ltx_Math" display="inline" id="S3.SS2.p3.m17"><semantics><msub><mi>Ï€</mi><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mi>k</mi></msub></msub><annotation encoding="application/x-tex">\pi_{\mathcal{S}_{k}}</annotation><annotation encoding="application/x-llamapun">italic_Ï€ start_POSTSUBSCRIPT caligraphic_S start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> is uniform on <math alttext="\mathcal{S}_{k}" class="ltx_Math" display="inline" id="S3.SS2.p3.m18"><semantics><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mi>k</mi></msub><annotation encoding="application/x-tex">\mathcal{S}_{k}</annotation><annotation encoding="application/x-llamapun">caligraphic_S start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>.
To see that this holds, we recall
<a class="ltx_ref" href="#S3.E28" title="In B.3.2 Deferred Proofs â€£ B.3 Lossy Coding and Sphere Packing â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Equation</span>Â <span class="ltx_text ltx_ref_tag">B.3.28</span></a>,
which gives the characterization</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E39">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{S}_{k,\delta}=\left\{\bm{\xi}^{\|}+\bm{\xi}^{\perp}\mid\bm{\xi}^{\|}\in\operatorname{Span}(\bm{U}_{k}),\bm{\xi}^{\perp}\in\operatorname{Span}(\bm{U}_{k})^{\perp},\left\|\bm{\xi}^{\perp}\right\|_{2}^{2}+\left(\left\|\bm{\xi}^{\|}\right\|_{2}-1\right)^{2}\leq\delta\right\}." class="ltx_math_unparsed" display="block" id="S3.E39.m1"><semantics><mrow><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mrow><mi>k</mi><mo>,</mo><mi>Î´</mi></mrow></msub><mo>=</mo><mrow><mo>{</mo><msup><mi>ğƒ</mi><mo>âˆ¥</mo></msup><mo>+</mo><msup><mi>ğƒ</mi><mo>âŸ‚</mo></msup><mo lspace="0em" rspace="0.167em">âˆ£</mo><msup><mi>ğƒ</mi><mo>âˆ¥</mo></msup><mo>âˆˆ</mo><mi>Span</mi><mrow><mo stretchy="false">(</mo><msub><mi>ğ‘¼</mi><mi>k</mi></msub><mo stretchy="false">)</mo></mrow><mo>,</mo><msup><mi>ğƒ</mi><mo>âŸ‚</mo></msup><mo>âˆˆ</mo><mi>Span</mi><msup><mrow><mo stretchy="false">(</mo><msub><mi>ğ‘¼</mi><mi>k</mi></msub><mo stretchy="false">)</mo></mrow><mo>âŸ‚</mo></msup><mo>,</mo><mo lspace="0em" rspace="0.167em" stretchy="true">âˆ¥</mo><msup><mi>ğƒ</mi><mo>âŸ‚</mo></msup><msubsup><mo lspace="0em" rspace="0em" stretchy="true">âˆ¥</mo><mn>2</mn><mn>2</mn></msubsup><mo lspace="0em">+</mo><msup><mrow><mo>(</mo><mo lspace="0em" rspace="0.167em" stretchy="true">âˆ¥</mo><msup><mi>ğƒ</mi><mo>âˆ¥</mo></msup><msub><mo lspace="0em" rspace="0em" stretchy="true">âˆ¥</mo><mn>2</mn></msub><mo lspace="0em">âˆ’</mo><mn>1</mn><mo>)</mo></mrow><mn>2</mn></msup><mo>â‰¤</mo><mi>Î´</mi><mo>}</mo></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">\mathcal{S}_{k,\delta}=\left\{\bm{\xi}^{\|}+\bm{\xi}^{\perp}\mid\bm{\xi}^{\|}\in\operatorname{Span}(\bm{U}_{k}),\bm{\xi}^{\perp}\in\operatorname{Span}(\bm{U}_{k})^{\perp},\left\|\bm{\xi}^{\perp}\right\|_{2}^{2}+\left(\left\|\bm{\xi}^{\|}\right\|_{2}-1\right)^{2}\leq\delta\right\}.</annotation><annotation encoding="application/x-llamapun">caligraphic_S start_POSTSUBSCRIPT italic_k , italic_Î´ end_POSTSUBSCRIPT = { bold_italic_Î¾ start_POSTSUPERSCRIPT âˆ¥ end_POSTSUPERSCRIPT + bold_italic_Î¾ start_POSTSUPERSCRIPT âŸ‚ end_POSTSUPERSCRIPT âˆ£ bold_italic_Î¾ start_POSTSUPERSCRIPT âˆ¥ end_POSTSUPERSCRIPT âˆˆ roman_Span ( bold_italic_U start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) , bold_italic_Î¾ start_POSTSUPERSCRIPT âŸ‚ end_POSTSUPERSCRIPT âˆˆ roman_Span ( bold_italic_U start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT âŸ‚ end_POSTSUPERSCRIPT , âˆ¥ bold_italic_Î¾ start_POSTSUPERSCRIPT âŸ‚ end_POSTSUPERSCRIPT âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + ( âˆ¥ bold_italic_Î¾ start_POSTSUPERSCRIPT âˆ¥ end_POSTSUPERSCRIPT âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT - 1 ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT â‰¤ italic_Î´ } .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.3.39)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">The conditional distribution in question is uniform on this set; we need to
show that the projection <math alttext="\pi_{\mathcal{S}_{k}}" class="ltx_Math" display="inline" id="S3.SS2.p3.m19"><semantics><msub><mi>Ï€</mi><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mi>k</mi></msub></msub><annotation encoding="application/x-tex">\pi_{\mathcal{S}_{k}}</annotation><annotation encoding="application/x-llamapun">italic_Ï€ start_POSTSUBSCRIPT caligraphic_S start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> applied to this conditional random
variable yields a random variable that is uniform on <math alttext="\mathcal{S}_{k}" class="ltx_Math" display="inline" id="S3.SS2.p3.m20"><semantics><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mi>k</mi></msub><annotation encoding="application/x-tex">\mathcal{S}_{k}</annotation><annotation encoding="application/x-llamapun">caligraphic_S start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>.
With respect to these coordinates, we have seen that <math alttext="\pi_{\mathcal{S}_{k}}(\bm{\xi}^{\|}+\bm{\xi}^{\perp})=\bm{\xi}^{\|}/\|\bm{\xi}^{\|}\|_{2}" class="ltx_Math" display="inline" id="S3.SS2.p3.m21"><semantics><mrow><mrow><msub><mi>Ï€</mi><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mi>k</mi></msub></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><msup><mi>ğƒ</mi><mo>âˆ¥</mo></msup><mo>+</mo><msup><mi>ğƒ</mi><mo>âŸ‚</mo></msup></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><msup><mi>ğƒ</mi><mo>âˆ¥</mo></msup><mo>/</mo><msub><mrow><mo stretchy="false">â€–</mo><msup><mi>ğƒ</mi><mo>âˆ¥</mo></msup><mo stretchy="false">â€–</mo></mrow><mn>2</mn></msub></mrow></mrow><annotation encoding="application/x-tex">\pi_{\mathcal{S}_{k}}(\bm{\xi}^{\|}+\bm{\xi}^{\perp})=\bm{\xi}^{\|}/\|\bm{\xi}^{\|}\|_{2}</annotation><annotation encoding="application/x-llamapun">italic_Ï€ start_POSTSUBSCRIPT caligraphic_S start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_italic_Î¾ start_POSTSUPERSCRIPT âˆ¥ end_POSTSUPERSCRIPT + bold_italic_Î¾ start_POSTSUPERSCRIPT âŸ‚ end_POSTSUPERSCRIPT ) = bold_italic_Î¾ start_POSTSUPERSCRIPT âˆ¥ end_POSTSUPERSCRIPT / âˆ¥ bold_italic_Î¾ start_POSTSUPERSCRIPT âˆ¥ end_POSTSUPERSCRIPT âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>.
Hence, for any <math alttext="\bm{\xi}\in\mathcal{S}_{k}" class="ltx_Math" display="inline" id="S3.SS2.p3.m22"><semantics><mrow><mi>ğƒ</mi><mo>âˆˆ</mo><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">\bm{\xi}\in\mathcal{S}_{k}</annotation><annotation encoding="application/x-llamapun">bold_italic_Î¾ âˆˆ caligraphic_S start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>, we have that the preimage of <math alttext="\bm{\xi}" class="ltx_Math" display="inline" id="S3.SS2.p3.m23"><semantics><mi>ğƒ</mi><annotation encoding="application/x-tex">\bm{\xi}</annotation><annotation encoding="application/x-llamapun">bold_italic_Î¾</annotation></semantics></math> in
<math alttext="\mathcal{S}_{k,\delta}" class="ltx_Math" display="inline" id="S3.SS2.p3.m24"><semantics><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mrow><mi>k</mi><mo>,</mo><mi>Î´</mi></mrow></msub><annotation encoding="application/x-tex">\mathcal{S}_{k,\delta}</annotation><annotation encoding="application/x-llamapun">caligraphic_S start_POSTSUBSCRIPT italic_k , italic_Î´ end_POSTSUBSCRIPT</annotation></semantics></math> under <math alttext="\pi_{\mathcal{S}_{k}}" class="ltx_Math" display="inline" id="S3.SS2.p3.m25"><semantics><msub><mi>Ï€</mi><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mi>k</mi></msub></msub><annotation encoding="application/x-tex">\pi_{\mathcal{S}_{k}}</annotation><annotation encoding="application/x-llamapun">italic_Ï€ start_POSTSUBSCRIPT caligraphic_S start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> is</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E40">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\pi_{\mathcal{S}_{k}}^{-1}(\bm{\xi})=\left\{r\bm{\xi}+\bm{\xi}^{\perp}\mid r&gt;0,\bm{\xi}^{\perp}\in\operatorname{Span}(\bm{U}_{k})^{\perp},\left\|\bm{\xi}^{\perp}\right\|_{2}^{2}+\left(r-1\right)^{2}\leq\delta\right\}." class="ltx_math_unparsed" display="block" id="S3.E40.m1"><semantics><mrow><msubsup><mi>Ï€</mi><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mi>k</mi></msub><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msubsup><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow><mo>=</mo><mrow><mo>{</mo><mi>r</mi><mi>ğƒ</mi><mo>+</mo><msup><mi>ğƒ</mi><mo>âŸ‚</mo></msup><mo lspace="0em" rspace="0.167em">âˆ£</mo><mi>r</mi><mo>&gt;</mo><mn>0</mn><mo>,</mo><msup><mi>ğƒ</mi><mo>âŸ‚</mo></msup><mo>âˆˆ</mo><mi>Span</mi><msup><mrow><mo stretchy="false">(</mo><msub><mi>ğ‘¼</mi><mi>k</mi></msub><mo stretchy="false">)</mo></mrow><mo>âŸ‚</mo></msup><mo>,</mo><mo lspace="0em" rspace="0.167em" stretchy="true">âˆ¥</mo><msup><mi>ğƒ</mi><mo>âŸ‚</mo></msup><msubsup><mo lspace="0em" rspace="0em" stretchy="true">âˆ¥</mo><mn>2</mn><mn>2</mn></msubsup><mo lspace="0em">+</mo><msup><mrow><mo>(</mo><mi>r</mi><mo>âˆ’</mo><mn>1</mn><mo>)</mo></mrow><mn>2</mn></msup><mo>â‰¤</mo><mi>Î´</mi><mo>}</mo></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">\pi_{\mathcal{S}_{k}}^{-1}(\bm{\xi})=\left\{r\bm{\xi}+\bm{\xi}^{\perp}\mid r&gt;0,\bm{\xi}^{\perp}\in\operatorname{Span}(\bm{U}_{k})^{\perp},\left\|\bm{\xi}^{\perp}\right\|_{2}^{2}+\left(r-1\right)^{2}\leq\delta\right\}.</annotation><annotation encoding="application/x-llamapun">italic_Ï€ start_POSTSUBSCRIPT caligraphic_S start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ( bold_italic_Î¾ ) = { italic_r bold_italic_Î¾ + bold_italic_Î¾ start_POSTSUPERSCRIPT âŸ‚ end_POSTSUPERSCRIPT âˆ£ italic_r &gt; 0 , bold_italic_Î¾ start_POSTSUPERSCRIPT âŸ‚ end_POSTSUPERSCRIPT âˆˆ roman_Span ( bold_italic_U start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT âŸ‚ end_POSTSUPERSCRIPT , âˆ¥ bold_italic_Î¾ start_POSTSUPERSCRIPT âŸ‚ end_POSTSUPERSCRIPT âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + ( italic_r - 1 ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT â‰¤ italic_Î´ } .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.3.40)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">To show that <math alttext="(\pi_{\mathcal{S}_{k}})_{\sharp}\mu_{k,\delta}" class="ltx_Math" display="inline" id="S3.SS2.p3.m26"><semantics><mrow><msub><mrow><mo stretchy="false">(</mo><msub><mi>Ï€</mi><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mi>k</mi></msub></msub><mo stretchy="false">)</mo></mrow><mi mathvariant="normal">â™¯</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><msub><mi>Î¼</mi><mrow><mi>k</mi><mo>,</mo><mi>Î´</mi></mrow></msub></mrow><annotation encoding="application/x-tex">(\pi_{\mathcal{S}_{k}})_{\sharp}\mu_{k,\delta}</annotation><annotation encoding="application/x-llamapun">( italic_Ï€ start_POSTSUBSCRIPT caligraphic_S start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) start_POSTSUBSCRIPT â™¯ end_POSTSUBSCRIPT italic_Î¼ start_POSTSUBSCRIPT italic_k , italic_Î´ end_POSTSUBSCRIPT</annotation></semantics></math> is uniform, we need to
decompose the integral of the uniform density on <math alttext="\mathcal{S}_{k,\delta}" class="ltx_Math" display="inline" id="S3.SS2.p3.m27"><semantics><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mrow><mi>k</mi><mo>,</mo><mi>Î´</mi></mrow></msub><annotation encoding="application/x-tex">\mathcal{S}_{k,\delta}</annotation><annotation encoding="application/x-llamapun">caligraphic_S start_POSTSUBSCRIPT italic_k , italic_Î´ end_POSTSUBSCRIPT</annotation></semantics></math> in a way
that makes it clear that each of the fibers
<math alttext="\pi_{\mathcal{S}_{k}}^{-1}(\bm{\xi})" class="ltx_Math" display="inline" id="S3.SS2.p3.m28"><semantics><mrow><msubsup><mi>Ï€</mi><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mi>k</mi></msub><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msubsup><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğƒ</mi><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">\pi_{\mathcal{S}_{k}}^{-1}(\bm{\xi})</annotation><annotation encoding="application/x-llamapun">italic_Ï€ start_POSTSUBSCRIPT caligraphic_S start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ( bold_italic_Î¾ )</annotation></semantics></math> (for each <math alttext="\bm{\xi}\in\mathcal{S}_{k}" class="ltx_Math" display="inline" id="S3.SS2.p3.m29"><semantics><mrow><mi>ğƒ</mi><mo>âˆˆ</mo><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">\bm{\xi}\in\mathcal{S}_{k}</annotation><annotation encoding="application/x-llamapun">bold_italic_Î¾ âˆˆ caligraphic_S start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>) â€œcontributesâ€ equally
to the integral.<span class="ltx_note ltx_role_footnote" id="footnote7"><sup class="ltx_note_mark">7</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">7</sup><span class="ltx_tag ltx_tag_note">7</span>More rigorously, this corresponds to decomposing
the uniform density on <math alttext="\mathcal{S}_{k,\delta}" class="ltx_Math" display="inline" id="footnote7.m1"><semantics><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mrow><mi>k</mi><mo>,</mo><mi>Î´</mi></mrow></msub><annotation encoding="application/x-tex">\mathcal{S}_{k,\delta}</annotation><annotation encoding="application/x-llamapun">caligraphic_S start_POSTSUBSCRIPT italic_k , italic_Î´ end_POSTSUBSCRIPT</annotation></semantics></math> into a regular conditional density
corresponding to <math alttext="\bm{\xi}\in\mathcal{S}_{k}" class="ltx_Math" display="inline" id="footnote7.m2"><semantics><mrow><mi>ğƒ</mi><mo>âˆˆ</mo><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">\bm{\xi}\in\mathcal{S}_{k}</annotation><annotation encoding="application/x-llamapun">bold_italic_Î¾ âˆˆ caligraphic_S start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>, and showing that the corresponding
density on <math alttext="\bm{\xi}" class="ltx_Math" display="inline" id="footnote7.m3"><semantics><mi>ğƒ</mi><annotation encoding="application/x-tex">\bm{\xi}</annotation><annotation encoding="application/x-llamapun">bold_italic_Î¾</annotation></semantics></math> is uniform. The proof makes it clear this is true.</span></span></span>
We have by <a class="ltx_ref" href="#Thmdefinition2" title="Definition B.2. â€£ B.3.1 Proof of Relationship Between Rate Distortion and Covering â€£ B.3 Lossy Coding and Sphere Packing â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Definition</span>Â <span class="ltx_text ltx_ref_tag">B.2</span></a></p>
<table class="ltx_equation ltx_eqn_table" id="S3.E41">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\operatorname{vol}(\mathcal{S}_{k,\delta})=\iint_{\operatorname{Span}(\bm{U}_{k})\times\operatorname{Span}(\bm{U}_{k})^{\perp}}\mathbf{1}_{\left\|\bm{\xi}^{\perp}\right\|_{2}^{2}+\left(\left\|\bm{\xi}^{\|}\right\|_{2}-1\right)^{2}\leq\delta}~{}\mathrm{d}\bm{\xi}^{\|}~{}\mathrm{d}\bm{\xi}^{\perp}." class="ltx_math_unparsed" display="block" id="S3.E41.m1"><semantics><mrow><mrow><mrow><mi>vol</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mrow><mi>k</mi><mo>,</mo><mi>Î´</mi></mrow></msub><mo stretchy="false">)</mo></mrow></mrow><mo rspace="0.111em">=</mo><mrow><msub><mo>âˆ¬</mo><mrow><mi>Span</mi><mrow><mo stretchy="false">(</mo><msub><mi>ğ‘¼</mi><mi>k</mi></msub><mo rspace="0.055em" stretchy="false">)</mo></mrow><mo rspace="0.222em">Ã—</mo><mi>Span</mi><msup><mrow><mo stretchy="false">(</mo><msub><mi>ğ‘¼</mi><mi>k</mi></msub><mo stretchy="false">)</mo></mrow><mo>âŸ‚</mo></msup></mrow></msub><mrow><msub><mn>ğŸ</mn><mrow><mrow><msubsup><mrow><mo>â€–</mo><msup><mi>ğƒ</mi><mo>âŸ‚</mo></msup><mo>â€–</mo></mrow><mn>2</mn><mn>2</mn></msubsup><mo>+</mo><msup><mrow><mo>(</mo><mrow><msub><mrow><mo>â€–</mo><msup><mi>ğƒ</mi><mo>âˆ¥</mo></msup><mo>â€–</mo></mrow><mn>2</mn></msub><mo>âˆ’</mo><mn>1</mn></mrow><mo>)</mo></mrow><mn>2</mn></msup></mrow><mo>â‰¤</mo><mi>Î´</mi></mrow></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><msup><mi>ğƒ</mi><mo>âˆ¥</mo></msup></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><msup><mi>ğƒ</mi><mo>âŸ‚</mo></msup></mrow></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">\operatorname{vol}(\mathcal{S}_{k,\delta})=\iint_{\operatorname{Span}(\bm{U}_{k})\times\operatorname{Span}(\bm{U}_{k})^{\perp}}\mathbf{1}_{\left\|\bm{\xi}^{\perp}\right\|_{2}^{2}+\left(\left\|\bm{\xi}^{\|}\right\|_{2}-1\right)^{2}\leq\delta}~{}\mathrm{d}\bm{\xi}^{\|}~{}\mathrm{d}\bm{\xi}^{\perp}.</annotation><annotation encoding="application/x-llamapun">roman_vol ( caligraphic_S start_POSTSUBSCRIPT italic_k , italic_Î´ end_POSTSUBSCRIPT ) = âˆ¬ start_POSTSUBSCRIPT roman_Span ( bold_italic_U start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) Ã— roman_Span ( bold_italic_U start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT âŸ‚ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT bold_1 start_POSTSUBSCRIPT âˆ¥ bold_italic_Î¾ start_POSTSUPERSCRIPT âŸ‚ end_POSTSUPERSCRIPT âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + ( âˆ¥ bold_italic_Î¾ start_POSTSUPERSCRIPT âˆ¥ end_POSTSUPERSCRIPT âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT - 1 ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT â‰¤ italic_Î´ end_POSTSUBSCRIPT roman_d bold_italic_Î¾ start_POSTSUPERSCRIPT âˆ¥ end_POSTSUPERSCRIPT roman_d bold_italic_Î¾ start_POSTSUPERSCRIPT âŸ‚ end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.3.41)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">In particular, the integration over the orthogonal coordinates factors.
Let <math alttext="~{}\mathrm{d}\bm{\theta}^{d}" class="ltx_Math" display="inline" id="S3.SS2.p3.m30"><semantics><mrow><mi mathvariant="normal">d</mi><mo lspace="0em" rspace="0em">â€‹</mo><msup><mi>ğœ½</mi><mi>d</mi></msup></mrow><annotation encoding="application/x-tex">~{}\mathrm{d}\bm{\theta}^{d}</annotation><annotation encoding="application/x-llamapun">roman_d bold_italic_Î¸ start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> denote the uniform (Haar) measure on the sphere of
radius <math alttext="1" class="ltx_Math" display="inline" id="S3.SS2.p3.m31"><semantics><mn>1</mn><annotation encoding="application/x-tex">1</annotation><annotation encoding="application/x-llamapun">1</annotation></semantics></math> in <math alttext="\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S3.SS2.p3.m32"><semantics><msup><mi>â„</mi><mi>d</mi></msup><annotation encoding="application/x-tex">\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun">blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>. Converting the <math alttext="\bm{\xi}^{\|}" class="ltx_Math" display="inline" id="S3.SS2.p3.m33"><semantics><msup><mi>ğƒ</mi><mo>âˆ¥</mo></msup><annotation encoding="application/x-tex">\bm{\xi}^{\|}</annotation><annotation encoding="application/x-llamapun">bold_italic_Î¾ start_POSTSUPERSCRIPT âˆ¥ end_POSTSUPERSCRIPT</annotation></semantics></math> integral to polar
coordinates, we have</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E42">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\operatorname{vol}(\mathcal{S}_{k,\delta})=\int_{[0,\infty)}\int_{\mathbb{S}^{d_{k}-1}}\int_{\operatorname{Span}(\bm{U}_{k})^{\perp}}r^{d_{k}-1}\mathbf{1}_{\left\|\bm{\xi}^{\perp}\right\|_{2}^{2}+\left(r-1\right)^{2}\leq\delta}~{}\mathrm{d}r~{}\mathrm{d}\bm{\theta}^{d_{k}}~{}\mathrm{d}\bm{\xi}^{\perp}." class="ltx_math_unparsed" display="block" id="S3.E42.m1"><semantics><mrow><mrow><mrow><mi>vol</mi><mo>â¡</mo><mrow><mo stretchy="false">(</mo><msub><mi class="ltx_font_mathcaligraphic">ğ’®</mi><mrow><mi>k</mi><mo>,</mo><mi>Î´</mi></mrow></msub><mo stretchy="false">)</mo></mrow></mrow><mo rspace="0.111em">=</mo><mrow><msub><mo rspace="0em">âˆ«</mo><mrow><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mi mathvariant="normal">âˆ</mi><mo stretchy="false">)</mo></mrow></msub><mrow><msub><mo rspace="0em">âˆ«</mo><msup><mi>ğ•Š</mi><mrow><msub><mi>d</mi><mi>k</mi></msub><mo>âˆ’</mo><mn>1</mn></mrow></msup></msub><mrow><msub><mo>âˆ«</mo><mrow><mi>Span</mi><msup><mrow><mo stretchy="false">(</mo><msub><mi>ğ‘¼</mi><mi>k</mi></msub><mo stretchy="false">)</mo></mrow><mo>âŸ‚</mo></msup></mrow></msub><mrow><msup><mi>r</mi><mrow><msub><mi>d</mi><mi>k</mi></msub><mo>âˆ’</mo><mn>1</mn></mrow></msup><mo lspace="0em" rspace="0em">â€‹</mo><msub><mn>ğŸ</mn><mrow><mrow><msubsup><mrow><mo>â€–</mo><msup><mi>ğƒ</mi><mo>âŸ‚</mo></msup><mo>â€–</mo></mrow><mn>2</mn><mn>2</mn></msubsup><mo>+</mo><msup><mrow><mo>(</mo><mrow><mi>r</mi><mo>âˆ’</mo><mn>1</mn></mrow><mo>)</mo></mrow><mn>2</mn></msup></mrow><mo>â‰¤</mo><mi>Î´</mi></mrow></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><mi>r</mi></mrow><mo lspace="0.330em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><msup><mi>ğœ½</mi><msub><mi>d</mi><mi>k</mi></msub></msup></mrow><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo rspace="0em">d</mo><msup><mi>ğƒ</mi><mo>âŸ‚</mo></msup></mrow></mrow></mrow></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">\operatorname{vol}(\mathcal{S}_{k,\delta})=\int_{[0,\infty)}\int_{\mathbb{S}^{d_{k}-1}}\int_{\operatorname{Span}(\bm{U}_{k})^{\perp}}r^{d_{k}-1}\mathbf{1}_{\left\|\bm{\xi}^{\perp}\right\|_{2}^{2}+\left(r-1\right)^{2}\leq\delta}~{}\mathrm{d}r~{}\mathrm{d}\bm{\theta}^{d_{k}}~{}\mathrm{d}\bm{\xi}^{\perp}.</annotation><annotation encoding="application/x-llamapun">roman_vol ( caligraphic_S start_POSTSUBSCRIPT italic_k , italic_Î´ end_POSTSUBSCRIPT ) = âˆ« start_POSTSUBSCRIPT [ 0 , âˆ ) end_POSTSUBSCRIPT âˆ« start_POSTSUBSCRIPT blackboard_S start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT - 1 end_POSTSUPERSCRIPT end_POSTSUBSCRIPT âˆ« start_POSTSUBSCRIPT roman_Span ( bold_italic_U start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT âŸ‚ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT italic_r start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT - 1 end_POSTSUPERSCRIPT bold_1 start_POSTSUBSCRIPT âˆ¥ bold_italic_Î¾ start_POSTSUPERSCRIPT âŸ‚ end_POSTSUPERSCRIPT âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + ( italic_r - 1 ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT â‰¤ italic_Î´ end_POSTSUBSCRIPT roman_d italic_r roman_d bold_italic_Î¸ start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUPERSCRIPT roman_d bold_italic_Î¾ start_POSTSUPERSCRIPT âŸ‚ end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.3.42)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">Comparing to the fiber representation (<a class="ltx_ref" href="#S3.E40" title="Equation B.3.40 â€£ B.3.2 Deferred Proofs â€£ B.3 Lossy Coding and Sphere Packing â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">B.3.40</span></a>),
we see that we need to â€œintegrate outâ€ over the <math alttext="r" class="ltx_Math" display="inline" id="S3.SS2.p3.m34"><semantics><mi>r</mi><annotation encoding="application/x-tex">r</annotation><annotation encoding="application/x-llamapun">italic_r</annotation></semantics></math> and <math alttext="\bm{\xi}^{\perp}" class="ltx_Math" display="inline" id="S3.SS2.p3.m35"><semantics><msup><mi>ğƒ</mi><mo>âŸ‚</mo></msup><annotation encoding="application/x-tex">\bm{\xi}^{\perp}</annotation><annotation encoding="application/x-llamapun">bold_italic_Î¾ start_POSTSUPERSCRIPT âŸ‚ end_POSTSUPERSCRIPT</annotation></semantics></math>
components of the preceding integral in order to verify that the pushforward
is uniform.
But this is evident, as the previous expression shows that the value of this
integral is independent of <math alttext="\bm{\xi}^{\|}" class="ltx_Math" display="inline" id="S3.SS2.p3.m36"><semantics><msup><mi>ğƒ</mi><mo>âˆ¥</mo></msup><annotation encoding="application/x-tex">\bm{\xi}^{\|}</annotation><annotation encoding="application/x-llamapun">bold_italic_Î¾ start_POSTSUPERSCRIPT âˆ¥ end_POSTSUPERSCRIPT</annotation></semantics></math>â€”or, equivalently in context, the
value of the spherical component <math alttext="\bm{\theta}^{d_{k}}" class="ltx_Math" display="inline" id="S3.SS2.p3.m37"><semantics><msup><mi>ğœ½</mi><msub><mi>d</mi><mi>k</mi></msub></msup><annotation encoding="application/x-tex">\bm{\theta}^{d_{k}}</annotation><annotation encoding="application/x-llamapun">bold_italic_Î¸ start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS2.p4">
<p class="ltx_p">Thus it follows from the above argument that <math alttext="\pi_{\mathcal{S}}(\bm{x}_{\delta})" class="ltx_Math" display="inline" id="S3.SS2.p4.m1"><semantics><mrow><msub><mi>Ï€</mi><mi class="ltx_font_mathcaligraphic">ğ’®</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ’™</mi><mi>Î´</mi></msub><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">\pi_{\mathcal{S}}(\bm{x}_{\delta})</annotation><annotation encoding="application/x-llamapun">italic_Ï€ start_POSTSUBSCRIPT caligraphic_S end_POSTSUBSCRIPT ( bold_italic_x start_POSTSUBSCRIPT italic_Î´ end_POSTSUBSCRIPT )</annotation></semantics></math> is
uniform.
Because the assumption on <math alttext="\delta" class="ltx_Math" display="inline" id="S3.SS2.p4.m2"><semantics><mi>Î´</mi><annotation encoding="application/x-tex">\delta</annotation><annotation encoding="application/x-llamapun">italic_Î´</annotation></semantics></math> implies that the mixture components in
the distribution of <math alttext="\bm{x}_{\delta}" class="ltx_Math" display="inline" id="S3.SS2.p4.m3"><semantics><msub><mi>ğ’™</mi><mi>Î´</mi></msub><annotation encoding="application/x-tex">\bm{x}_{\delta}</annotation><annotation encoding="application/x-llamapun">bold_italic_x start_POSTSUBSCRIPT italic_Î´ end_POSTSUBSCRIPT</annotation></semantics></math> do not overlap, the mixing weights
<math alttext="\pi_{k}" class="ltx_Math" display="inline" id="S3.SS2.p4.m4"><semantics><msub><mi>Ï€</mi><mi>k</mi></msub><annotation encoding="application/x-tex">\pi_{k}</annotation><annotation encoding="application/x-llamapun">italic_Ï€ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> are also preserved in the image <math alttext="\pi_{\mathcal{S}}(\bm{x}_{\delta})" class="ltx_Math" display="inline" id="S3.SS2.p4.m5"><semantics><mrow><msub><mi>Ï€</mi><mi class="ltx_font_mathcaligraphic">ğ’®</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ’™</mi><mi>Î´</mi></msub><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">\pi_{\mathcal{S}}(\bm{x}_{\delta})</annotation><annotation encoding="application/x-llamapun">italic_Ï€ start_POSTSUBSCRIPT caligraphic_S end_POSTSUBSCRIPT ( bold_italic_x start_POSTSUBSCRIPT italic_Î´ end_POSTSUBSCRIPT )</annotation></semantics></math>, and in
particular, the distribution of <math alttext="\pi_{\mathcal{S}}(\bm{x}_{\delta})" class="ltx_Math" display="inline" id="S3.SS2.p4.m6"><semantics><mrow><msub><mi>Ï€</mi><mi class="ltx_font_mathcaligraphic">ğ’®</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ’™</mi><mi>Î´</mi></msub><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">\pi_{\mathcal{S}}(\bm{x}_{\delta})</annotation><annotation encoding="application/x-llamapun">italic_Ï€ start_POSTSUBSCRIPT caligraphic_S end_POSTSUBSCRIPT ( bold_italic_x start_POSTSUBSCRIPT italic_Î´ end_POSTSUBSCRIPT )</annotation></semantics></math> is equal to the
distribution of <math alttext="\bm{x}" class="ltx_Math" display="inline" id="S3.SS2.p4.m7"><semantics><mi>ğ’™</mi><annotation encoding="application/x-tex">\bm{x}</annotation><annotation encoding="application/x-llamapun">bold_italic_x</annotation></semantics></math>.
Hence the second term in <a class="ltx_ref" href="#S3.E37" title="In B.3.2 Deferred Proofs â€£ B.3 Lossy Coding and Sphere Packing â€£ Appendix B Entropy, Diffusion, Denoising, and Lossy Coding â€£ Appendices â€£ Learning Deep Representations of Data Distributions"><span class="ltx_text ltx_ref_tag">Equation</span>Â <span class="ltx_text ltx_ref_tag">B.3.37</span></a> satisfies</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E43">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbb{E}\left[\left\|\pi_{\mathcal{S}}(\bm{x}_{\delta})-\mathrm{q}(\pi_{\mathcal{S}}(\bm{x}_{\delta}))\right\|_{2}^{2}\right]=\mathbb{E}\left[\left\|\bm{x}-\mathrm{q}(\bm{x})\right\|_{2}^{2}\right]\leq\epsilon^{2}," class="ltx_Math" display="block" id="S3.E43.m1"><semantics><mrow><mrow><mrow><mi>ğ”¼</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo>[</mo><msubsup><mrow><mo>â€–</mo><mrow><mrow><msub><mi>Ï€</mi><mi class="ltx_font_mathcaligraphic">ğ’®</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ’™</mi><mi>Î´</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>âˆ’</mo><mrow><mi mathvariant="normal">q</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mrow><msub><mi>Ï€</mi><mi class="ltx_font_mathcaligraphic">ğ’®</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ’™</mi><mi>Î´</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>â€–</mo></mrow><mn>2</mn><mn>2</mn></msubsup><mo>]</mo></mrow></mrow><mo>=</mo><mrow><mi>ğ”¼</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo>[</mo><msubsup><mrow><mo>â€–</mo><mrow><mi>ğ’™</mi><mo>âˆ’</mo><mrow><mi mathvariant="normal">q</mi><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğ’™</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>â€–</mo></mrow><mn>2</mn><mn>2</mn></msubsup><mo>]</mo></mrow></mrow><mo>â‰¤</mo><msup><mi>Ïµ</mi><mn>2</mn></msup></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">\mathbb{E}\left[\left\|\pi_{\mathcal{S}}(\bm{x}_{\delta})-\mathrm{q}(\pi_{\mathcal{S}}(\bm{x}_{\delta}))\right\|_{2}^{2}\right]=\mathbb{E}\left[\left\|\bm{x}-\mathrm{q}(\bm{x})\right\|_{2}^{2}\right]\leq\epsilon^{2},</annotation><annotation encoding="application/x-llamapun">blackboard_E [ âˆ¥ italic_Ï€ start_POSTSUBSCRIPT caligraphic_S end_POSTSUBSCRIPT ( bold_italic_x start_POSTSUBSCRIPT italic_Î´ end_POSTSUBSCRIPT ) - roman_q ( italic_Ï€ start_POSTSUBSCRIPT caligraphic_S end_POSTSUBSCRIPT ( bold_italic_x start_POSTSUBSCRIPT italic_Î´ end_POSTSUBSCRIPT ) ) âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ] = blackboard_E [ âˆ¥ bold_italic_x - roman_q ( bold_italic_x ) âˆ¥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ] â‰¤ italic_Ïµ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.3.43)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">because <math alttext="\mathrm{q}" class="ltx_Math" display="inline" id="S3.SS2.p4.m8"><semantics><mi mathvariant="normal">q</mi><annotation encoding="application/x-tex">\mathrm{q}</annotation><annotation encoding="application/x-llamapun">roman_q</annotation></semantics></math> is a distortion-<math alttext="\epsilon" class="ltx_Math" display="inline" id="S3.SS2.p4.m9"><semantics><mi>Ïµ</mi><annotation encoding="application/x-tex">\epsilon</annotation><annotation encoding="application/x-llamapun">italic_Ïµ</annotation></semantics></math> code for <math alttext="\bm{x}" class="ltx_Math" display="inline" id="S3.SS2.p4.m10"><semantics><mi>ğ’™</mi><annotation encoding="application/x-tex">\bm{x}</annotation><annotation encoding="application/x-llamapun">bold_italic_x</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS2.p5">
<p class="ltx_p">We have thus shown that the hypothesized rate-<math alttext="R" class="ltx_Math" display="inline" id="S3.SS2.p5.m1"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation><annotation encoding="application/x-llamapun">italic_R</annotation></semantics></math>, (expected squared)
distortion-<math alttext="\epsilon^{2}" class="ltx_Math" display="inline" id="S3.SS2.p5.m2"><semantics><msup><mi>Ïµ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\epsilon^{2}</annotation><annotation encoding="application/x-llamapun">italic_Ïµ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math> code for <math alttext="\bm{x}" class="ltx_Math" display="inline" id="S3.SS2.p5.m3"><semantics><mi>ğ’™</mi><annotation encoding="application/x-tex">\bm{x}</annotation><annotation encoding="application/x-llamapun">bold_italic_x</annotation></semantics></math> produces a rate-<math alttext="R" class="ltx_Math" display="inline" id="S3.SS2.p5.m4"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation><annotation encoding="application/x-llamapun">italic_R</annotation></semantics></math>, (expected
squared) distortion <math alttext="\delta+\epsilon" class="ltx_Math" display="inline" id="S3.SS2.p5.m5"><semantics><mrow><mi>Î´</mi><mo>+</mo><mi>Ïµ</mi></mrow><annotation encoding="application/x-tex">\delta+\epsilon</annotation><annotation encoding="application/x-llamapun">italic_Î´ + italic_Ïµ</annotation></semantics></math> code for <math alttext="\bm{x}_{\delta}" class="ltx_Math" display="inline" id="S3.SS2.p5.m6"><semantics><msub><mi>ğ’™</mi><mi>Î´</mi></msub><annotation encoding="application/x-tex">\bm{x}_{\delta}</annotation><annotation encoding="application/x-llamapun">bold_italic_x start_POSTSUBSCRIPT italic_Î´ end_POSTSUBSCRIPT</annotation></semantics></math>.
This establishes that</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E44">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="R_{\delta+\epsilon}(\bm{x}_{\delta})\leq R_{\epsilon}(\bm{x})," class="ltx_Math" display="block" id="S3.E44.m1"><semantics><mrow><mrow><mrow><msub><mi>R</mi><mrow><mi>Î´</mi><mo>+</mo><mi>Ïµ</mi></mrow></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><msub><mi>ğ’™</mi><mi>Î´</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>â‰¤</mo><mrow><msub><mi>R</mi><mi>Ïµ</mi></msub><mo lspace="0em" rspace="0em">â€‹</mo><mrow><mo stretchy="false">(</mo><mi>ğ’™</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">R_{\delta+\epsilon}(\bm{x}_{\delta})\leq R_{\epsilon}(\bm{x}),</annotation><annotation encoding="application/x-llamapun">italic_R start_POSTSUBSCRIPT italic_Î´ + italic_Ïµ end_POSTSUBSCRIPT ( bold_italic_x start_POSTSUBSCRIPT italic_Î´ end_POSTSUBSCRIPT ) â‰¤ italic_R start_POSTSUBSCRIPT italic_Ïµ end_POSTSUBSCRIPT ( bold_italic_x ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B.3.44)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">as was to be shown.</p>
</div>
<div class="ltx_para" id="S3.SS2.p6">
<p class="ltx_p">âˆ</p>
</div>
</div>
</section>
</section>
</section>
</div>
<footer class="ltx_page_footer">
<div class="ltx_align_center">
</div>
<div class="ltx_page_logo">Generated  on Mon Aug 11 17:57:54 2025 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
